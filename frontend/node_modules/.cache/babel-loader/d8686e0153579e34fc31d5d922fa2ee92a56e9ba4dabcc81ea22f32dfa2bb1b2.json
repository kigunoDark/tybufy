{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\VideoExportModal.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { X, Download, Check, AlertCircle } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const VideoExportModal = ({\n  isOpen,\n  onClose,\n  timelineItems,\n  tracks,\n  videoDuration,\n  onExport\n}) => {\n  _s();\n  const [exportSettings, setExportSettings] = useState({\n    resolution: \"1920x1080\",\n    fps: 30,\n    bitrate: 5000,\n    format: \"mp4\",\n    quality: \"high\"\n  });\n  const [isExporting, setIsExporting] = useState(false);\n  const [exportProgress, setExportProgress] = useState(0);\n  const [exportStatus, setExportStatus] = useState(\"idle\");\n  const [estimatedTime, setEstimatedTime] = useState(null);\n  const resolutionOptions = [{\n    value: \"3840x2160\",\n    label: \"4K (3840×2160)\",\n    size: \"2160p\"\n  }, {\n    value: \"1920x1080\",\n    label: \"Full HD (1920×1080)\",\n    size: \"1080p\"\n  }, {\n    value: \"1280x720\",\n    label: \"HD (1280×720)\",\n    size: \"720p\"\n  }, {\n    value: \"854x480\",\n    label: \"SD (854×480)\",\n    size: \"480p\"\n  }];\n  const fpsOptions = [24, 30, 60];\n  const qualityOptions = [{\n    value: \"low\",\n    label: \"Низкое качество\",\n    bitrate: 1000\n  }, {\n    value: \"medium\",\n    label: \"Среднее качество\",\n    bitrate: 3000\n  }, {\n    value: \"high\",\n    label: \"Высокое качество\",\n    bitrate: 5000\n  }, {\n    value: \"ultra\",\n    label: \"Ультра качество\",\n    bitrate: 10000\n  }];\n  const formatOptions = [{\n    value: \"mp4\",\n    label: \"MP4 (H.264)\",\n    extension: \".mp4\"\n  }, {\n    value: \"webm\",\n    label: \"WebM (VP9)\",\n    extension: \".webm\"\n  }, {\n    value: \"mov\",\n    label: \"QuickTime (MOV)\",\n    extension: \".mov\"\n  }];\n  useEffect(() => {\n    if (exportSettings.quality) {\n      const quality = qualityOptions.find(q => q.value === exportSettings.quality);\n      if (quality) {\n        setExportSettings(prev => ({\n          ...prev,\n          bitrate: quality.bitrate\n        }));\n      }\n    }\n  }, [exportSettings.quality, qualityOptions]);\n  useEffect(() => {\n    if (videoDuration && exportSettings.fps) {\n      const complexity = timelineItems.filter(item => item.trackType === \"overlay\").length;\n      const multiplier = 2 + complexity * 0.5;\n      setEstimatedTime(Math.ceil(videoDuration * multiplier));\n    }\n  }, [videoDuration, exportSettings.fps, timelineItems]);\n  const getFileSize = () => {\n    if (!videoDuration) return \"~\";\n    const sizeInMB = exportSettings.bitrate * videoDuration * 1000 / (8 * 1024 * 1024);\n    if (sizeInMB < 1024) {\n      return `~${sizeInMB.toFixed(0)} МБ`;\n    } else {\n      return `~${(sizeInMB / 1024).toFixed(1)} ГБ`;\n    }\n  };\n  const handleExport = async () => {\n    setIsExporting(true);\n    setExportStatus(\"processing\");\n    setExportProgress(0);\n    try {\n      await simulateVideoExport();\n      setExportStatus(\"success\");\n    } catch (error) {\n      console.error(\"Export failed:\", error);\n      setExportStatus(\"error\");\n    } finally {\n      setIsExporting(false);\n    }\n  };\n  const simulateVideoExport = async () => {\n    const totalSteps = 100;\n    const stepDuration = estimatedTime * 1000 / totalSteps;\n    for (let i = 0; i <= totalSteps; i++) {\n      setExportProgress(i);\n      const delay = stepDuration * (1 + Math.sin(i / 20) * 0.3);\n      await new Promise(resolve => setTimeout(resolve, delay));\n      if (i === totalSteps) {\n        await actualVideoExport();\n      }\n    }\n  };\n  const actualVideoExport = async () => {\n    const videoExporter = new VideoExporter({\n      timelineItems,\n      tracks,\n      videoDuration,\n      settings: exportSettings\n    });\n    const exportedVideoBlob = await videoExporter.render();\n    downloadVideo(exportedVideoBlob);\n  };\n  const downloadVideo = blob => {\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `edited_video_${Date.now()}.${exportSettings.format}`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  };\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between p-6 border-b border-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold text-gray-800 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(Download, {\n            size: 24,\n            className: \"mr-2 text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"p-2 hover:bg-gray-100 rounded-full transition-colors\",\n          disabled: isExporting,\n          children: /*#__PURE__*/_jsxDEV(X, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 space-y-6 max-h-[calc(90vh-120px)] overflow-y-auto\",\n        children: [exportStatus !== \"idle\" && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-4 rounded-xl ${exportStatus === \"processing\" ? \"bg-blue-50 border border-blue-200\" : exportStatus === \"success\" ? \"bg-green-50 border border-green-200\" : \"bg-red-50 border border-red-200\"}`,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [exportStatus === \"processing\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between text-sm text-blue-700 mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 171,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [exportProgress, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 172,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full bg-blue-200 rounded-full h-2\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"bg-blue-600 h-2 rounded-full transition-all duration-300\",\n                    style: {\n                      width: `${exportProgress}%`\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 23\n                }, this), estimatedTime && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-blue-600 mt-2\",\n                  children: [\"\\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u0440\\u0438\\u043C\\u0435\\u0440\\u043D\\u043E:\", \" \", Math.max(0, Math.ceil(estimatedTime * (100 - exportProgress) / 100)), \" \", \"\\u0441\\u0435\\u043A\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true), exportStatus === \"success\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Check, {\n                size: 20,\n                className: \"text-green-600 mr-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-700 font-medium\",\n                children: \"\\u0412\\u0438\\u0434\\u0435\\u043E \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u043E!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true), exportStatus === \"error\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n                size: 20,\n                className: \"text-red-600 mr-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-red-700 font-medium\",\n                children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0435\\u043E\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u0420\\u0430\\u0437\\u0440\\u0435\\u0448\\u0435\\u043D\\u0438\\u0435\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: exportSettings.resolution,\n              onChange: e => setExportSettings(prev => ({\n                ...prev,\n                resolution: e.target.value\n              })),\n              className: \"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n              disabled: isExporting,\n              children: resolutionOptions.map(option => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: option.value,\n                children: option.label\n              }, option.value, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u0427\\u0430\\u0441\\u0442\\u043E\\u0442\\u0430 \\u043A\\u0430\\u0434\\u0440\\u043E\\u0432 (FPS)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: exportSettings.fps,\n              onChange: e => setExportSettings(prev => ({\n                ...prev,\n                fps: parseInt(e.target.value)\n              })),\n              className: \"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n              disabled: isExporting,\n              children: fpsOptions.map(fps => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: fps,\n                children: [fps, \" FPS\"]\n              }, fps, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u041A\\u0430\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: exportSettings.quality,\n              onChange: e => setExportSettings(prev => ({\n                ...prev,\n                quality: e.target.value\n              })),\n              className: \"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n              disabled: isExporting,\n              children: qualityOptions.map(quality => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: quality.value,\n                children: [quality.label, \" (\", quality.bitrate, \" kbps)\"]\n              }, quality.value, true, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u0424\\u043E\\u0440\\u043C\\u0430\\u0442\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: exportSettings.format,\n              onChange: e => setExportSettings(prev => ({\n                ...prev,\n                format: e.target.value\n              })),\n              className: \"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n              disabled: isExporting,\n              children: formatOptions.map(format => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: format.value,\n                children: format.label\n              }, format.value, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 rounded-xl p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"font-medium text-gray-800 mb-3\",\n            children: \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u043E\\u0431 \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-4 text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-2 font-medium\",\n                children: [Math.round(videoDuration), \"\\u0441\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440 \\u0444\\u0430\\u0439\\u043B\\u0430:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-2 font-medium\",\n                children: getFileSize()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"\\u0411\\u0438\\u0442\\u0440\\u0435\\u0439\\u0442:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-2 font-medium\",\n                children: [exportSettings.bitrate, \" kbps\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"\\u0412\\u0440\\u0435\\u043C\\u044F \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0430:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-2 font-medium\",\n                children: [\"~\", estimatedTime, \"\\u0441\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 rounded-xl p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"font-medium text-gray-800 mb-3\",\n            children: \"\\u042D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B \\u0434\\u043B\\u044F \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2 max-h-32 overflow-y-auto\",\n            children: timelineItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-700\",\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `px-2 py-1 rounded text-xs ${item.trackType === \"main\" ? \"bg-blue-100 text-blue-700\" : item.trackType === \"audio\" ? \"bg-green-100 text-green-700\" : \"bg-purple-100 text-purple-700\"}`,\n                children: item.trackType\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 19\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-end space-x-3 p-6 border-t border-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors\",\n          disabled: isExporting,\n          children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleExport,\n          disabled: isExporting || timelineItems.length === 0,\n          className: `px-6 py-3 rounded-xl font-medium transition-all flex items-center ${isExporting || timelineItems.length === 0 ? \"bg-gray-300 text-gray-500 cursor-not-allowed\" : \"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg\"}`,\n          children: isExporting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 17\n            }, this), \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442...\"]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Download, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this), \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 138,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoExportModal, \"/oD81cKCIxVUBwvk7mGAXZ4GqR8=\");\n_c = VideoExportModal;\nclass VideoExporter {\n  constructor({\n    timelineItems,\n    tracks,\n    videoDuration,\n    settings\n  }) {\n    this.timelineItems = timelineItems;\n    this.tracks = tracks;\n    this.videoDuration = videoDuration;\n    this.settings = settings;\n    this.canvas = document.createElement(\"canvas\");\n    this.ctx = this.canvas.getContext(\"2d\");\n    const [width, height] = settings.resolution.split(\"x\").map(Number);\n    this.canvas.width = width;\n    this.canvas.height = height;\n  }\n  async render() {\n    const mediaRecorder = await this.setupMediaRecorder();\n    const chunks = [];\n    mediaRecorder.ondataavailable = event => {\n      if (event.data.size > 0) {\n        chunks.push(event.data);\n      }\n    };\n    return new Promise((resolve, reject) => {\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunks, {\n          type: `video/${this.settings.format}`\n        });\n        resolve(blob);\n      };\n      mediaRecorder.onerror = reject;\n      mediaRecorder.start();\n      this.renderFrames().then(() => {\n        mediaRecorder.stop();\n      }).catch(reject);\n    });\n  }\n  async setupMediaRecorder() {\n    const stream = this.canvas.captureStream(this.settings.fps);\n    const audioTracks = this.timelineItems.filter(item => item.trackType === \"audio\" && item.audioElement);\n    if (audioTracks.length > 0) {\n      const audioContext = new AudioContext();\n      const destination = audioContext.createMediaStreamDestination();\n      for (const audioTrack of audioTracks) {\n        const source = audioContext.createMediaElementSource(audioTrack.audioElement);\n        source.connect(destination);\n      }\n      const audioStream = destination.stream;\n      audioStream.getAudioTracks().forEach(track => {\n        stream.addTrack(track);\n      });\n    }\n    const options = {\n      mimeType: this.getMimeType(),\n      videoBitsPerSecond: this.settings.bitrate * 1000\n    };\n    return new MediaRecorder(stream, options);\n  }\n  getMimeType() {\n    switch (this.settings.format) {\n      case \"webm\":\n        return \"video/webm;codecs=vp9\";\n      case \"mov\":\n        return \"video/mp4;codecs=h264\";\n      default:\n        return \"video/mp4;codecs=h264\";\n    }\n  }\n  async renderFrames() {\n    const frameCount = Math.ceil(this.videoDuration * this.settings.fps);\n    const frameDuration = 1 / this.settings.fps;\n    for (let frame = 0; frame < frameCount; frame++) {\n      const currentTime = frame * frameDuration;\n      await this.renderFrame(currentTime);\n      await new Promise(resolve => requestAnimationFrame(resolve));\n    }\n  }\n  async renderFrame(currentTime) {\n    this.ctx.fillStyle = \"#000000\";\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    const sortedItems = [...this.timelineItems].sort((a, b) => {\n      const order = {\n        main: 1,\n        audio: 2,\n        overlay: 3\n      };\n      return order[a.trackType] - order[b.trackType];\n    });\n    for (const item of sortedItems) {\n      if (currentTime >= item.startTime && currentTime < item.startTime + item.duration) {\n        await this.renderItem(item, currentTime - item.startTime);\n      }\n    }\n  }\n  async renderItem(item, relativeTime) {\n    switch (item.type) {\n      case \"video\":\n        await this.renderVideo(item, relativeTime);\n        break;\n      case \"image\":\n        await this.renderImage(item);\n        break;\n    }\n  }\n  async renderVideo(item, relativeTime) {\n    if (!item.videoElement) return;\n    item.videoElement.currentTime = relativeTime;\n    await new Promise(resolve => {\n      const checkReady = () => {\n        if (item.videoElement.readyState >= 2) {\n          resolve();\n        } else {\n          requestAnimationFrame(checkReady);\n        }\n      };\n      checkReady();\n    });\n\n    // Рендерим видео на canvas\n    this.ctx.drawImage(item.videoElement, 0, 0, this.canvas.width, this.canvas.height);\n  }\n  async renderImage(item) {\n    if (!item.imageElement) return;\n\n    // Рендерим изображение на canvas\n    this.ctx.drawImage(item.imageElement, 0, 0, this.canvas.width, this.canvas.height);\n  }\n}\n\n// Хук для использования экспорта\nexport const useVideoExporter = () => {\n  _s2();\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\n  const openExportModal = () => setIsExportModalOpen(true);\n  const closeExportModal = () => setIsExportModalOpen(false);\n  return {\n    isExportModalOpen,\n    openExportModal,\n    closeExportModal,\n    VideoExportModal\n  };\n};\n\n// Пример использования в основном компоненте\n_s2(useVideoExporter, \"Wfaj4kprhDIijrMYdBElG6JtIdM=\");\nexport const VideoEditorWithExport = ({\n  timelineItems,\n  tracks,\n  videoDuration\n}) => {\n  _s3();\n  const {\n    isExportModalOpen,\n    openExportModal,\n    closeExportModal,\n    VideoExportModal\n  } = useVideoExporter();\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: openExportModal,\n      className: \"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center\",\n      children: [/*#__PURE__*/_jsxDEV(Download, {\n        size: 16,\n        className: \"mr-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 607,\n        columnNumber: 9\n      }, this), \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 603,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(VideoExportModal, {\n      isOpen: isExportModalOpen,\n      onClose: closeExportModal,\n      timelineItems: timelineItems,\n      tracks: tracks,\n      videoDuration: videoDuration\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 612,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s3(VideoEditorWithExport, \"vmMse5sSG96/poNLnFwVBa2DT9o=\", false, function () {\n  return [useVideoExporter];\n});\n_c2 = VideoEditorWithExport;\nvar _c, _c2;\n$RefreshReg$(_c, \"VideoExportModal\");\n$RefreshReg$(_c2, \"VideoEditorWithExport\");","map":{"version":3,"names":["useState","useEffect","X","Download","Check","AlertCircle","jsxDEV","_jsxDEV","Fragment","_Fragment","VideoExportModal","isOpen","onClose","timelineItems","tracks","videoDuration","onExport","_s","exportSettings","setExportSettings","resolution","fps","bitrate","format","quality","isExporting","setIsExporting","exportProgress","setExportProgress","exportStatus","setExportStatus","estimatedTime","setEstimatedTime","resolutionOptions","value","label","size","fpsOptions","qualityOptions","formatOptions","extension","find","q","prev","complexity","filter","item","trackType","length","multiplier","Math","ceil","getFileSize","sizeInMB","toFixed","handleExport","simulateVideoExport","error","console","totalSteps","stepDuration","i","delay","sin","Promise","resolve","setTimeout","actualVideoExport","videoExporter","VideoExporter","settings","exportedVideoBlob","render","downloadVideo","blob","url","URL","createObjectURL","a","document","createElement","href","download","Date","now","body","appendChild","click","removeChild","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","style","width","max","onChange","e","target","map","option","parseInt","round","name","id","_c","constructor","canvas","ctx","getContext","height","split","Number","mediaRecorder","setupMediaRecorder","chunks","ondataavailable","event","data","push","reject","onstop","Blob","type","onerror","start","renderFrames","then","stop","catch","stream","captureStream","audioTracks","audioElement","audioContext","AudioContext","destination","createMediaStreamDestination","audioTrack","source","createMediaElementSource","connect","audioStream","getAudioTracks","forEach","track","addTrack","options","mimeType","getMimeType","videoBitsPerSecond","MediaRecorder","frameCount","frameDuration","frame","currentTime","renderFrame","requestAnimationFrame","fillStyle","fillRect","sortedItems","sort","b","order","main","audio","overlay","startTime","duration","renderItem","relativeTime","renderVideo","renderImage","videoElement","checkReady","readyState","drawImage","imageElement","useVideoExporter","_s2","isExportModalOpen","setIsExportModalOpen","openExportModal","closeExportModal","VideoEditorWithExport","_s3","_c2","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/VideoExportModal.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { X, Download, Check, AlertCircle } from \"lucide-react\";\r\n\r\nexport const VideoExportModal = ({\r\n  isOpen,\r\n  onClose,\r\n  timelineItems,\r\n  tracks,\r\n  videoDuration,\r\n  onExport,\r\n}) => {\r\n  const [exportSettings, setExportSettings] = useState({\r\n    resolution: \"1920x1080\",\r\n    fps: 30,\r\n    bitrate: 5000,\r\n    format: \"mp4\",\r\n    quality: \"high\",\r\n  });\r\n\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [exportProgress, setExportProgress] = useState(0);\r\n  const [exportStatus, setExportStatus] = useState(\"idle\");\r\n  const [estimatedTime, setEstimatedTime] = useState(null);\r\n\r\n  const resolutionOptions = [\r\n    { value: \"3840x2160\", label: \"4K (3840×2160)\", size: \"2160p\" },\r\n    { value: \"1920x1080\", label: \"Full HD (1920×1080)\", size: \"1080p\" },\r\n    { value: \"1280x720\", label: \"HD (1280×720)\", size: \"720p\" },\r\n    { value: \"854x480\", label: \"SD (854×480)\", size: \"480p\" },\r\n  ];\r\n\r\n  const fpsOptions = [24, 30, 60];\r\n  const qualityOptions = [\r\n    { value: \"low\", label: \"Низкое качество\", bitrate: 1000 },\r\n    { value: \"medium\", label: \"Среднее качество\", bitrate: 3000 },\r\n    { value: \"high\", label: \"Высокое качество\", bitrate: 5000 },\r\n    { value: \"ultra\", label: \"Ультра качество\", bitrate: 10000 },\r\n  ];\r\n\r\n  const formatOptions = [\r\n    { value: \"mp4\", label: \"MP4 (H.264)\", extension: \".mp4\" },\r\n    { value: \"webm\", label: \"WebM (VP9)\", extension: \".webm\" },\r\n    { value: \"mov\", label: \"QuickTime (MOV)\", extension: \".mov\" },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (exportSettings.quality) {\r\n      const quality = qualityOptions.find(\r\n        (q) => q.value === exportSettings.quality\r\n      );\r\n      if (quality) {\r\n        setExportSettings((prev) => ({ ...prev, bitrate: quality.bitrate }));\r\n      }\r\n    }\r\n  }, [exportSettings.quality, qualityOptions]);\r\n\r\n  useEffect(() => {\r\n    if (videoDuration && exportSettings.fps) {\r\n      const complexity = timelineItems.filter(\r\n        (item) => item.trackType === \"overlay\"\r\n      ).length;\r\n      const multiplier = 2 + complexity * 0.5;\r\n      setEstimatedTime(Math.ceil(videoDuration * multiplier));\r\n    }\r\n  }, [videoDuration, exportSettings.fps, timelineItems]);\r\n\r\n  const getFileSize = () => {\r\n    if (!videoDuration) return \"~\";\r\n\r\n    const sizeInMB =\r\n      (exportSettings.bitrate * videoDuration * 1000) / (8 * 1024 * 1024);\r\n\r\n    if (sizeInMB < 1024) {\r\n      return `~${sizeInMB.toFixed(0)} МБ`;\r\n    } else {\r\n      return `~${(sizeInMB / 1024).toFixed(1)} ГБ`;\r\n    }\r\n  };\r\n\r\n  const handleExport = async () => {\r\n    setIsExporting(true);\r\n    setExportStatus(\"processing\");\r\n    setExportProgress(0);\r\n\r\n    try {\r\n      await simulateVideoExport();\r\n      setExportStatus(\"success\");\r\n    } catch (error) {\r\n      console.error(\"Export failed:\", error);\r\n      setExportStatus(\"error\");\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const simulateVideoExport = async () => {\r\n    const totalSteps = 100;\r\n    const stepDuration = (estimatedTime * 1000) / totalSteps;\r\n\r\n    for (let i = 0; i <= totalSteps; i++) {\r\n      setExportProgress(i);\r\n\r\n      const delay = stepDuration * (1 + Math.sin(i / 20) * 0.3);\r\n      await new Promise((resolve) => setTimeout(resolve, delay));\r\n\r\n      if (i === totalSteps) {\r\n        await actualVideoExport();\r\n      }\r\n    }\r\n  };\r\n\r\n  const actualVideoExport = async () => {\r\n    const videoExporter = new VideoExporter({\r\n      timelineItems,\r\n      tracks,\r\n      videoDuration,\r\n      settings: exportSettings,\r\n    });\r\n\r\n    const exportedVideoBlob = await videoExporter.render();\r\n    downloadVideo(exportedVideoBlob);\r\n  };\r\n\r\n  const downloadVideo = (blob) => {\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = `edited_video_${Date.now()}.${exportSettings.format}`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden\">\r\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800 flex items-center\">\r\n            <Download size={24} className=\"mr-2 text-blue-600\" />\r\n            Экспорт видео\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\"\r\n            disabled={isExporting}\r\n          >\r\n            <X size={20} />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-6 space-y-6 max-h-[calc(90vh-120px)] overflow-y-auto\">\r\n          {exportStatus !== \"idle\" && (\r\n            <div\r\n              className={`p-4 rounded-xl ${\r\n                exportStatus === \"processing\"\r\n                  ? \"bg-blue-50 border border-blue-200\"\r\n                  : exportStatus === \"success\"\r\n                  ? \"bg-green-50 border border-green-200\"\r\n                  : \"bg-red-50 border border-red-200\"\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center\">\r\n                {exportStatus === \"processing\" && (\r\n                  <>\r\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3\"></div>\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex justify-between text-sm text-blue-700 mb-2\">\r\n                        <span>Экспорт видео...</span>\r\n                        <span>{exportProgress}%</span>\r\n                      </div>\r\n                      <div className=\"w-full bg-blue-200 rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                          style={{ width: `${exportProgress}%` }}\r\n                        ></div>\r\n                      </div>\r\n                      {estimatedTime && (\r\n                        <div className=\"text-xs text-blue-600 mt-2\">\r\n                          Осталось примерно:{\" \"}\r\n                          {Math.max(\r\n                            0,\r\n                            Math.ceil(\r\n                              (estimatedTime * (100 - exportProgress)) / 100\r\n                            )\r\n                          )}{\" \"}\r\n                          сек\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </>\r\n                )}\r\n\r\n                {exportStatus === \"success\" && (\r\n                  <>\r\n                    <Check size={20} className=\"text-green-600 mr-3\" />\r\n                    <span className=\"text-green-700 font-medium\">\r\n                      Видео успешно экспортировано!\r\n                    </span>\r\n                  </>\r\n                )}\r\n\r\n                {exportStatus === \"error\" && (\r\n                  <>\r\n                    <AlertCircle size={20} className=\"text-red-600 mr-3\" />\r\n                    <span className=\"text-red-700 font-medium\">\r\n                      Ошибка при экспорте видео\r\n                    </span>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Разрешение\r\n              </label>\r\n              <select\r\n                value={exportSettings.resolution}\r\n                onChange={(e) =>\r\n                  setExportSettings((prev) => ({\r\n                    ...prev,\r\n                    resolution: e.target.value,\r\n                  }))\r\n                }\r\n                className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                disabled={isExporting}\r\n              >\r\n                {resolutionOptions.map((option) => (\r\n                  <option key={option.value} value={option.value}>\r\n                    {option.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Частота кадров (FPS)\r\n              </label>\r\n              <select\r\n                value={exportSettings.fps}\r\n                onChange={(e) =>\r\n                  setExportSettings((prev) => ({\r\n                    ...prev,\r\n                    fps: parseInt(e.target.value),\r\n                  }))\r\n                }\r\n                className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                disabled={isExporting}\r\n              >\r\n                {fpsOptions.map((fps) => (\r\n                  <option key={fps} value={fps}>\r\n                    {fps} FPS\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Качество\r\n              </label>\r\n              <select\r\n                value={exportSettings.quality}\r\n                onChange={(e) =>\r\n                  setExportSettings((prev) => ({\r\n                    ...prev,\r\n                    quality: e.target.value,\r\n                  }))\r\n                }\r\n                className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                disabled={isExporting}\r\n              >\r\n                {qualityOptions.map((quality) => (\r\n                  <option key={quality.value} value={quality.value}>\r\n                    {quality.label} ({quality.bitrate} kbps)\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Формат\r\n              </label>\r\n              <select\r\n                value={exportSettings.format}\r\n                onChange={(e) =>\r\n                  setExportSettings((prev) => ({\r\n                    ...prev,\r\n                    format: e.target.value,\r\n                  }))\r\n                }\r\n                className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                disabled={isExporting}\r\n              >\r\n                {formatOptions.map((format) => (\r\n                  <option key={format.value} value={format.value}>\r\n                    {format.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-gray-50 rounded-xl p-4\">\r\n            <h4 className=\"font-medium text-gray-800 mb-3\">\r\n              Информация об экспорте\r\n            </h4>\r\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n              <div>\r\n                <span className=\"text-gray-600\">Длительность:</span>\r\n                <span className=\"ml-2 font-medium\">\r\n                  {Math.round(videoDuration)}с\r\n                </span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600\">Размер файла:</span>\r\n                <span className=\"ml-2 font-medium\">{getFileSize()}</span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600\">Битрейт:</span>\r\n                <span className=\"ml-2 font-medium\">\r\n                  {exportSettings.bitrate} kbps\r\n                </span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600\">Время экспорта:</span>\r\n                <span className=\"ml-2 font-medium\">~{estimatedTime}с</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-gray-50 rounded-xl p-4\">\r\n            <h4 className=\"font-medium text-gray-800 mb-3\">\r\n              Элементы для экспорта\r\n            </h4>\r\n            <div className=\"space-y-2 max-h-32 overflow-y-auto\">\r\n              {timelineItems.map((item) => (\r\n                <div\r\n                  key={item.id}\r\n                  className=\"flex items-center justify-between text-sm\"\r\n                >\r\n                  <span className=\"text-gray-700\">{item.name}</span>\r\n                  <span\r\n                    className={`px-2 py-1 rounded text-xs ${\r\n                      item.trackType === \"main\"\r\n                        ? \"bg-blue-100 text-blue-700\"\r\n                        : item.trackType === \"audio\"\r\n                        ? \"bg-green-100 text-green-700\"\r\n                        : \"bg-purple-100 text-purple-700\"\r\n                    }`}\r\n                  >\r\n                    {item.trackType}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors\"\r\n            disabled={isExporting}\r\n          >\r\n            Отмена\r\n          </button>\r\n          <button\r\n            onClick={handleExport}\r\n            disabled={isExporting || timelineItems.length === 0}\r\n            className={`px-6 py-3 rounded-xl font-medium transition-all flex items-center ${\r\n              isExporting || timelineItems.length === 0\r\n                ? \"bg-gray-300 text-gray-500 cursor-not-allowed\"\r\n                : \"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg\"\r\n            }`}\r\n          >\r\n            {isExporting ? (\r\n              <>\r\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                Экспорт...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Download size={16} className=\"mr-2\" />\r\n                Экспортировать\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nclass VideoExporter {\r\n  constructor({ timelineItems, tracks, videoDuration, settings }) {\r\n    this.timelineItems = timelineItems;\r\n    this.tracks = tracks;\r\n    this.videoDuration = videoDuration;\r\n    this.settings = settings;\r\n\r\n    this.canvas = document.createElement(\"canvas\");\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n\r\n    const [width, height] = settings.resolution.split(\"x\").map(Number);\r\n    this.canvas.width = width;\r\n    this.canvas.height = height;\r\n  }\r\n\r\n  async render() {\r\n    const mediaRecorder = await this.setupMediaRecorder();\r\n    const chunks = [];\r\n\r\n    mediaRecorder.ondataavailable = (event) => {\r\n      if (event.data.size > 0) {\r\n        chunks.push(event.data);\r\n      }\r\n    };\r\n\r\n    return new Promise((resolve, reject) => {\r\n      mediaRecorder.onstop = () => {\r\n        const blob = new Blob(chunks, {\r\n          type: `video/${this.settings.format}`,\r\n        });\r\n        resolve(blob);\r\n      };\r\n\r\n      mediaRecorder.onerror = reject;\r\n\r\n      mediaRecorder.start();\r\n\r\n      this.renderFrames()\r\n        .then(() => {\r\n          mediaRecorder.stop();\r\n        })\r\n        .catch(reject);\r\n    });\r\n  }\r\n\r\n  async setupMediaRecorder() {\r\n    const stream = this.canvas.captureStream(this.settings.fps);\r\n\r\n    const audioTracks = this.timelineItems.filter(\r\n      (item) => item.trackType === \"audio\" && item.audioElement\r\n    );\r\n\r\n    if (audioTracks.length > 0) {\r\n      const audioContext = new AudioContext();\r\n      const destination = audioContext.createMediaStreamDestination();\r\n\r\n      for (const audioTrack of audioTracks) {\r\n        const source = audioContext.createMediaElementSource(\r\n          audioTrack.audioElement\r\n        );\r\n        source.connect(destination);\r\n      }\r\n\r\n      const audioStream = destination.stream;\r\n      audioStream.getAudioTracks().forEach((track) => {\r\n        stream.addTrack(track);\r\n      });\r\n    }\r\n\r\n    const options = {\r\n      mimeType: this.getMimeType(),\r\n      videoBitsPerSecond: this.settings.bitrate * 1000,\r\n    };\r\n\r\n    return new MediaRecorder(stream, options);\r\n  }\r\n\r\n  getMimeType() {\r\n    switch (this.settings.format) {\r\n      case \"webm\":\r\n        return \"video/webm;codecs=vp9\";\r\n      case \"mov\":\r\n        return \"video/mp4;codecs=h264\";\r\n      default:\r\n        return \"video/mp4;codecs=h264\";\r\n    }\r\n  }\r\n\r\n  async renderFrames() {\r\n    const frameCount = Math.ceil(this.videoDuration * this.settings.fps);\r\n    const frameDuration = 1 / this.settings.fps;\r\n\r\n    for (let frame = 0; frame < frameCount; frame++) {\r\n      const currentTime = frame * frameDuration;\r\n      await this.renderFrame(currentTime);\r\n\r\n      await new Promise((resolve) => requestAnimationFrame(resolve));\r\n    }\r\n  }\r\n\r\n  async renderFrame(currentTime) {\r\n    this.ctx.fillStyle = \"#000000\";\r\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n    const sortedItems = [...this.timelineItems].sort((a, b) => {\r\n      const order = { main: 1, audio: 2, overlay: 3 };\r\n      return order[a.trackType] - order[b.trackType];\r\n    });\r\n\r\n    for (const item of sortedItems) {\r\n      if (\r\n        currentTime >= item.startTime &&\r\n        currentTime < item.startTime + item.duration\r\n      ) {\r\n        await this.renderItem(item, currentTime - item.startTime);\r\n      }\r\n    }\r\n  }\r\n\r\n  async renderItem(item, relativeTime) {\r\n    switch (item.type) {\r\n      case \"video\":\r\n        await this.renderVideo(item, relativeTime);\r\n        break;\r\n      case \"image\":\r\n        await this.renderImage(item);\r\n        break;\r\n    }\r\n  }\r\n\r\n  async renderVideo(item, relativeTime) {\r\n    if (!item.videoElement) return;\r\n\r\n    item.videoElement.currentTime = relativeTime;\r\n\r\n    await new Promise((resolve) => {\r\n      const checkReady = () => {\r\n        if (item.videoElement.readyState >= 2) {\r\n          resolve();\r\n        } else {\r\n          requestAnimationFrame(checkReady);\r\n        }\r\n      };\r\n      checkReady();\r\n    });\r\n\r\n    // Рендерим видео на canvas\r\n    this.ctx.drawImage(\r\n      item.videoElement,\r\n      0,\r\n      0,\r\n      this.canvas.width,\r\n      this.canvas.height\r\n    );\r\n  }\r\n\r\n  async renderImage(item) {\r\n    if (!item.imageElement) return;\r\n\r\n    // Рендерим изображение на canvas\r\n    this.ctx.drawImage(\r\n      item.imageElement,\r\n      0,\r\n      0,\r\n      this.canvas.width,\r\n      this.canvas.height\r\n    );\r\n  }\r\n}\r\n\r\n// Хук для использования экспорта\r\nexport const useVideoExporter = () => {\r\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\r\n\r\n  const openExportModal = () => setIsExportModalOpen(true);\r\n  const closeExportModal = () => setIsExportModalOpen(false);\r\n\r\n  return {\r\n    isExportModalOpen,\r\n    openExportModal,\r\n    closeExportModal,\r\n    VideoExportModal,\r\n  };\r\n};\r\n\r\n// Пример использования в основном компоненте\r\nexport const VideoEditorWithExport = ({\r\n  timelineItems,\r\n  tracks,\r\n  videoDuration,\r\n}) => {\r\n  const {\r\n    isExportModalOpen,\r\n    openExportModal,\r\n    closeExportModal,\r\n    VideoExportModal,\r\n  } = useVideoExporter();\r\n\r\n  return (\r\n    <>\r\n      {/* Ваш основной интерфейс */}\r\n      <button\r\n        onClick={openExportModal}\r\n        className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center\"\r\n      >\r\n        <Download size={16} className=\"mr-2\" />\r\n        Экспорт видео\r\n      </button>\r\n\r\n      {/* Модальное окно экспорта */}\r\n      <VideoExportModal\r\n        isOpen={isExportModalOpen}\r\n        onClose={closeExportModal}\r\n        timelineItems={timelineItems}\r\n        tracks={tracks}\r\n        videoDuration={videoDuration}\r\n      />\r\n    </>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}