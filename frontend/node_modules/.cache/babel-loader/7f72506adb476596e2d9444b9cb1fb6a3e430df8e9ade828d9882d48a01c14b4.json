{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\VideoEditor\\\\VideoEditor.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Upload, Play, Pause, Volume2, Video, Music, SkipBack, SkipForward, VolumeX, Copy, Trash2, Scissors, Image, Film, Plus, Layers, ZoomIn, ZoomOut, RotateCcw } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoEditor = () => {\n  _s();\n  const [mediaLibrary, setMediaLibrary] = useState({\n    videos: [],\n    audios: [],\n    images: []\n  });\n  const [timelineItems, setTimelineItems] = useState([]);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [videoDuration, setVideoDuration] = useState(60);\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\n  const [timelineZoom, setTimelineZoom] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"videos\");\n  const [volume, setVolume] = useState(1);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\n  const [draggedItem, setDraggedItem] = useState(null);\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\n  const [dropPreview, setDropPreview] = useState(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState(0);\n  const [copiedItem, setCopiedItem] = useState(null);\n\n  // Новые состояния для resize\n  const [isResizing, setIsResizing] = useState(false);\n  const [resizeHandle, setResizeHandle] = useState(null); // 'left' | 'right'\n  const [resizeItem, setResizeItem] = useState(null);\n  const [originalItemData, setOriginalItemData] = useState(null);\n\n  // Треки как в CapCut\n  const [tracks, setTracks] = useState({\n    overlays: [{\n      id: 'overlay-1',\n      name: 'Overlay 1',\n      type: 'overlay'\n    }, {\n      id: 'overlay-2',\n      name: 'Overlay 2',\n      type: 'overlay'\n    }],\n    main: [{\n      id: 'main-video',\n      name: 'Main Video',\n      type: 'main'\n    }],\n    audio: [{\n      id: 'audio-1',\n      name: 'Audio 1',\n      type: 'audio'\n    }, {\n      id: 'audio-2',\n      name: 'Audio 2',\n      type: 'audio'\n    }]\n  });\n  const timelineRef = useRef(null);\n  const timelineScrollRef = useRef(null);\n  const trackLabelsRef = useRef(null);\n  const intervalRef = useRef(null);\n  const audioElementsRef = useRef(new Map());\n  const fileInputRef = useRef(null);\n  const audioInputRef = useRef(null);\n  const imageInputRef = useRef(null);\n  const videoRef = useRef(null);\n  const autoScrollIntervalRef = useRef(null);\n\n  // Базовые функции\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    const ms = Math.floor(seconds % 1 * 100);\n    return timelineZoom > 5 ? `${mins}:${secs.toString().padStart(2, \"0\")}.${ms.toString().padStart(2, \"0\")}` : `${mins}:${secs.toString().padStart(2, \"0\")}`;\n  };\n  const handlePlayPause = () => {\n    setIsPlaying(!isPlaying);\n  };\n  const seekTo = time => {\n    const newTime = Math.max(0, Math.min(videoDuration, time));\n    setCurrentTime(newTime);\n    const content = getCurrentTimelineContent();\n    content.audio.forEach(audioItem => {\n      const audioElement = audioElementsRef.current.get(audioItem.id);\n      if (audioElement) {\n        const relativeTime = newTime - audioItem.startTime;\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    });\n  };\n  const getCurrentTimelineContent = useCallback(() => {\n    const currentItems = timelineItems.filter(item => currentTime >= item.startTime && currentTime < item.startTime + item.duration);\n    return {\n      mainVideo: currentItems.find(item => item.trackType === 'main' && item.type === 'video'),\n      overlays: currentItems.filter(item => item.trackType === 'overlay'),\n      audio: currentItems.filter(item => item.trackType === 'audio')\n    };\n  }, [currentTime, timelineItems]);\n  const createAudioElement = useCallback(audioItem => {\n    if (!audioElementsRef.current.has(audioItem.id)) {\n      const audio = document.createElement('audio');\n      audio.src = audioItem.url;\n      audio.volume = (audioItem.volume || 1) * volume;\n      audio.muted = isMuted;\n      audio.preload = \"metadata\";\n      audioElementsRef.current.set(audioItem.id, audio);\n    }\n    return audioElementsRef.current.get(audioItem.id);\n  }, [volume, isMuted]);\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\n    const audioElement = audioElementsRef.current.get(audioItem.id);\n    if (audioElement) {\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\n      if (timeDiff > 0.2) {\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    }\n  }, []);\n  const checkCollision = useCallback((newItem, excludeId = null) => {\n    return timelineItems.some(item => {\n      if (item.id === excludeId) return false;\n      if (item.trackId !== newItem.trackId) return false;\n      const itemStart = item.startTime;\n      const itemEnd = item.startTime + item.duration;\n      const newStart = newItem.startTime;\n      const newEnd = newItem.startTime + newItem.duration;\n      return newStart < itemEnd && newEnd > itemStart;\n    });\n  }, [timelineItems]);\n\n  // Функция для вставки с автоматическим сдвигом блоков (как в CapCut)\n  const insertWithRipple = useCallback((trackId, insertTime, duration, excludeId = null) => {\n    const trackItems = timelineItems.filter(item => item.trackId === trackId && item.id !== excludeId).sort((a, b) => a.startTime - b.startTime);\n\n    // Если трек пустой\n    if (trackItems.length === 0) {\n      return {\n        time: Math.max(0, insertTime),\n        shouldRipple: false,\n        affectedItems: []\n      };\n    }\n\n    // Ищем где вставить\n    let insertPosition = insertTime;\n    let shouldRipple = false;\n    let affectedItems = [];\n\n    // Проверяем есть ли точно в этом месте блок\n    const blockAtPosition = trackItems.find(item => insertTime >= item.startTime && insertTime < item.startTime + item.duration);\n    if (blockAtPosition) {\n      // Вставляем в начало этого блока и сдвигаем все что справа\n      insertPosition = blockAtPosition.startTime;\n      shouldRipple = true;\n      affectedItems = trackItems.filter(item => item.startTime >= insertPosition);\n    } else {\n      // Ищем блоки которые нужно сдвинуть\n      const blocksToShift = trackItems.filter(item => item.startTime >= insertTime);\n      if (blocksToShift.length > 0) {\n        // Проверяем, есть ли место без сдвига\n        const nextBlock = blocksToShift[0];\n        const availableSpace = nextBlock.startTime - insertTime;\n        if (availableSpace >= duration) {\n          // Помещается без сдвига\n          insertPosition = insertTime;\n          shouldRipple = false;\n        } else {\n          // Нужно сдвинуть\n          insertPosition = insertTime;\n          shouldRipple = true;\n          affectedItems = blocksToShift;\n        }\n      } else {\n        // Вставляем в конец\n        insertPosition = insertTime;\n        shouldRipple = false;\n      }\n    }\n    return {\n      time: Math.max(0, insertPosition),\n      shouldRipple,\n      affectedItems,\n      shiftAmount: shouldRipple ? duration : 0\n    };\n  }, [timelineItems]);\n\n  // Функция для поиска ближайшего свободного места (обратная совместимость)\n  const findNearestValidPosition = useCallback((trackId, dropTime, duration, excludeId = null) => {\n    const result = insertWithRipple(trackId, dropTime, duration, excludeId);\n    return {\n      time: result.time,\n      isExact: !result.shouldRipple\n    };\n  }, [insertWithRipple]);\n\n  // Функция для применения ripple effect\n  const applyRippleEffect = useCallback((affectedItems, shiftAmount) => {\n    if (!affectedItems.length || shiftAmount <= 0) return;\n    console.log('Applying ripple effect:', {\n      affectedCount: affectedItems.length,\n      shiftAmount,\n      affectedItems: affectedItems.map(item => ({\n        name: item.name,\n        oldStart: item.startTime\n      }))\n    });\n    setTimelineItems(prev => prev.map(item => {\n      const affectedItem = affectedItems.find(affected => affected.id === item.id);\n      if (affectedItem) {\n        console.log(`Shifting ${item.name} from ${item.startTime} to ${item.startTime + shiftAmount}`);\n        return {\n          ...item,\n          startTime: item.startTime + shiftAmount\n        };\n      }\n      return item;\n    }));\n\n    // Обновляем общую длительность если нужно\n    if (affectedItems.length > 0) {\n      const maxEndTime = Math.max(...affectedItems.map(item => item.startTime + item.duration + shiftAmount));\n      if (maxEndTime > videoDuration) {\n        setVideoDuration(maxEndTime + 10);\n      }\n    }\n  }, [videoDuration]);\n  const findNextAvailablePosition = useCallback((trackId, duration, preferredStart = 0) => {\n    const trackItems = timelineItems.filter(item => item.trackId === trackId).sort((a, b) => a.startTime - b.startTime);\n    if (preferredStart >= 0) {\n      const testItem = {\n        trackId,\n        startTime: preferredStart,\n        duration\n      };\n      if (!checkCollision(testItem)) {\n        return preferredStart;\n      }\n    }\n    for (let i = 0; i < trackItems.length; i++) {\n      const currentItem = trackItems[i];\n      const nextItem = trackItems[i + 1];\n      if (i === 0 && currentItem.startTime >= duration) {\n        return 0;\n      }\n      if (nextItem) {\n        const gapStart = currentItem.startTime + currentItem.duration;\n        const gapEnd = nextItem.startTime;\n        const gapSize = gapEnd - gapStart;\n        if (gapSize >= duration) {\n          return gapStart;\n        }\n      }\n    }\n    if (trackItems.length === 0) return 0;\n    const lastItem = trackItems[trackItems.length - 1];\n    return lastItem.startTime + lastItem.duration;\n  }, [timelineItems, checkCollision]);\n  const removeFromTimeline = itemId => {\n    const audioElement = audioElementsRef.current.get(itemId);\n    if (audioElement) {\n      audioElement.pause();\n      audioElement.src = '';\n      audioElementsRef.current.delete(itemId);\n    }\n    setTimelineItems(prev => prev.filter(item => item.id !== itemId));\n    setSelectedTimelineItem(null);\n  };\n\n  // Функции для работы с элементами таймлайна\n  const splitTimelineItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    const item = selectedTimelineItem;\n    const splitTime = currentTime;\n    if (splitTime <= item.startTime || splitTime >= item.startTime + item.duration) {\n      return;\n    }\n    const firstPartDuration = splitTime - item.startTime;\n    const secondPartStart = splitTime;\n    const secondPartDuration = item.duration - firstPartDuration;\n    const secondPart = {\n      ...item,\n      id: Date.now() + Math.random(),\n      startTime: secondPartStart,\n      duration: secondPartDuration\n    };\n    const updatedFirstPart = {\n      ...item,\n      duration: firstPartDuration\n    };\n    setTimelineItems(prev => prev.map(timelineItem => timelineItem.id === item.id ? updatedFirstPart : timelineItem).concat(secondPart));\n    setSelectedTimelineItem(null);\n  }, [selectedTimelineItem, currentTime]);\n  const copyTimelineItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    setCopiedItem(selectedTimelineItem);\n  }, [selectedTimelineItem]);\n  const pasteTimelineItem = useCallback(() => {\n    var _insertResult$affecte;\n    if (!copiedItem) return;\n    const targetTrackId = copiedItem.trackId;\n    const insertResult = insertWithRipple(targetTrackId, currentTime, copiedItem.duration);\n\n    // Применяем ripple effect если нужно\n    if (insertResult.shouldRipple && ((_insertResult$affecte = insertResult.affectedItems) === null || _insertResult$affecte === void 0 ? void 0 : _insertResult$affecte.length) > 0) {\n      applyRippleEffect(insertResult.affectedItems, copiedItem.duration);\n    }\n    const newItem = {\n      ...copiedItem,\n      id: Date.now() + Math.random(),\n      startTime: insertResult.time\n    };\n    setTimelineItems(prev => [...prev, newItem]);\n    const newEndTime = newItem.startTime + newItem.duration;\n    if (newEndTime > videoDuration) {\n      setVideoDuration(newEndTime + 10);\n    }\n    setSelectedTimelineItem(newItem);\n  }, [copiedItem, currentTime, insertWithRipple, applyRippleEffect, videoDuration]);\n  const deleteSelectedItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    removeFromTimeline(selectedTimelineItem.id);\n  }, [selectedTimelineItem]);\n\n  // Автопрокрутка и зум\n  const stopAutoScroll = useCallback(() => {\n    if (autoScrollIntervalRef.current) {\n      clearInterval(autoScrollIntervalRef.current);\n      autoScrollIntervalRef.current = null;\n    }\n  }, []);\n  const startAutoScroll = useCallback((direction, speed = 1) => {\n    stopAutoScroll();\n    autoScrollIntervalRef.current = setInterval(() => {\n      if (timelineScrollRef.current) {\n        const scrollAmount = 15 * speed;\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n        if (direction === 'left' && currentScrollLeft > 0) {\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\n        } else if (direction === 'right' && currentScrollLeft < maxScroll) {\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\n        }\n      }\n    }, 16); // 60fps для плавности\n  }, [stopAutoScroll]);\n  const checkAutoScroll = useCallback(clientX => {\n    if (!timelineScrollRef.current) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const scrollZoneWidth = 120;\n    const relativeX = clientX - rect.left;\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\n      startAutoScroll('left', speed);\n    } else if (relativeX > rect.width - scrollZoneWidth) {\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\n        startAutoScroll('right', speed);\n      }\n    } else {\n      stopAutoScroll();\n    }\n  }, [startAutoScroll, stopAutoScroll]);\n\n  // Функции зума\n  const zoomIn = () => {\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\n  };\n  const zoomOut = () => {\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\n  };\n  const resetZoom = () => {\n    setTimelineZoom(1);\n  };\n\n  // Функции для resize\n  const handleResizeStart = useCallback((e, item, handle) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsResizing(true);\n    setResizeHandle(handle);\n    setResizeItem(item);\n    setOriginalItemData({\n      startTime: item.startTime,\n      duration: item.duration\n    });\n\n    // Предотвращаем drag\n    setIsTimelineDragging(false);\n    setDraggedTimelineItem(null);\n  }, []);\n  const handleResizeEnd = useCallback(() => {\n    setIsResizing(false);\n    setResizeHandle(null);\n    setResizeItem(null);\n    setOriginalItemData(null);\n    stopAutoScroll();\n  }, [stopAutoScroll]);\n\n  // Синхронизация скролла\n  const handleTrackAreaScroll = e => {\n    if (trackLabelsRef.current) {\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const handleTrackLabelsScroll = e => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const getTimelineWidth = () => {\n    const baseWidth = videoDuration * 50 * timelineZoom;\n    return Math.max(baseWidth, 2000);\n  };\n  const getPixelsPerSecond = () => {\n    return 50 * timelineZoom;\n  };\n\n  // Обработка resize во время движения мыши\n  useEffect(() => {\n    const handleMouseMove = e => {\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\n      checkAutoScroll(e.clientX);\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const pixelsPerSecond = getPixelsPerSecond();\n      const newTime = mouseX / pixelsPerSecond;\n      setTimelineItems(prev => prev.map(item => {\n        if (item.id !== resizeItem.id) return item;\n        const minDuration = 0.1;\n        if (resizeHandle === 'left') {\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\n          const newDuration = rightEdge - newStartTime;\n          return {\n            ...item,\n            startTime: newStartTime,\n            duration: newDuration\n          };\n        } else if (resizeHandle === 'right') {\n          const leftEdge = originalItemData.startTime;\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\n          const newDuration = newEndTime - leftEdge;\n          return {\n            ...item,\n            duration: newDuration\n          };\n        }\n        return item;\n      }));\n    };\n    const handleMouseUp = () => {\n      if (isResizing) {\n        handleResizeEnd();\n      }\n    };\n    if (isResizing) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd]);\n\n  // Основные эффекты\n  useEffect(() => {\n    const content = getCurrentTimelineContent();\n    if (content.mainVideo && content.mainVideo.url !== currentVideoSource) {\n      setCurrentVideoSource(content.mainVideo.url);\n      if (videoRef.current) {\n        const relativeTime = currentTime - content.mainVideo.startTime;\n        videoRef.current.currentTime = Math.max(0, relativeTime);\n      }\n    } else if (!content.mainVideo && content.overlays.find(o => o.type === 'image')) {\n      const firstImage = content.overlays.find(o => o.type === 'image');\n      setCurrentVideoSource(firstImage.url);\n    } else if (!content.mainVideo && !content.overlays.find(o => o.type === 'image')) {\n      setCurrentVideoSource(null);\n    }\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n    content.audio.forEach(audioItem => {\n      const audioElement = createAudioElement(audioItem);\n      const relativeTime = currentTime - audioItem.startTime;\n      audioElement.volume = (audioItem.volume || 1) * volume;\n      audioElement.muted = isMuted;\n      if (isPlaying && relativeTime >= 0) {\n        syncAudioTime(audioItem, relativeTime);\n        if (audioElement.paused) {\n          audioElement.play().catch(console.error);\n        }\n      } else {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource]);\n  useEffect(() => {\n    if (isPlaying) {\n      intervalRef.current = setInterval(() => {\n        setCurrentTime(prev => {\n          const newTime = prev + 0.1;\n          if (newTime >= videoDuration) {\n            setIsPlaying(false);\n            return videoDuration;\n          }\n          return newTime;\n        });\n      }, 100);\n    } else {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    }\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [isPlaying, videoDuration]);\n  useEffect(() => {\n    if (videoRef.current && currentVideoSource) {\n      const content = getCurrentTimelineContent();\n      if (content.mainVideo) {\n        const relativeTime = currentTime - content.mainVideo.startTime;\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\n        if (timeDiff > 0.5) {\n          videoRef.current.currentTime = Math.max(0, relativeTime);\n        }\n        if (isPlaying && videoRef.current.paused) {\n          videoRef.current.play().catch(console.error);\n        } else if (!isPlaying && !videoRef.current.paused) {\n          videoRef.current.pause();\n        }\n      }\n    }\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\n  useEffect(() => {\n    const currentAudioIds = new Set(timelineItems.filter(item => item.type === \"audio\").map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        audioElement.pause();\n        audioElement.src = '';\n        audioElementsRef.current.delete(id);\n      }\n    });\n  }, [timelineItems]);\n\n  // Очистка при размонтировании\n  useEffect(() => {\n    return () => {\n      stopAutoScroll();\n    };\n  }, [stopAutoScroll]);\n\n  // Обработка клавиатурных шорткатов\n  useEffect(() => {\n    const handleKeyDown = e => {\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {\n        return;\n      }\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        e.preventDefault();\n        deleteSelectedItem();\n      }\n      if (e.ctrlKey && e.key === 'b') {\n        e.preventDefault();\n        splitTimelineItem();\n      }\n      if (e.ctrlKey && e.key === 'c') {\n        e.preventDefault();\n        copyTimelineItem();\n      }\n      if (e.ctrlKey && e.key === 'v') {\n        e.preventDefault();\n        pasteTimelineItem();\n      }\n      if (e.key === ' ' || e.code === 'Space') {\n        e.preventDefault();\n        setIsPlaying(prev => !prev);\n      }\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\n        seekTo(Math.max(0, currentTime - step));\n      }\n      if (e.key === 'ArrowRight') {\n        e.preventDefault();\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\n        seekTo(Math.min(videoDuration, currentTime + step));\n      }\n      if (e.key === '=' || e.key === '+') {\n        e.preventDefault();\n        zoomIn();\n      }\n      if (e.key === '-') {\n        e.preventDefault();\n        zoomOut();\n      }\n      if (e.key === '0') {\n        e.preventDefault();\n        resetZoom();\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [selectedTimelineItem, copiedItem, currentTime, videoDuration, deleteSelectedItem, splitTimelineItem, copyTimelineItem, pasteTimelineItem]);\n\n  // Обработка колесика мыши для зума\n  useEffect(() => {\n    const handleWheel = e => {\n      var _timelineRef$current;\n      if (e.ctrlKey && (_timelineRef$current = timelineRef.current) !== null && _timelineRef$current !== void 0 && _timelineRef$current.contains(e.target)) {\n        e.preventDefault();\n        if (e.deltaY < 0) {\n          zoomIn();\n        } else {\n          zoomOut();\n        }\n      }\n    };\n    document.addEventListener('wheel', handleWheel, {\n      passive: false\n    });\n    return () => document.removeEventListener('wheel', handleWheel);\n  }, []);\n  const handleVideoUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newVideo = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        duration: 10,\n        type: \"video\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        videos: [...prev.videos, newVideo]\n      }));\n    });\n  };\n  const handleAudioUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newAudio = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        duration: 10,\n        type: \"audio\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        audios: [...prev.audios, newAudio]\n      }));\n    });\n  };\n  const handleImageUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newImage = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        type: \"image\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        images: [...prev.images, newImage]\n      }));\n    });\n  };\n  const addToTimeline = (mediaItem, startTime = null, targetTrackId = null) => {\n    let trackType, trackId;\n    if (mediaItem.type === \"video\") {\n      trackType = targetTrackId && targetTrackId.startsWith('overlay') ? 'overlay' : 'main';\n      trackId = targetTrackId || 'main-video';\n    } else if (mediaItem.type === \"image\") {\n      trackType = 'overlay';\n      trackId = targetTrackId || 'overlay-1';\n    } else if (mediaItem.type === \"audio\") {\n      trackType = 'audio';\n      trackId = targetTrackId || 'audio-1';\n    }\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\n    const finalStartTime = startTime !== null ? startTime : findNextAvailablePosition(trackId, duration);\n    const newTimelineItem = {\n      id: Date.now() + Math.random(),\n      mediaId: mediaItem.id,\n      type: mediaItem.type,\n      name: mediaItem.name,\n      url: mediaItem.url,\n      startTime: finalStartTime,\n      duration: duration,\n      trackId: trackId,\n      trackType: trackType,\n      volume: 1,\n      opacity: 1\n    };\n    setTimelineItems(prev => [...prev, newTimelineItem]);\n    const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\n    if (newEndTime > videoDuration) {\n      setVideoDuration(newEndTime + 10);\n    }\n  };\n  const addOverlayTrack = () => {\n    const newTrackId = `overlay-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      overlays: [...prev.overlays, {\n        id: newTrackId,\n        name: `Overlay ${prev.overlays.length + 1}`,\n        type: 'overlay'\n      }]\n    }));\n  };\n  const addAudioTrack = () => {\n    const newTrackId = `audio-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      audio: [...prev.audio, {\n        id: newTrackId,\n        name: `Audio ${prev.audio.length + 1}`,\n        type: 'audio'\n      }]\n    }));\n  };\n  const removeFromLibrary = (itemId, type) => {\n    setMediaLibrary(prev => ({\n      ...prev,\n      [type]: prev[type].filter(item => item.id !== itemId)\n    }));\n  };\n  const handleTimelineClick = e => {\n    if (isDragging || isTimelineDragging || isResizing) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    seekTo(clickTime);\n  };\n  const handleDragStart = (e, mediaItem) => {\n    setDraggedItem(mediaItem);\n    setIsDragging(true);\n    e.dataTransfer.effectAllowed = \"copy\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleDragEnd = () => {\n    setDraggedItem(null);\n    setDropPreview(null);\n    setIsDragging(false);\n  };\n  const handleTimelineItemDragStart = (e, timelineItem) => {\n    if (isResizing) {\n      e.preventDefault();\n      return;\n    }\n    e.stopPropagation();\n    setDraggedTimelineItem(timelineItem);\n    setIsTimelineDragging(true);\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const itemRect = e.target.getBoundingClientRect();\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleTimelineItemDragEnd = () => {\n    setDraggedTimelineItem(null);\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n    setDragOffset(0);\n    stopAutoScroll();\n  };\n  const handleDragOver = e => {\n    if (!draggedItem && !draggedTimelineItem) return;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\n    if (draggedTimelineItem || isResizing) {\n      checkAutoScroll(e.clientX);\n    }\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\n    const pixelsPerSecond = getPixelsPerSecond();\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\n    const trackHeight = 60;\n    const timeRulerHeight = 48;\n    const relativeY = dragY - timeRulerHeight;\n    const trackIndex = Math.floor(relativeY / trackHeight);\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const targetTrack = allTracks[trackIndex];\n    if (draggedItem && targetTrack) {\n      // Новый элемент из библиотеки\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\n      setDropPreview({\n        time: insertResult.time,\n        duration: duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    } else if (draggedTimelineItem && targetTrack) {\n      // Существующий элемент\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, draggedTimelineItem.duration, draggedTimelineItem.id);\n      setDropPreview({\n        time: insertResult.time,\n        duration: draggedTimelineItem.duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    }\n  };\n  const handleDrop = e => {\n    var _dropPreview$affected;\n    if (!draggedItem && !draggedTimelineItem || !dropPreview) return;\n    e.preventDefault();\n    stopAutoScroll();\n    console.log('Dropping with ripple:', {\n      dropPreview,\n      shouldRipple: dropPreview.shouldRipple,\n      affectedItems: ((_dropPreview$affected = dropPreview.affectedItems) === null || _dropPreview$affected === void 0 ? void 0 : _dropPreview$affected.length) || 0\n    });\n    if (dropPreview.isValid) {\n      if (draggedItem) {\n        var _dropPreview$affected2;\n        // Новый элемент из библиотеки\n        if (dropPreview.shouldRipple && ((_dropPreview$affected2 = dropPreview.affectedItems) === null || _dropPreview$affected2 === void 0 ? void 0 : _dropPreview$affected2.length) > 0) {\n          // Сначала сдвигаем существующие блоки\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\n        }\n\n        // Добавляем новый элемент\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\n        console.log('Added with ripple effect:', dropPreview.shouldRipple);\n      } else if (draggedTimelineItem) {\n        var _dropPreview$affected3;\n        // Перемещение существующего элемента\n        if (dropPreview.shouldRipple && ((_dropPreview$affected3 = dropPreview.affectedItems) === null || _dropPreview$affected3 === void 0 ? void 0 : _dropPreview$affected3.length) > 0) {\n          // Сначала сдвигаем блоки, которые нужно освободить место\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\n        }\n\n        // Перемещаем элемент\n        setTimelineItems(prev => prev.map(item => item.id === draggedTimelineItem.id ? {\n          ...item,\n          startTime: dropPreview.time,\n          trackId: dropPreview.trackId,\n          trackType: dropPreview.trackType\n        } : item));\n        console.log('Moved with ripple effect:', dropPreview.shouldRipple);\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\n        if (newEndTime > videoDuration) {\n          setVideoDuration(newEndTime + 10);\n        }\n      }\n    }\n    setDropPreview(null);\n    setDraggedItem(null);\n    setDraggedTimelineItem(null);\n    setIsDragging(false);\n    setIsTimelineDragging(false);\n  };\n  const handleDragLeave = e => {\n    var _timelineRef$current2;\n    if (!((_timelineRef$current2 = timelineRef.current) !== null && _timelineRef$current2 !== void 0 && _timelineRef$current2.contains(e.relatedTarget))) {\n      setDropPreview(null);\n      stopAutoScroll();\n    }\n  };\n  const getTimelineItemStyle = item => {\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${item.startTime * pixelsPerSecond}px`,\n      width: `${item.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getDropPreviewStyle = () => {\n    if (!dropPreview) return {};\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${dropPreview.time * pixelsPerSecond}px`,\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getTrackColor = trackType => {\n    switch (trackType) {\n      case 'overlay':\n        return 'bg-purple-500 border-purple-400';\n      case 'main':\n        return 'bg-blue-500 border-blue-400';\n      case 'audio':\n        return 'bg-green-500 border-green-400';\n      default:\n        return 'bg-gray-500 border-gray-400';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex h-screen w-full gap-4 p-4 bg-gray-100 overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-80 min-w-72 max-w-80 bg-white border-2 border-blue-200 flex flex-col rounded-2xl shadow-lg overflow-hidden flex-shrink-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 px-4 py-3 border-b border-blue-100\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-bold text-blue-800 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(Upload, {\n            size: 18,\n            className: \"mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1087,\n            columnNumber: 13\n          }, this), \"Media Library\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1086,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1085,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 pb-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex bg-gray-100 rounded-xl p-1\",\n          children: [{\n            id: \"videos\",\n            name: \"Videos\",\n            icon: Video\n          }, {\n            id: \"audios\",\n            name: \"Audio\",\n            icon: Music\n          }, {\n            id: \"images\",\n            name: \"Images\",\n            icon: Image\n          }].map(tab => {\n            const IconComponent = tab.icon;\n            return /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setActiveTab(tab.id),\n              className: `flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${activeTab === tab.id ? \"bg-white text-blue-600 shadow-sm\" : \"text-gray-600 hover:text-gray-800\"}`,\n              children: [/*#__PURE__*/_jsxDEV(IconComponent, {\n                size: 16,\n                className: \"mr-2 inline\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1110,\n                columnNumber: 19\n              }, this), tab.name]\n            }, tab.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1101,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1093,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1092,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            var _fileInputRef$current, _audioInputRef$curren, _imageInputRef$curren;\n            if (activeTab === \"videos\") (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();else if (activeTab === \"audios\") (_audioInputRef$curren = audioInputRef.current) === null || _audioInputRef$curren === void 0 ? void 0 : _audioInputRef$curren.click();else (_imageInputRef$curren = imageInputRef.current) === null || _imageInputRef$curren === void 0 ? void 0 : _imageInputRef$curren.click();\n          },\n          className: \"w-full p-6 border-2 border-dashed border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-200 text-center group\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-100 transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(Upload, {\n              size: 20,\n              className: \"text-gray-500 group-hover:text-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1128,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1127,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium text-gray-700 group-hover:text-blue-600\",\n            children: [\"Upload\", \" \", activeTab === \"videos\" ? \"Video\" : activeTab === \"audios\" ? \"Audio\" : \"Images\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 mt-1\",\n            children: activeTab === \"videos\" ? \"MP4, AVI, MOV up to 2GB\" : activeTab === \"audios\" ? \"MP3, WAV, M4A up to 100MB\" : \"JPG, PNG, GIF up to 10MB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1141,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1119,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        type: \"file\",\n        accept: \"video/*\",\n        multiple: true,\n        onChange: handleVideoUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: audioInputRef,\n        type: \"file\",\n        accept: \"audio/*\",\n        multiple: true,\n        onChange: handleAudioUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: imageInputRef,\n        type: \"file\",\n        accept: \"image/*\",\n        multiple: true,\n        onChange: handleImageUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto px-4 pb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [mediaLibrary[activeTab].map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n            draggable: \"true\",\n            onDragStart: e => handleDragStart(e, item),\n            onDragEnd: handleDragEnd,\n            className: `flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${(draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.id) === item.id ? \"opacity-50\" : \"\"}`,\n            onClick: () => addToTimeline(item),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\",\n              children: [activeTab === \"videos\" && /*#__PURE__*/_jsxDEV(Video, {\n                size: 20,\n                className: \"text-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1191,\n                columnNumber: 21\n              }, this), activeTab === \"audios\" && /*#__PURE__*/_jsxDEV(Music, {\n                size: 20,\n                className: \"text-green-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1194,\n                columnNumber: 21\n              }, this), activeTab === \"images\" && /*#__PURE__*/_jsxDEV(Image, {\n                size: 20,\n                className: \"text-purple-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1197,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1189,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1 min-w-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-gray-900 truncate\",\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1201,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500\",\n                children: activeTab === \"images\" ? \"Image\" : formatTime(item.duration || 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1204,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => {\n                e.stopPropagation();\n                removeFromLibrary(item.id, activeTab);\n              },\n              className: \"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\",\n              children: /*#__PURE__*/_jsxDEV(Trash2, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1217,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1210,\n              columnNumber: 17\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1179,\n            columnNumber: 15\n          }, this)), mediaLibrary[activeTab].length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3\",\n              children: [activeTab === \"videos\" && /*#__PURE__*/_jsxDEV(Video, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1224,\n                columnNumber: 46\n              }, this), activeTab === \"audios\" && /*#__PURE__*/_jsxDEV(Music, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1225,\n                columnNumber: 46\n              }, this), activeTab === \"images\" && /*#__PURE__*/_jsxDEV(Image, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1226,\n                columnNumber: 46\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1223,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: [\"No \", activeTab, \" uploaded yet\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1228,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-400 mt-1\",\n              children: \"Click upload button above\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1229,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1222,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1177,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1176,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1084,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col gap-4 min-w-0 overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm min-h-0\",\n        children: [currentVideoSource ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative w-full h-full\",\n          children: [getCurrentTimelineContent().mainVideo ? /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            src: currentVideoSource,\n            className: \"w-full h-full object-contain rounded-2xl\",\n            muted: isMuted\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1243,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: currentVideoSource,\n            alt: \"Timeline content\",\n            className: \"w-full h-full object-contain rounded-2xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1250,\n            columnNumber: 17\n          }, this), getCurrentTimelineContent().overlays.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-4 right-4 w-32 h-24 border-2 border-white rounded-lg overflow-hidden shadow-lg\",\n            style: {\n              top: `${4 + index * 100}px`,\n              opacity: item.opacity || 1\n            },\n            children: item.type === 'video' ? /*#__PURE__*/_jsxDEV(\"video\", {\n              src: item.url,\n              className: \"w-full h-full object-cover\",\n              muted: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1267,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n              src: item.url,\n              alt: item.name,\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1273,\n              columnNumber: 21\n            }, this)\n          }, item.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1258,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1241,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full h-full flex items-center justify-center text-white\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\",\n              children: /*#__PURE__*/_jsxDEV(Film, {\n                size: 40,\n                className: \"opacity-50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1286,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1285,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl opacity-75 font-medium\",\n              children: \"No content at current time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1288,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm opacity-50\",\n              children: \"Drag media to timeline tracks\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1291,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1284,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1283,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.max(0, currentTime - 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              children: /*#__PURE__*/_jsxDEV(SkipBack, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1304,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1300,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handlePlayPause,\n              className: \"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\",\n              children: isPlaying ? /*#__PURE__*/_jsxDEV(Pause, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1310,\n                columnNumber: 30\n              }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1310,\n                columnNumber: 52\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1306,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.min(videoDuration, currentTime + 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              children: /*#__PURE__*/_jsxDEV(SkipForward, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1318,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1312,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setIsMuted(!isMuted),\n                className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1325,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1325,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1321,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: \"0\",\n                max: \"1\",\n                step: \"0.1\",\n                value: volume,\n                onChange: e => setVolume(parseFloat(e.target.value)),\n                className: \"w-24 accent-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1327,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1320,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-white text-sm font-medium min-w-0\",\n              children: [formatTime(currentTime), \" / \", formatTime(videoDuration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1337,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1299,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1298,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1239,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${isDragging || isTimelineDragging || isResizing ? \"border-blue-400 bg-blue-50/20\" : \"border-gray-200\"}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 p-4 border-b border-gray-200 space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Film, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1355,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Timeline Pro\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1356,\n                columnNumber: 17\n              }, this), isDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-600\",\n                children: [\"- Adding \\\"\", draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.name, \"\\\" \", dropPreview.shouldRipple ? '⚡ ripple' : '📍 exact']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1358,\n                columnNumber: 19\n              }, this), isTimelineDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600\",\n                children: [\"- Moving \\\"\", draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.name, \"\\\" \", dropPreview.shouldRipple ? '⚡ push blocks' : '📍 exact']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1363,\n                columnNumber: 19\n              }, this), isResizing && resizeItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-orange-600\",\n                children: [\"- Trimming \\\"\", resizeItem.name, \"\\\" (\", resizeHandle, \" edge)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1368,\n                columnNumber: 19\n              }, this), copiedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600 text-sm\",\n                children: [\"- \\\"\", copiedItem.name, \"\\\" copied (Ctrl+V to paste)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1373,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1354,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomOut,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom Out (-)\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomOut, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1386,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1381,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-gray-500 min-w-12 text-center\",\n                  children: [(timelineZoom * 100).toFixed(0), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1388,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomIn,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom In (+)\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1396,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1391,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: resetZoom,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Reset Zoom (0)\",\n                  children: /*#__PURE__*/_jsxDEV(RotateCcw, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1403,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1398,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1380,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1379,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1353,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addOverlayTrack,\n                  className: \"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Overlay Track\",\n                  children: /*#__PURE__*/_jsxDEV(Plus, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1417,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1412,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addAudioTrack,\n                  className: \"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Audio Track\",\n                  children: /*#__PURE__*/_jsxDEV(Music, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1424,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1419,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: splitTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Split Selected Item (Ctrl+B)\",\n                  children: /*#__PURE__*/_jsxDEV(Scissors, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1436,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1426,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: copyTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Copy Selected Item (Ctrl+C)\",\n                  children: /*#__PURE__*/_jsxDEV(Copy, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1448,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1438,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: deleteSelectedItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Delete Selected Item (Del)\",\n                  children: /*#__PURE__*/_jsxDEV(Trash2, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1460,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1450,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1411,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-500 bg-gray-50 px-3 py-1 rounded-lg\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"CapCut Pro:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1465,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: \"Drag center: Move\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1466,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: \"Drag edges: Trim\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1467,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: \"Auto ripple: Push blocks\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1468,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: \"Ctrl+Wheel: Zoom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1469,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1464,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1410,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1409,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1352,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 flex min-h-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-12 border-b border-gray-200 flex-shrink-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1477,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: trackLabelsRef,\n              className: \"flex-1 overflow-y-auto overflow-x-hidden\",\n              onScroll: handleTrackLabelsScroll,\n              children: [tracks.overlays.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Layers, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1490,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1485,\n                columnNumber: 19\n              }, this)), tracks.main.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Video, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1501,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1496,\n                columnNumber: 19\n              }, this)), tracks.audio.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Music, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1512,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1507,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1479,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1476,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: el => {\n              timelineRef.current = el;\n              timelineScrollRef.current = el;\n            },\n            className: \"flex-1 relative overflow-auto bg-white\",\n            onScroll: handleTrackAreaScroll,\n            onDragOver: handleDragOver,\n            onDrop: handleDrop,\n            onDragLeave: handleDragLeave,\n            style: {\n              overflowX: 'auto',\n              overflowY: 'auto',\n              scrollbarWidth: 'thin'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${getTimelineWidth()}px`,\n                minHeight: '100%',\n                position: 'relative'\n              },\n              onClick: handleTimelineClick,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\",\n                children: [Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom / 5) + 1\n                }, (_, i) => {\n                  const timeValue = i * 5 / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-0 h-full border-l border-gray-300\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\",\n                      children: formatTime(timeValue)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1553,\n                      columnNumber: 25\n                    }, this)\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1548,\n                    columnNumber: 23\n                  }, this);\n                }), timelineZoom > 2 && Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom) + 1\n                }, (_, i) => {\n                  const timeValue = i / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-8 w-0 h-4 border-l border-gray-200\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    }\n                  }, `sub-${i}`, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1564,\n                    columnNumber: 23\n                  }, this);\n                }), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\",\n                  style: {\n                    left: `${currentTime * getPixelsPerSecond()}px`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1572,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1543,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative flex-1\",\n                style: {\n                  height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\n                  minHeight: '100%'\n                },\n                children: [timelineItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(item.trackType)} ${(selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === item.id ? \"ring-2 ring-blue-300\" : \"\"} ${(draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.id) === item.id ? \"opacity-50 z-30\" : \"\"} ${(copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"}`,\n                  style: getTimelineItemStyle(item),\n                  onClick: e => {\n                    e.stopPropagation();\n                    setSelectedTimelineItem(item);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, 'left'),\n                    title: \"Resize left edge\",\n                    style: {\n                      background: 'linear-gradient(to right, rgba(255,255,255,0.8), transparent)'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1611,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1605,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    draggable: \"true\",\n                    onDragStart: e => handleTimelineItemDragStart(e, item),\n                    onDragEnd: handleTimelineItemDragEnd,\n                    className: \"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\",\n                    children: [item.name, (copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"ml-2 text-green-200\",\n                      children: \"\\uD83D\\uDCCB\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1622,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1614,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, 'right'),\n                    title: \"Resize right edge\",\n                    style: {\n                      background: 'linear-gradient(to left, rgba(255,255,255,0.8), transparent)'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1632,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1626,\n                    columnNumber: 23\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1588,\n                  columnNumber: 21\n                }, this)), dropPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 transition-all ${dropPreview.isValid ? dropPreview.isExact ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse` : \"bg-red-300 border-red-500 border-dashed\"}`,\n                  style: getDropPreviewStyle(),\n                  children: dropPreview.isValid && !dropPreview.isExact && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center h-full text-white text-xs font-bold\",\n                    children: \"\\uD83E\\uDDF2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1649,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1638,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1580,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1535,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1519,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1475,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1345,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1237,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1082,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoEditor, \"w6ZnA3NNm9ErsIZXH1AUyZ6hDqw=\");\n_c = VideoEditor;\nexport default VideoEditor;\nvar _c;\n$RefreshReg$(_c, \"VideoEditor\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Upload","Play","Pause","Volume2","Video","Music","SkipBack","SkipForward","VolumeX","Copy","Trash2","Scissors","Image","Film","Plus","Layers","ZoomIn","ZoomOut","RotateCcw","jsxDEV","_jsxDEV","VideoEditor","_s","mediaLibrary","setMediaLibrary","videos","audios","images","timelineItems","setTimelineItems","currentTime","setCurrentTime","videoDuration","setVideoDuration","selectedTimelineItem","setSelectedTimelineItem","timelineZoom","setTimelineZoom","activeTab","setActiveTab","volume","setVolume","isMuted","setIsMuted","isPlaying","setIsPlaying","currentVideoSource","setCurrentVideoSource","draggedItem","setDraggedItem","draggedTimelineItem","setDraggedTimelineItem","dropPreview","setDropPreview","isDragging","setIsDragging","isTimelineDragging","setIsTimelineDragging","dragOffset","setDragOffset","copiedItem","setCopiedItem","isResizing","setIsResizing","resizeHandle","setResizeHandle","resizeItem","setResizeItem","originalItemData","setOriginalItemData","tracks","setTracks","overlays","id","name","type","main","audio","timelineRef","timelineScrollRef","trackLabelsRef","intervalRef","audioElementsRef","Map","fileInputRef","audioInputRef","imageInputRef","videoRef","autoScrollIntervalRef","formatTime","seconds","mins","Math","floor","secs","ms","toString","padStart","handlePlayPause","seekTo","time","newTime","max","min","content","getCurrentTimelineContent","forEach","audioItem","audioElement","current","get","relativeTime","startTime","currentItems","filter","item","duration","mainVideo","find","trackType","createAudioElement","has","document","createElement","src","url","muted","preload","set","syncAudioTime","timeDiff","abs","checkCollision","newItem","excludeId","some","trackId","itemStart","itemEnd","newStart","newEnd","insertWithRipple","insertTime","trackItems","sort","a","b","length","shouldRipple","affectedItems","insertPosition","blockAtPosition","blocksToShift","nextBlock","availableSpace","shiftAmount","findNearestValidPosition","dropTime","result","isExact","applyRippleEffect","console","log","affectedCount","map","oldStart","prev","affectedItem","affected","maxEndTime","findNextAvailablePosition","preferredStart","testItem","i","currentItem","nextItem","gapStart","gapEnd","gapSize","lastItem","removeFromTimeline","itemId","pause","delete","splitTimelineItem","splitTime","firstPartDuration","secondPartStart","secondPartDuration","secondPart","Date","now","random","updatedFirstPart","timelineItem","concat","copyTimelineItem","pasteTimelineItem","_insertResult$affecte","targetTrackId","insertResult","newEndTime","deleteSelectedItem","stopAutoScroll","clearInterval","startAutoScroll","direction","speed","setInterval","scrollAmount","currentScrollLeft","scrollLeft","maxScroll","scrollWidth","clientWidth","checkAutoScroll","clientX","rect","getBoundingClientRect","scrollZoneWidth","relativeX","left","width","zoomIn","zoomOut","resetZoom","handleResizeStart","e","handle","preventDefault","stopPropagation","handleResizeEnd","handleTrackAreaScroll","scrollTop","target","handleTrackLabelsScroll","getTimelineWidth","baseWidth","getPixelsPerSecond","handleMouseMove","mouseX","pixelsPerSecond","minDuration","rightEdge","newStartTime","newDuration","leftEdge","handleMouseUp","addEventListener","removeEventListener","o","firstImage","currentAudioIds","Set","paused","play","catch","error","handleKeyDown","tagName","key","ctrlKey","code","step","shiftKey","window","handleWheel","_timelineRef$current","contains","deltaY","passive","handleVideoUpload","event","files","Array","from","file","URL","createObjectURL","newVideo","handleAudioUpload","newAudio","handleImageUpload","newImage","addToTimeline","mediaItem","startsWith","finalStartTime","newTimelineItem","mediaId","opacity","addOverlayTrack","newTrackId","addAudioTrack","removeFromLibrary","handleTimelineClick","clickX","clickTime","handleDragStart","dataTransfer","effectAllowed","setData","handleDragEnd","handleTimelineItemDragStart","itemRect","handleTimelineItemDragEnd","handleDragOver","dropEffect","timelineRect","dragX","dragY","clientY","top","trackHeight","timeRulerHeight","relativeY","trackIndex","allTracks","targetTrack","isValid","handleDrop","_dropPreview$affected","_dropPreview$affected2","_dropPreview$affected3","handleDragLeave","_timelineRef$current2","relatedTarget","getTimelineItemStyle","findIndex","track","getDropPreviewStyle","getTrackColor","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","icon","tab","IconComponent","onClick","_fileInputRef$current","_audioInputRef$curren","_imageInputRef$curren","click","ref","accept","multiple","onChange","draggable","onDragStart","onDragEnd","alt","index","style","value","parseFloat","title","toFixed","disabled","onScroll","height","el","onDragOver","onDrop","onDragLeave","overflowX","overflowY","scrollbarWidth","minHeight","position","ceil","_","timeValue","onMouseDown","background","_c","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/VideoEditor/VideoEditor.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Upload,\r\n  Play,\r\n  Pause,\r\n  Volume2,\r\n  Video,\r\n  Music,\r\n  SkipBack,\r\n  SkipForward,\r\n  VolumeX,\r\n  Copy,\r\n  Trash2,\r\n  Scissors,\r\n  Image,\r\n  Film,\r\n  Plus,\r\n  Layers,\r\n  ZoomIn,\r\n  ZoomOut,\r\n  RotateCcw\r\n} from \"lucide-react\";\r\n\r\nconst VideoEditor = () => {\r\n  const [mediaLibrary, setMediaLibrary] = useState({\r\n    videos: [],\r\n    audios: [],\r\n    images: [],\r\n  });\r\n  const [timelineItems, setTimelineItems] = useState([]);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [videoDuration, setVideoDuration] = useState(60);\r\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\r\n  const [timelineZoom, setTimelineZoom] = useState(1);\r\n  const [activeTab, setActiveTab] = useState(\"videos\");\r\n  const [volume, setVolume] = useState(1);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\r\n  const [draggedItem, setDraggedItem] = useState(null);\r\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\r\n  const [dropPreview, setDropPreview] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\r\n  const [dragOffset, setDragOffset] = useState(0);\r\n  const [copiedItem, setCopiedItem] = useState(null);\r\n  \r\n  // Новые состояния для resize\r\n  const [isResizing, setIsResizing] = useState(false);\r\n  const [resizeHandle, setResizeHandle] = useState(null); // 'left' | 'right'\r\n  const [resizeItem, setResizeItem] = useState(null);\r\n  const [originalItemData, setOriginalItemData] = useState(null);\r\n  \r\n  // Треки как в CapCut\r\n  const [tracks, setTracks] = useState({\r\n    overlays: [\r\n      { id: 'overlay-1', name: 'Overlay 1', type: 'overlay' },\r\n      { id: 'overlay-2', name: 'Overlay 2', type: 'overlay' }\r\n    ],\r\n    main: [\r\n      { id: 'main-video', name: 'Main Video', type: 'main' }\r\n    ],\r\n    audio: [\r\n      { id: 'audio-1', name: 'Audio 1', type: 'audio' },\r\n      { id: 'audio-2', name: 'Audio 2', type: 'audio' }\r\n    ]\r\n  });\r\n\r\n  const timelineRef = useRef(null);\r\n  const timelineScrollRef = useRef(null);\r\n  const trackLabelsRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n  const audioElementsRef = useRef(new Map());\r\n  const fileInputRef = useRef(null);\r\n  const audioInputRef = useRef(null);\r\n  const imageInputRef = useRef(null);\r\n  const videoRef = useRef(null);\r\n  const autoScrollIntervalRef = useRef(null);\r\n\r\n  // Базовые функции\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    const ms = Math.floor((seconds % 1) * 100);\r\n    return timelineZoom > 5 ? `${mins}:${secs.toString().padStart(2, \"0\")}.${ms.toString().padStart(2, \"0\")}` : `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  const handlePlayPause = () => {\r\n    setIsPlaying(!isPlaying);\r\n  };\r\n\r\n  const seekTo = (time) => {\r\n    const newTime = Math.max(0, Math.min(videoDuration, time));\r\n    setCurrentTime(newTime);\r\n    \r\n    const content = getCurrentTimelineContent();\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = audioElementsRef.current.get(audioItem.id);\r\n      if (audioElement) {\r\n        const relativeTime = newTime - audioItem.startTime;\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    });\r\n  };\r\n\r\n  const getCurrentTimelineContent = useCallback(() => {\r\n    const currentItems = timelineItems.filter(\r\n      (item) =>\r\n        currentTime >= item.startTime &&\r\n        currentTime < item.startTime + item.duration\r\n    );\r\n\r\n    return {\r\n      mainVideo: currentItems.find(item => item.trackType === 'main' && item.type === 'video'),\r\n      overlays: currentItems.filter(item => item.trackType === 'overlay'),\r\n      audio: currentItems.filter(item => item.trackType === 'audio'),\r\n    };\r\n  }, [currentTime, timelineItems]);\r\n\r\n  const createAudioElement = useCallback((audioItem) => {\r\n    if (!audioElementsRef.current.has(audioItem.id)) {\r\n      const audio = document.createElement('audio');\r\n      audio.src = audioItem.url;\r\n      audio.volume = (audioItem.volume || 1) * volume;\r\n      audio.muted = isMuted;\r\n      audio.preload = \"metadata\";\r\n      audioElementsRef.current.set(audioItem.id, audio);\r\n    }\r\n    return audioElementsRef.current.get(audioItem.id);\r\n  }, [volume, isMuted]);\r\n\r\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\r\n    const audioElement = audioElementsRef.current.get(audioItem.id);\r\n    if (audioElement) {\r\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\r\n      if (timeDiff > 0.2) {\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const checkCollision = useCallback((newItem, excludeId = null) => {\r\n    return timelineItems.some(item => {\r\n      if (item.id === excludeId) return false;\r\n      if (item.trackId !== newItem.trackId) return false;\r\n      \r\n      const itemStart = item.startTime;\r\n      const itemEnd = item.startTime + item.duration;\r\n      const newStart = newItem.startTime;\r\n      const newEnd = newItem.startTime + newItem.duration;\r\n      \r\n      return (newStart < itemEnd && newEnd > itemStart);\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  // Функция для вставки с автоматическим сдвигом блоков (как в CapCut)\r\n  const insertWithRipple = useCallback((trackId, insertTime, duration, excludeId = null) => {\r\n    const trackItems = timelineItems\r\n      .filter(item => item.trackId === trackId && item.id !== excludeId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n\r\n    // Если трек пустой\r\n    if (trackItems.length === 0) {\r\n      return { time: Math.max(0, insertTime), shouldRipple: false, affectedItems: [] };\r\n    }\r\n\r\n    // Ищем где вставить\r\n    let insertPosition = insertTime;\r\n    let shouldRipple = false;\r\n    let affectedItems = [];\r\n\r\n    // Проверяем есть ли точно в этом месте блок\r\n    const blockAtPosition = trackItems.find(item => \r\n      insertTime >= item.startTime && insertTime < item.startTime + item.duration\r\n    );\r\n\r\n    if (blockAtPosition) {\r\n      // Вставляем в начало этого блока и сдвигаем все что справа\r\n      insertPosition = blockAtPosition.startTime;\r\n      shouldRipple = true;\r\n      affectedItems = trackItems.filter(item => item.startTime >= insertPosition);\r\n    } else {\r\n      // Ищем блоки которые нужно сдвинуть\r\n      const blocksToShift = trackItems.filter(item => item.startTime >= insertTime);\r\n      \r\n      if (blocksToShift.length > 0) {\r\n        // Проверяем, есть ли место без сдвига\r\n        const nextBlock = blocksToShift[0];\r\n        const availableSpace = nextBlock.startTime - insertTime;\r\n        \r\n        if (availableSpace >= duration) {\r\n          // Помещается без сдвига\r\n          insertPosition = insertTime;\r\n          shouldRipple = false;\r\n        } else {\r\n          // Нужно сдвинуть\r\n          insertPosition = insertTime;\r\n          shouldRipple = true;\r\n          affectedItems = blocksToShift;\r\n        }\r\n      } else {\r\n        // Вставляем в конец\r\n        insertPosition = insertTime;\r\n        shouldRipple = false;\r\n      }\r\n    }\r\n\r\n    return {\r\n      time: Math.max(0, insertPosition),\r\n      shouldRipple,\r\n      affectedItems,\r\n      shiftAmount: shouldRipple ? duration : 0\r\n    };\r\n  }, [timelineItems]);\r\n\r\n  // Функция для поиска ближайшего свободного места (обратная совместимость)\r\n  const findNearestValidPosition = useCallback((trackId, dropTime, duration, excludeId = null) => {\r\n    const result = insertWithRipple(trackId, dropTime, duration, excludeId);\r\n    return {\r\n      time: result.time,\r\n      isExact: !result.shouldRipple\r\n    };\r\n  }, [insertWithRipple]);\r\n\r\n  // Функция для применения ripple effect\r\n  const applyRippleEffect = useCallback((affectedItems, shiftAmount) => {\r\n    if (!affectedItems.length || shiftAmount <= 0) return;\r\n\r\n    console.log('Applying ripple effect:', { \r\n      affectedCount: affectedItems.length, \r\n      shiftAmount,\r\n      affectedItems: affectedItems.map(item => ({ name: item.name, oldStart: item.startTime }))\r\n    });\r\n\r\n    setTimelineItems(prev => prev.map(item => {\r\n      const affectedItem = affectedItems.find(affected => affected.id === item.id);\r\n      if (affectedItem) {\r\n        console.log(`Shifting ${item.name} from ${item.startTime} to ${item.startTime + shiftAmount}`);\r\n        return {\r\n          ...item,\r\n          startTime: item.startTime + shiftAmount\r\n        };\r\n      }\r\n      return item;\r\n    }));\r\n\r\n    // Обновляем общую длительность если нужно\r\n    if (affectedItems.length > 0) {\r\n      const maxEndTime = Math.max(...affectedItems.map(item => item.startTime + item.duration + shiftAmount));\r\n      if (maxEndTime > videoDuration) {\r\n        setVideoDuration(maxEndTime + 10);\r\n      }\r\n    }\r\n  }, [videoDuration]);\r\n\r\n  const findNextAvailablePosition = useCallback((trackId, duration, preferredStart = 0) => {\r\n    const trackItems = timelineItems\r\n      .filter(item => item.trackId === trackId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n    \r\n    if (preferredStart >= 0) {\r\n      const testItem = { trackId, startTime: preferredStart, duration };\r\n      if (!checkCollision(testItem)) {\r\n        return preferredStart;\r\n      }\r\n    }\r\n    \r\n    for (let i = 0; i < trackItems.length; i++) {\r\n      const currentItem = trackItems[i];\r\n      const nextItem = trackItems[i + 1];\r\n      \r\n      if (i === 0 && currentItem.startTime >= duration) {\r\n        return 0;\r\n      }\r\n      \r\n      if (nextItem) {\r\n        const gapStart = currentItem.startTime + currentItem.duration;\r\n        const gapEnd = nextItem.startTime;\r\n        const gapSize = gapEnd - gapStart;\r\n        \r\n        if (gapSize >= duration) {\r\n          return gapStart;\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (trackItems.length === 0) return 0;\r\n    const lastItem = trackItems[trackItems.length - 1];\r\n    return lastItem.startTime + lastItem.duration;\r\n  }, [timelineItems, checkCollision]);\r\n\r\n  const removeFromTimeline = (itemId) => {\r\n    const audioElement = audioElementsRef.current.get(itemId);\r\n    if (audioElement) {\r\n      audioElement.pause();\r\n      audioElement.src = '';\r\n      audioElementsRef.current.delete(itemId);\r\n    }\r\n    \r\n    setTimelineItems((prev) => prev.filter((item) => item.id !== itemId));\r\n    setSelectedTimelineItem(null);\r\n  };\r\n\r\n  // Функции для работы с элементами таймлайна\r\n  const splitTimelineItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    \r\n    const item = selectedTimelineItem;\r\n    const splitTime = currentTime;\r\n    \r\n    if (splitTime <= item.startTime || splitTime >= item.startTime + item.duration) {\r\n      return;\r\n    }\r\n    \r\n    const firstPartDuration = splitTime - item.startTime;\r\n    const secondPartStart = splitTime;\r\n    const secondPartDuration = item.duration - firstPartDuration;\r\n    \r\n    const secondPart = {\r\n      ...item,\r\n      id: Date.now() + Math.random(),\r\n      startTime: secondPartStart,\r\n      duration: secondPartDuration,\r\n    };\r\n    \r\n    const updatedFirstPart = {\r\n      ...item,\r\n      duration: firstPartDuration,\r\n    };\r\n    \r\n    setTimelineItems(prev => prev.map(timelineItem => \r\n      timelineItem.id === item.id ? updatedFirstPart : timelineItem\r\n    ).concat(secondPart));\r\n    \r\n    setSelectedTimelineItem(null);\r\n  }, [selectedTimelineItem, currentTime]);\r\n\r\n  const copyTimelineItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    setCopiedItem(selectedTimelineItem);\r\n  }, [selectedTimelineItem]);\r\n\r\n  const pasteTimelineItem = useCallback(() => {\r\n    if (!copiedItem) return;\r\n    \r\n    const targetTrackId = copiedItem.trackId;\r\n    const insertResult = insertWithRipple(targetTrackId, currentTime, copiedItem.duration);\r\n    \r\n    // Применяем ripple effect если нужно\r\n    if (insertResult.shouldRipple && insertResult.affectedItems?.length > 0) {\r\n      applyRippleEffect(insertResult.affectedItems, copiedItem.duration);\r\n    }\r\n    \r\n    const newItem = {\r\n      ...copiedItem,\r\n      id: Date.now() + Math.random(),\r\n      startTime: insertResult.time,\r\n    };\r\n\r\n    setTimelineItems(prev => [...prev, newItem]);\r\n\r\n    const newEndTime = newItem.startTime + newItem.duration;\r\n    if (newEndTime > videoDuration) {\r\n      setVideoDuration(newEndTime + 10);\r\n    }\r\n    \r\n    setSelectedTimelineItem(newItem);\r\n  }, [copiedItem, currentTime, insertWithRipple, applyRippleEffect, videoDuration]);\r\n\r\n  const deleteSelectedItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    removeFromTimeline(selectedTimelineItem.id);\r\n  }, [selectedTimelineItem]);\r\n\r\n  // Автопрокрутка и зум\r\n  const stopAutoScroll = useCallback(() => {\r\n    if (autoScrollIntervalRef.current) {\r\n      clearInterval(autoScrollIntervalRef.current);\r\n      autoScrollIntervalRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const startAutoScroll = useCallback((direction, speed = 1) => {\r\n    stopAutoScroll();\r\n    \r\n    autoScrollIntervalRef.current = setInterval(() => {\r\n      if (timelineScrollRef.current) {\r\n        const scrollAmount = 15 * speed;\r\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\r\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\r\n        \r\n        if (direction === 'left' && currentScrollLeft > 0) {\r\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\r\n        } else if (direction === 'right' && currentScrollLeft < maxScroll) {\r\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\r\n        }\r\n      }\r\n    }, 16); // 60fps для плавности\r\n  }, [stopAutoScroll]);\r\n\r\n  const checkAutoScroll = useCallback((clientX) => {\r\n    if (!timelineScrollRef.current) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const scrollZoneWidth = 120;\r\n    const relativeX = clientX - rect.left;\r\n    \r\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\r\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\r\n      startAutoScroll('left', speed);\r\n    }\r\n    else if (relativeX > rect.width - scrollZoneWidth) {\r\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\r\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\r\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\r\n        startAutoScroll('right', speed);\r\n      }\r\n    }\r\n    else {\r\n      stopAutoScroll();\r\n    }\r\n  }, [startAutoScroll, stopAutoScroll]);\r\n\r\n  // Функции зума\r\n  const zoomIn = () => {\r\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\r\n  };\r\n\r\n  const zoomOut = () => {\r\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\r\n  };\r\n\r\n  const resetZoom = () => {\r\n    setTimelineZoom(1);\r\n  };\r\n\r\n  // Функции для resize\r\n  const handleResizeStart = useCallback((e, item, handle) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setIsResizing(true);\r\n    setResizeHandle(handle);\r\n    setResizeItem(item);\r\n    setOriginalItemData({\r\n      startTime: item.startTime,\r\n      duration: item.duration\r\n    });\r\n    \r\n    // Предотвращаем drag\r\n    setIsTimelineDragging(false);\r\n    setDraggedTimelineItem(null);\r\n  }, []);\r\n\r\n  const handleResizeEnd = useCallback(() => {\r\n    setIsResizing(false);\r\n    setResizeHandle(null);\r\n    setResizeItem(null);\r\n    setOriginalItemData(null);\r\n    stopAutoScroll();\r\n  }, [stopAutoScroll]);\r\n\r\n  // Синхронизация скролла\r\n  const handleTrackAreaScroll = (e) => {\r\n    if (trackLabelsRef.current) {\r\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const handleTrackLabelsScroll = (e) => {\r\n    if (timelineScrollRef.current) {\r\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const getTimelineWidth = () => {\r\n    const baseWidth = videoDuration * 50 * timelineZoom;\r\n    return Math.max(baseWidth, 2000);\r\n  };\r\n\r\n  const getPixelsPerSecond = () => {\r\n    return 50 * timelineZoom;\r\n  };\r\n\r\n  // Обработка resize во время движения мыши\r\n  useEffect(() => {\r\n    const handleMouseMove = (e) => {\r\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\r\n      \r\n      checkAutoScroll(e.clientX);\r\n      \r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const pixelsPerSecond = getPixelsPerSecond();\r\n      const newTime = mouseX / pixelsPerSecond;\r\n      \r\n      setTimelineItems(prev => prev.map(item => {\r\n        if (item.id !== resizeItem.id) return item;\r\n        \r\n        const minDuration = 0.1;\r\n        \r\n        if (resizeHandle === 'left') {\r\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\r\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\r\n          const newDuration = rightEdge - newStartTime;\r\n          \r\n          return {\r\n            ...item,\r\n            startTime: newStartTime,\r\n            duration: newDuration\r\n          };\r\n          \r\n        } else if (resizeHandle === 'right') {\r\n          const leftEdge = originalItemData.startTime;\r\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\r\n          const newDuration = newEndTime - leftEdge;\r\n          \r\n          return {\r\n            ...item,\r\n            duration: newDuration\r\n          };\r\n        }\r\n        \r\n        return item;\r\n      }));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      if (isResizing) {\r\n        handleResizeEnd();\r\n      }\r\n    };\r\n\r\n    if (isResizing) {\r\n      document.addEventListener('mousemove', handleMouseMove);\r\n      document.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd]);\r\n\r\n  // Основные эффекты\r\n  useEffect(() => {\r\n    const content = getCurrentTimelineContent();\r\n\r\n    if (content.mainVideo && content.mainVideo.url !== currentVideoSource) {\r\n      setCurrentVideoSource(content.mainVideo.url);\r\n      if (videoRef.current) {\r\n        const relativeTime = currentTime - content.mainVideo.startTime;\r\n        videoRef.current.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    } else if (!content.mainVideo && content.overlays.find(o => o.type === 'image')) {\r\n      const firstImage = content.overlays.find(o => o.type === 'image');\r\n      setCurrentVideoSource(firstImage.url);\r\n    } else if (!content.mainVideo && !content.overlays.find(o => o.type === 'image')) {\r\n      setCurrentVideoSource(null);\r\n    }\r\n\r\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\r\n    \r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = createAudioElement(audioItem);\r\n      const relativeTime = currentTime - audioItem.startTime;\r\n      \r\n      audioElement.volume = (audioItem.volume || 1) * volume;\r\n      audioElement.muted = isMuted;\r\n      \r\n      if (isPlaying && relativeTime >= 0) {\r\n        syncAudioTime(audioItem, relativeTime);\r\n        if (audioElement.paused) {\r\n          audioElement.play().catch(console.error);\r\n        }\r\n      } else {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource]);\r\n\r\n  useEffect(() => {\r\n    if (isPlaying) {\r\n      intervalRef.current = setInterval(() => {\r\n        setCurrentTime((prev) => {\r\n          const newTime = prev + 0.1;\r\n          if (newTime >= videoDuration) {\r\n            setIsPlaying(false);\r\n            return videoDuration;\r\n          }\r\n          return newTime;\r\n        });\r\n      }, 100);\r\n    } else {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [isPlaying, videoDuration]);\r\n\r\n  useEffect(() => {\r\n    if (videoRef.current && currentVideoSource) {\r\n      const content = getCurrentTimelineContent();\r\n      if (content.mainVideo) {\r\n        const relativeTime = currentTime - content.mainVideo.startTime;\r\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\r\n\r\n        if (timeDiff > 0.5) {\r\n          videoRef.current.currentTime = Math.max(0, relativeTime);\r\n        }\r\n\r\n        if (isPlaying && videoRef.current.paused) {\r\n          videoRef.current.play().catch(console.error);\r\n        } else if (!isPlaying && !videoRef.current.paused) {\r\n          videoRef.current.pause();\r\n        }\r\n      }\r\n    }\r\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\r\n\r\n  useEffect(() => {\r\n    const currentAudioIds = new Set(\r\n      timelineItems\r\n        .filter(item => item.type === \"audio\")\r\n        .map(item => item.id)\r\n    );\r\n\r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        audioElement.pause();\r\n        audioElement.src = '';\r\n        audioElementsRef.current.delete(id);\r\n      }\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  // Очистка при размонтировании\r\n  useEffect(() => {\r\n    return () => {\r\n      stopAutoScroll();\r\n    };\r\n  }, [stopAutoScroll]);\r\n\r\n  // Обработка клавиатурных шорткатов\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {\r\n        return;\r\n      }\r\n\r\n      if (e.key === 'Delete' || e.key === 'Backspace') {\r\n        e.preventDefault();\r\n        deleteSelectedItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'b') {\r\n        e.preventDefault();\r\n        splitTimelineItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'c') {\r\n        e.preventDefault();\r\n        copyTimelineItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'v') {\r\n        e.preventDefault();\r\n        pasteTimelineItem();\r\n      }\r\n\r\n      if (e.key === ' ' || e.code === 'Space') {\r\n        e.preventDefault();\r\n        setIsPlaying(prev => !prev);\r\n      }\r\n\r\n      if (e.key === 'ArrowLeft') {\r\n        e.preventDefault();\r\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\r\n        seekTo(Math.max(0, currentTime - step));\r\n      }\r\n      if (e.key === 'ArrowRight') {\r\n        e.preventDefault();\r\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\r\n        seekTo(Math.min(videoDuration, currentTime + step));\r\n      }\r\n\r\n      if (e.key === '=' || e.key === '+') {\r\n        e.preventDefault();\r\n        zoomIn();\r\n      }\r\n      if (e.key === '-') {\r\n        e.preventDefault();\r\n        zoomOut();\r\n      }\r\n      if (e.key === '0') {\r\n        e.preventDefault();\r\n        resetZoom();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [selectedTimelineItem, copiedItem, currentTime, videoDuration, deleteSelectedItem, splitTimelineItem, copyTimelineItem, pasteTimelineItem]);\r\n\r\n  // Обработка колесика мыши для зума\r\n  useEffect(() => {\r\n    const handleWheel = (e) => {\r\n      if (e.ctrlKey && timelineRef.current?.contains(e.target)) {\r\n        e.preventDefault();\r\n        if (e.deltaY < 0) {\r\n          zoomIn();\r\n        } else {\r\n          zoomOut();\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('wheel', handleWheel, { passive: false });\r\n    return () => document.removeEventListener('wheel', handleWheel);\r\n  }, []);\r\n\r\n  const handleVideoUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newVideo = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        duration: 10,\r\n        type: \"video\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        videos: [...prev.videos, newVideo],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const handleAudioUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newAudio = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        duration: 10,\r\n        type: \"audio\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        audios: [...prev.audios, newAudio],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const handleImageUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newImage = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        type: \"image\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        images: [...prev.images, newImage],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const addToTimeline = (mediaItem, startTime = null, targetTrackId = null) => {\r\n    let trackType, trackId;\r\n    \r\n    if (mediaItem.type === \"video\") {\r\n      trackType = targetTrackId && targetTrackId.startsWith('overlay') ? 'overlay' : 'main';\r\n      trackId = targetTrackId || 'main-video';\r\n    } else if (mediaItem.type === \"image\") {\r\n      trackType = 'overlay';\r\n      trackId = targetTrackId || 'overlay-1';\r\n    } else if (mediaItem.type === \"audio\") {\r\n      trackType = 'audio';\r\n      trackId = targetTrackId || 'audio-1';\r\n    }\r\n    \r\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\r\n    \r\n    const finalStartTime = startTime !== null ? \r\n      startTime : \r\n      findNextAvailablePosition(trackId, duration);\r\n\r\n    const newTimelineItem = {\r\n      id: Date.now() + Math.random(),\r\n      mediaId: mediaItem.id,\r\n      type: mediaItem.type,\r\n      name: mediaItem.name,\r\n      url: mediaItem.url,\r\n      startTime: finalStartTime,\r\n      duration: duration,\r\n      trackId: trackId,\r\n      trackType: trackType,\r\n      volume: 1,\r\n      opacity: 1,\r\n    };\r\n\r\n    setTimelineItems((prev) => [...prev, newTimelineItem]);\r\n\r\n    const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\r\n    if (newEndTime > videoDuration) {\r\n      setVideoDuration(newEndTime + 10);\r\n    }\r\n  };\r\n\r\n  const addOverlayTrack = () => {\r\n    const newTrackId = `overlay-${Date.now()}`;\r\n    setTracks(prev => ({\r\n      ...prev,\r\n      overlays: [...prev.overlays, {\r\n        id: newTrackId,\r\n        name: `Overlay ${prev.overlays.length + 1}`,\r\n        type: 'overlay'\r\n      }]\r\n    }));\r\n  };\r\n\r\n  const addAudioTrack = () => {\r\n    const newTrackId = `audio-${Date.now()}`;\r\n    setTracks(prev => ({\r\n      ...prev,\r\n      audio: [...prev.audio, {\r\n        id: newTrackId,\r\n        name: `Audio ${prev.audio.length + 1}`,\r\n        type: 'audio'\r\n      }]\r\n    }));\r\n  };\r\n\r\n  const removeFromLibrary = (itemId, type) => {\r\n    setMediaLibrary((prev) => ({\r\n      ...prev,\r\n      [type]: prev[type].filter((item) => item.id !== itemId),\r\n    }));\r\n  };\r\n\r\n  const handleTimelineClick = (e) => {\r\n    if (isDragging || isTimelineDragging || isResizing) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    seekTo(clickTime);\r\n  };\r\n\r\n  const handleDragStart = (e, mediaItem) => {\r\n    setDraggedItem(mediaItem);\r\n    setIsDragging(true);\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    setDraggedItem(null);\r\n    setDropPreview(null);\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const handleTimelineItemDragStart = (e, timelineItem) => {\r\n    if (isResizing) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n    \r\n    e.stopPropagation();\r\n    setDraggedTimelineItem(timelineItem);\r\n    setIsTimelineDragging(true);\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const itemRect = e.target.getBoundingClientRect();\r\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\r\n    \r\n    e.dataTransfer.effectAllowed = \"move\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleTimelineItemDragEnd = () => {\r\n    setDraggedTimelineItem(null);\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n    setDragOffset(0);\r\n    stopAutoScroll();\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (!draggedItem && !draggedTimelineItem) return;\r\n    \r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\r\n    \r\n    if (draggedTimelineItem || isResizing) {\r\n      checkAutoScroll(e.clientX);\r\n    }\r\n    \r\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\r\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\r\n    \r\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\r\n    const trackHeight = 60;\r\n    const timeRulerHeight = 48;\r\n    \r\n    const relativeY = dragY - timeRulerHeight;\r\n    const trackIndex = Math.floor(relativeY / trackHeight);\r\n    \r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const targetTrack = allTracks[trackIndex];\r\n    \r\n    if (draggedItem && targetTrack) {\r\n      // Новый элемент из библиотеки\r\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\r\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\r\n      \r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || []\r\n      });\r\n    } else if (draggedTimelineItem && targetTrack) {\r\n      // Существующий элемент\r\n      const insertResult = insertWithRipple(\r\n        targetTrack.id, \r\n        dropTime, \r\n        draggedTimelineItem.duration, \r\n        draggedTimelineItem.id\r\n      );\r\n      \r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: draggedTimelineItem.duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || []\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    if ((!draggedItem && !draggedTimelineItem) || !dropPreview) return;\r\n    \r\n    e.preventDefault();\r\n    stopAutoScroll();\r\n    \r\n    console.log('Dropping with ripple:', { \r\n      dropPreview,\r\n      shouldRipple: dropPreview.shouldRipple,\r\n      affectedItems: dropPreview.affectedItems?.length || 0\r\n    });\r\n    \r\n    if (dropPreview.isValid) {\r\n      if (draggedItem) {\r\n        // Новый элемент из библиотеки\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          // Сначала сдвигаем существующие блоки\r\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\r\n        }\r\n        \r\n        // Добавляем новый элемент\r\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\r\n        \r\n        console.log('Added with ripple effect:', dropPreview.shouldRipple);\r\n        \r\n      } else if (draggedTimelineItem) {\r\n        // Перемещение существующего элемента\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          // Сначала сдвигаем блоки, которые нужно освободить место\r\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\r\n        }\r\n        \r\n        // Перемещаем элемент\r\n        setTimelineItems(prev => prev.map(item => \r\n          item.id === draggedTimelineItem.id \r\n            ? { \r\n                ...item, \r\n                startTime: dropPreview.time, \r\n                trackId: dropPreview.trackId, \r\n                trackType: dropPreview.trackType \r\n              }\r\n            : item\r\n        ));\r\n        \r\n        console.log('Moved with ripple effect:', dropPreview.shouldRipple);\r\n        \r\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\r\n        if (newEndTime > videoDuration) {\r\n          setVideoDuration(newEndTime + 10);\r\n        }\r\n      }\r\n    }\r\n    \r\n    setDropPreview(null);\r\n    setDraggedItem(null);\r\n    setDraggedTimelineItem(null);\r\n    setIsDragging(false);\r\n    setIsTimelineDragging(false);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    if (!timelineRef.current?.contains(e.relatedTarget)) {\r\n      setDropPreview(null);\r\n      stopAutoScroll();\r\n    }\r\n  };\r\n\r\n  const getTimelineItemStyle = (item) => {\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    \r\n    return {\r\n      left: `${item.startTime * pixelsPerSecond}px`,\r\n      width: `${item.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getDropPreviewStyle = () => {\r\n    if (!dropPreview) return {};\r\n    \r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    \r\n    return {\r\n      left: `${dropPreview.time * pixelsPerSecond}px`,\r\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getTrackColor = (trackType) => {\r\n    switch (trackType) {\r\n      case 'overlay': return 'bg-purple-500 border-purple-400';\r\n      case 'main': return 'bg-blue-500 border-blue-400';\r\n      case 'audio': return 'bg-green-500 border-green-400';\r\n      default: return 'bg-gray-500 border-gray-400';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex h-screen w-full gap-4 p-4 bg-gray-100 overflow-hidden\">\r\n      {/* Media Library */}\r\n      <div className=\"w-80 min-w-72 max-w-80 bg-white border-2 border-blue-200 flex flex-col rounded-2xl shadow-lg overflow-hidden flex-shrink-0\">\r\n        <div className=\"bg-blue-50 px-4 py-3 border-b border-blue-100\">\r\n          <h3 className=\"font-bold text-blue-800 flex items-center\">\r\n            <Upload size={18} className=\"mr-2\" />\r\n            Media Library\r\n          </h3>\r\n        </div>\r\n        \r\n        <div className=\"p-4 pb-0\">\r\n          <div className=\"flex bg-gray-100 rounded-xl p-1\">\r\n            {[\r\n              { id: \"videos\", name: \"Videos\", icon: Video },\r\n              { id: \"audios\", name: \"Audio\", icon: Music },\r\n              { id: \"images\", name: \"Images\", icon: Image },\r\n            ].map((tab) => {\r\n              const IconComponent = tab.icon;\r\n              return (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id)}\r\n                  className={`flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${\r\n                    activeTab === tab.id\r\n                      ? \"bg-white text-blue-600 shadow-sm\"\r\n                      : \"text-gray-600 hover:text-gray-800\"\r\n                  }`}\r\n                >\r\n                  <IconComponent size={16} className=\"mr-2 inline\" />\r\n                  {tab.name}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4\">\r\n          <button\r\n            onClick={() => {\r\n              if (activeTab === \"videos\") fileInputRef.current?.click();\r\n              else if (activeTab === \"audios\") audioInputRef.current?.click();\r\n              else imageInputRef.current?.click();\r\n            }}\r\n            className=\"w-full p-6 border-2 border-dashed border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-200 text-center group\"\r\n          >\r\n            <div className=\"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-100 transition-colors\">\r\n              <Upload\r\n                size={20}\r\n                className=\"text-gray-500 group-hover:text-blue-500\"\r\n              />\r\n            </div>\r\n            <span className=\"text-sm font-medium text-gray-700 group-hover:text-blue-600\">\r\n              Upload{\" \"}\r\n              {activeTab === \"videos\"\r\n                ? \"Video\"\r\n                : activeTab === \"audios\"\r\n                ? \"Audio\"\r\n                : \"Images\"}\r\n            </span>\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              {activeTab === \"videos\"\r\n                ? \"MP4, AVI, MOV up to 2GB\"\r\n                : activeTab === \"audios\"\r\n                ? \"MP3, WAV, M4A up to 100MB\"\r\n                : \"JPG, PNG, GIF up to 10MB\"}\r\n            </p>\r\n          </button>\r\n        </div>\r\n\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\"video/*\"\r\n          multiple\r\n          onChange={handleVideoUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={audioInputRef}\r\n          type=\"file\"\r\n          accept=\"audio/*\"\r\n          multiple\r\n          onChange={handleAudioUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={imageInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          multiple\r\n          onChange={handleImageUpload}\r\n          className=\"hidden\"\r\n        />\r\n\r\n        <div className=\"flex-1 overflow-y-auto px-4 pb-4\">\r\n          <div className=\"space-y-2\">\r\n            {mediaLibrary[activeTab].map((item) => (\r\n              <div\r\n                key={item.id}\r\n                draggable=\"true\"\r\n                onDragStart={(e) => handleDragStart(e, item)}\r\n                onDragEnd={handleDragEnd}\r\n                className={`flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${\r\n                  draggedItem?.id === item.id ? \"opacity-50\" : \"\"\r\n                }`}\r\n                onClick={() => addToTimeline(item)}\r\n              >\r\n                <div className=\"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\">\r\n                  {activeTab === \"videos\" && (\r\n                    <Video size={20} className=\"text-blue-500\" />\r\n                  )}\r\n                  {activeTab === \"audios\" && (\r\n                    <Music size={20} className=\"text-green-500\" />\r\n                  )}\r\n                  {activeTab === \"images\" && (\r\n                    <Image size={20} className=\"text-purple-500\" />\r\n                  )}\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <p className=\"text-sm font-medium text-gray-900 truncate\">\r\n                    {item.name}\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    {activeTab === \"images\"\r\n                      ? \"Image\"\r\n                      : formatTime(item.duration || 0)}\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    removeFromLibrary(item.id, activeTab);\r\n                  }}\r\n                  className=\"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\"\r\n                >\r\n                  <Trash2 size={14} />\r\n                </button>\r\n              </div>\r\n            ))}\r\n            {mediaLibrary[activeTab].length === 0 && (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3\">\r\n                  {activeTab === \"videos\" && <Video size={24} className=\"text-gray-400\" />}\r\n                  {activeTab === \"audios\" && <Music size={24} className=\"text-gray-400\" />}\r\n                  {activeTab === \"images\" && <Image size={24} className=\"text-gray-400\" />}\r\n                </div>\r\n                <p className=\"text-sm text-gray-500\">No {activeTab} uploaded yet</p>\r\n                <p className=\"text-xs text-gray-400 mt-1\">Click upload button above</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col gap-4 min-w-0 overflow-hidden\">\r\n        {/* Video Preview */}\r\n        <div className=\"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm min-h-0\">\r\n          {currentVideoSource ? (\r\n            <div className=\"relative w-full h-full\">\r\n              {getCurrentTimelineContent().mainVideo ? (\r\n                <video\r\n                  ref={videoRef}\r\n                  src={currentVideoSource}\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                  muted={isMuted}\r\n                />\r\n              ) : (\r\n                <img\r\n                  src={currentVideoSource}\r\n                  alt=\"Timeline content\"\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                />\r\n              )}\r\n              \r\n              {getCurrentTimelineContent().overlays.map((item, index) => (\r\n                <div\r\n                  key={item.id}\r\n                  className=\"absolute top-4 right-4 w-32 h-24 border-2 border-white rounded-lg overflow-hidden shadow-lg\"\r\n                  style={{ \r\n                    top: `${4 + index * 100}px`,\r\n                    opacity: item.opacity || 1,\r\n                  }}\r\n                >\r\n                  {item.type === 'video' ? (\r\n                    <video\r\n                      src={item.url}\r\n                      className=\"w-full h-full object-cover\"\r\n                      muted\r\n                    />\r\n                  ) : (\r\n                    <img\r\n                      src={item.url}\r\n                      alt={item.name}\r\n                      className=\"w-full h-full object-cover\"\r\n                    />\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"w-full h-full flex items-center justify-center text-white\">\r\n              <div className=\"text-center\">\r\n                <div className=\"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\">\r\n                  <Film size={40} className=\"opacity-50\" />\r\n                </div>\r\n                <p className=\"text-xl opacity-75 font-medium\">\r\n                  No content at current time\r\n                </p>\r\n                <p className=\"text-sm opacity-50\">\r\n                  Drag media to timeline tracks\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\">\r\n            <div className=\"flex items-center space-x-6\">\r\n              <button\r\n                onClick={() => seekTo(Math.max(0, currentTime - 10))}\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n              >\r\n                <SkipBack size={20} />\r\n              </button>\r\n              <button\r\n                onClick={handlePlayPause}\r\n                className=\"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\"\r\n              >\r\n                {isPlaying ? <Pause size={24} /> : <Play size={24} />}\r\n              </button>\r\n              <button\r\n                onClick={() =>\r\n                  seekTo(Math.min(videoDuration, currentTime + 10))\r\n                }\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n              >\r\n                <SkipForward size={20} />\r\n              </button>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <button\r\n                  onClick={() => setIsMuted(!isMuted)}\r\n                  className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n                >\r\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\r\n                </button>\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                  value={volume}\r\n                  onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                  className=\"w-24 accent-blue-500\"\r\n                />\r\n              </div>\r\n              <span className=\"text-white text-sm font-medium min-w-0\">\r\n                {formatTime(currentTime)} / {formatTime(videoDuration)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Timeline */}\r\n        <div \r\n          className={`h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${\r\n            isDragging || isTimelineDragging || isResizing\r\n              ? \"border-blue-400 bg-blue-50/20\" \r\n              : \"border-gray-200\"\r\n          }`}\r\n        >\r\n          <div className=\"bg-gray-50 p-4 border-b border-gray-200 space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n                <Film size={18} />\r\n                <span>Timeline Pro</span>\r\n                {isDragging && dropPreview && (\r\n                  <span className=\"text-green-600\">\r\n                    - Adding \"{draggedItem?.name}\" {dropPreview.shouldRipple ? '⚡ ripple' : '📍 exact'}\r\n                  </span>\r\n                )}\r\n                {isTimelineDragging && dropPreview && (\r\n                  <span className=\"text-blue-600\">\r\n                    - Moving \"{draggedTimelineItem?.name}\" {dropPreview.shouldRipple ? '⚡ push blocks' : '📍 exact'}\r\n                  </span>\r\n                )}\r\n                {isResizing && resizeItem && (\r\n                  <span className=\"text-orange-600\">\r\n                    - Trimming \"{resizeItem.name}\" ({resizeHandle} edge)\r\n                  </span>\r\n                )}\r\n                {copiedItem && (\r\n                  <span className=\"text-blue-600 text-sm\">\r\n                    - \"{copiedItem.name}\" copied (Ctrl+V to paste)\r\n                  </span>\r\n                )}\r\n              </h4>\r\n              \r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\">\r\n                  <button\r\n                    onClick={zoomOut}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom Out (-)\"\r\n                  >\r\n                    <ZoomOut size={16} />\r\n                  </button>\r\n                  <span className=\"text-xs text-gray-500 min-w-12 text-center\">\r\n                    {(timelineZoom * 100).toFixed(0)}%\r\n                  </span>\r\n                  <button\r\n                    onClick={zoomIn}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom In (+)\"\r\n                  >\r\n                    <ZoomIn size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={resetZoom}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Reset Zoom (0)\"\r\n                  >\r\n                    <RotateCcw size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-6\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button\r\n                    onClick={addOverlayTrack}\r\n                    className=\"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Overlay Track\"\r\n                  >\r\n                    <Plus size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={addAudioTrack}\r\n                    className=\"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Audio Track\"\r\n                  >\r\n                    <Music size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={splitTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Split Selected Item (Ctrl+B)\"\r\n                  >\r\n                    <Scissors size={16} />\r\n                  </button>\r\n                  <button \r\n                    onClick={copyTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Copy Selected Item (Ctrl+C)\"\r\n                  >\r\n                    <Copy size={16} />\r\n                  </button>\r\n                  <button \r\n                    onClick={deleteSelectedItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Delete Selected Item (Del)\"\r\n                  >\r\n                    <Trash2 size={16} />\r\n                  </button>\r\n                </div>\r\n                \r\n                <div className=\"text-xs text-gray-500 bg-gray-50 px-3 py-1 rounded-lg\">\r\n                  <span className=\"font-medium\">CapCut Pro:</span>\r\n                  <span className=\"ml-2\">Drag center: Move</span>\r\n                  <span className=\"ml-2\">Drag edges: Trim</span>\r\n                  <span className=\"ml-2\">Auto ripple: Push blocks</span>\r\n                  <span className=\"ml-2\">Ctrl+Wheel: Zoom</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 flex min-h-0\">\r\n            <div className=\"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\">\r\n              <div className=\"h-12 border-b border-gray-200 flex-shrink-0\"></div>\r\n              \r\n              <div \r\n                ref={trackLabelsRef}\r\n                className=\"flex-1 overflow-y-auto overflow-x-hidden\"\r\n                onScroll={handleTrackLabelsScroll}\r\n              >\r\n                {tracks.overlays.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Layers size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n                \r\n                {tracks.main.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Video size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n                \r\n                {tracks.audio.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Music size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div \r\n              ref={(el) => {\r\n                timelineRef.current = el;\r\n                timelineScrollRef.current = el;\r\n              }}\r\n              className=\"flex-1 relative overflow-auto bg-white\"\r\n              onScroll={handleTrackAreaScroll}\r\n              onDragOver={handleDragOver}\r\n              onDrop={handleDrop}\r\n              onDragLeave={handleDragLeave}\r\n              style={{ \r\n                overflowX: 'auto', \r\n                overflowY: 'auto',\r\n                scrollbarWidth: 'thin'\r\n              }}\r\n            >\r\n              <div \r\n                style={{ \r\n                  width: `${getTimelineWidth()}px`, \r\n                  minHeight: '100%',\r\n                  position: 'relative'\r\n                }}\r\n                onClick={handleTimelineClick}\r\n              >\r\n                <div className=\"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\">\r\n                  {Array.from({ length: Math.ceil(videoDuration * timelineZoom / 5) + 1 }, (_, i) => {\r\n                    const timeValue = i * 5 / timelineZoom;\r\n                    const pixelsPerSecond = getPixelsPerSecond();\r\n                    return (\r\n                      <div\r\n                        key={i}\r\n                        className=\"absolute top-0 h-full border-l border-gray-300\"\r\n                        style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                      >\r\n                        <span className=\"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\">\r\n                          {formatTime(timeValue)}\r\n                        </span>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                  \r\n                  {timelineZoom > 2 && Array.from({ length: Math.ceil(videoDuration * timelineZoom) + 1 }, (_, i) => {\r\n                    const timeValue = i / timelineZoom;\r\n                    const pixelsPerSecond = getPixelsPerSecond();\r\n                    return (\r\n                      <div\r\n                        key={`sub-${i}`}\r\n                        className=\"absolute top-8 w-0 h-4 border-l border-gray-200\"\r\n                        style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                      />\r\n                    );\r\n                  })}\r\n                  \r\n                  <div\r\n                    className=\"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\"\r\n                    style={{\r\n                      left: `${currentTime * getPixelsPerSecond()}px`,\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div \r\n                  className=\"relative flex-1\" \r\n                  style={{ \r\n                    height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\r\n                    minHeight: '100%'\r\n                  }}\r\n                >\r\n                  {timelineItems.map((item) => (\r\n                    <div\r\n                      key={item.id}\r\n                      className={`absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${\r\n                        getTrackColor(item.trackType)\r\n                      } ${\r\n                        selectedTimelineItem?.id === item.id ? \"ring-2 ring-blue-300\" : \"\"\r\n                      } ${\r\n                        draggedTimelineItem?.id === item.id ? \"opacity-50 z-30\" : \"\"\r\n                      } ${\r\n                        copiedItem?.id === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"\r\n                      }`}\r\n                      style={getTimelineItemStyle(item)}\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setSelectedTimelineItem(item);\r\n                      }}\r\n                    >\r\n                      <div\r\n                        className=\"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, 'left')}\r\n                        title=\"Resize left edge\"\r\n                        style={{ background: 'linear-gradient(to right, rgba(255,255,255,0.8), transparent)' }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n                      \r\n                      <div\r\n                        draggable=\"true\"\r\n                        onDragStart={(e) => handleTimelineItemDragStart(e, item)}\r\n                        onDragEnd={handleTimelineItemDragEnd}\r\n                        className=\"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\"\r\n                      >\r\n                        {item.name}\r\n                        {copiedItem?.id === item.id && (\r\n                          <span className=\"ml-2 text-green-200\">📋</span>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div\r\n                        className=\"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, 'right')}\r\n                        title=\"Resize right edge\"\r\n                        style={{ background: 'linear-gradient(to left, rgba(255,255,255,0.8), transparent)' }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  \r\n                  {dropPreview && (\r\n                    <div\r\n                      className={`absolute h-10 rounded-lg border-2 transition-all ${\r\n                        dropPreview.isValid \r\n                          ? dropPreview.isExact \r\n                            ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` \r\n                            : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse`\r\n                          : \"bg-red-300 border-red-500 border-dashed\"\r\n                      }`}\r\n                      style={getDropPreviewStyle()}\r\n                    >\r\n                      {dropPreview.isValid && !dropPreview.isExact && (\r\n                        <div className=\"flex items-center justify-center h-full text-white text-xs font-bold\">\r\n                          🧲\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoEditor;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}