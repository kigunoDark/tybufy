{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\Timeline.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Video, Music, Copy, Trash2, Scissors, Film, Plus, Layers, ZoomIn, ZoomOut, RotateCcw, HelpCircle } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Timeline = ({\n  timelineItems,\n  setTimelineItems,\n  currentTime,\n  videoDuration,\n  setVideoDuration,\n  selectedTimelineItem,\n  setSelectedTimelineItem,\n  timelineZoom,\n  setTimelineZoom,\n  tracks,\n  setTracks,\n  draggedItem,\n  draggedTimelineItem,\n  setDraggedTimelineItem,\n  dropPreview,\n  setDropPreview,\n  isDragging,\n  isTimelineDragging,\n  setIsTimelineDragging,\n  isResizing,\n  setIsResizing,\n  copiedItem,\n  formatTime,\n  seekTo,\n  splitTimelineItem,\n  copyTimelineItem,\n  pasteTimelineItem,\n  deleteSelectedItem,\n  addToTimeline,\n  insertWithRipple,\n  applyRippleEffect,\n  removeFromTimeline,\n  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞—Ä—É–∂—É\n  onSmartAddToTimeline\n}) => {\n  _s();\n  const timelineRef = useRef(null);\n  const timelineScrollRef = useRef(null);\n  const trackLabelsRef = useRef(null);\n  const autoScrollIntervalRef = useRef(null);\n\n  // Timeline-specific states\n  const [dragOffset, setDragOffset] = useState(0);\n  const [resizeHandle, setResizeHandle] = useState(null);\n  const [resizeItem, setResizeItem] = useState(null);\n  const [originalItemData, setOriginalItemData] = useState(null);\n\n  // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞\n  const stopAutoScroll = useCallback(() => {\n    if (autoScrollIntervalRef.current) {\n      clearInterval(autoScrollIntervalRef.current);\n      autoScrollIntervalRef.current = null;\n    }\n  }, []);\n  const startAutoScroll = useCallback((direction, speed = 1) => {\n    stopAutoScroll();\n    autoScrollIntervalRef.current = setInterval(() => {\n      if (timelineScrollRef.current) {\n        const scrollAmount = 15 * speed;\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n        if (direction === \"left\" && currentScrollLeft > 0) {\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\n        } else if (direction === \"right\" && currentScrollLeft < maxScroll) {\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\n        }\n      }\n    }, 16);\n  }, [stopAutoScroll]);\n  const checkAutoScroll = useCallback(clientX => {\n    if (!timelineScrollRef.current) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const scrollZoneWidth = 120;\n    const relativeX = clientX - rect.left;\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\n      startAutoScroll(\"left\", speed);\n    } else if (relativeX > rect.width - scrollZoneWidth) {\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\n        startAutoScroll(\"right\", speed);\n      }\n    } else {\n      stopAutoScroll();\n    }\n  }, [startAutoScroll, stopAutoScroll]);\n\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ä–æ–∂–∫–∏ –ø–æ —Ç–∏–ø—É –º–µ–¥–∏–∞\n  const getTargetTrackForType = useCallback(mediaType => {\n    var _tracks$main, _tracks$audio, _tracks$overlays, _tracks$main2, _tracks$main2$;\n    switch (mediaType) {\n      case \"video\":\n        const mainTrack = (_tracks$main = tracks.main) === null || _tracks$main === void 0 ? void 0 : _tracks$main[0];\n        console.log(`Main –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –≤–∏–¥–µ–æ:`, mainTrack);\n        return mainTrack === null || mainTrack === void 0 ? void 0 : mainTrack.id;\n      case \"audio\":\n      case \"music\":\n        const audioTrack = (_tracks$audio = tracks.audio) === null || _tracks$audio === void 0 ? void 0 : _tracks$audio[0];\n        console.log(`Audio –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –∞—É–¥–∏–æ:`, audioTrack);\n        return audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.id;\n      case \"image\":\n      case \"text\":\n        const overlayTrack = (_tracks$overlays = tracks.overlays) === null || _tracks$overlays === void 0 ? void 0 : _tracks$overlays[0];\n        console.log(`Overlay –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏/—Ç–µ–∫—Å—Ç–∞:`, overlayTrack);\n        return overlayTrack === null || overlayTrack === void 0 ? void 0 : overlayTrack.id;\n      default:\n        console.log(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø ${mediaType}, –∏—Å–ø–æ–ª—å–∑—É–µ–º main –¥–æ—Ä–æ–∂–∫—É`);\n        return (_tracks$main2 = tracks.main) === null || _tracks$main2 === void 0 ? void 0 : (_tracks$main2$ = _tracks$main2[0]) === null || _tracks$main2$ === void 0 ? void 0 : _tracks$main2$.id;\n    }\n  }, [tracks]);\n\n  // –£–º–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–æ—Ä–æ–∂–∫–µ\n  const addToTimelineAtCurrentTime = useCallback(() => {\n    if (!draggedItem) return;\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\n    if (!targetTrackId) return;\n\n    // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\n    const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\n    addToTimeline(draggedItem, bestPosition, targetTrackId);\n  }, [draggedItem, getTargetTrackForType, addToTimeline]);\n\n  // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞\n  const findBestPositionForItem = useCallback((item, targetTrackId) => {\n    const duration = item.duration || (item.type === \"image\" ? 5 : 10);\n\n    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ä–æ–∂–∫–µ\n    const itemsOnTrack = timelineItems.filter(timelineItem => timelineItem.trackId === targetTrackId).sort((a, b) => a.startTime - b.startTime);\n\n    // –ï—Å–ª–∏ –Ω–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ, —Ä–∞–∑–º–µ—â–∞–µ–º –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏\n    if (itemsOnTrack.length === 0) {\n      return currentTime;\n    }\n\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–µ—Å—Ç–æ –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏\n    const hasSpaceAtCurrentTime = !itemsOnTrack.some(existingItem => {\n      const existingStart = existingItem.startTime;\n      const existingEnd = existingItem.startTime + existingItem.duration;\n      const newStart = currentTime;\n      const newEnd = currentTime + duration;\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ\n      return !(newEnd <= existingStart || newStart >= existingEnd);\n    });\n    if (hasSpaceAtCurrentTime) {\n      return currentTime;\n    }\n\n    // –ï—Å–ª–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç –º–µ—Å—Ç–∞, —Ä–∞–∑–º–µ—â–∞–µ–º –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞\n    const lastItem = itemsOnTrack[itemsOnTrack.length - 1];\n    return lastItem.startTime + lastItem.duration;\n  }, [timelineItems, currentTime]);\n\n  // –ó—É–º –∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏ –∫–∞–∫ –≤ CapCut\n  const handleWheel = useCallback(e => {\n    if (e.ctrlKey) {\n      // Ctrl + –∫–æ–ª–µ—Å–æ = –∑—É–º —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∫—É—Ä—Å–æ—Ä\n      e.preventDefault();\n      if (!timelineScrollRef.current) return;\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const currentPixelsPerSecond = 50 * timelineZoom;\n      const timeAtMouse = mouseX / currentPixelsPerSecond;\n      const zoomDirection = e.deltaY < 0 ? 1 : -1;\n      const zoomStep = 1.2;\n      setTimelineZoom(prevZoom => {\n        let newZoom;\n        if (zoomDirection > 0) {\n          newZoom = Math.min(20, prevZoom * zoomStep);\n        } else {\n          newZoom = Math.max(0.1, prevZoom / zoomStep);\n        }\n        requestAnimationFrame(() => {\n          if (timelineScrollRef.current) {\n            const newPixelsPerSecond = 50 * newZoom;\n            const newMouseX = timeAtMouse * newPixelsPerSecond;\n            const targetScrollLeft = newMouseX - (e.clientX - rect.left);\n            timelineScrollRef.current.scrollLeft = Math.max(0, targetScrollLeft);\n          }\n        });\n        return newZoom;\n      });\n    } else if (e.shiftKey) {\n      // Shift + –∫–æ–ª–µ—Å–æ = –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\n      e.preventDefault();\n      if (timelineScrollRef.current) {\n        const scrollAmount = e.deltaY * 2;\n        timelineScrollRef.current.scrollLeft += scrollAmount;\n      }\n    }\n  }, [timelineZoom, setTimelineZoom]);\n\n  // –§—É–Ω–∫—Ü–∏–∏ –∑—É–º–∞\n  const zoomIn = () => {\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\n  };\n  const zoomOut = () => {\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\n  };\n  const resetZoom = () => {\n    setTimelineZoom(1);\n  };\n\n  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è resize\n  const handleResizeStart = useCallback((e, item, handle) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsResizing(true);\n    setResizeHandle(handle);\n    setResizeItem(item);\n    setOriginalItemData({\n      startTime: item.startTime,\n      duration: item.duration\n    });\n    setIsTimelineDragging(false);\n    setDraggedTimelineItem(null);\n  }, [setIsResizing, setIsTimelineDragging, setDraggedTimelineItem]);\n  const handleResizeEnd = useCallback(() => {\n    setIsResizing(false);\n    setResizeHandle(null);\n    setResizeItem(null);\n    setOriginalItemData(null);\n    stopAutoScroll();\n  }, [setIsResizing, stopAutoScroll]);\n\n  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤\n  const addOverlayTrack = () => {\n    const newTrackId = `overlay-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      overlays: [...prev.overlays, {\n        id: newTrackId,\n        name: `Overlay ${prev.overlays.length + 1}`,\n        type: \"overlay\"\n      }]\n    }));\n  };\n  const addAudioTrack = () => {\n    const newTrackId = `audio-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      audio: [...prev.audio, {\n        id: newTrackId,\n        name: `Audio ${prev.audio.length + 1}`,\n        type: \"audio\"\n      }]\n    }));\n  };\n\n  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞\n  const handleTrackAreaScroll = e => {\n    if (trackLabelsRef.current) {\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const handleTrackLabelsScroll = e => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const getTimelineWidth = () => {\n    const baseWidth = videoDuration * 50 * timelineZoom;\n    return Math.max(baseWidth, 2000);\n  };\n  const getPixelsPerSecond = () => {\n    return 50 * timelineZoom;\n  };\n\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π\n  const handleTimelineClick = e => {\n    if (isDragging || isTimelineDragging || isResizing) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    seekTo(clickTime);\n  };\n  const handleTimelineDoubleClick = useCallback(e => {\n    if (isDragging || isTimelineDragging || isResizing || !draggedItem) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\n    if (targetTrackId) {\n      // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—á–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞ –¥–ª—è –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞\n      addToTimeline(draggedItem, clickTime, targetTrackId);\n    }\n  }, [isDragging, isTimelineDragging, isResizing, draggedItem, getTargetTrackForType, addToTimeline]);\n\n  // –£–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–æ—Ä–æ–∂–∫—É (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ MediaLibrary)\n  const smartAddToTimeline = useCallback((item, specifiedTime = null, specifiedTrackId = null) => {\n    console.log(`–£–º–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ \"${item.name}\" —Ç–∏–ø–∞ \"${item.type}\"`);\n\n    // –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö\n    if (specifiedTime !== null && specifiedTrackId !== null) {\n      console.log(`–ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –≤—Ä–µ–º—è=${specifiedTime}, –¥–æ—Ä–æ–∂–∫–∞=${specifiedTrackId}`);\n      addToTimeline(item, specifiedTime, specifiedTrackId);\n      return;\n    }\n\n    // –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–º–Ω—É—é –ª–æ–≥–∏–∫—É\n    const targetTrackId = specifiedTrackId || getTargetTrackForType(item.type);\n    if (!targetTrackId) {\n      console.error(`–ù–µ –Ω–∞–π–¥–µ–Ω–∞ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è —Ç–∏–ø–∞ ${item.type}`);\n      return;\n    }\n    const bestPosition = specifiedTime !== null ? specifiedTime : findBestPositionForItem(item, targetTrackId);\n    console.log(`–î–æ–±–∞–≤–ª—è–µ–º \"${item.name}\" –Ω–∞ –¥–æ—Ä–æ–∂–∫—É ${targetTrackId} –≤ –ø–æ–∑–∏—Ü–∏—é ${bestPosition}`);\n\n    // –ù–∞—Ö–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Ä–æ–∂–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏\n    const targetTrack = [...tracks.overlays, ...tracks.main, ...tracks.audio].find(track => track.id === targetTrackId);\n    console.log(`–î–æ—Ä–æ–∂–∫–∞ –Ω–∞–π–¥–µ–Ω–∞:`, targetTrack);\n    addToTimeline(item, bestPosition, targetTrackId);\n  }, [addToTimeline, getTargetTrackForType, findBestPositionForItem, tracks]);\n  const handleTimelineItemDragStart = (e, timelineItem) => {\n    if (isResizing) {\n      e.preventDefault();\n      return;\n    }\n    e.stopPropagation();\n    setDraggedTimelineItem(timelineItem);\n    setIsTimelineDragging(true);\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const itemRect = e.target.getBoundingClientRect();\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleTimelineItemDragEnd = () => {\n    setDraggedTimelineItem(null);\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n    setDragOffset(0);\n    stopAutoScroll();\n  };\n  const handleDragOver = e => {\n    if (!draggedItem && !draggedTimelineItem) return;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\n    if (draggedTimelineItem || isResizing) {\n      checkAutoScroll(e.clientX);\n    }\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\n    const pixelsPerSecond = getPixelsPerSecond();\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\n    const trackHeight = 60;\n    const timeRulerHeight = 48;\n    const relativeY = dragY - timeRulerHeight;\n    const trackIndex = Math.floor(relativeY / trackHeight);\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const targetTrack = allTracks[trackIndex];\n    if (draggedItem && targetTrack) {\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\n      setDropPreview({\n        time: insertResult.time,\n        duration: duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    } else if (draggedTimelineItem && targetTrack) {\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, draggedTimelineItem.duration, draggedTimelineItem.id);\n      setDropPreview({\n        time: insertResult.time,\n        duration: draggedTimelineItem.duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    }\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    stopAutoScroll();\n\n    // –ï—Å–ª–∏ –Ω–µ—Ç –≤–∞–ª–∏–¥–Ω–æ–≥–æ preview, –Ω–æ –µ—Å—Ç—å draggedItem - –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–º–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\n    if (!dropPreview && draggedItem) {\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\n      if (targetTrackId) {\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\n        addToTimeline(draggedItem, bestPosition, targetTrackId);\n      }\n      setDropPreview(null);\n      setIsTimelineDragging(false);\n      return;\n    }\n    if (!draggedItem && !draggedTimelineItem || !dropPreview) return;\n    if (dropPreview.isValid) {\n      if (draggedItem) {\n        var _dropPreview$affected;\n        if (dropPreview.shouldRipple && ((_dropPreview$affected = dropPreview.affectedItems) === null || _dropPreview$affected === void 0 ? void 0 : _dropPreview$affected.length) > 0) {\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\n        }\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\n      } else if (draggedTimelineItem) {\n        var _dropPreview$affected2;\n        if (dropPreview.shouldRipple && ((_dropPreview$affected2 = dropPreview.affectedItems) === null || _dropPreview$affected2 === void 0 ? void 0 : _dropPreview$affected2.length) > 0) {\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\n        }\n        setTimelineItems(prev => prev.map(item => item.id === draggedTimelineItem.id ? {\n          ...item,\n          startTime: dropPreview.time,\n          trackId: dropPreview.trackId,\n          trackType: dropPreview.trackType\n        } : item));\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\n        if (newEndTime > videoDuration) {\n          setVideoDuration(newEndTime + 10);\n        }\n      }\n    }\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n  };\n  const handleDragLeave = e => {\n    var _timelineRef$current;\n    if (!((_timelineRef$current = timelineRef.current) !== null && _timelineRef$current !== void 0 && _timelineRef$current.contains(e.relatedTarget))) {\n      setDropPreview(null);\n      stopAutoScroll();\n    }\n  };\n  const getTimelineItemStyle = item => {\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${item.startTime * pixelsPerSecond}px`,\n      width: `${item.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getDropPreviewStyle = () => {\n    if (!dropPreview) return {};\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${dropPreview.time * pixelsPerSecond}px`,\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getTrackColor = trackType => {\n    switch (trackType) {\n      case \"overlay\":\n        return \"bg-purple-500 border-purple-400\";\n      case \"main\":\n        return \"bg-blue-500 border-blue-400\";\n      case \"audio\":\n        return \"bg-green-500 border-green-400\";\n      default:\n        return \"bg-gray-500 border-gray-400\";\n    }\n  };\n\n  // –≠—Ñ—Ñ–µ–∫—Ç—ã\n  useEffect(() => {\n    const handleMouseMove = e => {\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\n      checkAutoScroll(e.clientX);\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const pixelsPerSecond = getPixelsPerSecond();\n      const newTime = mouseX / pixelsPerSecond;\n      setTimelineItems(prev => prev.map(item => {\n        if (item.id !== resizeItem.id) return item;\n        const minDuration = 0.1;\n        if (resizeHandle === \"left\") {\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\n          const newDuration = rightEdge - newStartTime;\n          return {\n            ...item,\n            startTime: newStartTime,\n            duration: newDuration\n          };\n        } else if (resizeHandle === \"right\") {\n          const leftEdge = originalItemData.startTime;\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\n          const newDuration = newEndTime - leftEdge;\n          return {\n            ...item,\n            duration: newDuration\n          };\n        }\n        return item;\n      }));\n    };\n    const handleMouseUp = () => {\n      if (isResizing) {\n        handleResizeEnd();\n      }\n    };\n    if (isResizing) {\n      document.addEventListener(\"mousemove\", handleMouseMove);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n    return () => {\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n    };\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd, setTimelineItems]);\n\n  // –ü–µ—Ä–µ–¥–∞–µ–º smartAddToTimeline –Ω–∞—Ä—É–∂—É —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫\n  useEffect(() => {\n    if (onSmartAddToTimeline) {\n      onSmartAddToTimeline(smartAddToTimeline);\n    }\n  }, [onSmartAddToTimeline, smartAddToTimeline]);\n\n  // –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É–¥–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —ç–ª–µ–º–µ–Ω—Ç\n  useEffect(() => {\n    if (draggedItem) {\n      console.log(`=== –û–¢–õ–ê–î–ö–ê DRAGGEDITEM ===`);\n      console.log(`–≠–ª–µ–º–µ–Ω—Ç: \"${draggedItem.name}\", —Ç–∏–ø: \"${draggedItem.type}\"`);\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\n      const targetTrack = [...tracks.overlays, ...tracks.main, ...tracks.audio].find(track => track.id === targetTrackId);\n      console.log(`–¶–µ–ª–µ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ID: ${targetTrackId}`);\n      console.log(`–¶–µ–ª–µ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ –æ–±—ä–µ–∫—Ç:`, targetTrack);\n      if (targetTrack) {\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\n        console.log(`–ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –¥–æ—Ä–æ–∂–∫—É \"${targetTrack.name}\" –≤ –ø–æ–∑–∏—Ü–∏—é ${formatTime(bestPosition)}`);\n      } else {\n        console.error(`–î–æ—Ä–æ–∂–∫–∞ —Å ID ${targetTrackId} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!`);\n      }\n      console.log(`=== –ö–û–ù–ï–¶ –û–¢–õ–ê–î–ö–ò ===`);\n    }\n  }, [draggedItem, tracks, getTargetTrackForType, findBestPositionForItem, formatTime]);\n  useEffect(() => {\n    return () => {\n      stopAutoScroll();\n    };\n  }, [stopAutoScroll]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${isDragging || isTimelineDragging || isResizing ? \"border-blue-400 bg-blue-50/20\" : \"border-gray-200\"}`,\n    onWheel: handleWheel,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 p-4 border-b border-gray-200 space-y-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(Film, {\n            size: 18\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 717,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Timeline Pro\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 718,\n            columnNumber: 13\n          }, this), draggedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-blue-600 text-sm\",\n            children: [\"- \\u0413\\u043E\\u0442\\u043E\\u0432 \\u0434\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C: \\\"\", draggedItem.name, \"\\\" \\u043D\\u0430 \", draggedItem.type === 'video' ? 'Main Video' : draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' : 'Overlay', \" \\u0434\\u043E\\u0440\\u043E\\u0436\\u043A\\u0443\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 720,\n            columnNumber: 15\n          }, this), isDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-green-600\",\n            children: [\"- Adding \\\"\", draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.name, \"\\\"\", \" \", dropPreview.shouldRipple ? \"‚ö° ripple\" : \"üìç exact\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 729,\n            columnNumber: 15\n          }, this), isTimelineDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-blue-600\",\n            children: [\"- Moving \\\"\", draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.name, \"\\\"\", \" \", dropPreview.shouldRipple ? \"‚ö° push blocks\" : \"üìç exact\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 735,\n            columnNumber: 15\n          }, this), isResizing && resizeItem && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-orange-600\",\n            children: [\"- Trimming \\\"\", resizeItem.name, \"\\\" (\", resizeHandle, \" edge)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 741,\n            columnNumber: 15\n          }, this), copiedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-blue-600 text-sm\",\n            children: [\"- \\\"\", copiedItem.name, \"\\\" copied (Ctrl+V to paste)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 746,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 716,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: zoomOut,\n              className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n              title: \"Zoom Out (-)\",\n              children: /*#__PURE__*/_jsxDEV(ZoomOut, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 759,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 754,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500 min-w-12 text-center\",\n              children: [(timelineZoom * 100).toFixed(0), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 761,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: zoomIn,\n              className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n              title: \"Zoom In (+), or Ctrl+Wheel\",\n              children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 769,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: resetZoom,\n              className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n              title: \"Reset Zoom (0)\",\n              children: /*#__PURE__*/_jsxDEV(RotateCcw, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 776,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 771,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n              title: `–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:\n‚Ä¢ Ctrl + –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –ó—É–º (—Ñ–æ–∫—É—Å –Ω–∞ –∫—É—Ä—Å–æ—Ä)\n‚Ä¢ Shift + –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\n‚Ä¢ –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\n‚Ä¢ –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ - –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞\n‚Ä¢ Ctrl + C - –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å\n‚Ä¢ Ctrl + V - –í—Å—Ç–∞–≤–∏—Ç—å\n‚Ä¢ Ctrl + B - –†–∞–∑—Ä–µ–∑–∞—Ç—å\n‚Ä¢ Del/Backspace - –£–¥–∞–ª–∏—Ç—å\n‚Ä¢ + - –ü—Ä–∏–±–ª–∏–∑–∏—Ç—å\n‚Ä¢ - - –û—Ç–¥–∞–ª–∏—Ç—å\n‚Ä¢ 0 - –°–±—Ä–æ—Å–∏—Ç—å –∑—É–º\n\n–£–º–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ:\n‚Ä¢ –í–∏–¥–µ–æ ‚Üí Main –¥–æ—Ä–æ–∂–∫–∞\n‚Ä¢ –ê—É–¥–∏–æ ‚Üí Audio –¥–æ—Ä–æ–∂–∫–∞  \n‚Ä¢ –ö–∞—Ä—Ç–∏–Ω–∫–∏/–¢–µ–∫—Å—Ç ‚Üí Overlay –¥–æ—Ä–æ–∂–∫–∞\n‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ª—É—á—à–µ–π –ø–æ–∑–∏—Ü–∏–∏\n‚Ä¢ –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞`,\n              children: /*#__PURE__*/_jsxDEV(HelpCircle, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 800,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 778,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 753,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 752,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 715,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addOverlayTrack,\n              className: \"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\",\n              title: \"Add Overlay Track\",\n              children: /*#__PURE__*/_jsxDEV(Plus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 814,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 809,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addAudioTrack,\n              className: \"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\",\n              title: \"Add Audio Track\",\n              children: /*#__PURE__*/_jsxDEV(Music, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 821,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 816,\n              columnNumber: 15\n            }, this), draggedItem && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addToTimelineAtCurrentTime,\n              className: \"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200 animate-pulse bg-blue-100\",\n              title: `–î–æ–±–∞–≤–∏—Ç—å \"${draggedItem.name}\" –Ω–∞ ${draggedItem.type === 'video' ? 'Main Video' : draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' : 'Overlay'} –¥–æ—Ä–æ–∂–∫—É –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é`,\n              children: /*#__PURE__*/_jsxDEV(Plus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 833,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 824,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: splitTimelineItem,\n              disabled: !selectedTimelineItem,\n              className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n              title: \"Split Selected Item (Ctrl+B) - Cuts item at current time\",\n              children: /*#__PURE__*/_jsxDEV(Scissors, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 846,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 836,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: copyTimelineItem,\n              disabled: !selectedTimelineItem,\n              className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n              title: \"Copy Selected Item (Ctrl+C) - Copy item to clipboard\",\n              children: /*#__PURE__*/_jsxDEV(Copy, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 858,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 848,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: pasteTimelineItem,\n              disabled: !copiedItem,\n              className: `p-2 rounded-xl transition-all duration-200 ${copiedItem ? \"text-green-600 hover:text-green-800 hover:bg-green-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n              title: \"Paste Item (Ctrl+V) - Paste copied item\",\n              children: /*#__PURE__*/_jsxDEV(Copy, {\n                size: 16,\n                className: \"rotate-180\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 870,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 860,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: deleteSelectedItem,\n              disabled: !selectedTimelineItem,\n              className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n              title: \"Delete Selected Item (Del/Backspace) - Remove from timeline\",\n              children: /*#__PURE__*/_jsxDEV(Trash2, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 882,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 872,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 808,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 807,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 806,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 714,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex min-h-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-12 border-b border-gray-200 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 891,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: trackLabelsRef,\n          className: \"flex-1 overflow-y-auto overflow-x-hidden\",\n          onScroll: handleTrackLabelsScroll,\n          children: [tracks.overlays.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\",\n            style: {\n              height: \"60px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Layers, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 904,\n              columnNumber: 17\n            }, this), track.name]\n          }, track.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 899,\n            columnNumber: 15\n          }, this)), tracks.main.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\",\n            style: {\n              height: \"60px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Video, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 915,\n              columnNumber: 17\n            }, this), track.name]\n          }, track.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 910,\n            columnNumber: 15\n          }, this)), tracks.audio.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\",\n            style: {\n              height: \"60px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Music, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 926,\n              columnNumber: 17\n            }, this), track.name]\n          }, track.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 921,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 893,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 890,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: el => {\n          timelineRef.current = el;\n          timelineScrollRef.current = el;\n        },\n        className: \"flex-1 relative overflow-auto bg-white\",\n        onScroll: handleTrackAreaScroll,\n        onDragOver: handleDragOver,\n        onDrop: handleDrop,\n        onDragLeave: handleDragLeave,\n        style: {\n          overflowX: \"auto\",\n          overflowY: \"auto\",\n          scrollbarWidth: \"thin\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: `${getTimelineWidth()}px`,\n            minHeight: \"100%\",\n            position: \"relative\"\n          },\n          onClick: handleTimelineClick,\n          onDoubleClick: handleTimelineDoubleClick,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\",\n            children: [Array.from({\n              length: Math.ceil(videoDuration * timelineZoom / 5) + 1\n            }, (_, i) => {\n              const timeValue = i * 5 / timelineZoom;\n              const pixelsPerSecond = getPixelsPerSecond();\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-0 h-full border-l border-gray-300\",\n                style: {\n                  left: `${timeValue * pixelsPerSecond}px`\n                },\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\",\n                  children: formatTime(timeValue)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 970,\n                  columnNumber: 23\n                }, this)\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 965,\n                columnNumber: 21\n              }, this);\n            }), timelineZoom > 2 && Array.from({\n              length: Math.ceil(videoDuration * timelineZoom) + 1\n            }, (_, i) => {\n              const timeValue = i / timelineZoom;\n              const pixelsPerSecond = getPixelsPerSecond();\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-8 w-0 h-4 border-l border-gray-200\",\n                style: {\n                  left: `${timeValue * pixelsPerSecond}px`\n                }\n              }, `sub-${i}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 985,\n                columnNumber: 23\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\",\n              style: {\n                left: `${currentTime * getPixelsPerSecond()}px`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 994,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 958,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative flex-1\",\n            style: {\n              height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\n              minHeight: \"100%\"\n            },\n            children: [timelineItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(item.trackType)} ${(selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === item.id ? \"ring-2 ring-blue-300\" : \"\"} ${(draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.id) === item.id ? \"opacity-50 z-30\" : \"\"} ${(copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"}`,\n              style: getTimelineItemStyle(item),\n              onClick: e => {\n                e.stopPropagation();\n                setSelectedTimelineItem(item);\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\",\n                onMouseDown: e => handleResizeStart(e, item, \"left\"),\n                title: \"Trim start - Drag to adjust start time\",\n                style: {\n                  background: \"linear-gradient(to right, rgba(255,255,255,0.8), transparent)\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1045,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1036,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                draggable: \"true\",\n                onDragStart: e => handleTimelineItemDragStart(e, item),\n                onDragEnd: handleTimelineItemDragEnd,\n                className: \"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\",\n                title: \"Drag to move item on timeline - Ripple mode: pushes other blocks\",\n                children: [item.name, (copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2 text-green-200\",\n                  children: \"\\uD83D\\uDCCB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1057,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1048,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\",\n                onMouseDown: e => handleResizeStart(e, item, \"right\"),\n                title: \"Trim end - Drag to adjust duration\",\n                style: {\n                  background: \"linear-gradient(to left, rgba(255,255,255,0.8), transparent)\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1070,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1061,\n                columnNumber: 19\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1015,\n              columnNumber: 17\n            }, this)), dropPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `absolute h-10 rounded-lg border-2 transition-all ${dropPreview.isValid ? dropPreview.isExact ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse` : \"bg-red-300 border-red-500 border-dashed\"}`,\n              style: getDropPreviewStyle(),\n              children: dropPreview.isValid && !dropPreview.isExact && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center h-full text-white text-xs font-bold\",\n                children: \"\\uD83E\\uDDF2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1091,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1076,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1002,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 933,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 889,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 706,\n    columnNumber: 5\n  }, this);\n};\n_s(Timeline, \"Yj2nxar7aXsJSTqy2W61NeZD3kI=\");\n_c = Timeline;\nvar _c;\n$RefreshReg$(_c, \"Timeline\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Video","Music","Copy","Trash2","Scissors","Film","Plus","Layers","ZoomIn","ZoomOut","RotateCcw","HelpCircle","jsxDEV","_jsxDEV","Timeline","timelineItems","setTimelineItems","currentTime","videoDuration","setVideoDuration","selectedTimelineItem","setSelectedTimelineItem","timelineZoom","setTimelineZoom","tracks","setTracks","draggedItem","draggedTimelineItem","setDraggedTimelineItem","dropPreview","setDropPreview","isDragging","isTimelineDragging","setIsTimelineDragging","isResizing","setIsResizing","copiedItem","formatTime","seekTo","splitTimelineItem","copyTimelineItem","pasteTimelineItem","deleteSelectedItem","addToTimeline","insertWithRipple","applyRippleEffect","removeFromTimeline","onSmartAddToTimeline","_s","timelineRef","timelineScrollRef","trackLabelsRef","autoScrollIntervalRef","dragOffset","setDragOffset","resizeHandle","setResizeHandle","resizeItem","setResizeItem","originalItemData","setOriginalItemData","stopAutoScroll","current","clearInterval","startAutoScroll","direction","speed","setInterval","scrollAmount","currentScrollLeft","scrollLeft","maxScroll","scrollWidth","clientWidth","Math","max","min","checkAutoScroll","clientX","rect","getBoundingClientRect","scrollZoneWidth","relativeX","left","width","getTargetTrackForType","mediaType","_tracks$main","_tracks$audio","_tracks$overlays","_tracks$main2","_tracks$main2$","mainTrack","main","console","log","id","audioTrack","audio","overlayTrack","overlays","addToTimelineAtCurrentTime","targetTrackId","type","bestPosition","findBestPositionForItem","item","duration","itemsOnTrack","filter","timelineItem","trackId","sort","a","b","startTime","length","hasSpaceAtCurrentTime","some","existingItem","existingStart","existingEnd","newStart","newEnd","lastItem","handleWheel","e","ctrlKey","preventDefault","mouseX","currentPixelsPerSecond","timeAtMouse","zoomDirection","deltaY","zoomStep","prevZoom","newZoom","requestAnimationFrame","newPixelsPerSecond","newMouseX","targetScrollLeft","shiftKey","zoomIn","prev","zoomOut","resetZoom","handleResizeStart","handle","stopPropagation","handleResizeEnd","addOverlayTrack","newTrackId","Date","now","name","addAudioTrack","handleTrackAreaScroll","scrollTop","target","handleTrackLabelsScroll","getTimelineWidth","baseWidth","getPixelsPerSecond","handleTimelineClick","clickX","pixelsPerSecond","clickTime","handleTimelineDoubleClick","smartAddToTimeline","specifiedTime","specifiedTrackId","error","targetTrack","find","track","handleTimelineItemDragStart","itemRect","dataTransfer","effectAllowed","setData","handleTimelineItemDragEnd","handleDragOver","dropEffect","timelineRect","dragX","dropTime","dragY","clientY","top","trackHeight","timeRulerHeight","relativeY","trackIndex","floor","allTracks","insertResult","time","trackType","isValid","shouldRipple","affectedItems","handleDrop","_dropPreview$affected","_dropPreview$affected2","map","newEndTime","handleDragLeave","_timelineRef$current","contains","relatedTarget","getTimelineItemStyle","findIndex","getDropPreviewStyle","getTrackColor","handleMouseMove","newTime","minDuration","rightEdge","newStartTime","newDuration","leftEdge","handleMouseUp","document","addEventListener","removeEventListener","className","onWheel","children","size","fileName","_jsxFileName","lineNumber","columnNumber","onClick","title","toFixed","disabled","ref","onScroll","style","height","el","onDragOver","onDrop","onDragLeave","overflowX","overflowY","scrollbarWidth","minHeight","position","onDoubleClick","Array","from","ceil","_","i","timeValue","onMouseDown","background","draggable","onDragStart","onDragEnd","isExact","_c","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/Timeline.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Video,\r\n  Music,\r\n  Copy,\r\n  Trash2,\r\n  Scissors,\r\n  Film,\r\n  Plus,\r\n  Layers,\r\n  ZoomIn,\r\n  ZoomOut,\r\n  RotateCcw,\r\n  HelpCircle,\r\n} from \"lucide-react\";\r\n\r\nexport const Timeline = ({\r\n  timelineItems,\r\n  setTimelineItems,\r\n  currentTime,\r\n  videoDuration,\r\n  setVideoDuration,\r\n  selectedTimelineItem,\r\n  setSelectedTimelineItem,\r\n  timelineZoom,\r\n  setTimelineZoom,\r\n  tracks,\r\n  setTracks,\r\n  draggedItem,\r\n  draggedTimelineItem,\r\n  setDraggedTimelineItem,\r\n  dropPreview,\r\n  setDropPreview,\r\n  isDragging,\r\n  isTimelineDragging,\r\n  setIsTimelineDragging,\r\n  isResizing,\r\n  setIsResizing,\r\n  copiedItem,\r\n  formatTime,\r\n  seekTo,\r\n  splitTimelineItem,\r\n  copyTimelineItem,\r\n  pasteTimelineItem,\r\n  deleteSelectedItem,\r\n  addToTimeline,\r\n  insertWithRipple,\r\n  applyRippleEffect,\r\n  removeFromTimeline,\r\n  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞—Ä—É–∂—É\r\n  onSmartAddToTimeline,\r\n}) => {\r\n  const timelineRef = useRef(null);\r\n  const timelineScrollRef = useRef(null);\r\n  const trackLabelsRef = useRef(null);\r\n  const autoScrollIntervalRef = useRef(null);\r\n\r\n  // Timeline-specific states\r\n  const [dragOffset, setDragOffset] = useState(0);\r\n  const [resizeHandle, setResizeHandle] = useState(null);\r\n  const [resizeItem, setResizeItem] = useState(null);\r\n  const [originalItemData, setOriginalItemData] = useState(null);\r\n\r\n  // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞\r\n  const stopAutoScroll = useCallback(() => {\r\n    if (autoScrollIntervalRef.current) {\r\n      clearInterval(autoScrollIntervalRef.current);\r\n      autoScrollIntervalRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const startAutoScroll = useCallback(\r\n    (direction, speed = 1) => {\r\n      stopAutoScroll();\r\n\r\n      autoScrollIntervalRef.current = setInterval(() => {\r\n        if (timelineScrollRef.current) {\r\n          const scrollAmount = 15 * speed;\r\n          const currentScrollLeft = timelineScrollRef.current.scrollLeft;\r\n          const maxScroll =\r\n            timelineScrollRef.current.scrollWidth -\r\n            timelineScrollRef.current.clientWidth;\r\n\r\n          if (direction === \"left\" && currentScrollLeft > 0) {\r\n            timelineScrollRef.current.scrollLeft = Math.max(\r\n              0,\r\n              currentScrollLeft - scrollAmount\r\n            );\r\n          } else if (direction === \"right\" && currentScrollLeft < maxScroll) {\r\n            timelineScrollRef.current.scrollLeft = Math.min(\r\n              maxScroll,\r\n              currentScrollLeft + scrollAmount\r\n            );\r\n          }\r\n        }\r\n      }, 16);\r\n    },\r\n    [stopAutoScroll]\r\n  );\r\n\r\n  const checkAutoScroll = useCallback(\r\n    (clientX) => {\r\n      if (!timelineScrollRef.current) return;\r\n\r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const scrollZoneWidth = 120;\r\n      const relativeX = clientX - rect.left;\r\n\r\n      if (\r\n        relativeX < scrollZoneWidth &&\r\n        timelineScrollRef.current.scrollLeft > 0\r\n      ) {\r\n        const speed = ((scrollZoneWidth - relativeX) / scrollZoneWidth) * 3;\r\n        startAutoScroll(\"left\", speed);\r\n      } else if (relativeX > rect.width - scrollZoneWidth) {\r\n        const maxScroll =\r\n          timelineScrollRef.current.scrollWidth -\r\n          timelineScrollRef.current.clientWidth;\r\n        if (timelineScrollRef.current.scrollLeft < maxScroll) {\r\n          const speed =\r\n            ((relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth) *\r\n            3;\r\n          startAutoScroll(\"right\", speed);\r\n        }\r\n      } else {\r\n        stopAutoScroll();\r\n      }\r\n    },\r\n    [startAutoScroll, stopAutoScroll]\r\n  );\r\n\r\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ä–æ–∂–∫–∏ –ø–æ —Ç–∏–ø—É –º–µ–¥–∏–∞\r\n  const getTargetTrackForType = useCallback((mediaType) => {\r\n    \r\n    switch (mediaType) {\r\n      case \"video\":\r\n        const mainTrack = tracks.main?.[0];\r\n        console.log(`Main –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –≤–∏–¥–µ–æ:`, mainTrack);\r\n        return mainTrack?.id;\r\n      case \"audio\":\r\n      case \"music\":\r\n        const audioTrack = tracks.audio?.[0];\r\n        console.log(`Audio –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –∞—É–¥–∏–æ:`, audioTrack);\r\n        return audioTrack?.id;\r\n      case \"image\":\r\n      case \"text\":\r\n        const overlayTrack = tracks.overlays?.[0];\r\n        console.log(`Overlay –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏/—Ç–µ–∫—Å—Ç–∞:`, overlayTrack);\r\n        return overlayTrack?.id;\r\n      default:\r\n        console.log(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø ${mediaType}, –∏—Å–ø–æ–ª—å–∑—É–µ–º main –¥–æ—Ä–æ–∂–∫—É`);\r\n        return tracks.main?.[0]?.id;\r\n    }\r\n  }, [tracks]);\r\n\r\n  // –£–º–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–æ—Ä–æ–∂–∫–µ\r\n  const addToTimelineAtCurrentTime = useCallback(() => {\r\n    if (!draggedItem) return;\r\n    \r\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n    if (!targetTrackId) return;\r\n    \r\n    // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\r\n    const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\r\n    addToTimeline(draggedItem, bestPosition, targetTrackId);\r\n  }, [draggedItem, getTargetTrackForType, addToTimeline]);\r\n\r\n  // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞\r\n  const findBestPositionForItem = useCallback((item, targetTrackId) => {\r\n    const duration = item.duration || (item.type === \"image\" ? 5 : 10);\r\n    \r\n    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ä–æ–∂–∫–µ\r\n    const itemsOnTrack = timelineItems\r\n      .filter(timelineItem => timelineItem.trackId === targetTrackId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n    \r\n    // –ï—Å–ª–∏ –Ω–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ, —Ä–∞–∑–º–µ—â–∞–µ–º –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏\r\n    if (itemsOnTrack.length === 0) {\r\n      return currentTime;\r\n    }\r\n    \r\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–µ—Å—Ç–æ –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏\r\n    const hasSpaceAtCurrentTime = !itemsOnTrack.some(existingItem => {\r\n      const existingStart = existingItem.startTime;\r\n      const existingEnd = existingItem.startTime + existingItem.duration;\r\n      const newStart = currentTime;\r\n      const newEnd = currentTime + duration;\r\n      \r\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ\r\n      return !(newEnd <= existingStart || newStart >= existingEnd);\r\n    });\r\n    \r\n    if (hasSpaceAtCurrentTime) {\r\n      return currentTime;\r\n    }\r\n    \r\n    // –ï—Å–ª–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç –º–µ—Å—Ç–∞, —Ä–∞–∑–º–µ—â–∞–µ–º –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞\r\n    const lastItem = itemsOnTrack[itemsOnTrack.length - 1];\r\n    return lastItem.startTime + lastItem.duration;\r\n  }, [timelineItems, currentTime]);\r\n\r\n  // –ó—É–º –∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏ –∫–∞–∫ –≤ CapCut\r\n  const handleWheel = useCallback((e) => {\r\n    if (e.ctrlKey) {\r\n      // Ctrl + –∫–æ–ª–µ—Å–æ = –∑—É–º —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∫—É—Ä—Å–æ—Ä\r\n      e.preventDefault();\r\n      \r\n      if (!timelineScrollRef.current) return;\r\n      \r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const currentPixelsPerSecond = 50 * timelineZoom;\r\n      const timeAtMouse = mouseX / currentPixelsPerSecond;\r\n      \r\n      const zoomDirection = e.deltaY < 0 ? 1 : -1;\r\n      const zoomStep = 1.2;\r\n      \r\n      setTimelineZoom((prevZoom) => {\r\n        let newZoom;\r\n        if (zoomDirection > 0) {\r\n          newZoom = Math.min(20, prevZoom * zoomStep);\r\n        } else {\r\n          newZoom = Math.max(0.1, prevZoom / zoomStep);\r\n        }\r\n        \r\n        requestAnimationFrame(() => {\r\n          if (timelineScrollRef.current) {\r\n            const newPixelsPerSecond = 50 * newZoom;\r\n            const newMouseX = timeAtMouse * newPixelsPerSecond;\r\n            const targetScrollLeft = newMouseX - (e.clientX - rect.left);\r\n            timelineScrollRef.current.scrollLeft = Math.max(0, targetScrollLeft);\r\n          }\r\n        });\r\n        \r\n        return newZoom;\r\n      });\r\n    } else if (e.shiftKey) {\r\n      // Shift + –∫–æ–ª–µ—Å–æ = –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\r\n      e.preventDefault();\r\n      \r\n      if (timelineScrollRef.current) {\r\n        const scrollAmount = e.deltaY * 2;\r\n        timelineScrollRef.current.scrollLeft += scrollAmount;\r\n      }\r\n    }\r\n  }, [timelineZoom, setTimelineZoom]);\r\n\r\n  // –§—É–Ω–∫—Ü–∏–∏ –∑—É–º–∞\r\n  const zoomIn = () => {\r\n    setTimelineZoom((prev) => Math.min(20, prev * 1.5));\r\n  };\r\n\r\n  const zoomOut = () => {\r\n    setTimelineZoom((prev) => Math.max(0.1, prev / 1.5));\r\n  };\r\n\r\n  const resetZoom = () => {\r\n    setTimelineZoom(1);\r\n  };\r\n\r\n  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è resize\r\n  const handleResizeStart = useCallback(\r\n    (e, item, handle) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      setIsResizing(true);\r\n      setResizeHandle(handle);\r\n      setResizeItem(item);\r\n      setOriginalItemData({\r\n        startTime: item.startTime,\r\n        duration: item.duration,\r\n      });\r\n\r\n      setIsTimelineDragging(false);\r\n      setDraggedTimelineItem(null);\r\n    },\r\n    [setIsResizing, setIsTimelineDragging, setDraggedTimelineItem]\r\n  );\r\n\r\n  const handleResizeEnd = useCallback(() => {\r\n    setIsResizing(false);\r\n    setResizeHandle(null);\r\n    setResizeItem(null);\r\n    setOriginalItemData(null);\r\n    stopAutoScroll();\r\n  }, [setIsResizing, stopAutoScroll]);\r\n\r\n  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤\r\n  const addOverlayTrack = () => {\r\n    const newTrackId = `overlay-${Date.now()}`;\r\n    setTracks((prev) => ({\r\n      ...prev,\r\n      overlays: [\r\n        ...prev.overlays,\r\n        {\r\n          id: newTrackId,\r\n          name: `Overlay ${prev.overlays.length + 1}`,\r\n          type: \"overlay\",\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  const addAudioTrack = () => {\r\n    const newTrackId = `audio-${Date.now()}`;\r\n    setTracks((prev) => ({\r\n      ...prev,\r\n      audio: [\r\n        ...prev.audio,\r\n        {\r\n          id: newTrackId,\r\n          name: `Audio ${prev.audio.length + 1}`,\r\n          type: \"audio\",\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞\r\n  const handleTrackAreaScroll = (e) => {\r\n    if (trackLabelsRef.current) {\r\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const handleTrackLabelsScroll = (e) => {\r\n    if (timelineScrollRef.current) {\r\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const getTimelineWidth = () => {\r\n    const baseWidth = videoDuration * 50 * timelineZoom;\r\n    return Math.max(baseWidth, 2000);\r\n  };\r\n\r\n  const getPixelsPerSecond = () => {\r\n    return 50 * timelineZoom;\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π\r\n  const handleTimelineClick = (e) => {\r\n    if (isDragging || isTimelineDragging || isResizing) return;\r\n\r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    seekTo(clickTime);\r\n  };\r\n\r\n  const handleTimelineDoubleClick = useCallback((e) => {\r\n    if (isDragging || isTimelineDragging || isResizing || !draggedItem) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    \r\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n    if (targetTrackId) {\r\n      // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—á–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞ –¥–ª—è –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞\r\n      addToTimeline(draggedItem, clickTime, targetTrackId);\r\n    }\r\n  }, [isDragging, isTimelineDragging, isResizing, draggedItem, getTargetTrackForType, addToTimeline]);\r\n\r\n  // –£–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–æ—Ä–æ–∂–∫—É (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ MediaLibrary)\r\n  const smartAddToTimeline = useCallback((item, specifiedTime = null, specifiedTrackId = null) => {\r\n    console.log(`–£–º–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ \"${item.name}\" —Ç–∏–ø–∞ \"${item.type}\"`);\r\n    \r\n    // –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö\r\n    if (specifiedTime !== null && specifiedTrackId !== null) {\r\n      console.log(`–ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –≤—Ä–µ–º—è=${specifiedTime}, –¥–æ—Ä–æ–∂–∫–∞=${specifiedTrackId}`);\r\n      addToTimeline(item, specifiedTime, specifiedTrackId);\r\n      return;\r\n    }\r\n    \r\n    // –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–º–Ω—É—é –ª–æ–≥–∏–∫—É\r\n    const targetTrackId = specifiedTrackId || getTargetTrackForType(item.type);\r\n    if (!targetTrackId) {\r\n      console.error(`–ù–µ –Ω–∞–π–¥–µ–Ω–∞ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–æ—Ä–æ–∂–∫–∞ –¥–ª—è —Ç–∏–ø–∞ ${item.type}`);\r\n      return;\r\n    }\r\n    \r\n    const bestPosition = specifiedTime !== null ? specifiedTime : findBestPositionForItem(item, targetTrackId);\r\n    console.log(`–î–æ–±–∞–≤–ª—è–µ–º \"${item.name}\" –Ω–∞ –¥–æ—Ä–æ–∂–∫—É ${targetTrackId} –≤ –ø–æ–∑–∏—Ü–∏—é ${bestPosition}`);\r\n    \r\n    // –ù–∞—Ö–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Ä–æ–∂–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏\r\n    const targetTrack = [...tracks.overlays, ...tracks.main, ...tracks.audio]\r\n      .find(track => track.id === targetTrackId);\r\n    console.log(`–î–æ—Ä–æ–∂–∫–∞ –Ω–∞–π–¥–µ–Ω–∞:`, targetTrack);\r\n    \r\n    addToTimeline(item, bestPosition, targetTrackId);\r\n  }, [addToTimeline, getTargetTrackForType, findBestPositionForItem, tracks]);\r\n\r\n  const handleTimelineItemDragStart = (e, timelineItem) => {\r\n    if (isResizing) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n\r\n    e.stopPropagation();\r\n    setDraggedTimelineItem(timelineItem);\r\n    setIsTimelineDragging(true);\r\n\r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const itemRect = e.target.getBoundingClientRect();\r\n    setDragOffset(\r\n      e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft\r\n    );\r\n\r\n    e.dataTransfer.effectAllowed = \"move\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleTimelineItemDragEnd = () => {\r\n    setDraggedTimelineItem(null);\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n    setDragOffset(0);\r\n    stopAutoScroll();\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (!draggedItem && !draggedTimelineItem) return;\r\n\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\r\n\r\n    if (draggedTimelineItem || isResizing) {\r\n      checkAutoScroll(e.clientX);\r\n    }\r\n\r\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\r\n    const dragX =\r\n      e.clientX -\r\n      timelineRect.left +\r\n      timelineScrollRef.current.scrollLeft -\r\n      (draggedTimelineItem ? dragOffset : 0);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\r\n\r\n    const dragY =\r\n      e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\r\n    const trackHeight = 60;\r\n    const timeRulerHeight = 48;\r\n\r\n    const relativeY = dragY - timeRulerHeight;\r\n    const trackIndex = Math.floor(relativeY / trackHeight);\r\n\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const targetTrack = allTracks[trackIndex];\r\n\r\n    if (draggedItem && targetTrack) {\r\n      const duration =\r\n        draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\r\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\r\n\r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || [],\r\n      });\r\n    } else if (draggedTimelineItem && targetTrack) {\r\n      const insertResult = insertWithRipple(\r\n        targetTrack.id,\r\n        dropTime,\r\n        draggedTimelineItem.duration,\r\n        draggedTimelineItem.id\r\n      );\r\n\r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: draggedTimelineItem.duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || [],\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    stopAutoScroll();\r\n\r\n    // –ï—Å–ª–∏ –Ω–µ—Ç –≤–∞–ª–∏–¥–Ω–æ–≥–æ preview, –Ω–æ –µ—Å—Ç—å draggedItem - –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–º–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\r\n    if (!dropPreview && draggedItem) {\r\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n      if (targetTrackId) {\r\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\r\n        addToTimeline(draggedItem, bestPosition, targetTrackId);\r\n      }\r\n      setDropPreview(null);\r\n      setIsTimelineDragging(false);\r\n      return;\r\n    }\r\n\r\n    if ((!draggedItem && !draggedTimelineItem) || !dropPreview) return;\r\n\r\n    if (dropPreview.isValid) {\r\n      if (draggedItem) {\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\r\n        }\r\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\r\n      } else if (draggedTimelineItem) {\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          applyRippleEffect(\r\n            dropPreview.affectedItems,\r\n            draggedTimelineItem.duration\r\n          );\r\n        }\r\n\r\n        setTimelineItems((prev) =>\r\n          prev.map((item) =>\r\n            item.id === draggedTimelineItem.id\r\n              ? {\r\n                  ...item,\r\n                  startTime: dropPreview.time,\r\n                  trackId: dropPreview.trackId,\r\n                  trackType: dropPreview.trackType,\r\n                }\r\n              : item\r\n          )\r\n        );\r\n\r\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\r\n        if (newEndTime > videoDuration) {\r\n          setVideoDuration(newEndTime + 10);\r\n        }\r\n      }\r\n    }\r\n\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    if (!timelineRef.current?.contains(e.relatedTarget)) {\r\n      setDropPreview(null);\r\n      stopAutoScroll();\r\n    }\r\n  };\r\n\r\n  const getTimelineItemStyle = (item) => {\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(\r\n      (track) => track.id === item.trackId\r\n    );\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n\r\n    return {\r\n      left: `${item.startTime * pixelsPerSecond}px`,\r\n      width: `${item.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getDropPreviewStyle = () => {\r\n    if (!dropPreview) return {};\r\n\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(\r\n      (track) => track.id === dropPreview.trackId\r\n    );\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n\r\n    return {\r\n      left: `${dropPreview.time * pixelsPerSecond}px`,\r\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getTrackColor = (trackType) => {\r\n    switch (trackType) {\r\n      case \"overlay\":\r\n        return \"bg-purple-500 border-purple-400\";\r\n      case \"main\":\r\n        return \"bg-blue-500 border-blue-400\";\r\n      case \"audio\":\r\n        return \"bg-green-500 border-green-400\";\r\n      default:\r\n        return \"bg-gray-500 border-gray-400\";\r\n    }\r\n  };\r\n\r\n  // –≠—Ñ—Ñ–µ–∫—Ç—ã\r\n  useEffect(() => {\r\n    const handleMouseMove = (e) => {\r\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\r\n\r\n      checkAutoScroll(e.clientX);\r\n\r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX =\r\n        e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const pixelsPerSecond = getPixelsPerSecond();\r\n      const newTime = mouseX / pixelsPerSecond;\r\n\r\n      setTimelineItems((prev) =>\r\n        prev.map((item) => {\r\n          if (item.id !== resizeItem.id) return item;\r\n\r\n          const minDuration = 0.1;\r\n\r\n          if (resizeHandle === \"left\") {\r\n            const rightEdge =\r\n              originalItemData.startTime + originalItemData.duration;\r\n            const newStartTime = Math.max(\r\n              0,\r\n              Math.min(rightEdge - minDuration, newTime)\r\n            );\r\n            const newDuration = rightEdge - newStartTime;\r\n\r\n            return {\r\n              ...item,\r\n              startTime: newStartTime,\r\n              duration: newDuration,\r\n            };\r\n          } else if (resizeHandle === \"right\") {\r\n            const leftEdge = originalItemData.startTime;\r\n            const newEndTime = Math.max(leftEdge + minDuration, newTime);\r\n            const newDuration = newEndTime - leftEdge;\r\n\r\n            return {\r\n              ...item,\r\n              duration: newDuration,\r\n            };\r\n          }\r\n\r\n          return item;\r\n        })\r\n      );\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      if (isResizing) {\r\n        handleResizeEnd();\r\n      }\r\n    };\r\n\r\n    if (isResizing) {\r\n      document.addEventListener(\"mousemove\", handleMouseMove);\r\n      document.addEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener(\"mousemove\", handleMouseMove);\r\n      document.removeEventListener(\"mouseup\", handleMouseUp);\r\n    };\r\n  }, [\r\n    isResizing,\r\n    resizeItem,\r\n    resizeHandle,\r\n    originalItemData,\r\n    getPixelsPerSecond,\r\n    checkAutoScroll,\r\n    handleResizeEnd,\r\n    setTimelineItems,\r\n  ]);\r\n\r\n  // –ü–µ—Ä–µ–¥–∞–µ–º smartAddToTimeline –Ω–∞—Ä—É–∂—É —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫\r\n  useEffect(() => {\r\n    if (onSmartAddToTimeline) {\r\n      onSmartAddToTimeline(smartAddToTimeline);\r\n    }\r\n  }, [onSmartAddToTimeline, smartAddToTimeline]);\r\n\r\n  // –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É–¥–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —ç–ª–µ–º–µ–Ω—Ç\r\n  useEffect(() => {\r\n    if (draggedItem) {\r\n      console.log(`=== –û–¢–õ–ê–î–ö–ê DRAGGEDITEM ===`);\r\n      console.log(`–≠–ª–µ–º–µ–Ω—Ç: \"${draggedItem.name}\", —Ç–∏–ø: \"${draggedItem.type}\"`);\r\n      \r\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n      const targetTrack = [...tracks.overlays, ...tracks.main, ...tracks.audio]\r\n        .find(track => track.id === targetTrackId);\r\n      \r\n      console.log(`–¶–µ–ª–µ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ID: ${targetTrackId}`);\r\n      console.log(`–¶–µ–ª–µ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ –æ–±—ä–µ–∫—Ç:`, targetTrack);\r\n      \r\n      if (targetTrack) {\r\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\r\n        console.log(`–ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –¥–æ—Ä–æ–∂–∫—É \"${targetTrack.name}\" –≤ –ø–æ–∑–∏—Ü–∏—é ${formatTime(bestPosition)}`);\r\n      } else {\r\n        console.error(`–î–æ—Ä–æ–∂–∫–∞ —Å ID ${targetTrackId} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!`);\r\n      }\r\n      console.log(`=== –ö–û–ù–ï–¶ –û–¢–õ–ê–î–ö–ò ===`);\r\n    }\r\n  }, [draggedItem, tracks, getTargetTrackForType, findBestPositionForItem, formatTime]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      stopAutoScroll();\r\n    };\r\n  }, [stopAutoScroll]);\r\n\r\n  return (\r\n    <div\r\n      className={`h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${\r\n        isDragging || isTimelineDragging || isResizing\r\n          ? \"border-blue-400 bg-blue-50/20\"\r\n          : \"border-gray-200\"\r\n      }`}\r\n      onWheel={handleWheel}\r\n    >\r\n      <div className=\"bg-gray-50 p-4 border-b border-gray-200 space-y-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n            <Film size={18} />\r\n            <span>Timeline Pro</span>\r\n            {draggedItem && (\r\n              <span className=\"text-blue-600 text-sm\">\r\n                - –ì–æ—Ç–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å: \"{draggedItem.name}\" –Ω–∞ {\r\n                  draggedItem.type === 'video' ? 'Main Video' :\r\n                  draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' :\r\n                  'Overlay'\r\n                } –¥–æ—Ä–æ–∂–∫—É\r\n              </span>\r\n            )}\r\n            {isDragging && dropPreview && (\r\n              <span className=\"text-green-600\">\r\n                - Adding \"{draggedItem?.name}\"{\" \"}\r\n                {dropPreview.shouldRipple ? \"‚ö° ripple\" : \"üìç exact\"}\r\n              </span>\r\n            )}\r\n            {isTimelineDragging && dropPreview && (\r\n              <span className=\"text-blue-600\">\r\n                - Moving \"{draggedTimelineItem?.name}\"{\" \"}\r\n                {dropPreview.shouldRipple ? \"‚ö° push blocks\" : \"üìç exact\"}\r\n              </span>\r\n            )}\r\n            {isResizing && resizeItem && (\r\n              <span className=\"text-orange-600\">\r\n                - Trimming \"{resizeItem.name}\" ({resizeHandle} edge)\r\n              </span>\r\n            )}\r\n            {copiedItem && (\r\n              <span className=\"text-blue-600 text-sm\">\r\n                - \"{copiedItem.name}\" copied (Ctrl+V to paste)\r\n              </span>\r\n            )}\r\n          </h4>\r\n\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\">\r\n              <button\r\n                onClick={zoomOut}\r\n                className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                title=\"Zoom Out (-)\"\r\n              >\r\n                <ZoomOut size={16} />\r\n              </button>\r\n              <span className=\"text-xs text-gray-500 min-w-12 text-center\">\r\n                {(timelineZoom * 100).toFixed(0)}%\r\n              </span>\r\n              <button\r\n                onClick={zoomIn}\r\n                className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                title=\"Zoom In (+), or Ctrl+Wheel\"\r\n              >\r\n                <ZoomIn size={16} />\r\n              </button>\r\n              <button\r\n                onClick={resetZoom}\r\n                className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                title=\"Reset Zoom (0)\"\r\n              >\r\n                <RotateCcw size={16} />\r\n              </button>\r\n              <button\r\n                className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                title={`–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:\r\n‚Ä¢ Ctrl + –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –ó—É–º (—Ñ–æ–∫—É—Å –Ω–∞ –∫—É—Ä—Å–æ—Ä)\r\n‚Ä¢ Shift + –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\r\n‚Ä¢ –ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞\r\n‚Ä¢ –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ - –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞\r\n‚Ä¢ Ctrl + C - –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å\r\n‚Ä¢ Ctrl + V - –í—Å—Ç–∞–≤–∏—Ç—å\r\n‚Ä¢ Ctrl + B - –†–∞–∑—Ä–µ–∑–∞—Ç—å\r\n‚Ä¢ Del/Backspace - –£–¥–∞–ª–∏—Ç—å\r\n‚Ä¢ + - –ü—Ä–∏–±–ª–∏–∑–∏—Ç—å\r\n‚Ä¢ - - –û—Ç–¥–∞–ª–∏—Ç—å\r\n‚Ä¢ 0 - –°–±—Ä–æ—Å–∏—Ç—å –∑—É–º\r\n\r\n–£–º–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ:\r\n‚Ä¢ –í–∏–¥–µ–æ ‚Üí Main –¥–æ—Ä–æ–∂–∫–∞\r\n‚Ä¢ –ê—É–¥–∏–æ ‚Üí Audio –¥–æ—Ä–æ–∂–∫–∞  \r\n‚Ä¢ –ö–∞—Ä—Ç–∏–Ω–∫–∏/–¢–µ–∫—Å—Ç ‚Üí Overlay –¥–æ—Ä–æ–∂–∫–∞\r\n‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ª—É—á—à–µ–π –ø–æ–∑–∏—Ü–∏–∏\r\n‚Ä¢ –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞`}\r\n              >\r\n                <HelpCircle size={16} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-6\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <button\r\n                onClick={addOverlayTrack}\r\n                className=\"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\"\r\n                title=\"Add Overlay Track\"\r\n              >\r\n                <Plus size={16} />\r\n              </button>\r\n              <button\r\n                onClick={addAudioTrack}\r\n                className=\"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\"\r\n                title=\"Add Audio Track\"\r\n              >\r\n                <Music size={16} />\r\n              </button>\r\n              {draggedItem && (\r\n                <button\r\n                  onClick={addToTimelineAtCurrentTime}\r\n                  className=\"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200 animate-pulse bg-blue-100\"\r\n                  title={`–î–æ–±–∞–≤–∏—Ç—å \"${draggedItem.name}\" –Ω–∞ ${\r\n                    draggedItem.type === 'video' ? 'Main Video' :\r\n                    draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' :\r\n                    'Overlay'\r\n                  } –¥–æ—Ä–æ–∂–∫—É –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é`}\r\n                >\r\n                  <Plus size={16} />\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={splitTimelineItem}\r\n                disabled={!selectedTimelineItem}\r\n                className={`p-2 rounded-xl transition-all duration-200 ${\r\n                  selectedTimelineItem\r\n                    ? \"text-red-600 hover:text-red-800 hover:bg-red-50\"\r\n                    : \"text-gray-400 cursor-not-allowed\"\r\n                }`}\r\n                title=\"Split Selected Item (Ctrl+B) - Cuts item at current time\"\r\n              >\r\n                <Scissors size={16} />\r\n              </button>\r\n              <button\r\n                onClick={copyTimelineItem}\r\n                disabled={!selectedTimelineItem}\r\n                className={`p-2 rounded-xl transition-all duration-200 ${\r\n                  selectedTimelineItem\r\n                    ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\"\r\n                    : \"text-gray-400 cursor-not-allowed\"\r\n                }`}\r\n                title=\"Copy Selected Item (Ctrl+C) - Copy item to clipboard\"\r\n              >\r\n                <Copy size={16} />\r\n              </button>\r\n              <button\r\n                onClick={pasteTimelineItem}\r\n                disabled={!copiedItem}\r\n                className={`p-2 rounded-xl transition-all duration-200 ${\r\n                  copiedItem\r\n                    ? \"text-green-600 hover:text-green-800 hover:bg-green-50\"\r\n                    : \"text-gray-400 cursor-not-allowed\"\r\n                }`}\r\n                title=\"Paste Item (Ctrl+V) - Paste copied item\"\r\n              >\r\n                <Copy size={16} className=\"rotate-180\" />\r\n              </button>\r\n              <button\r\n                onClick={deleteSelectedItem}\r\n                disabled={!selectedTimelineItem}\r\n                className={`p-2 rounded-xl transition-all duration-200 ${\r\n                  selectedTimelineItem\r\n                    ? \"text-red-600 hover:text-red-800 hover:bg-red-50\"\r\n                    : \"text-gray-400 cursor-not-allowed\"\r\n                }`}\r\n                title=\"Delete Selected Item (Del/Backspace) - Remove from timeline\"\r\n              >\r\n                <Trash2 size={16} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 flex min-h-0\">\r\n        <div className=\"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\">\r\n          <div className=\"h-12 border-b border-gray-200 flex-shrink-0\"></div>\r\n\r\n          <div\r\n            ref={trackLabelsRef}\r\n            className=\"flex-1 overflow-y-auto overflow-x-hidden\"\r\n            onScroll={handleTrackLabelsScroll}\r\n          >\r\n            {tracks.overlays.map((track) => (\r\n              <div\r\n                key={track.id}\r\n                className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\"\r\n                style={{ height: \"60px\" }}\r\n              >\r\n                <Layers size={16} className=\"mr-2\" />\r\n                {track.name}\r\n              </div>\r\n            ))}\r\n\r\n            {tracks.main.map((track) => (\r\n              <div\r\n                key={track.id}\r\n                className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\"\r\n                style={{ height: \"60px\" }}\r\n              >\r\n                <Video size={16} className=\"mr-2\" />\r\n                {track.name}\r\n              </div>\r\n            ))}\r\n\r\n            {tracks.audio.map((track) => (\r\n              <div\r\n                key={track.id}\r\n                className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\"\r\n                style={{ height: \"60px\" }}\r\n              >\r\n                <Music size={16} className=\"mr-2\" />\r\n                {track.name}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          ref={(el) => {\r\n            timelineRef.current = el;\r\n            timelineScrollRef.current = el;\r\n          }}\r\n          className=\"flex-1 relative overflow-auto bg-white\"\r\n          onScroll={handleTrackAreaScroll}\r\n          onDragOver={handleDragOver}\r\n          onDrop={handleDrop}\r\n          onDragLeave={handleDragLeave}\r\n          style={{\r\n            overflowX: \"auto\",\r\n            overflowY: \"auto\",\r\n            scrollbarWidth: \"thin\",\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              width: `${getTimelineWidth()}px`,\r\n              minHeight: \"100%\",\r\n              position: \"relative\",\r\n            }}\r\n            onClick={handleTimelineClick}\r\n            onDoubleClick={handleTimelineDoubleClick}\r\n          >\r\n            <div className=\"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\">\r\n              {Array.from(\r\n                { length: Math.ceil((videoDuration * timelineZoom) / 5) + 1 },\r\n                (_, i) => {\r\n                  const timeValue = (i * 5) / timelineZoom;\r\n                  const pixelsPerSecond = getPixelsPerSecond();\r\n                  return (\r\n                    <div\r\n                      key={i}\r\n                      className=\"absolute top-0 h-full border-l border-gray-300\"\r\n                      style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                    >\r\n                      <span className=\"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\">\r\n                        {formatTime(timeValue)}\r\n                      </span>\r\n                    </div>\r\n                  );\r\n                }\r\n              )}\r\n\r\n              {timelineZoom > 2 &&\r\n                Array.from(\r\n                  { length: Math.ceil(videoDuration * timelineZoom) + 1 },\r\n                  (_, i) => {\r\n                    const timeValue = i / timelineZoom;\r\n                    const pixelsPerSecond = getPixelsPerSecond();\r\n                    return (\r\n                      <div\r\n                        key={`sub-${i}`}\r\n                        className=\"absolute top-8 w-0 h-4 border-l border-gray-200\"\r\n                        style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                      />\r\n                    );\r\n                  }\r\n                )}\r\n\r\n              <div\r\n                className=\"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\"\r\n                style={{\r\n                  left: `${currentTime * getPixelsPerSecond()}px`,\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div\r\n              className=\"relative flex-1\"\r\n              style={{\r\n                height: `${\r\n                  (tracks.overlays.length +\r\n                    tracks.main.length +\r\n                    tracks.audio.length) *\r\n                  60\r\n                }px`,\r\n                minHeight: \"100%\",\r\n              }}\r\n            >\r\n              {timelineItems.map((item) => (\r\n                <div\r\n                  key={item.id}\r\n                  className={`absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(\r\n                    item.trackType\r\n                  )} ${\r\n                    selectedTimelineItem?.id === item.id\r\n                      ? \"ring-2 ring-blue-300\"\r\n                      : \"\"\r\n                  } ${\r\n                    draggedTimelineItem?.id === item.id ? \"opacity-50 z-30\" : \"\"\r\n                  } ${\r\n                    copiedItem?.id === item.id\r\n                      ? \"ring-2 ring-green-300 ring-dashed\"\r\n                      : \"\"\r\n                  }`}\r\n                  style={getTimelineItemStyle(item)}\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    setSelectedTimelineItem(item);\r\n                  }}\r\n                >\r\n                  <div\r\n                    className=\"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\"\r\n                    onMouseDown={(e) => handleResizeStart(e, item, \"left\")}\r\n                    title=\"Trim start - Drag to adjust start time\"\r\n                    style={{\r\n                      background:\r\n                        \"linear-gradient(to right, rgba(255,255,255,0.8), transparent)\",\r\n                    }}\r\n                  >\r\n                    <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                  </div>\r\n\r\n                  <div\r\n                    draggable=\"true\"\r\n                    onDragStart={(e) => handleTimelineItemDragStart(e, item)}\r\n                    onDragEnd={handleTimelineItemDragEnd}\r\n                    className=\"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\"\r\n                    title=\"Drag to move item on timeline - Ripple mode: pushes other blocks\"\r\n                  >\r\n                    {item.name}\r\n                    {copiedItem?.id === item.id && (\r\n                      <span className=\"ml-2 text-green-200\">üìã</span>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div\r\n                    className=\"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\"\r\n                    onMouseDown={(e) => handleResizeStart(e, item, \"right\")}\r\n                    title=\"Trim end - Drag to adjust duration\"\r\n                    style={{\r\n                      background:\r\n                        \"linear-gradient(to left, rgba(255,255,255,0.8), transparent)\",\r\n                    }}\r\n                  >\r\n                    <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n\r\n              {dropPreview && (\r\n                <div\r\n                  className={`absolute h-10 rounded-lg border-2 transition-all ${\r\n                    dropPreview.isValid\r\n                      ? dropPreview.isExact\r\n                        ? `${getTrackColor(\r\n                            dropPreview.trackType\r\n                          )} bg-opacity-60 border-solid`\r\n                        : `${getTrackColor(\r\n                            dropPreview.trackType\r\n                          )} bg-opacity-40 border-dashed animate-pulse`\r\n                      : \"bg-red-300 border-red-500 border-dashed\"\r\n                  }`}\r\n                  style={getDropPreviewStyle()}\r\n                >\r\n                  {dropPreview.isValid && !dropPreview.isExact && (\r\n                    <div className=\"flex items-center justify-center h-full text-white text-xs font-bold\">\r\n                      üß≤\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}