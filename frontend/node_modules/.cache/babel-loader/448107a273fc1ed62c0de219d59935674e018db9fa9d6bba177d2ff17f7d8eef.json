{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\FFmpegVideoExporter\\\\index.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { X, Download, Zap, Settings } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FFmpegVideoExporter = ({\n  isOpen,\n  onClose,\n  timelineItems = [],\n  videoDuration = 60,\n  overlayTransforms = {}\n}) => {\n  _s();\n  const [ffmpeg, setFfmpeg] = useState(null);\n  const [isExporting, setIsExporting] = useState(false);\n  const [exportProgress, setExportProgress] = useState(0);\n  const [exportStage, setExportStage] = useState(\"idle\");\n  const [error, setError] = useState(null);\n  const [exportedBlob, setExportedBlob] = useState(null);\n  const [exportSettings, setExportSettings] = useState({\n    resolution: \"1280x720\",\n    fps: 24,\n    duration: Math.min(videoDuration, 20),\n    // –°–æ–∫—Ä–∞—Ç–∏–ª–∏ –¥–æ 20 —Å–µ–∫\n    includeAudio: true\n  });\n  const canvasRef = useRef(null);\n  const mediaCache = useRef(new Map());\n\n  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FFmpeg\n  useEffect(() => {\n    const initFFmpeg = async () => {\n      if (!isOpen || ffmpeg) return;\n      try {\n        setExportStage(\"loading\");\n        console.log(\"üöÄ –¢–ï–°–¢: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FFmpeg...\");\n        const {\n          FFmpeg\n        } = await import(\"@ffmpeg/ffmpeg\");\n        const {\n          fetchFile\n        } = await import(\"@ffmpeg/util\");\n        const ffmpegInstance = new FFmpeg();\n        await ffmpegInstance.load({\n          coreURL: \"https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.js\",\n          wasmURL: \"https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.wasm\"\n        });\n        ffmpegInstance.on(\"progress\", ({\n          progress\n        }) => {\n          if (isExporting) {\n            setExportProgress(Math.min(90, Math.round(progress * 85) + 70));\n          }\n        });\n        window.fetchFile = fetchFile;\n        setFfmpeg(ffmpegInstance);\n        setExportStage(\"ready\");\n        console.log(\"‚úÖ –¢–ï–°–¢: FFmpeg –≥–æ—Ç–æ–≤\");\n      } catch (error) {\n        console.error(\"‚ùå –¢–ï–°–¢: –û—à–∏–±–∫–∞ FFmpeg:\", error);\n        setError(error.message);\n        setExportStage(\"error\");\n      }\n    };\n    initFFmpeg();\n  }, [isOpen]);\n\n  // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞\n  const loadMediaWithCache = async item => {\n    const cacheKey = `${item.id}_${item.url}`;\n    if (mediaCache.current.has(cacheKey)) {\n      return mediaCache.current.get(cacheKey);\n    }\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => reject(new Error(\"Timeout\")), 3000);\n      const isVideo = item.type === \"videos\" || item.trackType === \"main\";\n      if (isVideo) {\n        const video = document.createElement(\"video\");\n        video.crossOrigin = \"anonymous\";\n        video.muted = true;\n        video.preload = \"metadata\";\n        video.onloadedmetadata = () => {\n          clearTimeout(timeout);\n          mediaCache.current.set(cacheKey, video);\n          console.log(`‚úÖ –¢–ï–°–¢: –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${item.name}`);\n          resolve(video);\n        };\n        video.onerror = () => {\n          clearTimeout(timeout);\n          reject(new Error(\"Video failed\"));\n        };\n        video.src = item.url;\n      } else {\n        const img = new Image();\n        img.crossOrigin = \"anonymous\";\n        img.onload = () => {\n          clearTimeout(timeout);\n          mediaCache.current.set(cacheKey, img);\n          console.log(`‚úÖ –¢–ï–°–¢: –ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ ${item.name}`);\n          resolve(img);\n        };\n        img.onerror = () => {\n          clearTimeout(timeout);\n          reject(new Error(\"Image failed\"));\n        };\n        img.src = item.url;\n      }\n    });\n  };\n\n  // üî¥ –¢–ï–°–¢–û–í–´–ô —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ú–ò —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏\n  const renderTestFrame = async (ctx, currentTime, width, height) => {\n    // –ß–µ—Ä–Ω—ã–π —Ñ–æ–Ω\n    ctx.fillStyle = \"#000000\";\n    ctx.fillRect(0, 0, width, height);\n    console.log(`\\nüî¥ –¢–ï–°–¢ –ö–ê–î–† ${currentTime.toFixed(1)}s - —Ä–∞–∑–º–µ—Ä ${width}x${height}`);\n\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –∫—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç (—Ç–µ—Å—Ç canvas)\n    ctx.fillStyle = \"#FF0000\";\n    ctx.fillRect(50, 50, 100, 100);\n    console.log(`üî¥ –ö—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω 50,50 100x100`);\n\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô —Å–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç (—Ç–µ—Å—Ç –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)\n    ctx.fillStyle = \"#0000FF\";\n    ctx.fillRect(width - 150, 50, 100, 100);\n    console.log(`üîµ –°–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É`);\n\n    // –ê–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã timeline\n    const activeItems = timelineItems.filter(item => {\n      const start = item.startTime || 0;\n      const end = start + (item.duration || 0);\n      return currentTime >= start && currentTime <= end && item.trackType !== \"audio\";\n    });\n    console.log(`üìä –ê–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: ${activeItems.length}`);\n\n    // –°–æ—Ä—Ç–∏—Ä—É–µ–º: main —Å–Ω–∞—á–∞–ª–∞, overlay –ø–æ—Ç–æ–º\n    const sortedItems = activeItems.sort((a, b) => {\n      const order = {\n        main: 1,\n        overlay: 2\n      };\n      return (order[a.trackType] || 1) - (order[b.trackType] || 1);\n    });\n\n    // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç\n    for (let i = 0; i < sortedItems.length; i++) {\n      const item = sortedItems[i];\n      try {\n        console.log(`üé® –¢–ï–°–¢: –†–µ–Ω–¥–µ—Ä–∏–º \"${item.name}\" (${item.trackType})`);\n        const element = await loadMediaWithCache(item);\n        if (!element) {\n          console.log(`‚ùå –¢–ï–°–¢: –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω ${item.name}`);\n          continue;\n        }\n        ctx.save();\n\n        // –í—Ä–µ–º—è –¥–ª—è –≤–∏–¥–µ–æ\n        if (element.tagName === \"VIDEO\") {\n          const relativeTime = currentTime - (item.startTime || 0);\n          element.currentTime = Math.max(0, relativeTime);\n          console.log(`üìπ –¢–ï–°–¢: –í–∏–¥–µ–æ –≤—Ä–µ–º—è ${relativeTime.toFixed(1)}s`);\n        }\n        let x,\n          y,\n          w,\n          h,\n          opacity = 1;\n        if (item.trackType === \"main\") {\n          // –û—Å–Ω–æ–≤–Ω–æ–µ –≤–∏–¥–µ–æ - –≤–µ—Å—å —ç–∫—Ä–∞–Ω\n          x = 0;\n          y = 0;\n          w = width;\n          h = height;\n          console.log(`üì∫ –¢–ï–°–¢: MAIN –≤–∏–¥–µ–æ ${w}x${h}`);\n        } else if (item.trackType === \"overlay\") {\n          // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –ë–û–õ–¨–®–û–ô overlay\n          x = width * 0.6; // –°–ø—Ä–∞–≤–∞\n          y = height * 0.3; // –í —Ü–µ–Ω—Ç—Ä–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏\n          w = width * 0.35; // 35% —ç–∫—Ä–∞–Ω–∞\n          h = height * 0.4; // 40% —ç–∫—Ä–∞–Ω–∞\n          opacity = 0.8;\n          console.log(`üñºÔ∏è –¢–ï–°–¢: OVERLAY –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –ë–û–õ–¨–®–û–ô pos(${x.toFixed(0)}, ${y.toFixed(0)}) size(${w.toFixed(0)}x${h.toFixed(0)})`);\n        } else {\n          // –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø\n          x = width * 0.2;\n          y = height * 0.6;\n          w = width * 0.3;\n          h = height * 0.3;\n          console.log(`‚ùì –¢–ï–°–¢: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø ${item.trackType}`);\n        }\n\n        // –†–∏—Å—É–µ–º —ç–ª–µ–º–µ–Ω—Ç\n        ctx.globalAlpha = opacity;\n        if (w > 0 && h > 0) {\n          ctx.drawImage(element, x, y, w, h);\n          console.log(`‚úÖ –¢–ï–°–¢: –û–¢–†–ï–ù–î–ï–†–ï–ù ${item.name} opacity=${opacity}`);\n\n          // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –∑–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ —ç–ª–µ–º–µ–Ω—Ç–∞\n          ctx.globalAlpha = 1;\n          ctx.strokeStyle = \"#00FF00\";\n          ctx.lineWidth = 5;\n          ctx.strokeRect(x, y, w, h);\n          console.log(`üü¢ –¢–ï–°–¢: –ó–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ ${item.name}`);\n        }\n        ctx.restore();\n      } catch (error) {\n        console.error(`üí• –¢–ï–°–¢: –û—à–∏–±–∫–∞ ${item.name}:`, error);\n      }\n    }\n\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –∂–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç\n    ctx.fillStyle = \"#FFFF00\";\n    ctx.font = \"48px Arial\";\n    ctx.fillText(`–¢–ï–°–¢ ${currentTime.toFixed(1)}s`, 200, height - 100);\n    console.log(`üü° –¢–ï–°–¢: –ñ–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω`);\n    console.log(`üèÅ –¢–ï–°–¢: –ö–∞–¥—Ä ${currentTime.toFixed(1)}s –≥–æ—Ç–æ–≤\\n`);\n  };\n\n  // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞—É–¥–∏–æ\n  const prepareAudio = async () => {\n    if (!exportSettings.includeAudio) {\n      console.log(\"üîá –¢–ï–°–¢: –ê—É–¥–∏–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ\");\n      return null;\n    }\n    const audioItems = timelineItems.filter(item => item.trackType === \"audio\" || item.type === \"videos\" && item.trackType === \"main\");\n    if (audioItems.length === 0) {\n      console.log(\"üîá –¢–ï–°–¢: –ê—É–¥–∏–æ —Ç—Ä–µ–∫–æ–≤ –Ω–µ—Ç\");\n      return null;\n    }\n    console.log(`üéµ –¢–ï–°–¢: –ù–∞–π–¥–µ–Ω–æ ${audioItems.length} –∞—É–¥–∏–æ`);\n\n    // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π\n    for (const audioItem of audioItems) {\n      try {\n        console.log(`üì• –¢–ï–°–¢: –ó–∞–≥—Ä—É–∂–∞–µ–º –∞—É–¥–∏–æ ${audioItem.name}`);\n        const response = await fetch(audioItem.url);\n        if (!response.ok) continue;\n        const blob = await response.blob();\n        if (blob.size === 0) continue;\n        console.log(`‚úÖ –¢–ï–°–¢: –ê—É–¥–∏–æ –≥–æ—Ç–æ–≤–æ ${audioItem.name}`);\n        return {\n          blob,\n          name: audioItem.name\n        };\n      } catch (error) {\n        console.warn(`‚ö†Ô∏è –¢–ï–°–¢: –ê—É–¥–∏–æ –æ—à–∏–±–∫–∞ ${audioItem.name}`);\n      }\n    }\n    return null;\n  };\n\n  // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤\n  const createTestFrames = async duration => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\", {\n      alpha: false\n    });\n    const [width, height] = exportSettings.resolution.split(\"x\").map(Number);\n    canvas.width = width;\n    canvas.height = height;\n    console.log(`üéûÔ∏è –¢–ï–°–¢: –°–æ–∑–¥–∞–µ–º –∫–∞–¥—Ä—ã ${width}x${height}`);\n    const maxFrames = Math.min(Math.ceil(duration * exportSettings.fps), 100); // –û–≥—Ä–∞–Ω–∏—á–∏–ª–∏ 100 –∫–∞–¥—Ä–∞–º–∏\n    const frames = [];\n    for (let i = 0; i < maxFrames; i++) {\n      const currentTime = i / exportSettings.fps;\n      await renderTestFrame(ctx, currentTime, width, height);\n      const blob = await new Promise(resolve => {\n        canvas.toBlob(resolve, \"image/png\");\n      });\n      if (blob) {\n        frames.push(blob);\n        console.log(`üì∏ –¢–ï–°–¢: –ö–∞–¥—Ä ${i + 1}/${maxFrames} —Å–æ–∑–¥–∞–Ω (${(blob.size / 1024).toFixed(1)}KB)`);\n      }\n      setExportProgress(Math.round(i / maxFrames * 50));\n      await new Promise(resolve => setTimeout(resolve, 50)); // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    }\n    console.log(`‚úÖ –¢–ï–°–¢: –°–æ–∑–¥–∞–Ω–æ ${frames.length} –∫–∞–¥—Ä–æ–≤`);\n    return frames;\n  };\n\n  // –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ\n  const encodeTestVideo = async (frames, audioFile, duration) => {\n    if (!window.fetchFile || frames.length === 0) {\n      throw new Error(\"–¢–ï–°–¢: –ù–µ—Ç –∫–∞–¥—Ä–æ–≤\");\n    }\n    try {\n      setExportProgress(50);\n      console.log(`üé¨ –¢–ï–°–¢: –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ${frames.length} –∫–∞–¥—Ä–æ–≤`);\n\n      // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º PNG –∫–∞–¥—Ä—ã\n      for (let i = 0; i < frames.length; i++) {\n        const frameData = await window.fetchFile(frames[i]);\n        const filename = `frame_${i.toString().padStart(4, \"0\")}.png`;\n        await ffmpeg.writeFile(filename, frameData);\n        if (i % 10 === 0) {\n          setExportProgress(50 + Math.round(i / frames.length * 30));\n        }\n      }\n      setExportProgress(80);\n\n      // FFmpeg –∫–æ–º–∞–Ω–¥–∞\n      const args = [\"-framerate\", exportSettings.fps.toString(), \"-i\", \"frame_%04d.png\", \"-t\", Math.min(duration, frames.length / exportSettings.fps).toString()];\n\n      // –ê—É–¥–∏–æ\n      if (audioFile) {\n        const audioData = await window.fetchFile(audioFile.blob);\n        await ffmpeg.writeFile(\"audio.mp3\", audioData);\n        args.push(\"-i\", \"audio.mp3\", \"-c:a\", \"aac\", \"-b:a\", \"128k\", \"-shortest\");\n        console.log(`üéµ –¢–ï–°–¢: –ê—É–¥–∏–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ`);\n      }\n\n      // –í–∏–¥–µ–æ –∫–æ–¥–µ–∫\n      args.push(\"-c:v\", \"libx264\", \"-preset\", \"fast\",\n      // –ë—ã—Å—Ç—Ä–µ–µ —á–µ–º ultrafast\n      \"-crf\", \"18\",\n      // –õ—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ\n      \"-pix_fmt\", \"yuv420p\", \"-movflags\", \"+faststart\", \"test_output.mp4\");\n      console.log(`üîß –¢–ï–°–¢: FFmpeg –∫–æ–º–∞–Ω–¥–∞:`, args.join(\" \"));\n      await ffmpeg.exec(args);\n      setExportProgress(90);\n      const data = await ffmpeg.readFile(\"test_output.mp4\");\n      const videoBlob = new Blob([data.buffer], {\n        type: \"video/mp4\"\n      });\n\n      // –û—á–∏—Å—Ç–∫–∞\n      for (let i = 0; i < frames.length; i++) {\n        try {\n          await ffmpeg.deleteFile(`frame_${i.toString().padStart(4, \"0\")}.png`);\n        } catch (e) {}\n      }\n      if (audioFile) {\n        try {\n          await ffmpeg.deleteFile(\"audio.mp3\");\n        } catch (e) {}\n      }\n      try {\n        await ffmpeg.deleteFile(\"test_output.mp4\");\n      } catch (e) {}\n      console.log(`‚úÖ –¢–ï–°–¢: –í–∏–¥–µ–æ —Å–æ–∑–¥–∞–Ω–æ ${(videoBlob.size / 1024 / 1024).toFixed(2)}MB`);\n      return videoBlob;\n    } catch (error) {\n      throw new Error(`–¢–ï–°–¢: –û—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è ${error.message}`);\n    }\n  };\n\n  // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞\n  const startTestExport = async () => {\n    if (!ffmpeg || isExporting || timelineItems.length === 0) return;\n    setIsExporting(true);\n    setExportProgress(0);\n    setExportStage(\"processing\");\n    setError(null);\n    setExportedBlob(null);\n    try {\n      console.log(\"üî¥ –¢–ï–°–¢: –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏\");\n      console.log(`üìä –¢–ï–°–¢: Timeline: ${timelineItems.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤`);\n      const actualDuration = Math.min(exportSettings.duration, 10); // –ú–∞–∫—Å–∏–º—É–º 10 —Å–µ–∫ –¥–ª—è —Ç–µ—Å—Ç–∞\n\n      setExportStage(\"rendering\");\n      const frames = await createTestFrames(actualDuration);\n      if (frames.length === 0) {\n        throw new Error(\"–¢–ï–°–¢: –ù–µ—Ç –∫–∞–¥—Ä–æ–≤\");\n      }\n      const audioFile = await prepareAudio();\n      setExportStage(\"encoding\");\n      const videoBlob = await encodeTestVideo(frames, audioFile, actualDuration);\n      setExportProgress(100);\n      setExportStage(\"completed\");\n      setExportedBlob(videoBlob);\n      console.log(`‚úÖ –¢–ï–°–¢: –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!`);\n    } catch (error) {\n      console.error(\"‚ùå –¢–ï–°–¢: –û—à–∏–±–∫–∞:\", error);\n      setError(error.message);\n      setExportStage(\"error\");\n    } finally {\n      setIsExporting(false);\n    }\n  };\n  const downloadVideo = () => {\n    if (!exportedBlob) return;\n    const url = URL.createObjectURL(exportedBlob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `TEST_export_${Date.now()}.mp4`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  };\n  const getStageText = () => {\n    switch (exportStage) {\n      case \"loading\":\n        return \"–ó–∞–≥—Ä—É–∑–∫–∞ FFmpeg...\";\n      case \"processing\":\n        return \"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¢–ï–°–¢–ê...\";\n      case \"rendering\":\n        return \"–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¢–ï–°–¢–û–í–´–• –∫–∞–¥—Ä–æ–≤...\";\n      case \"encoding\":\n        return \"–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¢–ï–°–¢–ê...\";\n      case \"completed\":\n        return \"‚úÖ –¢–ï–°–¢ –≥–æ—Ç–æ–≤!\";\n      case \"error\":\n        return \"‚ùå –¢–ï–°–¢ –æ—à–∏–±–∫–∞\";\n      default:\n        return \"–ì–æ—Ç–æ–≤ –∫ –¢–ï–°–¢–û–í–û–ú–£ —ç–∫—Å–ø–æ—Ä—Ç—É\";\n    }\n  };\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-2xl shadow-xl max-w-lg w-full p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold mb-4 flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Zap, {\n          size: 24,\n          className: \"mr-3 text-red-600\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this), \"\\uD83D\\uDD34 \\u0422\\u0415\\u0421\\u0422 \\u044D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0441 \\u043F\\u0440\\u0438\\u043D\\u0443\\u0434\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u044B\\u043C\\u0438 \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u0430\\u043C\\u0438\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-red-50 p-4 rounded-lg border border-red-200\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-medium text-red-800 mb-2 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Settings, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 15\n            }, this), \"\\u0422\\u0415\\u0421\\u0422\\u041E\\u0412\\u042B\\u0415 \\u043D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-red-700 space-y-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 \\u041A\\u0440\\u0430\\u0441\\u043D\\u044B\\u0439 \\u043A\\u0432\\u0430\\u0434\\u0440\\u0430\\u0442 \\u0441\\u043B\\u0435\\u0432\\u0430 \\u0441\\u0432\\u0435\\u0440\\u0445\\u0443\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 \\u0421\\u0438\\u043D\\u0438\\u0439 \\u043A\\u0432\\u0430\\u0434\\u0440\\u0430\\u0442 \\u0441\\u043F\\u0440\\u0430\\u0432\\u0430 \\u0441\\u0432\\u0435\\u0440\\u0445\\u0443\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 Overlay \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B \\u0443\\u0432\\u0435\\u043B\\u0438\\u0447\\u0435\\u043D\\u044B \\u0432 3 \\u0440\\u0430\\u0437\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 \\u0417\\u0435\\u043B\\u0435\\u043D\\u0430\\u044F \\u0440\\u0430\\u043C\\u043A\\u0430 \\u0432\\u043E\\u043A\\u0440\\u0443\\u0433 overlay\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 \\u0416\\u0435\\u043B\\u0442\\u044B\\u0439 \\u0442\\u0435\\u043A\\u0441\\u0442 \\u0441 \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0435\\u043C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u2022 \\u041C\\u0430\\u043A\\u0441\\u0438\\u043C\\u0443\\u043C 10 \\u0441\\u0435\\u043A\\u0443\\u043D\\u0434, 100 \\u043A\\u0430\\u0434\\u0440\\u043E\\u0432\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-4 rounded-lg ${exportStage === \"error\" ? \"bg-red-50\" : exportStage === \"completed\" ? \"bg-green-50\" : \"bg-blue-50\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: getStageText()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this), isExporting && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm\",\n              children: [exportProgress, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 31\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 13\n          }, this), isExporting && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full bg-gray-200 rounded-full h-2\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-600 h-2 rounded-full transition-all\",\n              style: {\n                width: `${exportProgress}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 485,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-red-50 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-800 font-medium\",\n            children: \"\\u0422\\u0415\\u0421\\u0422 \\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-600 text-sm\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }, this), exportedBlob && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-green-50 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-green-800 font-medium mb-2\",\n            children: [\"\\u2705 \\u0422\\u0415\\u0421\\u0422 \\u0432\\u0438\\u0434\\u0435\\u043E \\u0433\\u043E\\u0442\\u043E\\u0432\\u043E! \\u0420\\u0430\\u0437\\u043C\\u0435\\u0440: \", (exportedBlob.size / 1024 / 1024).toFixed(2), \"MB\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-green-700 text-sm mb-3\",\n            children: \"\\u041F\\u0440\\u043E\\u0432\\u0435\\u0440\\u044C\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0435\\u043E \\u043D\\u0430 \\u043D\\u0430\\u043B\\u0438\\u0447\\u0438\\u0435: \\u043A\\u0440\\u0430\\u0441\\u043D\\u043E\\u0433\\u043E/\\u0441\\u0438\\u043D\\u0435\\u0433\\u043E \\u043A\\u0432\\u0430\\u0434\\u0440\\u0430\\u0442\\u043E\\u0432, overlay \\u0441 \\u0437\\u0435\\u043B\\u0435\\u043D\\u043E\\u0439 \\u0440\\u0430\\u043C\\u043A\\u043E\\u0439, \\u0436\\u0435\\u043B\\u0442\\u043E\\u0433\\u043E \\u0442\\u0435\\u043A\\u0441\\u0442\\u0430 \\u0438 \\u0437\\u0432\\u0443\\u043A\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: downloadVideo,\n            className: \"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Download, {\n              size: 16,\n              className: \"mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 17\n            }, this), \"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C \\u0422\\u0415\\u0421\\u0422\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-600 bg-gray-50 p-3 rounded\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Timeline \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432: \", timelineItems.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 522,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Overlay \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432: \", timelineItems.filter(item => item.trackType === \"overlay\").length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"\\u0410\\u0443\\u0434\\u0438\\u043E \\u0442\\u0440\\u0435\\u043A\\u043E\\u0432: \", timelineItems.filter(item => item.trackType === \"audio\").length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-2 font-medium\",\n            children: \"\\uD83D\\uDD34 \\u0422\\u0415\\u0421\\u0422: \\u0412\\u0441\\u0435 \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B \\u043F\\u0440\\u0438\\u043D\\u0443\\u0434\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E \\u0443\\u0432\\u0435\\u043B\\u0438\\u0447\\u0435\\u043D\\u044B \\u0438 \\u0432\\u044B\\u0434\\u0435\\u043B\\u0435\\u043D\\u044B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"px-4 py-2 text-gray-600 hover:text-gray-800\",\n          disabled: isExporting,\n          children: \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startTestExport,\n          disabled: !ffmpeg || isExporting || timelineItems.length === 0,\n          className: \"bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 flex items-center disabled:bg-gray-400\",\n          children: [/*#__PURE__*/_jsxDEV(Zap, {\n            size: 16,\n            className: \"mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 545,\n            columnNumber: 13\n          }, this), isExporting ? `–¢–ï–°–¢ ${exportProgress}%` : \"üî¥ –¢–ï–°–¢ —ç–∫—Å–ø–æ—Ä—Ç\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          display: \"none\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 550,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 450,\n    columnNumber: 5\n  }, this);\n};\n_s(FFmpegVideoExporter, \"XnzIjGwIHxwsN5nD8gPFgwRNdAs=\");\n_c = FFmpegVideoExporter;\nexport const useFFmpegExporter = () => {\n  _s2();\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\n  const openExportModal = () => setIsExportModalOpen(true);\n  const closeExportModal = () => setIsExportModalOpen(false);\n  return {\n    isExportModalOpen,\n    openExportModal,\n    closeExportModal\n  };\n};\n_s2(useFFmpegExporter, \"Wfaj4kprhDIijrMYdBElG6JtIdM=\");\nexport default FFmpegVideoExporter;\nvar _c;\n$RefreshReg$(_c, \"FFmpegVideoExporter\");","map":{"version":3,"names":["React","useState","useRef","useEffect","X","Download","Zap","Settings","jsxDEV","_jsxDEV","FFmpegVideoExporter","isOpen","onClose","timelineItems","videoDuration","overlayTransforms","_s","ffmpeg","setFfmpeg","isExporting","setIsExporting","exportProgress","setExportProgress","exportStage","setExportStage","error","setError","exportedBlob","setExportedBlob","exportSettings","setExportSettings","resolution","fps","duration","Math","min","includeAudio","canvasRef","mediaCache","Map","initFFmpeg","console","log","FFmpeg","fetchFile","ffmpegInstance","load","coreURL","wasmURL","on","progress","round","window","message","loadMediaWithCache","item","cacheKey","id","url","current","has","get","Promise","resolve","reject","timeout","setTimeout","Error","isVideo","type","trackType","video","document","createElement","crossOrigin","muted","preload","onloadedmetadata","clearTimeout","set","name","onerror","src","img","Image","onload","renderTestFrame","ctx","currentTime","width","height","fillStyle","fillRect","toFixed","activeItems","filter","start","startTime","end","length","sortedItems","sort","a","b","order","main","overlay","i","element","save","tagName","relativeTime","max","x","y","w","h","opacity","globalAlpha","drawImage","strokeStyle","lineWidth","strokeRect","restore","font","fillText","prepareAudio","audioItems","audioItem","response","fetch","ok","blob","size","warn","createTestFrames","canvas","getContext","alpha","split","map","Number","maxFrames","ceil","frames","toBlob","push","encodeTestVideo","audioFile","frameData","filename","toString","padStart","writeFile","args","audioData","join","exec","data","readFile","videoBlob","Blob","buffer","deleteFile","e","startTestExport","actualDuration","downloadVideo","URL","createObjectURL","href","download","Date","now","body","appendChild","click","removeChild","revokeObjectURL","getStageText","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","onClick","disabled","ref","display","_c","useFFmpegExporter","_s2","isExportModalOpen","setIsExportModalOpen","openExportModal","closeExportModal","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/FFmpegVideoExporter/index.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  X,\r\n  Download,\r\n  Zap,\r\n  Settings,\r\n} from \"lucide-react\";\r\n\r\nconst FFmpegVideoExporter = ({\r\n  isOpen,\r\n  onClose,\r\n  timelineItems = [],\r\n  videoDuration = 60,\r\n  overlayTransforms = {},\r\n}) => {\r\n  const [ffmpeg, setFfmpeg] = useState(null);\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [exportProgress, setExportProgress] = useState(0);\r\n  const [exportStage, setExportStage] = useState(\"idle\");\r\n  const [error, setError] = useState(null);\r\n  const [exportedBlob, setExportedBlob] = useState(null);\r\n\r\n  const [exportSettings, setExportSettings] = useState({\r\n    resolution: \"1280x720\",\r\n    fps: 24,\r\n    duration: Math.min(videoDuration, 20), // –°–æ–∫—Ä–∞—Ç–∏–ª–∏ –¥–æ 20 —Å–µ–∫\r\n    includeAudio: true,\r\n  });\r\n\r\n  const canvasRef = useRef(null);\r\n  const mediaCache = useRef(new Map());\r\n\r\n  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FFmpeg\r\n  useEffect(() => {\r\n    const initFFmpeg = async () => {\r\n      if (!isOpen || ffmpeg) return;\r\n\r\n      try {\r\n        setExportStage(\"loading\");\r\n        console.log(\"üöÄ –¢–ï–°–¢: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FFmpeg...\");\r\n\r\n        const { FFmpeg } = await import(\"@ffmpeg/ffmpeg\");\r\n        const { fetchFile } = await import(\"@ffmpeg/util\");\r\n\r\n        const ffmpegInstance = new FFmpeg();\r\n\r\n        await ffmpegInstance.load({\r\n          coreURL: \"https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.js\",\r\n          wasmURL: \"https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.wasm\",\r\n        });\r\n\r\n        ffmpegInstance.on(\"progress\", ({ progress }) => {\r\n          if (isExporting) {\r\n            setExportProgress(Math.min(90, Math.round(progress * 85) + 70));\r\n          }\r\n        });\r\n\r\n        window.fetchFile = fetchFile;\r\n        setFfmpeg(ffmpegInstance);\r\n        setExportStage(\"ready\");\r\n        console.log(\"‚úÖ –¢–ï–°–¢: FFmpeg –≥–æ—Ç–æ–≤\");\r\n      } catch (error) {\r\n        console.error(\"‚ùå –¢–ï–°–¢: –û—à–∏–±–∫–∞ FFmpeg:\", error);\r\n        setError(error.message);\r\n        setExportStage(\"error\");\r\n      }\r\n    };\r\n\r\n    initFFmpeg();\r\n  }, [isOpen]);\r\n\r\n  // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞\r\n  const loadMediaWithCache = async (item) => {\r\n    const cacheKey = `${item.id}_${item.url}`;\r\n    if (mediaCache.current.has(cacheKey)) {\r\n      return mediaCache.current.get(cacheKey);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const timeout = setTimeout(() => reject(new Error(\"Timeout\")), 3000);\r\n      const isVideo = item.type === \"videos\" || item.trackType === \"main\";\r\n\r\n      if (isVideo) {\r\n        const video = document.createElement(\"video\");\r\n        video.crossOrigin = \"anonymous\";\r\n        video.muted = true;\r\n        video.preload = \"metadata\";\r\n        video.onloadedmetadata = () => {\r\n          clearTimeout(timeout);\r\n          mediaCache.current.set(cacheKey, video);\r\n          console.log(`‚úÖ –¢–ï–°–¢: –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${item.name}`);\r\n          resolve(video);\r\n        };\r\n        video.onerror = () => {\r\n          clearTimeout(timeout);\r\n          reject(new Error(\"Video failed\"));\r\n        };\r\n        video.src = item.url;\r\n      } else {\r\n        const img = new Image();\r\n        img.crossOrigin = \"anonymous\";\r\n        img.onload = () => {\r\n          clearTimeout(timeout);\r\n          mediaCache.current.set(cacheKey, img);\r\n          console.log(`‚úÖ –¢–ï–°–¢: –ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ ${item.name}`);\r\n          resolve(img);\r\n        };\r\n        img.onerror = () => {\r\n          clearTimeout(timeout);\r\n          reject(new Error(\"Image failed\"));\r\n        };\r\n        img.src = item.url;\r\n      }\r\n    });\r\n  };\r\n\r\n  // üî¥ –¢–ï–°–¢–û–í–´–ô —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ú–ò —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏\r\n  const renderTestFrame = async (ctx, currentTime, width, height) => {\r\n    // –ß–µ—Ä–Ω—ã–π —Ñ–æ–Ω\r\n    ctx.fillStyle = \"#000000\";\r\n    ctx.fillRect(0, 0, width, height);\r\n\r\n    console.log(`\\nüî¥ –¢–ï–°–¢ –ö–ê–î–† ${currentTime.toFixed(1)}s - —Ä–∞–∑–º–µ—Ä ${width}x${height}`);\r\n\r\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –∫—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç (—Ç–µ—Å—Ç canvas)\r\n    ctx.fillStyle = \"#FF0000\";\r\n    ctx.fillRect(50, 50, 100, 100);\r\n    console.log(`üî¥ –ö—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω 50,50 100x100`);\r\n\r\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô —Å–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç (—Ç–µ—Å—Ç –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)\r\n    ctx.fillStyle = \"#0000FF\";\r\n    ctx.fillRect(width - 150, 50, 100, 100);\r\n    console.log(`üîµ –°–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É`);\r\n\r\n    // –ê–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã timeline\r\n    const activeItems = timelineItems.filter((item) => {\r\n      const start = item.startTime || 0;\r\n      const end = start + (item.duration || 0);\r\n      return currentTime >= start && currentTime <= end && item.trackType !== \"audio\";\r\n    });\r\n\r\n    console.log(`üìä –ê–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: ${activeItems.length}`);\r\n\r\n    // –°–æ—Ä—Ç–∏—Ä—É–µ–º: main —Å–Ω–∞—á–∞–ª–∞, overlay –ø–æ—Ç–æ–º\r\n    const sortedItems = activeItems.sort((a, b) => {\r\n      const order = { main: 1, overlay: 2 };\r\n      return (order[a.trackType] || 1) - (order[b.trackType] || 1);\r\n    });\r\n\r\n    // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç\r\n    for (let i = 0; i < sortedItems.length; i++) {\r\n      const item = sortedItems[i];\r\n      \r\n      try {\r\n        console.log(`üé® –¢–ï–°–¢: –†–µ–Ω–¥–µ—Ä–∏–º \"${item.name}\" (${item.trackType})`);\r\n        \r\n        const element = await loadMediaWithCache(item);\r\n        if (!element) {\r\n          console.log(`‚ùå –¢–ï–°–¢: –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω ${item.name}`);\r\n          continue;\r\n        }\r\n\r\n        ctx.save();\r\n\r\n        // –í—Ä–µ–º—è –¥–ª—è –≤–∏–¥–µ–æ\r\n        if (element.tagName === \"VIDEO\") {\r\n          const relativeTime = currentTime - (item.startTime || 0);\r\n          element.currentTime = Math.max(0, relativeTime);\r\n          console.log(`üìπ –¢–ï–°–¢: –í–∏–¥–µ–æ –≤—Ä–µ–º—è ${relativeTime.toFixed(1)}s`);\r\n        }\r\n\r\n        let x, y, w, h, opacity = 1;\r\n\r\n        if (item.trackType === \"main\") {\r\n          // –û—Å–Ω–æ–≤–Ω–æ–µ –≤–∏–¥–µ–æ - –≤–µ—Å—å —ç–∫—Ä–∞–Ω\r\n          x = 0;\r\n          y = 0;\r\n          w = width;\r\n          h = height;\r\n          console.log(`üì∫ –¢–ï–°–¢: MAIN –≤–∏–¥–µ–æ ${w}x${h}`);\r\n          \r\n        } else if (item.trackType === \"overlay\") {\r\n          // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –ë–û–õ–¨–®–û–ô overlay\r\n          x = width * 0.6;  // –°–ø—Ä–∞–≤–∞\r\n          y = height * 0.3; // –í —Ü–µ–Ω—Ç—Ä–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏\r\n          w = width * 0.35; // 35% —ç–∫—Ä–∞–Ω–∞\r\n          h = height * 0.4; // 40% —ç–∫—Ä–∞–Ω–∞\r\n          opacity = 0.8;\r\n          \r\n          console.log(`üñºÔ∏è –¢–ï–°–¢: OVERLAY –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –ë–û–õ–¨–®–û–ô pos(${x.toFixed(0)}, ${y.toFixed(0)}) size(${w.toFixed(0)}x${h.toFixed(0)})`);\r\n          \r\n        } else {\r\n          // –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø\r\n          x = width * 0.2;\r\n          y = height * 0.6;\r\n          w = width * 0.3;\r\n          h = height * 0.3;\r\n          console.log(`‚ùì –¢–ï–°–¢: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø ${item.trackType}`);\r\n        }\r\n\r\n        // –†–∏—Å—É–µ–º —ç–ª–µ–º–µ–Ω—Ç\r\n        ctx.globalAlpha = opacity;\r\n        \r\n        if (w > 0 && h > 0) {\r\n          ctx.drawImage(element, x, y, w, h);\r\n          console.log(`‚úÖ –¢–ï–°–¢: –û–¢–†–ï–ù–î–ï–†–ï–ù ${item.name} opacity=${opacity}`);\r\n          \r\n          // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –∑–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ —ç–ª–µ–º–µ–Ω—Ç–∞\r\n          ctx.globalAlpha = 1;\r\n          ctx.strokeStyle = \"#00FF00\";\r\n          ctx.lineWidth = 5;\r\n          ctx.strokeRect(x, y, w, h);\r\n          console.log(`üü¢ –¢–ï–°–¢: –ó–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ ${item.name}`);\r\n        }\r\n\r\n        ctx.restore();\r\n        \r\n      } catch (error) {\r\n        console.error(`üí• –¢–ï–°–¢: –û—à–∏–±–∫–∞ ${item.name}:`, error);\r\n      }\r\n    }\r\n\r\n    // üî¥ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –∂–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç\r\n    ctx.fillStyle = \"#FFFF00\";\r\n    ctx.font = \"48px Arial\";\r\n    ctx.fillText(`–¢–ï–°–¢ ${currentTime.toFixed(1)}s`, 200, height - 100);\r\n    console.log(`üü° –¢–ï–°–¢: –ñ–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω`);\r\n\r\n    console.log(`üèÅ –¢–ï–°–¢: –ö–∞–¥—Ä ${currentTime.toFixed(1)}s –≥–æ—Ç–æ–≤\\n`);\r\n  };\r\n\r\n  // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞—É–¥–∏–æ\r\n  const prepareAudio = async () => {\r\n    if (!exportSettings.includeAudio) {\r\n      console.log(\"üîá –¢–ï–°–¢: –ê—É–¥–∏–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ\");\r\n      return null;\r\n    }\r\n\r\n    const audioItems = timelineItems.filter(\r\n      (item) => item.trackType === \"audio\" || (item.type === \"videos\" && item.trackType === \"main\")\r\n    );\r\n\r\n    if (audioItems.length === 0) {\r\n      console.log(\"üîá –¢–ï–°–¢: –ê—É–¥–∏–æ —Ç—Ä–µ–∫–æ–≤ –Ω–µ—Ç\");\r\n      return null;\r\n    }\r\n\r\n    console.log(`üéµ –¢–ï–°–¢: –ù–∞–π–¥–µ–Ω–æ ${audioItems.length} –∞—É–¥–∏–æ`);\r\n\r\n    // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π\r\n    for (const audioItem of audioItems) {\r\n      try {\r\n        console.log(`üì• –¢–ï–°–¢: –ó–∞–≥—Ä—É–∂–∞–µ–º –∞—É–¥–∏–æ ${audioItem.name}`);\r\n        const response = await fetch(audioItem.url);\r\n        if (!response.ok) continue;\r\n        const blob = await response.blob();\r\n        if (blob.size === 0) continue;\r\n        \r\n        console.log(`‚úÖ –¢–ï–°–¢: –ê—É–¥–∏–æ –≥–æ—Ç–æ–≤–æ ${audioItem.name}`);\r\n        return { blob, name: audioItem.name };\r\n      } catch (error) {\r\n        console.warn(`‚ö†Ô∏è –¢–ï–°–¢: –ê—É–¥–∏–æ –æ—à–∏–±–∫–∞ ${audioItem.name}`);\r\n      }\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤\r\n  const createTestFrames = async (duration) => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext(\"2d\", { alpha: false });\r\n\r\n    const [width, height] = exportSettings.resolution.split(\"x\").map(Number);\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    console.log(`üéûÔ∏è –¢–ï–°–¢: –°–æ–∑–¥–∞–µ–º –∫–∞–¥—Ä—ã ${width}x${height}`);\r\n\r\n    const maxFrames = Math.min(Math.ceil(duration * exportSettings.fps), 100); // –û–≥—Ä–∞–Ω–∏—á–∏–ª–∏ 100 –∫–∞–¥—Ä–∞–º–∏\r\n    const frames = [];\r\n\r\n    for (let i = 0; i < maxFrames; i++) {\r\n      const currentTime = i / exportSettings.fps;\r\n      \r\n      await renderTestFrame(ctx, currentTime, width, height);\r\n\r\n      const blob = await new Promise((resolve) => {\r\n        canvas.toBlob(resolve, \"image/png\");\r\n      });\r\n\r\n      if (blob) {\r\n        frames.push(blob);\r\n        console.log(`üì∏ –¢–ï–°–¢: –ö–∞–¥—Ä ${i + 1}/${maxFrames} —Å–æ–∑–¥–∞–Ω (${(blob.size / 1024).toFixed(1)}KB)`);\r\n      }\r\n\r\n      setExportProgress(Math.round((i / maxFrames) * 50));\r\n      await new Promise(resolve => setTimeout(resolve, 50)); // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ\r\n    }\r\n\r\n    console.log(`‚úÖ –¢–ï–°–¢: –°–æ–∑–¥–∞–Ω–æ ${frames.length} –∫–∞–¥—Ä–æ–≤`);\r\n    return frames;\r\n  };\r\n\r\n  // –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ\r\n  const encodeTestVideo = async (frames, audioFile, duration) => {\r\n    if (!window.fetchFile || frames.length === 0) {\r\n      throw new Error(\"–¢–ï–°–¢: –ù–µ—Ç –∫–∞–¥—Ä–æ–≤\");\r\n    }\r\n\r\n    try {\r\n      setExportProgress(50);\r\n      console.log(`üé¨ –¢–ï–°–¢: –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ${frames.length} –∫–∞–¥—Ä–æ–≤`);\r\n\r\n      // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º PNG –∫–∞–¥—Ä—ã\r\n      for (let i = 0; i < frames.length; i++) {\r\n        const frameData = await window.fetchFile(frames[i]);\r\n        const filename = `frame_${i.toString().padStart(4, \"0\")}.png`;\r\n        await ffmpeg.writeFile(filename, frameData);\r\n        \r\n        if (i % 10 === 0) {\r\n          setExportProgress(50 + Math.round((i / frames.length) * 30));\r\n        }\r\n      }\r\n\r\n      setExportProgress(80);\r\n\r\n      // FFmpeg –∫–æ–º–∞–Ω–¥–∞\r\n      const args = [\r\n        \"-framerate\", exportSettings.fps.toString(),\r\n        \"-i\", \"frame_%04d.png\",\r\n        \"-t\", Math.min(duration, frames.length / exportSettings.fps).toString(),\r\n      ];\r\n\r\n      // –ê—É–¥–∏–æ\r\n      if (audioFile) {\r\n        const audioData = await window.fetchFile(audioFile.blob);\r\n        await ffmpeg.writeFile(\"audio.mp3\", audioData);\r\n        args.push(\"-i\", \"audio.mp3\", \"-c:a\", \"aac\", \"-b:a\", \"128k\", \"-shortest\");\r\n        console.log(`üéµ –¢–ï–°–¢: –ê—É–¥–∏–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ`);\r\n      }\r\n\r\n      // –í–∏–¥–µ–æ –∫–æ–¥–µ–∫\r\n      args.push(\r\n        \"-c:v\", \"libx264\",\r\n        \"-preset\", \"fast\", // –ë—ã—Å—Ç—Ä–µ–µ —á–µ–º ultrafast\r\n        \"-crf\", \"18\", // –õ—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ\r\n        \"-pix_fmt\", \"yuv420p\",\r\n        \"-movflags\", \"+faststart\",\r\n        \"test_output.mp4\"\r\n      );\r\n\r\n      console.log(`üîß –¢–ï–°–¢: FFmpeg –∫–æ–º–∞–Ω–¥–∞:`, args.join(\" \"));\r\n\r\n      await ffmpeg.exec(args);\r\n\r\n      setExportProgress(90);\r\n\r\n      const data = await ffmpeg.readFile(\"test_output.mp4\");\r\n      const videoBlob = new Blob([data.buffer], { type: \"video/mp4\" });\r\n\r\n      // –û—á–∏—Å—Ç–∫–∞\r\n      for (let i = 0; i < frames.length; i++) {\r\n        try {\r\n          await ffmpeg.deleteFile(`frame_${i.toString().padStart(4, \"0\")}.png`);\r\n        } catch (e) {}\r\n      }\r\n      if (audioFile) {\r\n        try { await ffmpeg.deleteFile(\"audio.mp3\"); } catch (e) {}\r\n      }\r\n      try { await ffmpeg.deleteFile(\"test_output.mp4\"); } catch (e) {}\r\n\r\n      console.log(`‚úÖ –¢–ï–°–¢: –í–∏–¥–µ–æ —Å–æ–∑–¥–∞–Ω–æ ${(videoBlob.size / 1024 / 1024).toFixed(2)}MB`);\r\n      return videoBlob;\r\n      \r\n    } catch (error) {\r\n      throw new Error(`–¢–ï–°–¢: –û—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞\r\n  const startTestExport = async () => {\r\n    if (!ffmpeg || isExporting || timelineItems.length === 0) return;\r\n\r\n    setIsExporting(true);\r\n    setExportProgress(0);\r\n    setExportStage(\"processing\");\r\n    setError(null);\r\n    setExportedBlob(null);\r\n\r\n    try {\r\n      console.log(\"üî¥ –¢–ï–°–¢: –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏\");\r\n      console.log(`üìä –¢–ï–°–¢: Timeline: ${timelineItems.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤`);\r\n\r\n      const actualDuration = Math.min(exportSettings.duration, 10); // –ú–∞–∫—Å–∏–º—É–º 10 —Å–µ–∫ –¥–ª—è —Ç–µ—Å—Ç–∞\r\n\r\n      setExportStage(\"rendering\");\r\n      const frames = await createTestFrames(actualDuration);\r\n\r\n      if (frames.length === 0) {\r\n        throw new Error(\"–¢–ï–°–¢: –ù–µ—Ç –∫–∞–¥—Ä–æ–≤\");\r\n      }\r\n\r\n      const audioFile = await prepareAudio();\r\n\r\n      setExportStage(\"encoding\");\r\n      const videoBlob = await encodeTestVideo(frames, audioFile, actualDuration);\r\n\r\n      setExportProgress(100);\r\n      setExportStage(\"completed\");\r\n      setExportedBlob(videoBlob);\r\n\r\n      console.log(`‚úÖ –¢–ï–°–¢: –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!`);\r\n    } catch (error) {\r\n      console.error(\"‚ùå –¢–ï–°–¢: –û—à–∏–±–∫–∞:\", error);\r\n      setError(error.message);\r\n      setExportStage(\"error\");\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const downloadVideo = () => {\r\n    if (!exportedBlob) return;\r\n    const url = URL.createObjectURL(exportedBlob);\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = `TEST_export_${Date.now()}.mp4`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const getStageText = () => {\r\n    switch (exportStage) {\r\n      case \"loading\": return \"–ó–∞–≥—Ä—É–∑–∫–∞ FFmpeg...\";\r\n      case \"processing\": return \"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¢–ï–°–¢–ê...\";\r\n      case \"rendering\": return \"–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¢–ï–°–¢–û–í–´–• –∫–∞–¥—Ä–æ–≤...\";\r\n      case \"encoding\": return \"–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¢–ï–°–¢–ê...\";\r\n      case \"completed\": return \"‚úÖ –¢–ï–°–¢ –≥–æ—Ç–æ–≤!\";\r\n      case \"error\": return \"‚ùå –¢–ï–°–¢ –æ—à–∏–±–∫–∞\";\r\n      default: return \"–ì–æ—Ç–æ–≤ –∫ –¢–ï–°–¢–û–í–û–ú–£ —ç–∫—Å–ø–æ—Ä—Ç—É\";\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-2xl shadow-xl max-w-lg w-full p-6\">\r\n        <h2 className=\"text-xl font-bold mb-4 flex items-center\">\r\n          <Zap size={24} className=\"mr-3 text-red-600\" />\r\n          üî¥ –¢–ï–°–¢ —ç–∫—Å–ø–æ—Ä—Ç —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏\r\n        </h2>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* –¢–µ—Å—Ç–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ */}\r\n          <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\r\n            <h3 className=\"font-medium text-red-800 mb-2 flex items-center\">\r\n              <Settings size={16} className=\"mr-2\" />\r\n              –¢–ï–°–¢–û–í–´–ï –Ω–∞—Å—Ç—Ä–æ–π–∫–∏\r\n            </h3>\r\n            <div className=\"text-sm text-red-700 space-y-1\">\r\n              <p>‚Ä¢ –ö—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç —Å–ª–µ–≤–∞ —Å–≤–µ—Ä—Ö—É</p>\r\n              <p>‚Ä¢ –°–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É</p>\r\n              <p>‚Ä¢ Overlay —ç–ª–µ–º–µ–Ω—Ç—ã —É–≤–µ–ª–∏—á–µ–Ω—ã –≤ 3 —Ä–∞–∑–∞</p>\r\n              <p>‚Ä¢ –ó–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ overlay</p>\r\n              <p>‚Ä¢ –ñ–µ–ª—Ç—ã–π —Ç–µ–∫—Å—Ç —Å –≤—Ä–µ–º–µ–Ω–µ–º</p>\r\n              <p>‚Ä¢ –ú–∞–∫—Å–∏–º—É–º 10 —Å–µ–∫—É–Ω–¥, 100 –∫–∞–¥—Ä–æ–≤</p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* –°—Ç–∞—Ç—É—Å */}\r\n          <div className={`p-4 rounded-lg ${\r\n            exportStage === \"error\" ? \"bg-red-50\" :\r\n            exportStage === \"completed\" ? \"bg-green-50\" : \"bg-blue-50\"\r\n          }`}>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <span className=\"font-medium\">{getStageText()}</span>\r\n              {isExporting && <span className=\"text-sm\">{exportProgress}%</span>}\r\n            </div>\r\n            {isExporting && (\r\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                <div\r\n                  className=\"bg-blue-600 h-2 rounded-full transition-all\"\r\n                  style={{ width: `${exportProgress}%` }}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* –û—à–∏–±–∫–∞ */}\r\n          {error && (\r\n            <div className=\"bg-red-50 p-4 rounded-lg\">\r\n              <div className=\"text-red-800 font-medium\">–¢–ï–°–¢ –û—à–∏–±–∫–∞</div>\r\n              <div className=\"text-red-600 text-sm\">{error}</div>\r\n            </div>\r\n          )}\r\n\r\n          {/* –†–µ–∑—É–ª—å—Ç–∞—Ç */}\r\n          {exportedBlob && (\r\n            <div className=\"bg-green-50 p-4 rounded-lg\">\r\n              <div className=\"text-green-800 font-medium mb-2\">\r\n                ‚úÖ –¢–ï–°–¢ –≤–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ! –†–∞–∑–º–µ—Ä: {(exportedBlob.size / 1024 / 1024).toFixed(2)}MB\r\n              </div>\r\n              <div className=\"text-green-700 text-sm mb-3\">\r\n                –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏–¥–µ–æ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ: –∫—Ä–∞—Å–Ω–æ–≥–æ/—Å–∏–Ω–µ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤, overlay —Å –∑–µ–ª–µ–Ω–æ–π —Ä–∞–º–∫–æ–π, –∂–µ–ª—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ –∑–≤—É–∫–∞\r\n              </div>\r\n              <button\r\n                onClick={downloadVideo}\r\n                className=\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center\"\r\n              >\r\n                <Download size={16} className=\"mr-2\" />\r\n                –°–∫–∞—á–∞—Ç—å –¢–ï–°–¢\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */}\r\n          <div className=\"text-xs text-gray-600 bg-gray-50 p-3 rounded\">\r\n            <div>Timeline —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {timelineItems.length}</div>\r\n            <div>Overlay —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {timelineItems.filter(item => item.trackType === \"overlay\").length}</div>\r\n            <div>–ê—É–¥–∏–æ —Ç—Ä–µ–∫–æ–≤: {timelineItems.filter(item => item.trackType === \"audio\").length}</div>\r\n            <div className=\"mt-2 font-medium\">\r\n              üî¥ –¢–ï–°–¢: –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω—ã –∏ –≤—ã–¥–µ–ª–µ–Ω—ã\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between mt-6\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n            disabled={isExporting}\r\n          >\r\n            –ó–∞–∫—Ä—ã—Ç—å\r\n          </button>\r\n\r\n          <button\r\n            onClick={startTestExport}\r\n            disabled={!ffmpeg || isExporting || timelineItems.length === 0}\r\n            className=\"bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 flex items-center disabled:bg-gray-400\"\r\n          >\r\n            <Zap size={16} className=\"mr-2\" />\r\n            {isExporting ? `–¢–ï–°–¢ ${exportProgress}%` : \"üî¥ –¢–ï–°–¢ —ç–∫—Å–ø–æ—Ä—Ç\"}\r\n          </button>\r\n        </div>\r\n\r\n        <canvas ref={canvasRef} style={{ display: \"none\" }} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const useFFmpegExporter = () => {\r\n  const [isExportModalOpen, setIsExportModalOpen] = useState(false);\r\n\r\n  const openExportModal = () => setIsExportModalOpen(true);\r\n  const closeExportModal = () => setIsExportModalOpen(false);\r\n\r\n  return {\r\n    isExportModalOpen,\r\n    openExportModal,\r\n    closeExportModal,\r\n  };\r\n};\r\n\r\nexport default FFmpegVideoExporter;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}