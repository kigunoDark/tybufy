{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\VideoEditor\\\\VideoEditor.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Upload, Play, Pause, Volume2, Video, Music, SkipBack, SkipForward, VolumeX, Copy, Trash2, Scissors, Image, Film, Plus, Layers, ZoomIn, ZoomOut, RotateCcw, HelpCircle, X, AlertCircle, CheckCircle, Loader } from \"lucide-react\";\n// Встроенная реализация MediaStorage\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nclass EmbeddedMediaStorage {\n  constructor() {\n    this.dbName = 'VideoEditorDB';\n    this.version = 1;\n    this.db = null;\n    this.fallbackMode = false;\n    this.memoryStorage = new Map();\n    this.limits = {\n      videos: 5,\n      images: 10,\n      audios: 5,\n      maxFileSize: 100 * 1024 * 1024,\n      // 100MB\n      retentionDays: 7\n    };\n  }\n  isIndexedDBSupported() {\n    return 'indexedDB' in window && indexedDB !== null;\n  }\n  async init() {\n    if (!this.isIndexedDBSupported()) {\n      console.warn('IndexedDB not supported, using fallback mode');\n      this.fallbackMode = true;\n      return this.initFallback();\n    }\n    try {\n      return await this.initIndexedDB();\n    } catch (error) {\n      console.warn('IndexedDB initialization failed, switching to fallback mode:', error);\n      this.fallbackMode = true;\n      return this.initFallback();\n    }\n  }\n  async initIndexedDB() {\n    return new Promise((resolve, reject) => {\n      try {\n        const request = indexedDB.open(this.dbName, this.version);\n        request.onerror = () => {\n          var _request$error;\n          console.error('IndexedDB error:', request.error);\n          reject(new Error(`IndexedDB error: ${((_request$error = request.error) === null || _request$error === void 0 ? void 0 : _request$error.message) || 'Unknown error'}`));\n        };\n        request.onsuccess = () => {\n          this.db = request.result;\n          console.log('IndexedDB initialized successfully');\n          resolve(this.db);\n        };\n        request.onupgradeneeded = event => {\n          try {\n            const db = event.target.result;\n            if (!db.objectStoreNames.contains('files')) {\n              const fileStore = db.createObjectStore('files', {\n                keyPath: 'id'\n              });\n              fileStore.createIndex('type', 'type');\n              fileStore.createIndex('createdAt', 'createdAt');\n              console.log('IndexedDB store created');\n            }\n          } catch (upgradeError) {\n            console.error('IndexedDB upgrade error:', upgradeError);\n            reject(upgradeError);\n          }\n        };\n        request.onblocked = () => {\n          console.warn('IndexedDB blocked - another tab may be open');\n          reject(new Error('IndexedDB blocked by another tab'));\n        };\n      } catch (error) {\n        console.error('IndexedDB initialization error:', error);\n        reject(error);\n      }\n    });\n  }\n  async initFallback() {\n    console.log('Initializing fallback storage mode');\n    this.fallbackMode = true;\n    try {\n      const savedData = localStorage.getItem('mediaFiles');\n      if (savedData) {\n        const parsedData = JSON.parse(savedData);\n        for (const [key, value] of Object.entries(parsedData)) {\n          // Пересоздаем blob из base64 если есть\n          if (value.base64Data) {\n            try {\n              const blob = this.base64ToBlob(value.base64Data, value.mimetype);\n              value.blob = blob;\n              value.url = URL.createObjectURL(blob);\n            } catch (e) {\n              console.warn('Failed to restore blob from base64:', e);\n              continue;\n            }\n          }\n          this.memoryStorage.set(key, value);\n        }\n      }\n    } catch (error) {\n      console.warn('Failed to load from localStorage:', error);\n    }\n    return true;\n  }\n\n  // Преобразование blob в base64 для localStorage\n  async blobToBase64(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result.split(',')[1]);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Преобразование base64 обратно в blob\n  base64ToBlob(base64, mimeType) {\n    const byteCharacters = atob(base64);\n    const byteNumbers = new Array(byteCharacters.length);\n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    const byteArray = new Uint8Array(byteNumbers);\n    return new Blob([byteArray], {\n      type: mimeType\n    });\n  }\n  async saveFile(file, type) {\n    if (file.size > this.limits.maxFileSize) {\n      throw new Error(`File too large. Max size: ${this.limits.maxFileSize / (1024 * 1024)}MB`);\n    }\n    const currentFiles = await this.getFilesByType(type);\n    if (currentFiles.length >= this.limits[type]) {\n      throw new Error(`Storage limit reached. Max ${this.limits[type]} ${type} allowed.`);\n    }\n    const fileData = {\n      id: Date.now() + Math.random(),\n      name: file.name,\n      type: type,\n      size: file.size,\n      mimetype: file.type,\n      blob: file,\n      url: URL.createObjectURL(file),\n      createdAt: new Date().toISOString(),\n      expiresAt: new Date(Date.now() + this.limits.retentionDays * 24 * 60 * 60 * 1000).toISOString()\n    };\n\n    // Добавляем метаданные\n    try {\n      if (type === 'videos') {\n        fileData.duration = await this.getVideoDuration(file);\n      } else if (type === 'images') {\n        const dimensions = await this.getImageDimensions(file);\n        fileData.width = dimensions.width;\n        fileData.height = dimensions.height;\n      } else if (type === 'audios') {\n        fileData.duration = await this.getAudioDuration(file);\n      }\n    } catch (metaError) {\n      console.warn('Failed to get file metadata:', metaError);\n    }\n    if (this.fallbackMode) {\n      return this.saveToFallback(fileData);\n    } else {\n      return this.saveToIndexedDB(fileData);\n    }\n  }\n  async saveToIndexedDB(fileData) {\n    return new Promise((resolve, reject) => {\n      try {\n        const transaction = this.db.transaction(['files'], 'readwrite');\n        const store = transaction.objectStore('files');\n        const request = store.add(fileData);\n        request.onsuccess = () => {\n          this.updateStorageInfo();\n          resolve(fileData);\n        };\n        request.onerror = () => {\n          var _request$error2;\n          console.error('IndexedDB save error:', request.error);\n          reject(new Error(`Failed to save to IndexedDB: ${((_request$error2 = request.error) === null || _request$error2 === void 0 ? void 0 : _request$error2.message) || 'Unknown error'}`));\n        };\n      } catch (error) {\n        console.error('IndexedDB transaction error:', error);\n        reject(error);\n      }\n    });\n  }\n  async saveToFallback(fileData) {\n    try {\n      // Конвертируем blob в base64 для localStorage\n      const base64Data = await this.blobToBase64(fileData.blob);\n      const storageData = {\n        ...fileData\n      };\n      storageData.base64Data = base64Data;\n      delete storageData.blob; // Не сохраняем blob в localStorage\n\n      this.memoryStorage.set(fileData.id.toString(), fileData);\n\n      // Сохраняем в localStorage\n      try {\n        const allMeta = {};\n        for (const [key, value] of this.memoryStorage.entries()) {\n          const base64 = await this.blobToBase64(value.blob);\n          allMeta[key] = {\n            ...value,\n            base64Data: base64,\n            blob: undefined,\n            url: undefined // URL пересоздадим при загрузке\n          };\n        }\n        localStorage.setItem('mediaFiles', JSON.stringify(allMeta));\n      } catch (lsError) {\n        console.warn('Failed to save to localStorage:', lsError);\n      }\n      this.updateStorageInfo();\n      return fileData;\n    } catch (error) {\n      console.error('Fallback save error:', error);\n      throw error;\n    }\n  }\n  async getFilesByType(type) {\n    if (this.fallbackMode) {\n      return this.getFromFallback(type);\n    } else {\n      return this.getFromIndexedDB(type);\n    }\n  }\n  async getFromIndexedDB(type) {\n    return new Promise((resolve, reject) => {\n      try {\n        const transaction = this.db.transaction(['files'], 'readonly');\n        const store = transaction.objectStore('files');\n        const index = store.index('type');\n        const request = index.getAll(type);\n        request.onsuccess = () => {\n          const now = new Date();\n          const validFiles = request.result.filter(file => {\n            return new Date(file.expiresAt) > now;\n          }).map(file => {\n            // Пересоздаем URL если его нет\n            if (!file.url && file.blob) {\n              file.url = URL.createObjectURL(file.blob);\n            }\n            return file;\n          });\n          resolve(validFiles);\n        };\n        request.onerror = () => {\n          var _request$error3;\n          console.error('IndexedDB get error:', request.error);\n          reject(new Error(`Failed to get from IndexedDB: ${((_request$error3 = request.error) === null || _request$error3 === void 0 ? void 0 : _request$error3.message) || 'Unknown error'}`));\n        };\n      } catch (error) {\n        console.error('IndexedDB get transaction error:', error);\n        reject(error);\n      }\n    });\n  }\n  async getFromFallback(type) {\n    const now = new Date();\n    const files = [];\n    for (const [key, file] of this.memoryStorage.entries()) {\n      if (file.type === type && new Date(file.expiresAt) > now) {\n        // Пересоздаем URL если его нет\n        if (!file.url && file.blob) {\n          file.url = URL.createObjectURL(file.blob);\n        }\n        files.push(file);\n      }\n    }\n    return files;\n  }\n  async getAllFiles() {\n    try {\n      const videos = await this.getFilesByType('videos');\n      const images = await this.getFilesByType('images');\n      const audios = await this.getFilesByType('audios');\n      return {\n        videos,\n        images,\n        audios\n      };\n    } catch (error) {\n      console.error('Get all files error:', error);\n      return {\n        videos: [],\n        images: [],\n        audios: []\n      };\n    }\n  }\n  async deleteFile(id) {\n    if (this.fallbackMode) {\n      return this.deleteFromFallback(id);\n    } else {\n      return this.deleteFromIndexedDB(id);\n    }\n  }\n  async deleteFromIndexedDB(id) {\n    return new Promise((resolve, reject) => {\n      try {\n        const transaction = this.db.transaction(['files'], 'readwrite');\n        const store = transaction.objectStore('files');\n        const request = store.delete(id);\n        request.onsuccess = () => {\n          this.updateStorageInfo();\n          resolve();\n        };\n        request.onerror = () => {\n          var _request$error4;\n          console.error('IndexedDB delete error:', request.error);\n          reject(new Error(`Failed to delete from IndexedDB: ${((_request$error4 = request.error) === null || _request$error4 === void 0 ? void 0 : _request$error4.message) || 'Unknown error'}`));\n        };\n      } catch (error) {\n        console.error('IndexedDB delete transaction error:', error);\n        reject(error);\n      }\n    });\n  }\n  async deleteFromFallback(id) {\n    try {\n      const file = this.memoryStorage.get(id.toString());\n      if (file && file.url) {\n        URL.revokeObjectURL(file.url);\n      }\n      this.memoryStorage.delete(id.toString());\n\n      // Обновляем localStorage\n      try {\n        const allMeta = {};\n        for (const [key, value] of this.memoryStorage.entries()) {\n          const base64 = await this.blobToBase64(value.blob);\n          allMeta[key] = {\n            ...value,\n            base64Data: base64,\n            blob: undefined,\n            url: undefined\n          };\n        }\n        localStorage.setItem('mediaFiles', JSON.stringify(allMeta));\n      } catch (lsError) {\n        console.warn('Failed to update localStorage after delete:', lsError);\n      }\n      this.updateStorageInfo();\n      return true;\n    } catch (error) {\n      console.error('Fallback delete error:', error);\n      throw error;\n    }\n  }\n  async canUpload(type) {\n    try {\n      const files = await this.getFilesByType(type);\n      return files.length < this.limits[type];\n    } catch (error) {\n      console.error('Can upload check error:', error);\n      return false;\n    }\n  }\n  async getRemainingSpace(type) {\n    try {\n      const files = await this.getFilesByType(type);\n      return this.limits[type] - files.length;\n    } catch (error) {\n      console.error('Get remaining space error:', error);\n      return 0;\n    }\n  }\n  async getStorageInfo() {\n    try {\n      const files = await this.getAllFiles();\n      const totalSize = [...files.videos, ...files.images, ...files.audios].reduce((sum, file) => sum + file.size, 0);\n      return {\n        usage: {\n          videos: files.videos.length,\n          images: files.images.length,\n          audios: files.audios.length,\n          totalSize: totalSize,\n          totalSizeMB: Math.round(totalSize / (1024 * 1024))\n        },\n        limits: this.limits,\n        files: files,\n        mode: this.fallbackMode ? 'fallback' : 'indexeddb'\n      };\n    } catch (error) {\n      console.error('Get storage info error:', error);\n      return {\n        usage: {\n          videos: 0,\n          images: 0,\n          audios: 0,\n          totalSize: 0,\n          totalSizeMB: 0\n        },\n        limits: this.limits,\n        files: {\n          videos: [],\n          images: [],\n          audios: []\n        },\n        mode: this.fallbackMode ? 'fallback' : 'indexeddb'\n      };\n    }\n  }\n  async updateStorageInfo() {\n    try {\n      const info = await this.getStorageInfo();\n      localStorage.setItem('mediaStorageInfo', JSON.stringify(info));\n      window.dispatchEvent(new CustomEvent('storageUpdated', {\n        detail: info\n      }));\n    } catch (error) {\n      console.error('Update storage info error:', error);\n    }\n  }\n  async getVideoDuration(file) {\n    return new Promise(resolve => {\n      try {\n        const video = document.createElement('video');\n        video.preload = 'metadata';\n        const timeout = setTimeout(() => {\n          video.src = '';\n          resolve(10);\n        }, 5000);\n        video.onloadedmetadata = () => {\n          clearTimeout(timeout);\n          URL.revokeObjectURL(video.src);\n          resolve(video.duration || 10);\n        };\n        video.onerror = () => {\n          clearTimeout(timeout);\n          resolve(10);\n        };\n        video.src = URL.createObjectURL(file);\n      } catch (error) {\n        console.warn('Video duration error:', error);\n        resolve(10);\n      }\n    });\n  }\n  async getAudioDuration(file) {\n    return new Promise(resolve => {\n      try {\n        const audio = document.createElement('audio');\n        audio.preload = 'metadata';\n        const timeout = setTimeout(() => {\n          audio.src = '';\n          resolve(10);\n        }, 5000);\n        audio.onloadedmetadata = () => {\n          clearTimeout(timeout);\n          URL.revokeObjectURL(audio.src);\n          resolve(audio.duration || 10);\n        };\n        audio.onerror = () => {\n          clearTimeout(timeout);\n          resolve(10);\n        };\n        audio.src = URL.createObjectURL(file);\n      } catch (error) {\n        console.warn('Audio duration error:', error);\n        resolve(10);\n      }\n    });\n  }\n  async getImageDimensions(file) {\n    return new Promise(resolve => {\n      try {\n        const img = new Image();\n        const timeout = setTimeout(() => {\n          img.src = '';\n          resolve({\n            width: 0,\n            height: 0\n          });\n        }, 5000);\n        img.onload = () => {\n          clearTimeout(timeout);\n          URL.revokeObjectURL(img.src);\n          resolve({\n            width: img.width,\n            height: img.height\n          });\n        };\n        img.onerror = () => {\n          clearTimeout(timeout);\n          resolve({\n            width: 0,\n            height: 0\n          });\n        };\n        img.src = URL.createObjectURL(file);\n      } catch (error) {\n        console.warn('Image dimensions error:', error);\n        resolve({\n          width: 0,\n          height: 0\n        });\n      }\n    });\n  }\n  async cleanupExpiredFiles() {\n    try {\n      const now = new Date();\n      let expiredCount = 0;\n      if (this.fallbackMode) {\n        const keysToDelete = [];\n        for (const [key, file] of this.memoryStorage.entries()) {\n          if (new Date(file.expiresAt) <= now) {\n            keysToDelete.push(key);\n            if (file.url) {\n              URL.revokeObjectURL(file.url);\n            }\n          }\n        }\n        keysToDelete.forEach(key => this.memoryStorage.delete(key));\n        expiredCount = keysToDelete.length;\n      } else {\n        const allFiles = await new Promise(resolve => {\n          const transaction = this.db.transaction(['files'], 'readonly');\n          const store = transaction.objectStore('files');\n          const request = store.getAll();\n          request.onsuccess = () => resolve(request.result || []);\n          request.onerror = () => resolve([]);\n        });\n        const expiredFiles = allFiles.filter(file => {\n          return new Date(file.expiresAt) <= now;\n        });\n        for (const file of expiredFiles) {\n          try {\n            await this.deleteFromIndexedDB(file.id);\n            if (file.url) {\n              URL.revokeObjectURL(file.url);\n            }\n            expiredCount++;\n          } catch (deleteError) {\n            console.warn('Failed to delete expired file:', deleteError);\n          }\n        }\n      }\n      console.log(`Cleaned up ${expiredCount} expired files`);\n      return expiredCount;\n    } catch (error) {\n      console.error('Cleanup error:', error);\n      return 0;\n    }\n  }\n}\nconst MediaStorage = new EmbeddedMediaStorage();\nconst VideoEditor = () => {\n  _s();\n  var _mediaLibrary$activeT, _mediaLibrary$activeT2, _mediaLibrary$activeT3, _mediaLibrary$activeT4, _mediaLibrary$activeT5, _mediaLibrary$activeT6, _mediaLibrary$activeT7, _mediaLibrary$activeT8, _mediaLibrary$activeT9;\n  const [mediaLibrary, setMediaLibrary] = useState({\n    videos: [],\n    audios: [],\n    images: []\n  });\n\n  // Новые состояния для работы с MediaStorage\n  const [storageInfo, setStorageInfo] = useState(null);\n  const [isStorageReady, setIsStorageReady] = useState(false);\n  const [uploadingFiles, setUploadingFiles] = useState(new Set());\n  const [storageError, setStorageError] = useState(null);\n  const [timelineItems, setTimelineItems] = useState([]);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [videoDuration, setVideoDuration] = useState(60);\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\n  const [timelineZoom, setTimelineZoom] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"videos\");\n  const [volume, setVolume] = useState(1);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\n  const [draggedItem, setDraggedItem] = useState(null);\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\n  const [dropPreview, setDropPreview] = useState(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState(0);\n  const [copiedItem, setCopiedItem] = useState(null);\n\n  // Новые состояния для resize\n  const [isResizing, setIsResizing] = useState(false);\n  const [resizeHandle, setResizeHandle] = useState(null); // 'left' | 'right'\n  const [resizeItem, setResizeItem] = useState(null);\n  const [originalItemData, setOriginalItemData] = useState(null);\n\n  // Состояния для управления overlays на видео\n  const [selectedOverlay, setSelectedOverlay] = useState(null);\n  const [overlayTransforms, setOverlayTransforms] = useState({}); // { overlayId: { x, y, scale, opacity } }\n  const [isDraggingOverlay, setIsDraggingOverlay] = useState(false);\n  const [isResizingOverlay, setIsResizingOverlay] = useState(false);\n  const [overlayDragStart, setOverlayDragStart] = useState({\n    x: 0,\n    y: 0\n  });\n  const [resizeOverlayHandle, setResizeOverlayHandle] = useState(null);\n  const [initialOverlayTransform, setInitialOverlayTransform] = useState(null);\n\n  // Модальное окно помощи\n  const [showHelp, setShowHelp] = useState(false);\n\n  // Треки как в CapCut\n  const [tracks, setTracks] = useState({\n    overlays: [{\n      id: 'overlay-1',\n      name: 'Overlay 1',\n      type: 'overlay'\n    }, {\n      id: 'overlay-2',\n      name: 'Overlay 2',\n      type: 'overlay'\n    }],\n    main: [{\n      id: 'main-video',\n      name: 'Main Video',\n      type: 'main'\n    }],\n    audio: [{\n      id: 'audio-1',\n      name: 'Audio 1',\n      type: 'audio'\n    }, {\n      id: 'audio-2',\n      name: 'Audio 2',\n      type: 'audio'\n    }]\n  });\n  const timelineRef = useRef(null);\n  const timelineScrollRef = useRef(null);\n  const trackLabelsRef = useRef(null);\n  const intervalRef = useRef(null);\n  const audioElementsRef = useRef(new Map());\n  const fileInputRef = useRef(null);\n  const audioInputRef = useRef(null);\n  const imageInputRef = useRef(null);\n  const videoRef = useRef(null);\n  const autoScrollIntervalRef = useRef(null);\n  const videoContainerRef = useRef(null);\n\n  // Инициализация MediaStorage при загрузке компонента\n  useEffect(() => {\n    const initStorage = async () => {\n      try {\n        setStorageError(null);\n        await MediaStorage.init();\n        setIsStorageReady(true);\n\n        // Загружаем существующие файлы\n        await loadExistingFiles();\n\n        // Получаем информацию о хранилище\n        const info = await MediaStorage.getStorageInfo();\n        setStorageInfo(info);\n\n        // Очищаем истекшие файлы\n        await MediaStorage.cleanupExpiredFiles();\n        console.log('MediaStorage initialized successfully');\n      } catch (error) {\n        console.error('Failed to initialize MediaStorage:', error);\n        setStorageError(error.message);\n        setIsStorageReady(false);\n      }\n    };\n    initStorage();\n\n    // Слушаем события обновления хранилища\n    const handleStorageUpdate = event => {\n      setStorageInfo(event.detail);\n    };\n    window.addEventListener('storageUpdated', handleStorageUpdate);\n    return () => {\n      window.removeEventListener('storageUpdated', handleStorageUpdate);\n    };\n  }, []);\n\n  // Загрузка существующих файлов из MediaStorage\n  const loadExistingFiles = async () => {\n    try {\n      const files = await MediaStorage.getAllFiles();\n      setMediaLibrary(files);\n      console.log('Loaded existing files from storage:', files);\n    } catch (error) {\n      console.error('Failed to load existing files:', error);\n    }\n  };\n\n  // Базовые функции\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    const ms = Math.floor(seconds % 1 * 100);\n    return timelineZoom > 5 ? `${mins}:${secs.toString().padStart(2, \"0\")}.${ms.toString().padStart(2, \"0\")}` : `${mins}:${secs.toString().padStart(2, \"0\")}`;\n  };\n  const formatFileSize = bytes => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n  };\n  const handlePlayPause = () => {\n    setIsPlaying(!isPlaying);\n  };\n  const seekTo = time => {\n    const newTime = Math.max(0, Math.min(videoDuration, time));\n    setCurrentTime(newTime);\n    const content = getCurrentTimelineContent();\n    content.audio.forEach(audioItem => {\n      const audioElement = audioElementsRef.current.get(audioItem.id);\n      if (audioElement) {\n        const relativeTime = newTime - audioItem.startTime;\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    });\n  };\n  const getCurrentTimelineContent = useCallback(() => {\n    const currentItems = timelineItems.filter(item => currentTime >= item.startTime && currentTime < item.startTime + item.duration);\n    return {\n      mainVideo: currentItems.find(item => item.trackType === 'main' && item.type === 'video'),\n      overlays: currentItems.filter(item => item.trackType === 'overlay'),\n      audio: currentItems.filter(item => item.trackType === 'audio')\n    };\n  }, [currentTime, timelineItems]);\n  const createAudioElement = useCallback(audioItem => {\n    if (!audioElementsRef.current.has(audioItem.id)) {\n      const audio = document.createElement('audio');\n      audio.src = audioItem.url;\n      audio.volume = (audioItem.volume || 1) * volume;\n      audio.muted = isMuted;\n      audio.preload = \"metadata\";\n      audioElementsRef.current.set(audioItem.id, audio);\n    }\n    return audioElementsRef.current.get(audioItem.id);\n  }, [volume, isMuted]);\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\n    const audioElement = audioElementsRef.current.get(audioItem.id);\n    if (audioElement) {\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\n      if (timeDiff > 0.2) {\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    }\n  }, []);\n  const checkCollision = useCallback((newItem, excludeId = null) => {\n    return timelineItems.some(item => {\n      if (item.id === excludeId) return false;\n      if (item.trackId !== newItem.trackId) return false;\n      const itemStart = item.startTime;\n      const itemEnd = item.startTime + item.duration;\n      const newStart = newItem.startTime;\n      const newEnd = newItem.startTime + newItem.duration;\n      return newStart < itemEnd && newEnd > itemStart;\n    });\n  }, [timelineItems]);\n\n  // Функция для вставки с автоматическим сдвигом блоков (как в CapCut)\n  const insertWithRipple = useCallback((trackId, insertTime, duration, excludeId = null) => {\n    const trackItems = timelineItems.filter(item => item.trackId === trackId && item.id !== excludeId).sort((a, b) => a.startTime - b.startTime);\n\n    // Если трек пустой\n    if (trackItems.length === 0) {\n      return {\n        time: Math.max(0, insertTime),\n        shouldRipple: false,\n        affectedItems: []\n      };\n    }\n\n    // Ищем где вставить\n    let insertPosition = insertTime;\n    let shouldRipple = false;\n    let affectedItems = [];\n\n    // Проверяем есть ли точно в этом месте блок\n    const blockAtPosition = trackItems.find(item => insertTime >= item.startTime && insertTime < item.startTime + item.duration);\n    if (blockAtPosition) {\n      // Вставляем в начало этого блока и сдвигаем все что справа\n      insertPosition = blockAtPosition.startTime;\n      shouldRipple = true;\n      affectedItems = trackItems.filter(item => item.startTime >= insertPosition);\n    } else {\n      // Ищем блоки которые нужно сдвинуть\n      const blocksToShift = trackItems.filter(item => item.startTime >= insertTime);\n      if (blocksToShift.length > 0) {\n        // Проверяем, есть ли место без сдвига\n        const nextBlock = blocksToShift[0];\n        const availableSpace = nextBlock.startTime - insertTime;\n        if (availableSpace >= duration) {\n          // Помещается без сдвига\n          insertPosition = insertTime;\n          shouldRipple = false;\n        } else {\n          // Нужно сдвинуть\n          insertPosition = insertTime;\n          shouldRipple = true;\n          affectedItems = blocksToShift;\n        }\n      } else {\n        // Вставляем в конец\n        insertPosition = insertTime;\n        shouldRipple = false;\n      }\n    }\n    return {\n      time: Math.max(0, insertPosition),\n      shouldRipple,\n      affectedItems,\n      shiftAmount: shouldRipple ? duration : 0\n    };\n  }, [timelineItems]);\n\n  // Функция для поиска ближайшего свободного места (обратная совместимость)\n  const findNearestValidPosition = useCallback((trackId, dropTime, duration, excludeId = null) => {\n    const result = insertWithRipple(trackId, dropTime, duration, excludeId);\n    return {\n      time: result.time,\n      isExact: !result.shouldRipple\n    };\n  }, [insertWithRipple]);\n\n  // Функция для применения ripple effect\n  const applyRippleEffect = useCallback((affectedItems, shiftAmount) => {\n    if (!affectedItems.length || shiftAmount <= 0) return;\n    console.log('Applying ripple effect:', {\n      affectedCount: affectedItems.length,\n      shiftAmount,\n      affectedItems: affectedItems.map(item => ({\n        name: item.name,\n        oldStart: item.startTime\n      }))\n    });\n    setTimelineItems(prev => prev.map(item => {\n      const affectedItem = affectedItems.find(affected => affected.id === item.id);\n      if (affectedItem) {\n        console.log(`Shifting ${item.name} from ${item.startTime} to ${item.startTime + shiftAmount}`);\n        return {\n          ...item,\n          startTime: item.startTime + shiftAmount\n        };\n      }\n      return item;\n    }));\n\n    // Обновляем общую длительность если нужно\n    if (affectedItems.length > 0) {\n      const maxEndTime = Math.max(...affectedItems.map(item => item.startTime + item.duration + shiftAmount));\n      if (maxEndTime > videoDuration) {\n        setVideoDuration(maxEndTime + 10);\n      }\n    }\n  }, [videoDuration]);\n  const findNextAvailablePosition = useCallback((trackId, duration, preferredStart = 0) => {\n    const trackItems = timelineItems.filter(item => item.trackId === trackId).sort((a, b) => a.startTime - b.startTime);\n    if (preferredStart >= 0) {\n      const testItem = {\n        trackId,\n        startTime: preferredStart,\n        duration\n      };\n      if (!checkCollision(testItem)) {\n        return preferredStart;\n      }\n    }\n    for (let i = 0; i < trackItems.length; i++) {\n      const currentItem = trackItems[i];\n      const nextItem = trackItems[i + 1];\n      if (i === 0 && currentItem.startTime >= duration) {\n        return 0;\n      }\n      if (nextItem) {\n        const gapStart = currentItem.startTime + currentItem.duration;\n        const gapEnd = nextItem.startTime;\n        const gapSize = gapEnd - gapStart;\n        if (gapSize >= duration) {\n          return gapStart;\n        }\n      }\n    }\n    if (trackItems.length === 0) return 0;\n    const lastItem = trackItems[trackItems.length - 1];\n    return lastItem.startTime + lastItem.duration;\n  }, [timelineItems, checkCollision]);\n  const removeFromTimeline = itemId => {\n    const audioElement = audioElementsRef.current.get(itemId);\n    if (audioElement) {\n      audioElement.pause();\n      audioElement.src = '';\n      audioElementsRef.current.delete(itemId);\n    }\n    setTimelineItems(prev => prev.filter(item => item.id !== itemId));\n    setSelectedTimelineItem(null);\n  };\n\n  // Функции для управления overlays на видео\n  const getOverlayTransform = useCallback(overlayId => {\n    return overlayTransforms[overlayId] || {\n      x: 0,\n      y: 0,\n      scale: 1,\n      opacity: 1\n    };\n  }, [overlayTransforms]);\n  const updateOverlayTransform = useCallback((overlayId, updates) => {\n    setOverlayTransforms(prev => ({\n      ...prev,\n      [overlayId]: {\n        ...getOverlayTransform(overlayId),\n        ...updates\n      }\n    }));\n  }, [getOverlayTransform]);\n  const handleOverlayMouseDown = useCallback((e, overlay) => {\n    if (e.target.closest('.resize-handle')) return; // Не начинаем drag если кликнули на resize handle\n\n    e.preventDefault();\n    e.stopPropagation();\n    setSelectedOverlay(overlay);\n    setIsDraggingOverlay(true);\n    const container = videoContainerRef.current;\n    if (!container) return;\n    const containerRect = container.getBoundingClientRect();\n    const overlayElement = e.currentTarget;\n    const overlayRect = overlayElement.getBoundingClientRect();\n    const transform = getOverlayTransform(overlay.id);\n\n    // Запоминаем точный offset от позиции мыши до текущей позиции элемента\n    setOverlayDragStart({\n      x: e.clientX - overlayRect.left,\n      y: e.clientY - overlayRect.top,\n      containerX: containerRect.left,\n      containerY: containerRect.top\n    });\n  }, [getOverlayTransform]);\n  const handleOverlayResizeStart = useCallback((e, overlay, handle) => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log('Starting resize:', handle); // Для отладки\n\n    setSelectedOverlay(overlay);\n    setIsResizingOverlay(true);\n    setResizeOverlayHandle(handle);\n    const currentTransform = getOverlayTransform(overlay.id);\n    setInitialOverlayTransform(currentTransform);\n    setOverlayDragStart({\n      x: e.clientX,\n      y: e.clientY,\n      startScale: currentTransform.scale,\n      startX: currentTransform.x,\n      startY: currentTransform.y\n    });\n  }, [getOverlayTransform]);\n  const handleOverlayMouseMove = useCallback(e => {\n    if (!selectedOverlay) return;\n    if (isDraggingOverlay) {\n      // Перетаскивание с максимальной плавностью\n      const container = videoContainerRef.current;\n      if (!container) return;\n      const rect = container.getBoundingClientRect();\n      const overlaySize = 128 * getOverlayTransform(selectedOverlay.id).scale;\n\n      // Вычисляем новую позицию с учетом начального offset\n      const newX = e.clientX - overlayDragStart.containerX - overlayDragStart.x;\n      const newY = e.clientY - overlayDragStart.containerY - overlayDragStart.y;\n\n      // Ограничиваем движение границами контейнера с учетом размера overlay\n      const padding = 5; // Минимальный отступ\n      const limitedX = Math.max(padding, Math.min(rect.width - overlaySize - padding, newX));\n      const limitedY = Math.max(padding, Math.min(rect.height - overlaySize - padding, newY));\n\n      // Обновляем позицию относительно базовой позиции\n      const baseX = 200;\n      const baseY = 50 + selectedOverlay.index * 120;\n\n      // Мгновенное обновление без debounce для плавности\n      updateOverlayTransform(selectedOverlay.id, {\n        x: limitedX - baseX,\n        y: limitedY - baseY\n      });\n    } else if (isResizingOverlay && overlayDragStart.startScale !== undefined && resizeOverlayHandle) {\n      console.log('Resizing...', resizeOverlayHandle); // Для отладки\n\n      // Простая логика resize\n      const deltaX = e.clientX - overlayDragStart.x;\n      const deltaY = e.clientY - overlayDragStart.y;\n\n      // Определяем направление и чувствительность\n      let scaleFactor = 1;\n      const sensitivity = 0.005; // Базовая чувствительность\n\n      switch (resizeOverlayHandle) {\n        case 'nw':\n          // Северо-запад: тянем влево-вверх = уменьшаем\n          scaleFactor = 1 - (deltaX + deltaY) * sensitivity;\n          break;\n        case 'ne':\n          // Северо-восток: тянем вправо-вверх = увеличиваем вправо, уменьшаем вверх  \n          scaleFactor = 1 + (deltaX - deltaY) * sensitivity;\n          break;\n        case 'sw':\n          // Юго-запад: тянем влево-вниз = уменьшаем влево, увеличиваем вниз\n          scaleFactor = 1 + (-deltaX + deltaY) * sensitivity;\n          break;\n        case 'se':\n          // Юго-восток: тянем вправо-вниз = увеличиваем\n          scaleFactor = 1 + (deltaX + deltaY) * sensitivity;\n          break;\n      }\n\n      // Применяем новый масштаб\n      const newScale = Math.max(0.2, Math.min(4, overlayDragStart.startScale * scaleFactor));\n\n      // Простое обновление без сложной компенсации позиции\n      updateOverlayTransform(selectedOverlay.id, {\n        scale: newScale\n      });\n    }\n  }, [selectedOverlay, isDraggingOverlay, isResizingOverlay, overlayDragStart, initialOverlayTransform, updateOverlayTransform, getOverlayTransform, resizeOverlayHandle]);\n  const handleOverlayMouseUp = useCallback(() => {\n    console.log('Mouse up - stopping drag/resize'); // Для отладки\n    setIsDraggingOverlay(false);\n    setIsResizingOverlay(false);\n    setResizeOverlayHandle(null);\n    setInitialOverlayTransform(null);\n  }, []);\n  const handleOverlayWheel = useCallback((e, overlayId) => {\n    if (!e.ctrlKey) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const transform = getOverlayTransform(overlayId);\n    const scaleDelta = e.deltaY > 0 ? -0.05 : 0.05; // Более плавное масштабирование\n    const newScale = Math.max(0.2, Math.min(4, transform.scale + scaleDelta));\n    updateOverlayTransform(overlayId, {\n      scale: newScale\n    });\n  }, [getOverlayTransform, updateOverlayTransform]);\n\n  // Функции для работы с элементами таймлайна\n  const splitTimelineItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    const item = selectedTimelineItem;\n    const splitTime = currentTime;\n    if (splitTime <= item.startTime || splitTime >= item.startTime + item.duration) {\n      return;\n    }\n    const firstPartDuration = splitTime - item.startTime;\n    const secondPartStart = splitTime;\n    const secondPartDuration = item.duration - firstPartDuration;\n    const secondPart = {\n      ...item,\n      id: Date.now() + Math.random(),\n      startTime: secondPartStart,\n      duration: secondPartDuration\n    };\n    const updatedFirstPart = {\n      ...item,\n      duration: firstPartDuration\n    };\n    setTimelineItems(prev => prev.map(timelineItem => timelineItem.id === item.id ? updatedFirstPart : timelineItem).concat(secondPart));\n    setSelectedTimelineItem(null);\n  }, [selectedTimelineItem, currentTime]);\n  const copyTimelineItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    setCopiedItem(selectedTimelineItem);\n  }, [selectedTimelineItem]);\n  const pasteTimelineItem = useCallback(() => {\n    var _insertResult$affecte;\n    if (!copiedItem) return;\n    const targetTrackId = copiedItem.trackId;\n    const insertResult = insertWithRipple(targetTrackId, currentTime, copiedItem.duration);\n\n    // Применяем ripple effect если нужно\n    if (insertResult.shouldRipple && ((_insertResult$affecte = insertResult.affectedItems) === null || _insertResult$affecte === void 0 ? void 0 : _insertResult$affecte.length) > 0) {\n      applyRippleEffect(insertResult.affectedItems, copiedItem.duration);\n    }\n    const newItem = {\n      ...copiedItem,\n      id: Date.now() + Math.random(),\n      startTime: insertResult.time\n    };\n    setTimelineItems(prev => [...prev, newItem]);\n    const newEndTime = newItem.startTime + newItem.duration;\n    if (newEndTime > videoDuration) {\n      setVideoDuration(newEndTime + 10);\n    }\n    setSelectedTimelineItem(newItem);\n  }, [copiedItem, currentTime, insertWithRipple, applyRippleEffect, videoDuration]);\n  const deleteSelectedItem = useCallback(() => {\n    if (!selectedTimelineItem) return;\n    removeFromTimeline(selectedTimelineItem.id);\n  }, [selectedTimelineItem]);\n\n  // Автопрокрутка и зум\n  const stopAutoScroll = useCallback(() => {\n    if (autoScrollIntervalRef.current) {\n      clearInterval(autoScrollIntervalRef.current);\n      autoScrollIntervalRef.current = null;\n    }\n  }, []);\n  const startAutoScroll = useCallback((direction, speed = 1) => {\n    stopAutoScroll();\n    autoScrollIntervalRef.current = setInterval(() => {\n      if (timelineScrollRef.current) {\n        const scrollAmount = 15 * speed;\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n        if (direction === 'left' && currentScrollLeft > 0) {\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\n        } else if (direction === 'right' && currentScrollLeft < maxScroll) {\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\n        }\n      }\n    }, 16); // 60fps для плавности\n  }, [stopAutoScroll]);\n  const checkAutoScroll = useCallback(clientX => {\n    if (!timelineScrollRef.current) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const scrollZoneWidth = 120;\n    const relativeX = clientX - rect.left;\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\n      startAutoScroll('left', speed);\n    } else if (relativeX > rect.width - scrollZoneWidth) {\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\n        startAutoScroll('right', speed);\n      }\n    } else {\n      stopAutoScroll();\n    }\n  }, [startAutoScroll, stopAutoScroll]);\n\n  // Функции зума\n  const zoomIn = () => {\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\n  };\n  const zoomOut = () => {\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\n  };\n  const resetZoom = () => {\n    setTimelineZoom(1);\n  };\n\n  // Функции для resize\n  const handleResizeStart = useCallback((e, item, handle) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsResizing(true);\n    setResizeHandle(handle);\n    setResizeItem(item);\n    setOriginalItemData({\n      startTime: item.startTime,\n      duration: item.duration\n    });\n\n    // Предотвращаем drag\n    setIsTimelineDragging(false);\n    setDraggedTimelineItem(null);\n  }, []);\n  const handleResizeEnd = useCallback(() => {\n    setIsResizing(false);\n    setResizeHandle(null);\n    setResizeItem(null);\n    setOriginalItemData(null);\n    stopAutoScroll();\n  }, [stopAutoScroll]);\n\n  // Синхронизация скролла\n  const handleTrackAreaScroll = e => {\n    if (trackLabelsRef.current) {\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const handleTrackLabelsScroll = e => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const getTimelineWidth = () => {\n    const baseWidth = videoDuration * 50 * timelineZoom;\n    return Math.max(baseWidth, 2000);\n  };\n  const getPixelsPerSecond = () => {\n    return 50 * timelineZoom;\n  };\n\n  // НОВЫЕ ФУНКЦИИ ДЛЯ РАБОТЫ С MEDIASTORAGE\n\n  // Обновленная функция загрузки видео с MediaStorage\n  const handleVideoUpload = async event => {\n    if (!isStorageReady) {\n      console.error('Storage not ready');\n      return;\n    }\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    for (const file of files) {\n      const fileId = Date.now() + Math.random();\n      setUploadingFiles(prev => new Set([...prev, fileId]));\n      try {\n        // Проверяем, можем ли загрузить\n        const canUpload = await MediaStorage.canUpload('videos');\n        if (!canUpload) {\n          const remaining = await MediaStorage.getRemainingSpace('videos');\n          throw new Error(`Video storage limit reached. ${remaining} slots remaining.`);\n        }\n\n        // Сохраняем файл в MediaStorage\n        const savedFile = await MediaStorage.saveFile(file, 'videos');\n        console.log('Video saved to MediaStorage:', savedFile);\n\n        // Добавляем в медиабиблиотеку\n        setMediaLibrary(prev => ({\n          ...prev,\n          videos: [...prev.videos, savedFile]\n        }));\n      } catch (error) {\n        console.error('Failed to upload video:', error);\n        setStorageError(error.message);\n      } finally {\n        setUploadingFiles(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(fileId);\n          return newSet;\n        });\n      }\n    }\n\n    // Очищаем input\n    if (event.target) {\n      event.target.value = '';\n    }\n  };\n\n  // Обновленная функция загрузки аудио с MediaStorage\n  const handleAudioUpload = async event => {\n    if (!isStorageReady) {\n      console.error('Storage not ready');\n      return;\n    }\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    for (const file of files) {\n      const fileId = Date.now() + Math.random();\n      setUploadingFiles(prev => new Set([...prev, fileId]));\n      try {\n        // Проверяем, можем ли загрузить\n        const canUpload = await MediaStorage.canUpload('audios');\n        if (!canUpload) {\n          const remaining = await MediaStorage.getRemainingSpace('audios');\n          throw new Error(`Audio storage limit reached. ${remaining} slots remaining.`);\n        }\n\n        // Сохраняем файл в MediaStorage\n        const savedFile = await MediaStorage.saveFile(file, 'audios');\n        console.log('Audio saved to MediaStorage:', savedFile);\n\n        // Добавляем в медиабиблиотеку\n        setMediaLibrary(prev => ({\n          ...prev,\n          audios: [...prev.audios, savedFile]\n        }));\n      } catch (error) {\n        console.error('Failed to upload audio:', error);\n        setStorageError(error.message);\n      } finally {\n        setUploadingFiles(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(fileId);\n          return newSet;\n        });\n      }\n    }\n\n    // Очищаем input\n    if (event.target) {\n      event.target.value = '';\n    }\n  };\n\n  // Обновленная функция загрузки изображений с MediaStorage\n  const handleImageUpload = async event => {\n    if (!isStorageReady) {\n      console.error('Storage not ready');\n      return;\n    }\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    for (const file of files) {\n      const fileId = Date.now() + Math.random();\n      setUploadingFiles(prev => new Set([...prev, fileId]));\n      try {\n        // Проверяем, можем ли загрузить\n        const canUpload = await MediaStorage.canUpload('images');\n        if (!canUpload) {\n          const remaining = await MediaStorage.getRemainingSpace('images');\n          throw new Error(`Image storage limit reached. ${remaining} slots remaining.`);\n        }\n\n        // Сохраняем файл в MediaStorage\n        const savedFile = await MediaStorage.saveFile(file, 'images');\n        console.log('Image saved to MediaStorage:', savedFile);\n\n        // Добавляем в медиабиблиотеку\n        setMediaLibrary(prev => ({\n          ...prev,\n          images: [...prev.images, savedFile]\n        }));\n      } catch (error) {\n        console.error('Failed to upload image:', error);\n        setStorageError(error.message);\n      } finally {\n        setUploadingFiles(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(fileId);\n          return newSet;\n        });\n      }\n    }\n\n    // Очищаем input\n    if (event.target) {\n      event.target.value = '';\n    }\n  };\n\n  // Обновленная функция удаления из библиотеки с MediaStorage\n  const removeFromLibrary = async (itemId, type) => {\n    try {\n      // Удаляем из MediaStorage\n      await MediaStorage.deleteFile(itemId);\n      console.log('File deleted from MediaStorage:', itemId);\n\n      // Удаляем из медиабиблиотеки\n      setMediaLibrary(prev => ({\n        ...prev,\n        [type]: prev[type].filter(item => item.id !== itemId)\n      }));\n\n      // Удаляем из таймлайна если есть\n      setTimelineItems(prev => prev.filter(item => item.mediaId !== itemId));\n    } catch (error) {\n      console.error('Failed to remove from library:', error);\n      setStorageError(error.message);\n    }\n  };\n\n  // Функция очистки Storage (для отладки)\n  const clearStorage = async () => {\n    try {\n      const allFiles = await MediaStorage.getAllFiles();\n      const allItems = [...allFiles.videos, ...allFiles.images, ...allFiles.audios];\n      for (const item of allItems) {\n        await MediaStorage.deleteFile(item.id);\n      }\n      setMediaLibrary({\n        videos: [],\n        audios: [],\n        images: []\n      });\n      setTimelineItems([]);\n      console.log('Storage cleared');\n    } catch (error) {\n      console.error('Failed to clear storage:', error);\n    }\n  };\n\n  // Эффекты для управления overlays\n  useEffect(() => {\n    if (isDraggingOverlay || isResizingOverlay) {\n      document.addEventListener('mousemove', handleOverlayMouseMove);\n      document.addEventListener('mouseup', handleOverlayMouseUp);\n      document.body.style.cursor = isDraggingOverlay ? 'grabbing' : 'nw-resize';\n      return () => {\n        document.removeEventListener('mousemove', handleOverlayMouseMove);\n        document.removeEventListener('mouseup', handleOverlayMouseUp);\n        document.body.style.cursor = '';\n      };\n    }\n  }, [isDraggingOverlay, isResizingOverlay, handleOverlayMouseMove, handleOverlayMouseUp]);\n\n  // Обработка resize во время движения мыши\n  useEffect(() => {\n    const handleMouseMove = e => {\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\n      checkAutoScroll(e.clientX);\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const pixelsPerSecond = getPixelsPerSecond();\n      const newTime = mouseX / pixelsPerSecond;\n      setTimelineItems(prev => prev.map(item => {\n        if (item.id !== resizeItem.id) return item;\n        const minDuration = 0.1;\n        if (resizeHandle === 'left') {\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\n          const newDuration = rightEdge - newStartTime;\n          return {\n            ...item,\n            startTime: newStartTime,\n            duration: newDuration\n          };\n        } else if (resizeHandle === 'right') {\n          const leftEdge = originalItemData.startTime;\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\n          const newDuration = newEndTime - leftEdge;\n          return {\n            ...item,\n            duration: newDuration\n          };\n        }\n        return item;\n      }));\n    };\n    const handleMouseUp = () => {\n      if (isResizing) {\n        handleResizeEnd();\n      }\n    };\n    if (isResizing) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd]);\n\n  // Основные эффекты\n  useEffect(() => {\n    const content = getCurrentTimelineContent();\n    if (content.mainVideo && content.mainVideo.url !== currentVideoSource) {\n      setCurrentVideoSource(content.mainVideo.url);\n      if (videoRef.current) {\n        const relativeTime = currentTime - content.mainVideo.startTime;\n        videoRef.current.currentTime = Math.max(0, relativeTime);\n      }\n    } else if (!content.mainVideo && content.overlays.find(o => o.type === 'image')) {\n      const firstImage = content.overlays.find(o => o.type === 'image');\n      setCurrentVideoSource(firstImage.url);\n    } else if (!content.mainVideo && !content.overlays.find(o => o.type === 'image')) {\n      setCurrentVideoSource(null);\n    }\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n    content.audio.forEach(audioItem => {\n      const audioElement = createAudioElement(audioItem);\n      const relativeTime = currentTime - audioItem.startTime;\n      audioElement.volume = (audioItem.volume || 1) * volume;\n      audioElement.muted = isMuted;\n      if (isPlaying && relativeTime >= 0) {\n        syncAudioTime(audioItem, relativeTime);\n        if (audioElement.paused) {\n          audioElement.play().catch(console.error);\n        }\n      } else {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource]);\n  useEffect(() => {\n    if (isPlaying) {\n      intervalRef.current = setInterval(() => {\n        setCurrentTime(prev => {\n          const newTime = prev + 0.1;\n          if (newTime >= videoDuration) {\n            setIsPlaying(false);\n            return videoDuration;\n          }\n          return newTime;\n        });\n      }, 100);\n    } else {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    }\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [isPlaying, videoDuration]);\n  useEffect(() => {\n    if (videoRef.current && currentVideoSource) {\n      const content = getCurrentTimelineContent();\n      if (content.mainVideo) {\n        const relativeTime = currentTime - content.mainVideo.startTime;\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\n        if (timeDiff > 0.5) {\n          videoRef.current.currentTime = Math.max(0, relativeTime);\n        }\n        if (isPlaying && videoRef.current.paused) {\n          videoRef.current.play().catch(console.error);\n        } else if (!isPlaying && !videoRef.current.paused) {\n          videoRef.current.pause();\n        }\n      }\n    }\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\n  useEffect(() => {\n    const currentAudioIds = new Set(timelineItems.filter(item => item.type === \"audio\").map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        audioElement.pause();\n        audioElement.src = '';\n        audioElementsRef.current.delete(id);\n      }\n    });\n  }, [timelineItems]);\n\n  // Очистка при размонтировании\n  useEffect(() => {\n    return () => {\n      stopAutoScroll();\n    };\n  }, [stopAutoScroll]);\n\n  // Обработка клавиатурных шорткатов\n  useEffect(() => {\n    const handleKeyDown = e => {\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {\n        return;\n      }\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        e.preventDefault();\n        deleteSelectedItem();\n      }\n      if (e.ctrlKey && e.key === 'b') {\n        e.preventDefault();\n        splitTimelineItem();\n      }\n      if (e.ctrlKey && e.key === 'c') {\n        e.preventDefault();\n        copyTimelineItem();\n      }\n      if (e.ctrlKey && e.key === 'v') {\n        e.preventDefault();\n        pasteTimelineItem();\n      }\n      if (e.key === ' ' || e.code === 'Space') {\n        e.preventDefault();\n        setIsPlaying(prev => !prev);\n      }\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\n        seekTo(Math.max(0, currentTime - step));\n      }\n      if (e.key === 'ArrowRight') {\n        e.preventDefault();\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\n        seekTo(Math.min(videoDuration, currentTime + step));\n      }\n      if (e.key === '=' || e.key === '+') {\n        e.preventDefault();\n        zoomIn();\n      }\n      if (e.key === '-') {\n        e.preventDefault();\n        zoomOut();\n      }\n      if (e.key === '0') {\n        e.preventDefault();\n        resetZoom();\n      }\n      if (e.key === '?' || e.shiftKey && e.key === '/') {\n        e.preventDefault();\n        setShowHelp(true);\n      }\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        if (showHelp) {\n          setShowHelp(false);\n        } else if (selectedOverlay) {\n          setSelectedOverlay(null);\n        }\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [selectedTimelineItem, copiedItem, currentTime, videoDuration, showHelp, selectedOverlay, deleteSelectedItem, splitTimelineItem, copyTimelineItem, pasteTimelineItem]);\n\n  // Обработка колесика мыши для зума\n  useEffect(() => {\n    const handleWheel = e => {\n      var _timelineRef$current;\n      if (e.ctrlKey && (_timelineRef$current = timelineRef.current) !== null && _timelineRef$current !== void 0 && _timelineRef$current.contains(e.target)) {\n        e.preventDefault();\n        if (e.deltaY < 0) {\n          zoomIn();\n        } else {\n          zoomOut();\n        }\n      }\n    };\n    document.addEventListener('wheel', handleWheel, {\n      passive: false\n    });\n    return () => document.removeEventListener('wheel', handleWheel);\n  }, []);\n  const addToTimeline = (mediaItem, startTime = null, targetTrackId = null) => {\n    let trackType, trackId;\n    if (mediaItem.type === \"video\") {\n      trackType = targetTrackId && targetTrackId.startsWith('overlay') ? 'overlay' : 'main';\n      trackId = targetTrackId || 'main-video';\n    } else if (mediaItem.type === \"image\") {\n      trackType = 'overlay';\n      trackId = targetTrackId || 'overlay-1';\n    } else if (mediaItem.type === \"audio\") {\n      trackType = 'audio';\n      trackId = targetTrackId || 'audio-1';\n    }\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\n    const finalStartTime = startTime !== null ? startTime : findNextAvailablePosition(trackId, duration);\n    const newTimelineItem = {\n      id: Date.now() + Math.random(),\n      mediaId: mediaItem.id,\n      type: mediaItem.type,\n      name: mediaItem.name,\n      url: mediaItem.url,\n      startTime: finalStartTime,\n      duration: duration,\n      trackId: trackId,\n      trackType: trackType,\n      volume: 1,\n      opacity: 1\n    };\n    setTimelineItems(prev => [...prev, newTimelineItem]);\n    const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\n    if (newEndTime > videoDuration) {\n      setVideoDuration(newEndTime + 10);\n    }\n  };\n  const addOverlayTrack = () => {\n    const newTrackId = `overlay-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      overlays: [...prev.overlays, {\n        id: newTrackId,\n        name: `Overlay ${prev.overlays.length + 1}`,\n        type: 'overlay'\n      }]\n    }));\n  };\n  const addAudioTrack = () => {\n    const newTrackId = `audio-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      audio: [...prev.audio, {\n        id: newTrackId,\n        name: `Audio ${prev.audio.length + 1}`,\n        type: 'audio'\n      }]\n    }));\n  };\n  const handleTimelineClick = e => {\n    if (isDragging || isTimelineDragging || isResizing) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    seekTo(clickTime);\n  };\n  const handleDragStart = (e, mediaItem) => {\n    setDraggedItem(mediaItem);\n    setIsDragging(true);\n    e.dataTransfer.effectAllowed = \"copy\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleDragEnd = () => {\n    setDraggedItem(null);\n    setDropPreview(null);\n    setIsDragging(false);\n  };\n  const handleTimelineItemDragStart = (e, timelineItem) => {\n    if (isResizing) {\n      e.preventDefault();\n      return;\n    }\n    e.stopPropagation();\n    setDraggedTimelineItem(timelineItem);\n    setIsTimelineDragging(true);\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const itemRect = e.target.getBoundingClientRect();\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleTimelineItemDragEnd = () => {\n    setDraggedTimelineItem(null);\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n    setDragOffset(0);\n    stopAutoScroll();\n  };\n  const handleDragOver = e => {\n    if (!draggedItem && !draggedTimelineItem) return;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\n    if (draggedTimelineItem || isResizing) {\n      checkAutoScroll(e.clientX);\n    }\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\n    const pixelsPerSecond = getPixelsPerSecond();\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\n    const trackHeight = 60;\n    const timeRulerHeight = 48;\n    const relativeY = dragY - timeRulerHeight;\n    const trackIndex = Math.floor(relativeY / trackHeight);\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const targetTrack = allTracks[trackIndex];\n    if (draggedItem && targetTrack) {\n      // Новый элемент из библиотеки\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\n      setDropPreview({\n        time: insertResult.time,\n        duration: duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    } else if (draggedTimelineItem && targetTrack) {\n      // Существующий элемент\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, draggedTimelineItem.duration, draggedTimelineItem.id);\n      setDropPreview({\n        time: insertResult.time,\n        duration: draggedTimelineItem.duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    }\n  };\n  const handleDrop = e => {\n    var _dropPreview$affected;\n    if (!draggedItem && !draggedTimelineItem || !dropPreview) return;\n    e.preventDefault();\n    stopAutoScroll();\n    console.log('Dropping with ripple:', {\n      dropPreview,\n      shouldRipple: dropPreview.shouldRipple,\n      affectedItems: ((_dropPreview$affected = dropPreview.affectedItems) === null || _dropPreview$affected === void 0 ? void 0 : _dropPreview$affected.length) || 0\n    });\n    if (dropPreview.isValid) {\n      if (draggedItem) {\n        var _dropPreview$affected2;\n        // Новый элемент из библиотеки\n        if (dropPreview.shouldRipple && ((_dropPreview$affected2 = dropPreview.affectedItems) === null || _dropPreview$affected2 === void 0 ? void 0 : _dropPreview$affected2.length) > 0) {\n          // Сначала сдвигаем существующие блоки\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\n        }\n\n        // Добавляем новый элемент\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\n        console.log('Added with ripple effect:', dropPreview.shouldRipple);\n      } else if (draggedTimelineItem) {\n        var _dropPreview$affected3;\n        // Перемещение существующего элемента\n        if (dropPreview.shouldRipple && ((_dropPreview$affected3 = dropPreview.affectedItems) === null || _dropPreview$affected3 === void 0 ? void 0 : _dropPreview$affected3.length) > 0) {\n          // Сначала сдвигаем блоки, которые нужно освободить место\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\n        }\n\n        // Перемещаем элемент\n        setTimelineItems(prev => prev.map(item => item.id === draggedTimelineItem.id ? {\n          ...item,\n          startTime: dropPreview.time,\n          trackId: dropPreview.trackId,\n          trackType: dropPreview.trackType\n        } : item));\n        console.log('Moved with ripple effect:', dropPreview.shouldRipple);\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\n        if (newEndTime > videoDuration) {\n          setVideoDuration(newEndTime + 10);\n        }\n      }\n    }\n    setDropPreview(null);\n    setDraggedItem(null);\n    setDraggedTimelineItem(null);\n    setIsDragging(false);\n    setIsTimelineDragging(false);\n  };\n  const handleDragLeave = e => {\n    var _timelineRef$current2;\n    if (!((_timelineRef$current2 = timelineRef.current) !== null && _timelineRef$current2 !== void 0 && _timelineRef$current2.contains(e.relatedTarget))) {\n      setDropPreview(null);\n      stopAutoScroll();\n    }\n  };\n  const getTimelineItemStyle = item => {\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${item.startTime * pixelsPerSecond}px`,\n      width: `${item.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getDropPreviewStyle = () => {\n    if (!dropPreview) return {};\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${dropPreview.time * pixelsPerSecond}px`,\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getTrackColor = trackType => {\n    switch (trackType) {\n      case 'overlay':\n        return 'bg-purple-500 border-purple-400';\n      case 'main':\n        return 'bg-blue-500 border-blue-400';\n      case 'audio':\n        return 'bg-green-500 border-green-400';\n      default:\n        return 'bg-gray-500 border-gray-400';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex h-screen w-full gap-4 p-4 bg-gray-100 overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-80 min-w-72 max-w-80 bg-white border-2 border-blue-200 flex flex-col rounded-2xl shadow-lg overflow-hidden flex-shrink-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 px-4 py-3 border-b border-blue-100\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-bold text-blue-800 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(Upload, {\n            size: 18,\n            className: \"mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2041,\n            columnNumber: 13\n          }, this), \"Media Library\", !isStorageReady && /*#__PURE__*/_jsxDEV(Loader, {\n            size: 16,\n            className: \"ml-2 animate-spin text-orange-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2044,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2040,\n          columnNumber: 11\n        }, this), storageInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-blue-600 mt-1 flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [storageInfo.usage.totalSizeMB, \"MB used \\u2022 \", storageInfo.mode]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2051,\n            columnNumber: 15\n          }, this), storageInfo.mode === 'fallback' && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-orange-600 font-medium\",\n            children: \"Fallback Mode\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2055,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2050,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2039,\n        columnNumber: 9\n      }, this), storageError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-red-50 border-b border-red-200 flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          size: 16,\n          className: \"text-red-500 mr-2 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2064,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-red-700\",\n          children: storageError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2065,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setStorageError(null),\n          className: \"ml-auto text-red-500 hover:text-red-700\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2070,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2066,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2063,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 pb-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex bg-gray-100 rounded-xl p-1\",\n          children: [{\n            id: \"videos\",\n            name: \"Videos\",\n            icon: Video\n          }, {\n            id: \"audios\",\n            name: \"Audio\",\n            icon: Music\n          }, {\n            id: \"images\",\n            name: \"Images\",\n            icon: Image\n          }].map(tab => {\n            var _mediaLibrary$tab$id, _storageInfo$limits;\n            const IconComponent = tab.icon;\n            const count = ((_mediaLibrary$tab$id = mediaLibrary[tab.id]) === null || _mediaLibrary$tab$id === void 0 ? void 0 : _mediaLibrary$tab$id.length) || 0;\n            const limit = (storageInfo === null || storageInfo === void 0 ? void 0 : (_storageInfo$limits = storageInfo.limits) === null || _storageInfo$limits === void 0 ? void 0 : _storageInfo$limits[tab.id]) || 0;\n            return /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setActiveTab(tab.id),\n              className: `flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${activeTab === tab.id ? \"bg-white text-blue-600 shadow-sm\" : \"text-gray-600 hover:text-gray-800\"}`,\n              children: [/*#__PURE__*/_jsxDEV(IconComponent, {\n                size: 16,\n                className: \"mr-2 inline\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2096,\n                columnNumber: 19\n              }, this), tab.name, storageInfo && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `ml-1 text-xs ${count >= limit ? 'text-red-500' : 'text-gray-400'}`,\n                children: [\"(\", count, \"/\", limit, \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2099,\n                columnNumber: 21\n              }, this)]\n            }, tab.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2087,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2076,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2075,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            var _fileInputRef$current, _audioInputRef$curren, _imageInputRef$curren;\n            if (!isStorageReady) return;\n            if (activeTab === \"videos\") (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();else if (activeTab === \"audios\") (_audioInputRef$curren = audioInputRef.current) === null || _audioInputRef$curren === void 0 ? void 0 : _audioInputRef$curren.click();else (_imageInputRef$curren = imageInputRef.current) === null || _imageInputRef$curren === void 0 ? void 0 : _imageInputRef$curren.click();\n          },\n          disabled: !isStorageReady || storageInfo && ((_mediaLibrary$activeT = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT === void 0 ? void 0 : _mediaLibrary$activeT.length) >= storageInfo.limits[activeTab],\n          className: `w-full p-6 border-2 border-dashed rounded-2xl transition-all duration-200 text-center group ${!isStorageReady || storageInfo && ((_mediaLibrary$activeT2 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT2 === void 0 ? void 0 : _mediaLibrary$activeT2.length) >= storageInfo.limits[activeTab] ? \"border-gray-200 bg-gray-50 cursor-not-allowed\" : \"border-gray-300 hover:border-blue-400 hover:bg-blue-50/50\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-3 transition-colors ${!isStorageReady || storageInfo && ((_mediaLibrary$activeT3 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT3 === void 0 ? void 0 : _mediaLibrary$activeT3.length) >= storageInfo.limits[activeTab] ? \"bg-gray-100\" : \"bg-gray-100 group-hover:bg-blue-100\"}`,\n            children: uploadingFiles.size > 0 ? /*#__PURE__*/_jsxDEV(Loader, {\n              size: 20,\n              className: \"text-blue-500 animate-spin\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2130,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Upload, {\n              size: 20,\n              className: `${!isStorageReady || storageInfo && ((_mediaLibrary$activeT4 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT4 === void 0 ? void 0 : _mediaLibrary$activeT4.length) >= storageInfo.limits[activeTab] ? \"text-gray-400\" : \"text-gray-500 group-hover:text-blue-500\"}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2132,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2124,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `text-sm font-medium ${!isStorageReady || storageInfo && ((_mediaLibrary$activeT5 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT5 === void 0 ? void 0 : _mediaLibrary$activeT5.length) >= storageInfo.limits[activeTab] ? \"text-gray-400\" : \"text-gray-700 group-hover:text-blue-600\"}`,\n            children: !isStorageReady ? \"Initializing...\" : uploadingFiles.size > 0 ? \"Uploading...\" : storageInfo && ((_mediaLibrary$activeT6 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT6 === void 0 ? void 0 : _mediaLibrary$activeT6.length) >= storageInfo.limits[activeTab] ? \"Storage Full\" : `Upload ${activeTab === \"videos\" ? \"Video\" : activeTab === \"audios\" ? \"Audio\" : \"Images\"}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: `text-xs mt-1 ${!isStorageReady || storageInfo && ((_mediaLibrary$activeT7 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT7 === void 0 ? void 0 : _mediaLibrary$activeT7.length) >= storageInfo.limits[activeTab] ? \"text-gray-400\" : \"text-gray-500\"}`,\n            children: activeTab === \"videos\" ? \"MP4, AVI, MOV up to 100MB\" : activeTab === \"audios\" ? \"MP3, WAV, M4A up to 100MB\" : \"JPG, PNG, GIF up to 10MB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2152,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2110,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        type: \"file\",\n        accept: \"video/*\",\n        multiple: true,\n        onChange: handleVideoUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: audioInputRef,\n        type: \"file\",\n        accept: \"audio/*\",\n        multiple: true,\n        onChange: handleAudioUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: imageInputRef,\n        type: \"file\",\n        accept: \"image/*\",\n        multiple: true,\n        onChange: handleImageUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2182,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto px-4 pb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [((_mediaLibrary$activeT8 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT8 === void 0 ? void 0 : _mediaLibrary$activeT8.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n            draggable: \"true\",\n            onDragStart: e => handleDragStart(e, item),\n            onDragEnd: handleDragEnd,\n            className: `flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${(draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.id) === item.id ? \"opacity-50\" : \"\"}`,\n            onClick: () => addToTimeline(item),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\",\n              children: [activeTab === \"videos\" && /*#__PURE__*/_jsxDEV(Video, {\n                size: 20,\n                className: \"text-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2206,\n                columnNumber: 21\n              }, this), activeTab === \"audios\" && /*#__PURE__*/_jsxDEV(Music, {\n                size: 20,\n                className: \"text-green-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2209,\n                columnNumber: 21\n              }, this), activeTab === \"images\" && /*#__PURE__*/_jsxDEV(Image, {\n                size: 20,\n                className: \"text-purple-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2212,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2204,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1 min-w-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-gray-900 truncate\",\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2216,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between text-xs text-gray-500\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: activeTab === \"images\" ? item.width && item.height ? `${item.width}×${item.height}px` : \"Image\" : formatTime(item.duration || 0)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2220,\n                  columnNumber: 21\n                }, this), item.size && /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: formatFileSize(item.size)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2228,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2219,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2215,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => {\n                e.stopPropagation();\n                removeFromLibrary(item.id, activeTab);\n              },\n              className: \"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\",\n              children: /*#__PURE__*/_jsxDEV(Trash2, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2239,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2232,\n              columnNumber: 17\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2194,\n            columnNumber: 15\n          }, this))) || [], ((_mediaLibrary$activeT9 = mediaLibrary[activeTab]) === null || _mediaLibrary$activeT9 === void 0 ? void 0 : _mediaLibrary$activeT9.length) === 0 && isStorageReady && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3\",\n              children: [activeTab === \"videos\" && /*#__PURE__*/_jsxDEV(Video, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2247,\n                columnNumber: 46\n              }, this), activeTab === \"audios\" && /*#__PURE__*/_jsxDEV(Music, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2248,\n                columnNumber: 46\n              }, this), activeTab === \"images\" && /*#__PURE__*/_jsxDEV(Image, {\n                size: 24,\n                className: \"text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2249,\n                columnNumber: 46\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2246,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: [\"No \", activeTab, \" uploaded yet\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2251,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-400 mt-1\",\n              children: \"Click upload button above\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2252,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2245,\n            columnNumber: 15\n          }, this), !isStorageReady && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-8\",\n            children: [/*#__PURE__*/_jsxDEV(Loader, {\n              size: 32,\n              className: \"text-blue-500 animate-spin mx-auto mb-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2258,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: \"Initializing storage...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2259,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2257,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2192,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2191,\n        columnNumber: 9\n      }, this), process.env.NODE_ENV === 'development' && storageInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t border-gray-200 bg-gray-50\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-600 space-y-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Mode: \", storageInfo.mode]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2269,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Total: \", storageInfo.usage.totalSizeMB, \"MB\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2270,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: clearStorage,\n            className: \"text-red-600 hover:text-red-800 underline\",\n            children: \"Clear Storage (Debug)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2271,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2268,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2267,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2038,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col gap-4 min-w-0 overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ref: videoContainerRef,\n        className: \"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm min-h-0\",\n        title: \"Video Preview - Click overlays to select, drag to move, Ctrl+scroll to resize, use opacity slider\",\n        children: [currentVideoSource ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative w-full h-full\",\n          onClick: e => {\n            // Снимаем выделение overlay при клике на пустое место\n            if (e.target === e.currentTarget) {\n              setSelectedOverlay(null);\n            }\n          },\n          children: [getCurrentTimelineContent().mainVideo ? /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            src: currentVideoSource,\n            className: \"w-full h-full object-contain rounded-2xl\",\n            muted: isMuted\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2301,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: currentVideoSource,\n            alt: \"Timeline content\",\n            className: \"w-full h-full object-contain rounded-2xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2308,\n            columnNumber: 17\n          }, this), getCurrentTimelineContent().overlays.map((item, index) => {\n            const transform = getOverlayTransform(item.id);\n            const isSelected = (selectedOverlay === null || selectedOverlay === void 0 ? void 0 : selectedOverlay.id) === item.id;\n            const isDraggingThis = isDraggingOverlay && isSelected;\n            const isResizingThis = isResizingOverlay && isSelected;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `absolute select-none ${isSelected ? 'ring-2 ring-blue-400 ring-opacity-75 shadow-xl' : 'hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50'} ${isDraggingThis ? 'cursor-grabbing z-50' : isResizingThis ? 'cursor-nw-resize' : 'cursor-grab hover:shadow-lg'}`,\n              style: {\n                left: `${200 + transform.x}px`,\n                top: `${50 + index * 120 + transform.y}px`,\n                width: `${128 * transform.scale}px`,\n                height: `${96 * transform.scale}px`,\n                opacity: transform.opacity,\n                zIndex: isSelected ? 1000 : 10 + index,\n                transform: isDraggingThis ? 'scale(1.02)' : 'scale(1)',\n                transition: isDraggingThis || isResizingThis ? 'none' : 'transform 0.2s ease, box-shadow 0.2s ease'\n              },\n              onMouseDown: e => handleOverlayMouseDown(e, {\n                ...item,\n                index\n              }),\n              onWheel: e => handleOverlayWheel(e, item.id),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `relative w-full h-full border-2 rounded-lg overflow-hidden shadow-lg group ${isSelected ? 'border-blue-400' : 'border-white hover:border-blue-300'}`,\n                style: {\n                  transition: isDraggingThis || isResizingThis ? 'none' : 'border-color 0.2s ease'\n                },\n                children: [item.type === 'video' ? /*#__PURE__*/_jsxDEV(\"video\", {\n                  src: item.url,\n                  className: \"w-full h-full object-cover pointer-events-none\",\n                  muted: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2347,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.url,\n                  alt: item.name,\n                  className: \"w-full h-full object-cover pointer-events-none\",\n                  draggable: false\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2353,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute inset-0 bg-blue-500 bg-opacity-0 hover:bg-opacity-10 ${isSelected ? 'bg-opacity-10' : ''}`,\n                  style: {\n                    transition: isDraggingThis || isResizingThis ? 'none' : 'background-color 0.2s ease'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2362,\n                  columnNumber: 23\n                }, this), isSelected && /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `resize-handle absolute -top-2 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-nw-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${isResizingThis && resizeOverlayHandle === 'nw' ? 'scale-150 bg-red-500' : ''}`,\n                    onMouseDown: e => handleOverlayResizeStart(e, item, 'nw'),\n                    style: {\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2372,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `resize-handle absolute -top-2 -right-2 w-4 h-4 bg-blue-500 rounded-full cursor-ne-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${isResizingThis && resizeOverlayHandle === 'ne' ? 'scale-150 bg-red-500' : ''}`,\n                    onMouseDown: e => handleOverlayResizeStart(e, item, 'ne'),\n                    style: {\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2381,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `resize-handle absolute -bottom-2 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-sw-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${isResizingThis && resizeOverlayHandle === 'sw' ? 'scale-150 bg-red-500' : ''}`,\n                    onMouseDown: e => handleOverlayResizeStart(e, item, 'sw'),\n                    style: {\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2390,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `resize-handle absolute -bottom-2 -right-2 w-4 h-4 bg-blue-500 rounded-full cursor-se-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${isResizingThis && resizeOverlayHandle === 'se' ? 'scale-150 bg-red-500' : ''}`,\n                    onMouseDown: e => handleOverlayResizeStart(e, item, 'se'),\n                    style: {\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2399,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-blue-500 rounded-full opacity-60 pointer-events-none\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2410,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute -bottom-12 left-0 right-0 bg-black/80 backdrop-blur-sm rounded-lg px-3 py-2 border border-white/20 shadow-lg\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-white text-xs font-medium min-w-fit\",\n                        children: \"Opacity:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2415,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"range\",\n                        min: \"0.1\",\n                        max: \"1\",\n                        step: \"0.05\",\n                        value: transform.opacity,\n                        onChange: e => updateOverlayTransform(item.id, {\n                          opacity: parseFloat(e.target.value)\n                        }),\n                        className: \"flex-1 h-2 accent-blue-500 cursor-pointer\",\n                        onMouseDown: e => e.stopPropagation()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2416,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-white text-xs min-w-8 text-right font-mono\",\n                        children: [Math.round(transform.opacity * 100), \"%\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2426,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2414,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2413,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute top-1 left-1 bg-black/70 text-white text-xs px-2 py-1 rounded pointer-events-none ${isSelected ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`,\n                  style: {\n                    transition: isDraggingThis || isResizingThis ? 'none' : 'opacity 0.2s ease'\n                  },\n                  children: [item.name, \" \\u2022 \", Math.round(transform.scale * 100), \"% \\u2022 \", Math.round(transform.opacity * 100), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2435,\n                  columnNumber: 23\n                }, this), isSelected && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -top-0.5 -left-0.5 -right-0.5 -bottom-0.5 border-2 border-blue-400 rounded-lg pointer-events-none animate-pulse\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2446,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2340,\n                columnNumber: 21\n              }, this)\n            }, item.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2322,\n              columnNumber: 19\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2291,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full h-full flex items-center justify-center text-white\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\",\n              children: /*#__PURE__*/_jsxDEV(Film, {\n                size: 40,\n                className: \"opacity-50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2457,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2456,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl opacity-75 font-medium\",\n              children: \"No content at current time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2459,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm opacity-50 mb-4\",\n              children: \"Drag media to timeline tracks to start editing\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2462,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs opacity-40 space-y-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\uD83D\\uDCA1 Overlays are interactive \\u2022 Ripple mode enabled\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2466,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"\\uD83D\\uDCC1 Files stored in \", (storageInfo === null || storageInfo === void 0 ? void 0 : storageInfo.mode) || 'storage', \" mode\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2467,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Press \", /*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-1 py-0.5 bg-gray-700 rounded text-xs\",\n                  children: \"?\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2468,\n                  columnNumber: 28\n                }, this), \" for help & shortcuts\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2468,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2465,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2455,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2454,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.max(0, currentTime - 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              title: \"Skip back 10 seconds\",\n              children: /*#__PURE__*/_jsxDEV(SkipBack, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2481,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2476,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handlePlayPause,\n              className: \"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\",\n              title: \"Play/Pause (Space)\",\n              children: isPlaying ? /*#__PURE__*/_jsxDEV(Pause, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2488,\n                columnNumber: 30\n              }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2488,\n                columnNumber: 52\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2483,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.min(videoDuration, currentTime + 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              title: \"Skip forward 10 seconds\",\n              children: /*#__PURE__*/_jsxDEV(SkipForward, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2497,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2490,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setIsMuted(!isMuted),\n                className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n                title: \"Toggle mute\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2505,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2505,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2500,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: \"0\",\n                max: \"1\",\n                step: \"0.1\",\n                value: volume,\n                onChange: e => setVolume(parseFloat(e.target.value)),\n                className: \"w-24 accent-blue-500\",\n                title: \"Volume control\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2507,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2499,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-white text-sm font-medium min-w-0\",\n              title: \"Current time / Total duration\",\n              children: [formatTime(currentTime), \" / \", formatTime(videoDuration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2518,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2475,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2474,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2285,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${isDragging || isTimelineDragging || isResizing ? \"border-blue-400 bg-blue-50/20\" : \"border-gray-200\"}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 p-4 border-b border-gray-200 space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Film, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2536,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Timeline Pro\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2537,\n                columnNumber: 17\n              }, this), storageInfo && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `text-xs px-2 py-1 rounded-full ${storageInfo.mode === 'indexeddb' ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-700'}`,\n                children: storageInfo.mode === 'indexeddb' ? '💾 IndexedDB' : '🔄 Fallback'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2539,\n                columnNumber: 19\n              }, this), isDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-600\",\n                children: [\"- Adding \\\"\", draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.name, \"\\\" \", dropPreview.shouldRipple ? '⚡ ripple' : '📍 exact']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2548,\n                columnNumber: 19\n              }, this), isTimelineDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600\",\n                children: [\"- Moving \\\"\", draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.name, \"\\\" \", dropPreview.shouldRipple ? '⚡ push blocks' : '📍 exact']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2553,\n                columnNumber: 19\n              }, this), isResizing && resizeItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-orange-600\",\n                children: [\"- Trimming \\\"\", resizeItem.name, \"\\\" (\", resizeHandle, \" edge)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2558,\n                columnNumber: 19\n              }, this), copiedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600 text-sm\",\n                children: [\"- \\\"\", copiedItem.name, \"\\\" copied (Ctrl+V to paste)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2563,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2535,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setShowHelp(true),\n                className: \"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200\",\n                title: \"\\uD83D\\uDCD6 Help & Shortcuts Guide - Learn all controls and hotkeys (Press ? key)\",\n                children: /*#__PURE__*/_jsxDEV(HelpCircle, {\n                  size: 18\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2575,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2570,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomOut,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom Out (-)\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomOut, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2584,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2579,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-gray-500 min-w-12 text-center\",\n                  children: [(timelineZoom * 100).toFixed(0), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2586,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomIn,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom In (+), or Ctrl+Wheel\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2594,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2589,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: resetZoom,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Reset Zoom (0)\",\n                  children: /*#__PURE__*/_jsxDEV(RotateCcw, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2601,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2596,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2578,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2569,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2534,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addOverlayTrack,\n                  className: \"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Overlay Track\",\n                  children: /*#__PURE__*/_jsxDEV(Plus, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2615,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2610,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addAudioTrack,\n                  className: \"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Audio Track\",\n                  children: /*#__PURE__*/_jsxDEV(Music, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2622,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2617,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: splitTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Split Selected Item (Ctrl+B) - Cuts item at current time\",\n                  children: /*#__PURE__*/_jsxDEV(Scissors, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2634,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2624,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: copyTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Copy Selected Item (Ctrl+C) - Copy item to clipboard\",\n                  children: /*#__PURE__*/_jsxDEV(Copy, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2646,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2636,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: deleteSelectedItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Delete Selected Item (Del/Backspace) - Remove from timeline\",\n                  children: /*#__PURE__*/_jsxDEV(Trash2, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2658,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2648,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2609,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2608,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2607,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2533,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 flex min-h-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-12 border-b border-gray-200 flex-shrink-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2667,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: trackLabelsRef,\n              className: \"flex-1 overflow-y-auto overflow-x-hidden\",\n              onScroll: handleTrackLabelsScroll,\n              children: [tracks.overlays.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Layers, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2680,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2675,\n                columnNumber: 19\n              }, this)), tracks.main.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Video, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2691,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2686,\n                columnNumber: 19\n              }, this)), tracks.audio.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\",\n                style: {\n                  height: '60px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Music, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2702,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2697,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2669,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2666,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: el => {\n              timelineRef.current = el;\n              timelineScrollRef.current = el;\n            },\n            className: \"flex-1 relative overflow-auto bg-white\",\n            onScroll: handleTrackAreaScroll,\n            onDragOver: handleDragOver,\n            onDrop: handleDrop,\n            onDragLeave: handleDragLeave,\n            style: {\n              overflowX: 'auto',\n              overflowY: 'auto',\n              scrollbarWidth: 'thin'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${getTimelineWidth()}px`,\n                minHeight: '100%',\n                position: 'relative'\n              },\n              onClick: handleTimelineClick,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\",\n                children: [Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom / 5) + 1\n                }, (_, i) => {\n                  const timeValue = i * 5 / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-0 h-full border-l border-gray-300\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\",\n                      children: formatTime(timeValue)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2743,\n                      columnNumber: 25\n                    }, this)\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2738,\n                    columnNumber: 23\n                  }, this);\n                }), timelineZoom > 2 && Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom) + 1\n                }, (_, i) => {\n                  const timeValue = i / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-8 w-0 h-4 border-l border-gray-200\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    }\n                  }, `sub-${i}`, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2754,\n                    columnNumber: 23\n                  }, this);\n                }), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\",\n                  style: {\n                    left: `${currentTime * getPixelsPerSecond()}px`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2762,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2733,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative flex-1\",\n                style: {\n                  height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\n                  minHeight: '100%'\n                },\n                children: [timelineItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(item.trackType)} ${(selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === item.id ? \"ring-2 ring-blue-300\" : \"\"} ${(draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.id) === item.id ? \"opacity-50 z-30\" : \"\"} ${(copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"}`,\n                  style: getTimelineItemStyle(item),\n                  onClick: e => {\n                    e.stopPropagation();\n                    setSelectedTimelineItem(item);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, 'left'),\n                    title: \"Trim start - Drag to adjust start time\",\n                    style: {\n                      background: 'linear-gradient(to right, rgba(255,255,255,0.8), transparent)'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2801,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2795,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    draggable: \"true\",\n                    onDragStart: e => handleTimelineItemDragStart(e, item),\n                    onDragEnd: handleTimelineItemDragEnd,\n                    className: \"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\",\n                    title: \"Drag to move item on timeline - Ripple mode: pushes other blocks\",\n                    children: [item.name, (copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"ml-2 text-green-200\",\n                      children: \"\\uD83D\\uDCCB\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2813,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2804,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, 'right'),\n                    title: \"Trim end - Drag to adjust duration\",\n                    style: {\n                      background: 'linear-gradient(to left, rgba(255,255,255,0.8), transparent)'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2823,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2817,\n                    columnNumber: 23\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2778,\n                  columnNumber: 21\n                }, this)), dropPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 transition-all ${dropPreview.isValid ? dropPreview.isExact ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse` : \"bg-red-300 border-red-500 border-dashed\"}`,\n                  style: getDropPreviewStyle(),\n                  children: dropPreview.isValid && !dropPreview.isExact && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center h-full text-white text-xs font-bold\",\n                    children: \"\\uD83E\\uDDF2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2840,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2829,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2770,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2725,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2709,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2665,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2526,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2283,\n      columnNumber: 7\n    }, this), showHelp && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-b border-gray-200 flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-bold text-gray-800 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(HelpCircle, {\n              size: 24,\n              className: \"mr-3 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2859,\n              columnNumber: 17\n            }, this), \"CapCut Pro - Help & Shortcuts\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2858,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowHelp(false),\n            className: \"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2866,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2862,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2857,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-gray-800 mb-3 flex items-center\",\n              children: \"\\uD83D\\uDCBE Smart Storage System\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2873,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 gap-3 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Current mode:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2878,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: (storageInfo === null || storageInfo === void 0 ? void 0 : storageInfo.mode) || 'Loading...'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2879,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2877,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Storage limits:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2882,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"5 videos, 10 images, 5 audios\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2883,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2881,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Auto cleanup:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2886,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Files expire after 7 days\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2887,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2885,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Fallback mode:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2890,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"If IndexedDB unavailable\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2891,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2889,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2876,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2872,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-gray-800 mb-3 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(Film, {\n                size: 18,\n                className: \"mr-2 text-blue-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2899,\n                columnNumber: 19\n              }, this), \"Timeline Controls\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2898,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 gap-3 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Drag center:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2904,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Move item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2905,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2903,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Drag edges:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2908,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Trim duration\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2909,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2907,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Auto ripple:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2912,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Push other blocks\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2913,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2911,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Ctrl + Wheel:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2916,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Zoom timeline\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2917,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2915,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2902,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2897,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-gray-800 mb-3 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(Layers, {\n                size: 18,\n                className: \"mr-2 text-purple-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2925,\n                columnNumber: 19\n              }, this), \"Video Overlays (CapCut Style)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2924,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 gap-3 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Click overlay:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2930,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Select & show controls\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2931,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2929,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Drag anywhere:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2934,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Move position\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2935,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2933,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Drag corner dots:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2938,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Resize overlay\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2939,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2937,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Ctrl + Scroll:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2942,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Smooth zoom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2943,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2941,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Opacity slider:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2946,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"0-100% transparency\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2947,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2945,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Auto bounds:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2950,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Stays in view area\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2951,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2949,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2928,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2923,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-gray-800 mb-3 flex items-center\",\n              children: \"\\u2328\\uFE0F Keyboard Shortcuts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2958,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 gap-3 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Space\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2963,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Play / Pause\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2964,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2962,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"\\u2190 \\u2192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2967,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Seek (0.1s)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2968,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2966,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Shift + \\u2190 \\u2192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2971,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Seek (1s)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2972,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2970,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Ctrl + \\u2190 \\u2192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2975,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Seek (5s)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2976,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2974,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Ctrl + B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2979,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Split item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2980,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2978,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Ctrl + C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2983,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Copy item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2984,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2982,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Ctrl + V\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2987,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Paste item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2988,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2986,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"Del\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2991,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Delete item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2992,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2990,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"+ -\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2995,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Zoom in/out\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2996,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2994,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"kbd\", {\n                  className: \"px-2 py-1 bg-gray-100 rounded text-xs font-mono\",\n                  children: \"0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2999,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Reset zoom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3000,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2998,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2961,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2957,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-semibold text-gray-800 mb-3 flex items-center\",\n              children: \"\\uD83D\\uDCA1 Pro Tips\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 3007,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"space-y-2 text-sm text-gray-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-block w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3012,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Files are automatically saved to smart storage with 7-day retention\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3013,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 3011,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-block w-2 h-2 bg-purple-500 rounded-full mt-2 mr-3 flex-shrink-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3016,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Storage automatically switches to fallback mode if IndexedDB unavailable\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3017,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 3015,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-block w-2 h-2 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3020,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Upload limits prevent storage overflow (5 videos, 10 images, 5 audios)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3021,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 3019,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-block w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3024,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Ripple mode automatically pushes blocks when inserting new content\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3025,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 3023,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-block w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3028,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Use Ctrl+scroll over overlays for precise size control like in CapCut\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 3029,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 3027,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 3010,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 3006,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2870,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center text-sm text-gray-500\",\n            children: [\"\\uD83C\\uDFAC Made with CapCut Pro styling \\u2022 \\uD83D\\uDCBE Smart MediaStorage \\u2022 Press \", /*#__PURE__*/_jsxDEV(\"kbd\", {\n              className: \"px-1 py-0.5 bg-white rounded text-xs font-mono border\",\n              children: \"?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 3037,\n              columnNumber: 81\n            }, this), \" anytime\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 3036,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 3035,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2856,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2855,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 2036,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoEditor, \"/HcB3PbPB1YEV7+iTxWob7/pJM0=\");\n_c = VideoEditor;\nexport default VideoEditor;\nvar _c;\n$RefreshReg$(_c, \"VideoEditor\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Upload","Play","Pause","Volume2","Video","Music","SkipBack","SkipForward","VolumeX","Copy","Trash2","Scissors","Image","Film","Plus","Layers","ZoomIn","ZoomOut","RotateCcw","HelpCircle","X","AlertCircle","CheckCircle","Loader","jsxDEV","_jsxDEV","Fragment","_Fragment","EmbeddedMediaStorage","constructor","dbName","version","db","fallbackMode","memoryStorage","Map","limits","videos","images","audios","maxFileSize","retentionDays","isIndexedDBSupported","window","indexedDB","init","console","warn","initFallback","initIndexedDB","error","Promise","resolve","reject","request","open","onerror","_request$error","Error","message","onsuccess","result","log","onupgradeneeded","event","target","objectStoreNames","contains","fileStore","createObjectStore","keyPath","createIndex","upgradeError","onblocked","savedData","localStorage","getItem","parsedData","JSON","parse","key","value","Object","entries","base64Data","blob","base64ToBlob","mimetype","url","URL","createObjectURL","e","set","blobToBase64","reader","FileReader","onload","split","readAsDataURL","base64","mimeType","byteCharacters","atob","byteNumbers","Array","length","i","charCodeAt","byteArray","Uint8Array","Blob","type","saveFile","file","size","currentFiles","getFilesByType","fileData","id","Date","now","Math","random","name","createdAt","toISOString","expiresAt","duration","getVideoDuration","dimensions","getImageDimensions","width","height","getAudioDuration","metaError","saveToFallback","saveToIndexedDB","transaction","store","objectStore","add","updateStorageInfo","_request$error2","storageData","toString","allMeta","undefined","setItem","stringify","lsError","getFromFallback","getFromIndexedDB","index","getAll","validFiles","filter","map","_request$error3","files","push","getAllFiles","deleteFile","deleteFromFallback","deleteFromIndexedDB","delete","_request$error4","get","revokeObjectURL","canUpload","getRemainingSpace","getStorageInfo","totalSize","reduce","sum","usage","totalSizeMB","round","mode","info","dispatchEvent","CustomEvent","detail","video","document","createElement","preload","timeout","setTimeout","src","onloadedmetadata","clearTimeout","audio","img","cleanupExpiredFiles","expiredCount","keysToDelete","forEach","allFiles","expiredFiles","deleteError","MediaStorage","VideoEditor","_s","_mediaLibrary$activeT","_mediaLibrary$activeT2","_mediaLibrary$activeT3","_mediaLibrary$activeT4","_mediaLibrary$activeT5","_mediaLibrary$activeT6","_mediaLibrary$activeT7","_mediaLibrary$activeT8","_mediaLibrary$activeT9","mediaLibrary","setMediaLibrary","storageInfo","setStorageInfo","isStorageReady","setIsStorageReady","uploadingFiles","setUploadingFiles","Set","storageError","setStorageError","timelineItems","setTimelineItems","currentTime","setCurrentTime","videoDuration","setVideoDuration","selectedTimelineItem","setSelectedTimelineItem","timelineZoom","setTimelineZoom","activeTab","setActiveTab","volume","setVolume","isMuted","setIsMuted","isPlaying","setIsPlaying","currentVideoSource","setCurrentVideoSource","draggedItem","setDraggedItem","draggedTimelineItem","setDraggedTimelineItem","dropPreview","setDropPreview","isDragging","setIsDragging","isTimelineDragging","setIsTimelineDragging","dragOffset","setDragOffset","copiedItem","setCopiedItem","isResizing","setIsResizing","resizeHandle","setResizeHandle","resizeItem","setResizeItem","originalItemData","setOriginalItemData","selectedOverlay","setSelectedOverlay","overlayTransforms","setOverlayTransforms","isDraggingOverlay","setIsDraggingOverlay","isResizingOverlay","setIsResizingOverlay","overlayDragStart","setOverlayDragStart","x","y","resizeOverlayHandle","setResizeOverlayHandle","initialOverlayTransform","setInitialOverlayTransform","showHelp","setShowHelp","tracks","setTracks","overlays","main","timelineRef","timelineScrollRef","trackLabelsRef","intervalRef","audioElementsRef","fileInputRef","audioInputRef","imageInputRef","videoRef","autoScrollIntervalRef","videoContainerRef","initStorage","loadExistingFiles","handleStorageUpdate","addEventListener","removeEventListener","formatTime","seconds","mins","floor","secs","ms","padStart","formatFileSize","bytes","k","sizes","parseFloat","pow","toFixed","handlePlayPause","seekTo","time","newTime","max","min","content","getCurrentTimelineContent","audioItem","audioElement","current","relativeTime","startTime","currentItems","item","mainVideo","find","trackType","createAudioElement","has","muted","syncAudioTime","timeDiff","abs","checkCollision","newItem","excludeId","some","trackId","itemStart","itemEnd","newStart","newEnd","insertWithRipple","insertTime","trackItems","sort","a","b","shouldRipple","affectedItems","insertPosition","blockAtPosition","blocksToShift","nextBlock","availableSpace","shiftAmount","findNearestValidPosition","dropTime","isExact","applyRippleEffect","affectedCount","oldStart","prev","affectedItem","affected","maxEndTime","findNextAvailablePosition","preferredStart","testItem","currentItem","nextItem","gapStart","gapEnd","gapSize","lastItem","removeFromTimeline","itemId","pause","getOverlayTransform","overlayId","scale","opacity","updateOverlayTransform","updates","handleOverlayMouseDown","overlay","closest","preventDefault","stopPropagation","container","containerRect","getBoundingClientRect","overlayElement","currentTarget","overlayRect","transform","clientX","left","clientY","top","containerX","containerY","handleOverlayResizeStart","handle","currentTransform","startScale","startX","startY","handleOverlayMouseMove","rect","overlaySize","newX","newY","padding","limitedX","limitedY","baseX","baseY","deltaX","deltaY","scaleFactor","sensitivity","newScale","handleOverlayMouseUp","handleOverlayWheel","ctrlKey","scaleDelta","splitTimelineItem","splitTime","firstPartDuration","secondPartStart","secondPartDuration","secondPart","updatedFirstPart","timelineItem","concat","copyTimelineItem","pasteTimelineItem","_insertResult$affecte","targetTrackId","insertResult","newEndTime","deleteSelectedItem","stopAutoScroll","clearInterval","startAutoScroll","direction","speed","setInterval","scrollAmount","currentScrollLeft","scrollLeft","maxScroll","scrollWidth","clientWidth","checkAutoScroll","scrollZoneWidth","relativeX","zoomIn","zoomOut","resetZoom","handleResizeStart","handleResizeEnd","handleTrackAreaScroll","scrollTop","handleTrackLabelsScroll","getTimelineWidth","baseWidth","getPixelsPerSecond","handleVideoUpload","from","fileId","remaining","savedFile","newSet","handleAudioUpload","handleImageUpload","removeFromLibrary","mediaId","clearStorage","allItems","body","style","cursor","handleMouseMove","mouseX","pixelsPerSecond","minDuration","rightEdge","newStartTime","newDuration","leftEdge","handleMouseUp","o","firstImage","currentAudioIds","paused","play","catch","handleKeyDown","tagName","code","step","shiftKey","handleWheel","_timelineRef$current","passive","addToTimeline","mediaItem","startsWith","finalStartTime","newTimelineItem","addOverlayTrack","newTrackId","addAudioTrack","handleTimelineClick","clickX","clickTime","handleDragStart","dataTransfer","effectAllowed","setData","handleDragEnd","handleTimelineItemDragStart","itemRect","handleTimelineItemDragEnd","handleDragOver","dropEffect","timelineRect","dragX","dragY","trackHeight","timeRulerHeight","relativeY","trackIndex","allTracks","targetTrack","isValid","handleDrop","_dropPreview$affected","_dropPreview$affected2","_dropPreview$affected3","handleDragLeave","_timelineRef$current2","relatedTarget","getTimelineItemStyle","findIndex","track","getDropPreviewStyle","getTrackColor","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","icon","tab","_mediaLibrary$tab$id","_storageInfo$limits","IconComponent","count","limit","_fileInputRef$current","_audioInputRef$curren","_imageInputRef$curren","click","disabled","ref","accept","multiple","onChange","draggable","onDragStart","onDragEnd","process","env","NODE_ENV","title","alt","isSelected","isDraggingThis","isResizingThis","zIndex","transition","onMouseDown","onWheel","onScroll","el","onDragOver","onDrop","onDragLeave","overflowX","overflowY","scrollbarWidth","minHeight","position","ceil","_","timeValue","background","_c","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/VideoEditor/VideoEditor.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Upload,\r\n  Play,\r\n  Pause,\r\n  Volume2,\r\n  Video,\r\n  Music,\r\n  SkipBack,\r\n  SkipForward,\r\n  VolumeX,\r\n  Copy,\r\n  Trash2,\r\n  Scissors,\r\n  Image,\r\n  Film,\r\n  Plus,\r\n  Layers,\r\n  ZoomIn,\r\n  ZoomOut,\r\n  RotateCcw,\r\n  HelpCircle,\r\n  X,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  Loader\r\n} from \"lucide-react\";\r\n// Встроенная реализация MediaStorage\r\nclass EmbeddedMediaStorage {\r\n  constructor() {\r\n    this.dbName = 'VideoEditorDB';\r\n    this.version = 1;\r\n    this.db = null;\r\n    this.fallbackMode = false;\r\n    this.memoryStorage = new Map();\r\n    this.limits = {\r\n      videos: 5,\r\n      images: 10,\r\n      audios: 5,\r\n      maxFileSize: 100 * 1024 * 1024, // 100MB\r\n      retentionDays: 7\r\n    };\r\n  }\r\n\r\n  isIndexedDBSupported() {\r\n    return 'indexedDB' in window && indexedDB !== null;\r\n  }\r\n\r\n  async init() {\r\n    if (!this.isIndexedDBSupported()) {\r\n      console.warn('IndexedDB not supported, using fallback mode');\r\n      this.fallbackMode = true;\r\n      return this.initFallback();\r\n    }\r\n\r\n    try {\r\n      return await this.initIndexedDB();\r\n    } catch (error) {\r\n      console.warn('IndexedDB initialization failed, switching to fallback mode:', error);\r\n      this.fallbackMode = true;\r\n      return this.initFallback();\r\n    }\r\n  }\r\n\r\n  async initIndexedDB() {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const request = indexedDB.open(this.dbName, this.version);\r\n\r\n        request.onerror = () => {\r\n          console.error('IndexedDB error:', request.error);\r\n          reject(new Error(`IndexedDB error: ${request.error?.message || 'Unknown error'}`));\r\n        };\r\n\r\n        request.onsuccess = () => {\r\n          this.db = request.result;\r\n          console.log('IndexedDB initialized successfully');\r\n          resolve(this.db);\r\n        };\r\n\r\n        request.onupgradeneeded = (event) => {\r\n          try {\r\n            const db = event.target.result;\r\n            if (!db.objectStoreNames.contains('files')) {\r\n              const fileStore = db.createObjectStore('files', { keyPath: 'id' });\r\n              fileStore.createIndex('type', 'type');\r\n              fileStore.createIndex('createdAt', 'createdAt');\r\n              console.log('IndexedDB store created');\r\n            }\r\n          } catch (upgradeError) {\r\n            console.error('IndexedDB upgrade error:', upgradeError);\r\n            reject(upgradeError);\r\n          }\r\n        };\r\n\r\n        request.onblocked = () => {\r\n          console.warn('IndexedDB blocked - another tab may be open');\r\n          reject(new Error('IndexedDB blocked by another tab'));\r\n        };\r\n\r\n      } catch (error) {\r\n        console.error('IndexedDB initialization error:', error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  async initFallback() {\r\n    console.log('Initializing fallback storage mode');\r\n    this.fallbackMode = true;\r\n    \r\n    try {\r\n      const savedData = localStorage.getItem('mediaFiles');\r\n      if (savedData) {\r\n        const parsedData = JSON.parse(savedData);\r\n        for (const [key, value] of Object.entries(parsedData)) {\r\n          // Пересоздаем blob из base64 если есть\r\n          if (value.base64Data) {\r\n            try {\r\n              const blob = this.base64ToBlob(value.base64Data, value.mimetype);\r\n              value.blob = blob;\r\n              value.url = URL.createObjectURL(blob);\r\n            } catch (e) {\r\n              console.warn('Failed to restore blob from base64:', e);\r\n              continue;\r\n            }\r\n          }\r\n          this.memoryStorage.set(key, value);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to load from localStorage:', error);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // Преобразование blob в base64 для localStorage\r\n  async blobToBase64(blob) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = () => resolve(reader.result.split(',')[1]);\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(blob);\r\n    });\r\n  }\r\n\r\n  // Преобразование base64 обратно в blob\r\n  base64ToBlob(base64, mimeType) {\r\n    const byteCharacters = atob(base64);\r\n    const byteNumbers = new Array(byteCharacters.length);\r\n    for (let i = 0; i < byteCharacters.length; i++) {\r\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\r\n    }\r\n    const byteArray = new Uint8Array(byteNumbers);\r\n    return new Blob([byteArray], { type: mimeType });\r\n  }\r\n\r\n  async saveFile(file, type) {\r\n    if (file.size > this.limits.maxFileSize) {\r\n      throw new Error(`File too large. Max size: ${this.limits.maxFileSize / (1024 * 1024)}MB`);\r\n    }\r\n\r\n    const currentFiles = await this.getFilesByType(type);\r\n    if (currentFiles.length >= this.limits[type]) {\r\n      throw new Error(`Storage limit reached. Max ${this.limits[type]} ${type} allowed.`);\r\n    }\r\n\r\n    const fileData = {\r\n      id: Date.now() + Math.random(),\r\n      name: file.name,\r\n      type: type,\r\n      size: file.size,\r\n      mimetype: file.type,\r\n      blob: file,\r\n      url: URL.createObjectURL(file),\r\n      createdAt: new Date().toISOString(),\r\n      expiresAt: new Date(Date.now() + this.limits.retentionDays * 24 * 60 * 60 * 1000).toISOString()\r\n    };\r\n\r\n    // Добавляем метаданные\r\n    try {\r\n      if (type === 'videos') {\r\n        fileData.duration = await this.getVideoDuration(file);\r\n      } else if (type === 'images') {\r\n        const dimensions = await this.getImageDimensions(file);\r\n        fileData.width = dimensions.width;\r\n        fileData.height = dimensions.height;\r\n      } else if (type === 'audios') {\r\n        fileData.duration = await this.getAudioDuration(file);\r\n      }\r\n    } catch (metaError) {\r\n      console.warn('Failed to get file metadata:', metaError);\r\n    }\r\n\r\n    if (this.fallbackMode) {\r\n      return this.saveToFallback(fileData);\r\n    } else {\r\n      return this.saveToIndexedDB(fileData);\r\n    }\r\n  }\r\n\r\n  async saveToIndexedDB(fileData) {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const transaction = this.db.transaction(['files'], 'readwrite');\r\n        const store = transaction.objectStore('files');\r\n        const request = store.add(fileData);\r\n\r\n        request.onsuccess = () => {\r\n          this.updateStorageInfo();\r\n          resolve(fileData);\r\n        };\r\n        \r\n        request.onerror = () => {\r\n          console.error('IndexedDB save error:', request.error);\r\n          reject(new Error(`Failed to save to IndexedDB: ${request.error?.message || 'Unknown error'}`));\r\n        };\r\n      } catch (error) {\r\n        console.error('IndexedDB transaction error:', error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  async saveToFallback(fileData) {\r\n    try {\r\n      // Конвертируем blob в base64 для localStorage\r\n      const base64Data = await this.blobToBase64(fileData.blob);\r\n      const storageData = { ...fileData };\r\n      storageData.base64Data = base64Data;\r\n      delete storageData.blob; // Не сохраняем blob в localStorage\r\n      \r\n      this.memoryStorage.set(fileData.id.toString(), fileData);\r\n      \r\n      // Сохраняем в localStorage\r\n      try {\r\n        const allMeta = {};\r\n        for (const [key, value] of this.memoryStorage.entries()) {\r\n          const base64 = await this.blobToBase64(value.blob);\r\n          allMeta[key] = {\r\n            ...value,\r\n            base64Data: base64,\r\n            blob: undefined,\r\n            url: undefined // URL пересоздадим при загрузке\r\n          };\r\n        }\r\n        localStorage.setItem('mediaFiles', JSON.stringify(allMeta));\r\n      } catch (lsError) {\r\n        console.warn('Failed to save to localStorage:', lsError);\r\n      }\r\n\r\n      this.updateStorageInfo();\r\n      return fileData;\r\n    } catch (error) {\r\n      console.error('Fallback save error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getFilesByType(type) {\r\n    if (this.fallbackMode) {\r\n      return this.getFromFallback(type);\r\n    } else {\r\n      return this.getFromIndexedDB(type);\r\n    }\r\n  }\r\n\r\n  async getFromIndexedDB(type) {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const transaction = this.db.transaction(['files'], 'readonly');\r\n        const store = transaction.objectStore('files');\r\n        const index = store.index('type');\r\n        const request = index.getAll(type);\r\n\r\n        request.onsuccess = () => {\r\n          const now = new Date();\r\n          const validFiles = request.result.filter(file => {\r\n            return new Date(file.expiresAt) > now;\r\n          }).map(file => {\r\n            // Пересоздаем URL если его нет\r\n            if (!file.url && file.blob) {\r\n              file.url = URL.createObjectURL(file.blob);\r\n            }\r\n            return file;\r\n          });\r\n          resolve(validFiles);\r\n        };\r\n        \r\n        request.onerror = () => {\r\n          console.error('IndexedDB get error:', request.error);\r\n          reject(new Error(`Failed to get from IndexedDB: ${request.error?.message || 'Unknown error'}`));\r\n        };\r\n      } catch (error) {\r\n        console.error('IndexedDB get transaction error:', error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  async getFromFallback(type) {\r\n    const now = new Date();\r\n    const files = [];\r\n    \r\n    for (const [key, file] of this.memoryStorage.entries()) {\r\n      if (file.type === type && new Date(file.expiresAt) > now) {\r\n        // Пересоздаем URL если его нет\r\n        if (!file.url && file.blob) {\r\n          file.url = URL.createObjectURL(file.blob);\r\n        }\r\n        files.push(file);\r\n      }\r\n    }\r\n    \r\n    return files;\r\n  }\r\n\r\n  async getAllFiles() {\r\n    try {\r\n      const videos = await this.getFilesByType('videos');\r\n      const images = await this.getFilesByType('images');\r\n      const audios = await this.getFilesByType('audios');\r\n      \r\n      return { videos, images, audios };\r\n    } catch (error) {\r\n      console.error('Get all files error:', error);\r\n      return { videos: [], images: [], audios: [] };\r\n    }\r\n  }\r\n\r\n  async deleteFile(id) {\r\n    if (this.fallbackMode) {\r\n      return this.deleteFromFallback(id);\r\n    } else {\r\n      return this.deleteFromIndexedDB(id);\r\n    }\r\n  }\r\n\r\n  async deleteFromIndexedDB(id) {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const transaction = this.db.transaction(['files'], 'readwrite');\r\n        const store = transaction.objectStore('files');\r\n        const request = store.delete(id);\r\n\r\n        request.onsuccess = () => {\r\n          this.updateStorageInfo();\r\n          resolve();\r\n        };\r\n        \r\n        request.onerror = () => {\r\n          console.error('IndexedDB delete error:', request.error);\r\n          reject(new Error(`Failed to delete from IndexedDB: ${request.error?.message || 'Unknown error'}`));\r\n        };\r\n      } catch (error) {\r\n        console.error('IndexedDB delete transaction error:', error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  async deleteFromFallback(id) {\r\n    try {\r\n      const file = this.memoryStorage.get(id.toString());\r\n      if (file && file.url) {\r\n        URL.revokeObjectURL(file.url);\r\n      }\r\n      \r\n      this.memoryStorage.delete(id.toString());\r\n      \r\n      // Обновляем localStorage\r\n      try {\r\n        const allMeta = {};\r\n        for (const [key, value] of this.memoryStorage.entries()) {\r\n          const base64 = await this.blobToBase64(value.blob);\r\n          allMeta[key] = {\r\n            ...value,\r\n            base64Data: base64,\r\n            blob: undefined,\r\n            url: undefined\r\n          };\r\n        }\r\n        localStorage.setItem('mediaFiles', JSON.stringify(allMeta));\r\n      } catch (lsError) {\r\n        console.warn('Failed to update localStorage after delete:', lsError);\r\n      }\r\n\r\n      this.updateStorageInfo();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Fallback delete error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async canUpload(type) {\r\n    try {\r\n      const files = await this.getFilesByType(type);\r\n      return files.length < this.limits[type];\r\n    } catch (error) {\r\n      console.error('Can upload check error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async getRemainingSpace(type) {\r\n    try {\r\n      const files = await this.getFilesByType(type);\r\n      return this.limits[type] - files.length;\r\n    } catch (error) {\r\n      console.error('Get remaining space error:', error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  async getStorageInfo() {\r\n    try {\r\n      const files = await this.getAllFiles();\r\n      const totalSize = [...files.videos, ...files.images, ...files.audios]\r\n        .reduce((sum, file) => sum + file.size, 0);\r\n\r\n      return {\r\n        usage: {\r\n          videos: files.videos.length,\r\n          images: files.images.length,\r\n          audios: files.audios.length,\r\n          totalSize: totalSize,\r\n          totalSizeMB: Math.round(totalSize / (1024 * 1024))\r\n        },\r\n        limits: this.limits,\r\n        files: files,\r\n        mode: this.fallbackMode ? 'fallback' : 'indexeddb'\r\n      };\r\n    } catch (error) {\r\n      console.error('Get storage info error:', error);\r\n      return {\r\n        usage: { videos: 0, images: 0, audios: 0, totalSize: 0, totalSizeMB: 0 },\r\n        limits: this.limits,\r\n        files: { videos: [], images: [], audios: [] },\r\n        mode: this.fallbackMode ? 'fallback' : 'indexeddb'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateStorageInfo() {\r\n    try {\r\n      const info = await this.getStorageInfo();\r\n      localStorage.setItem('mediaStorageInfo', JSON.stringify(info));\r\n      window.dispatchEvent(new CustomEvent('storageUpdated', { detail: info }));\r\n    } catch (error) {\r\n      console.error('Update storage info error:', error);\r\n    }\r\n  }\r\n\r\n  async getVideoDuration(file) {\r\n    return new Promise((resolve) => {\r\n      try {\r\n        const video = document.createElement('video');\r\n        video.preload = 'metadata';\r\n        \r\n        const timeout = setTimeout(() => {\r\n          video.src = '';\r\n          resolve(10);\r\n        }, 5000);\r\n        \r\n        video.onloadedmetadata = () => {\r\n          clearTimeout(timeout);\r\n          URL.revokeObjectURL(video.src);\r\n          resolve(video.duration || 10);\r\n        };\r\n        \r\n        video.onerror = () => {\r\n          clearTimeout(timeout);\r\n          resolve(10);\r\n        };\r\n        \r\n        video.src = URL.createObjectURL(file);\r\n      } catch (error) {\r\n        console.warn('Video duration error:', error);\r\n        resolve(10);\r\n      }\r\n    });\r\n  }\r\n\r\n  async getAudioDuration(file) {\r\n    return new Promise((resolve) => {\r\n      try {\r\n        const audio = document.createElement('audio');\r\n        audio.preload = 'metadata';\r\n        \r\n        const timeout = setTimeout(() => {\r\n          audio.src = '';\r\n          resolve(10);\r\n        }, 5000);\r\n        \r\n        audio.onloadedmetadata = () => {\r\n          clearTimeout(timeout);\r\n          URL.revokeObjectURL(audio.src);\r\n          resolve(audio.duration || 10);\r\n        };\r\n        \r\n        audio.onerror = () => {\r\n          clearTimeout(timeout);\r\n          resolve(10);\r\n        };\r\n        \r\n        audio.src = URL.createObjectURL(file);\r\n      } catch (error) {\r\n        console.warn('Audio duration error:', error);\r\n        resolve(10);\r\n      }\r\n    });\r\n  }\r\n\r\n  async getImageDimensions(file) {\r\n    return new Promise((resolve) => {\r\n      try {\r\n        const img = new Image();\r\n        \r\n        const timeout = setTimeout(() => {\r\n          img.src = '';\r\n          resolve({ width: 0, height: 0 });\r\n        }, 5000);\r\n        \r\n        img.onload = () => {\r\n          clearTimeout(timeout);\r\n          URL.revokeObjectURL(img.src);\r\n          resolve({ width: img.width, height: img.height });\r\n        };\r\n        \r\n        img.onerror = () => {\r\n          clearTimeout(timeout);\r\n          resolve({ width: 0, height: 0 });\r\n        };\r\n        \r\n        img.src = URL.createObjectURL(file);\r\n      } catch (error) {\r\n        console.warn('Image dimensions error:', error);\r\n        resolve({ width: 0, height: 0 });\r\n      }\r\n    });\r\n  }\r\n\r\n  async cleanupExpiredFiles() {\r\n    try {\r\n      const now = new Date();\r\n      let expiredCount = 0;\r\n\r\n      if (this.fallbackMode) {\r\n        const keysToDelete = [];\r\n        for (const [key, file] of this.memoryStorage.entries()) {\r\n          if (new Date(file.expiresAt) <= now) {\r\n            keysToDelete.push(key);\r\n            if (file.url) {\r\n              URL.revokeObjectURL(file.url);\r\n            }\r\n          }\r\n        }\r\n        \r\n        keysToDelete.forEach(key => this.memoryStorage.delete(key));\r\n        expiredCount = keysToDelete.length;\r\n      } else {\r\n        const allFiles = await new Promise((resolve) => {\r\n          const transaction = this.db.transaction(['files'], 'readonly');\r\n          const store = transaction.objectStore('files');\r\n          const request = store.getAll();\r\n          \r\n          request.onsuccess = () => resolve(request.result || []);\r\n          request.onerror = () => resolve([]);\r\n        });\r\n\r\n        const expiredFiles = allFiles.filter(file => {\r\n          return new Date(file.expiresAt) <= now;\r\n        });\r\n\r\n        for (const file of expiredFiles) {\r\n          try {\r\n            await this.deleteFromIndexedDB(file.id);\r\n            if (file.url) {\r\n              URL.revokeObjectURL(file.url);\r\n            }\r\n            expiredCount++;\r\n          } catch (deleteError) {\r\n            console.warn('Failed to delete expired file:', deleteError);\r\n          }\r\n        }\r\n      }\r\n\r\n      console.log(`Cleaned up ${expiredCount} expired files`);\r\n      return expiredCount;\r\n    } catch (error) {\r\n      console.error('Cleanup error:', error);\r\n      return 0;\r\n    }\r\n  }\r\n}\r\n\r\nconst MediaStorage = new EmbeddedMediaStorage();\r\n\r\nconst VideoEditor = () => {\r\n  const [mediaLibrary, setMediaLibrary] = useState({\r\n    videos: [],\r\n    audios: [],\r\n    images: [],\r\n  });\r\n  \r\n  // Новые состояния для работы с MediaStorage\r\n  const [storageInfo, setStorageInfo] = useState(null);\r\n  const [isStorageReady, setIsStorageReady] = useState(false);\r\n  const [uploadingFiles, setUploadingFiles] = useState(new Set());\r\n  const [storageError, setStorageError] = useState(null);\r\n  \r\n  const [timelineItems, setTimelineItems] = useState([]);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [videoDuration, setVideoDuration] = useState(60);\r\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\r\n  const [timelineZoom, setTimelineZoom] = useState(1);\r\n  const [activeTab, setActiveTab] = useState(\"videos\");\r\n  const [volume, setVolume] = useState(1);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\r\n  const [draggedItem, setDraggedItem] = useState(null);\r\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\r\n  const [dropPreview, setDropPreview] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\r\n  const [dragOffset, setDragOffset] = useState(0);\r\n  const [copiedItem, setCopiedItem] = useState(null);\r\n  \r\n  // Новые состояния для resize\r\n  const [isResizing, setIsResizing] = useState(false);\r\n  const [resizeHandle, setResizeHandle] = useState(null); // 'left' | 'right'\r\n  const [resizeItem, setResizeItem] = useState(null);\r\n  const [originalItemData, setOriginalItemData] = useState(null);\r\n  \r\n  // Состояния для управления overlays на видео\r\n  const [selectedOverlay, setSelectedOverlay] = useState(null);\r\n  const [overlayTransforms, setOverlayTransforms] = useState({}); // { overlayId: { x, y, scale, opacity } }\r\n  const [isDraggingOverlay, setIsDraggingOverlay] = useState(false);\r\n  const [isResizingOverlay, setIsResizingOverlay] = useState(false);\r\n  const [overlayDragStart, setOverlayDragStart] = useState({ x: 0, y: 0 });\r\n  const [resizeOverlayHandle, setResizeOverlayHandle] = useState(null);\r\n  const [initialOverlayTransform, setInitialOverlayTransform] = useState(null);\r\n  \r\n  // Модальное окно помощи\r\n  const [showHelp, setShowHelp] = useState(false);\r\n  \r\n  // Треки как в CapCut\r\n  const [tracks, setTracks] = useState({\r\n    overlays: [\r\n      { id: 'overlay-1', name: 'Overlay 1', type: 'overlay' },\r\n      { id: 'overlay-2', name: 'Overlay 2', type: 'overlay' }\r\n    ],\r\n    main: [\r\n      { id: 'main-video', name: 'Main Video', type: 'main' }\r\n    ],\r\n    audio: [\r\n      { id: 'audio-1', name: 'Audio 1', type: 'audio' },\r\n      { id: 'audio-2', name: 'Audio 2', type: 'audio' }\r\n    ]\r\n  });\r\n\r\n  const timelineRef = useRef(null);\r\n  const timelineScrollRef = useRef(null);\r\n  const trackLabelsRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n  const audioElementsRef = useRef(new Map());\r\n  const fileInputRef = useRef(null);\r\n  const audioInputRef = useRef(null);\r\n  const imageInputRef = useRef(null);\r\n  const videoRef = useRef(null);\r\n  const autoScrollIntervalRef = useRef(null);\r\n  const videoContainerRef = useRef(null);\r\n\r\n  // Инициализация MediaStorage при загрузке компонента\r\n  useEffect(() => {\r\n    const initStorage = async () => {\r\n      try {\r\n        setStorageError(null);\r\n        await MediaStorage.init();\r\n        setIsStorageReady(true);\r\n        \r\n        // Загружаем существующие файлы\r\n        await loadExistingFiles();\r\n        \r\n        // Получаем информацию о хранилище\r\n        const info = await MediaStorage.getStorageInfo();\r\n        setStorageInfo(info);\r\n        \r\n        // Очищаем истекшие файлы\r\n        await MediaStorage.cleanupExpiredFiles();\r\n        \r\n        console.log('MediaStorage initialized successfully');\r\n      } catch (error) {\r\n        console.error('Failed to initialize MediaStorage:', error);\r\n        setStorageError(error.message);\r\n        setIsStorageReady(false);\r\n      }\r\n    };\r\n\r\n    initStorage();\r\n\r\n    // Слушаем события обновления хранилища\r\n    const handleStorageUpdate = (event) => {\r\n      setStorageInfo(event.detail);\r\n    };\r\n\r\n    window.addEventListener('storageUpdated', handleStorageUpdate);\r\n    \r\n    return () => {\r\n      window.removeEventListener('storageUpdated', handleStorageUpdate);\r\n    };\r\n  }, []);\r\n\r\n  // Загрузка существующих файлов из MediaStorage\r\n  const loadExistingFiles = async () => {\r\n    try {\r\n      const files = await MediaStorage.getAllFiles();\r\n      setMediaLibrary(files);\r\n      console.log('Loaded existing files from storage:', files);\r\n    } catch (error) {\r\n      console.error('Failed to load existing files:', error);\r\n    }\r\n  };\r\n\r\n  // Базовые функции\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    const ms = Math.floor((seconds % 1) * 100);\r\n    return timelineZoom > 5 ? `${mins}:${secs.toString().padStart(2, \"0\")}.${ms.toString().padStart(2, \"0\")}` : `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\r\n  };\r\n\r\n  const handlePlayPause = () => {\r\n    setIsPlaying(!isPlaying);\r\n  };\r\n\r\n  const seekTo = (time) => {\r\n    const newTime = Math.max(0, Math.min(videoDuration, time));\r\n    setCurrentTime(newTime);\r\n    \r\n    const content = getCurrentTimelineContent();\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = audioElementsRef.current.get(audioItem.id);\r\n      if (audioElement) {\r\n        const relativeTime = newTime - audioItem.startTime;\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    });\r\n  };\r\n\r\n  const getCurrentTimelineContent = useCallback(() => {\r\n    const currentItems = timelineItems.filter(\r\n      (item) =>\r\n        currentTime >= item.startTime &&\r\n        currentTime < item.startTime + item.duration\r\n    );\r\n\r\n    return {\r\n      mainVideo: currentItems.find(item => item.trackType === 'main' && item.type === 'video'),\r\n      overlays: currentItems.filter(item => item.trackType === 'overlay'),\r\n      audio: currentItems.filter(item => item.trackType === 'audio'),\r\n    };\r\n  }, [currentTime, timelineItems]);\r\n\r\n  const createAudioElement = useCallback((audioItem) => {\r\n    if (!audioElementsRef.current.has(audioItem.id)) {\r\n      const audio = document.createElement('audio');\r\n      audio.src = audioItem.url;\r\n      audio.volume = (audioItem.volume || 1) * volume;\r\n      audio.muted = isMuted;\r\n      audio.preload = \"metadata\";\r\n      audioElementsRef.current.set(audioItem.id, audio);\r\n    }\r\n    return audioElementsRef.current.get(audioItem.id);\r\n  }, [volume, isMuted]);\r\n\r\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\r\n    const audioElement = audioElementsRef.current.get(audioItem.id);\r\n    if (audioElement) {\r\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\r\n      if (timeDiff > 0.2) {\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const checkCollision = useCallback((newItem, excludeId = null) => {\r\n    return timelineItems.some(item => {\r\n      if (item.id === excludeId) return false;\r\n      if (item.trackId !== newItem.trackId) return false;\r\n      \r\n      const itemStart = item.startTime;\r\n      const itemEnd = item.startTime + item.duration;\r\n      const newStart = newItem.startTime;\r\n      const newEnd = newItem.startTime + newItem.duration;\r\n      \r\n      return (newStart < itemEnd && newEnd > itemStart);\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  // Функция для вставки с автоматическим сдвигом блоков (как в CapCut)\r\n  const insertWithRipple = useCallback((trackId, insertTime, duration, excludeId = null) => {\r\n    const trackItems = timelineItems\r\n      .filter(item => item.trackId === trackId && item.id !== excludeId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n\r\n    // Если трек пустой\r\n    if (trackItems.length === 0) {\r\n      return { time: Math.max(0, insertTime), shouldRipple: false, affectedItems: [] };\r\n    }\r\n\r\n    // Ищем где вставить\r\n    let insertPosition = insertTime;\r\n    let shouldRipple = false;\r\n    let affectedItems = [];\r\n\r\n    // Проверяем есть ли точно в этом месте блок\r\n    const blockAtPosition = trackItems.find(item => \r\n      insertTime >= item.startTime && insertTime < item.startTime + item.duration\r\n    );\r\n\r\n    if (blockAtPosition) {\r\n      // Вставляем в начало этого блока и сдвигаем все что справа\r\n      insertPosition = blockAtPosition.startTime;\r\n      shouldRipple = true;\r\n      affectedItems = trackItems.filter(item => item.startTime >= insertPosition);\r\n    } else {\r\n      // Ищем блоки которые нужно сдвинуть\r\n      const blocksToShift = trackItems.filter(item => item.startTime >= insertTime);\r\n      \r\n      if (blocksToShift.length > 0) {\r\n        // Проверяем, есть ли место без сдвига\r\n        const nextBlock = blocksToShift[0];\r\n        const availableSpace = nextBlock.startTime - insertTime;\r\n        \r\n        if (availableSpace >= duration) {\r\n          // Помещается без сдвига\r\n          insertPosition = insertTime;\r\n          shouldRipple = false;\r\n        } else {\r\n          // Нужно сдвинуть\r\n          insertPosition = insertTime;\r\n          shouldRipple = true;\r\n          affectedItems = blocksToShift;\r\n        }\r\n      } else {\r\n        // Вставляем в конец\r\n        insertPosition = insertTime;\r\n        shouldRipple = false;\r\n      }\r\n    }\r\n\r\n    return {\r\n      time: Math.max(0, insertPosition),\r\n      shouldRipple,\r\n      affectedItems,\r\n      shiftAmount: shouldRipple ? duration : 0\r\n    };\r\n  }, [timelineItems]);\r\n\r\n  // Функция для поиска ближайшего свободного места (обратная совместимость)\r\n  const findNearestValidPosition = useCallback((trackId, dropTime, duration, excludeId = null) => {\r\n    const result = insertWithRipple(trackId, dropTime, duration, excludeId);\r\n    return {\r\n      time: result.time,\r\n      isExact: !result.shouldRipple\r\n    };\r\n  }, [insertWithRipple]);\r\n\r\n  // Функция для применения ripple effect\r\n  const applyRippleEffect = useCallback((affectedItems, shiftAmount) => {\r\n    if (!affectedItems.length || shiftAmount <= 0) return;\r\n\r\n    console.log('Applying ripple effect:', { \r\n      affectedCount: affectedItems.length, \r\n      shiftAmount,\r\n      affectedItems: affectedItems.map(item => ({ name: item.name, oldStart: item.startTime }))\r\n    });\r\n\r\n    setTimelineItems(prev => prev.map(item => {\r\n      const affectedItem = affectedItems.find(affected => affected.id === item.id);\r\n      if (affectedItem) {\r\n        console.log(`Shifting ${item.name} from ${item.startTime} to ${item.startTime + shiftAmount}`);\r\n        return {\r\n          ...item,\r\n          startTime: item.startTime + shiftAmount\r\n        };\r\n      }\r\n      return item;\r\n    }));\r\n\r\n    // Обновляем общую длительность если нужно\r\n    if (affectedItems.length > 0) {\r\n      const maxEndTime = Math.max(...affectedItems.map(item => item.startTime + item.duration + shiftAmount));\r\n      if (maxEndTime > videoDuration) {\r\n        setVideoDuration(maxEndTime + 10);\r\n      }\r\n    }\r\n  }, [videoDuration]);\r\n\r\n  const findNextAvailablePosition = useCallback((trackId, duration, preferredStart = 0) => {\r\n    const trackItems = timelineItems\r\n      .filter(item => item.trackId === trackId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n    \r\n    if (preferredStart >= 0) {\r\n      const testItem = { trackId, startTime: preferredStart, duration };\r\n      if (!checkCollision(testItem)) {\r\n        return preferredStart;\r\n      }\r\n    }\r\n    \r\n    for (let i = 0; i < trackItems.length; i++) {\r\n      const currentItem = trackItems[i];\r\n      const nextItem = trackItems[i + 1];\r\n      \r\n      if (i === 0 && currentItem.startTime >= duration) {\r\n        return 0;\r\n      }\r\n      \r\n      if (nextItem) {\r\n        const gapStart = currentItem.startTime + currentItem.duration;\r\n        const gapEnd = nextItem.startTime;\r\n        const gapSize = gapEnd - gapStart;\r\n        \r\n        if (gapSize >= duration) {\r\n          return gapStart;\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (trackItems.length === 0) return 0;\r\n    const lastItem = trackItems[trackItems.length - 1];\r\n    return lastItem.startTime + lastItem.duration;\r\n  }, [timelineItems, checkCollision]);\r\n\r\n  const removeFromTimeline = (itemId) => {\r\n    const audioElement = audioElementsRef.current.get(itemId);\r\n    if (audioElement) {\r\n      audioElement.pause();\r\n      audioElement.src = '';\r\n      audioElementsRef.current.delete(itemId);\r\n    }\r\n    \r\n    setTimelineItems((prev) => prev.filter((item) => item.id !== itemId));\r\n    setSelectedTimelineItem(null);\r\n  };\r\n\r\n  // Функции для управления overlays на видео\r\n  const getOverlayTransform = useCallback((overlayId) => {\r\n    return overlayTransforms[overlayId] || { x: 0, y: 0, scale: 1, opacity: 1 };\r\n  }, [overlayTransforms]);\r\n\r\n  const updateOverlayTransform = useCallback((overlayId, updates) => {\r\n    setOverlayTransforms(prev => ({\r\n      ...prev,\r\n      [overlayId]: { ...getOverlayTransform(overlayId), ...updates }\r\n    }));\r\n  }, [getOverlayTransform]);\r\n\r\n  const handleOverlayMouseDown = useCallback((e, overlay) => {\r\n    if (e.target.closest('.resize-handle')) return; // Не начинаем drag если кликнули на resize handle\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    setSelectedOverlay(overlay);\r\n    setIsDraggingOverlay(true);\r\n    \r\n    const container = videoContainerRef.current;\r\n    if (!container) return;\r\n    \r\n    const containerRect = container.getBoundingClientRect();\r\n    const overlayElement = e.currentTarget;\r\n    const overlayRect = overlayElement.getBoundingClientRect();\r\n    const transform = getOverlayTransform(overlay.id);\r\n    \r\n    // Запоминаем точный offset от позиции мыши до текущей позиции элемента\r\n    setOverlayDragStart({\r\n      x: e.clientX - overlayRect.left,\r\n      y: e.clientY - overlayRect.top,\r\n      containerX: containerRect.left,\r\n      containerY: containerRect.top\r\n    });\r\n  }, [getOverlayTransform]);\r\n\r\n  const handleOverlayResizeStart = useCallback((e, overlay, handle) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    console.log('Starting resize:', handle); // Для отладки\r\n    \r\n    setSelectedOverlay(overlay);\r\n    setIsResizingOverlay(true);\r\n    setResizeOverlayHandle(handle);\r\n    \r\n    const currentTransform = getOverlayTransform(overlay.id);\r\n    setInitialOverlayTransform(currentTransform);\r\n    \r\n    setOverlayDragStart({\r\n      x: e.clientX,\r\n      y: e.clientY,\r\n      startScale: currentTransform.scale,\r\n      startX: currentTransform.x,\r\n      startY: currentTransform.y\r\n    });\r\n  }, [getOverlayTransform]);\r\n\r\n  const handleOverlayMouseMove = useCallback((e) => {\r\n    if (!selectedOverlay) return;\r\n    \r\n    if (isDraggingOverlay) {\r\n      // Перетаскивание с максимальной плавностью\r\n      const container = videoContainerRef.current;\r\n      if (!container) return;\r\n      \r\n      const rect = container.getBoundingClientRect();\r\n      const overlaySize = 128 * getOverlayTransform(selectedOverlay.id).scale;\r\n      \r\n      // Вычисляем новую позицию с учетом начального offset\r\n      const newX = e.clientX - overlayDragStart.containerX - overlayDragStart.x;\r\n      const newY = e.clientY - overlayDragStart.containerY - overlayDragStart.y;\r\n      \r\n      // Ограничиваем движение границами контейнера с учетом размера overlay\r\n      const padding = 5; // Минимальный отступ\r\n      const limitedX = Math.max(padding, Math.min(rect.width - overlaySize - padding, newX));\r\n      const limitedY = Math.max(padding, Math.min(rect.height - overlaySize - padding, newY));\r\n      \r\n      // Обновляем позицию относительно базовой позиции\r\n      const baseX = 200;\r\n      const baseY = 50 + selectedOverlay.index * 120;\r\n      \r\n      // Мгновенное обновление без debounce для плавности\r\n      updateOverlayTransform(selectedOverlay.id, { \r\n        x: limitedX - baseX, \r\n        y: limitedY - baseY \r\n      });\r\n      \r\n    } else if (isResizingOverlay && overlayDragStart.startScale !== undefined && resizeOverlayHandle) {\r\n      console.log('Resizing...', resizeOverlayHandle); // Для отладки\r\n      \r\n      // Простая логика resize\r\n      const deltaX = e.clientX - overlayDragStart.x;\r\n      const deltaY = e.clientY - overlayDragStart.y;\r\n      \r\n      // Определяем направление и чувствительность\r\n      let scaleFactor = 1;\r\n      const sensitivity = 0.005; // Базовая чувствительность\r\n      \r\n      switch (resizeOverlayHandle) {\r\n        case 'nw': // Северо-запад: тянем влево-вверх = уменьшаем\r\n          scaleFactor = 1 - (deltaX + deltaY) * sensitivity;\r\n          break;\r\n        case 'ne': // Северо-восток: тянем вправо-вверх = увеличиваем вправо, уменьшаем вверх  \r\n          scaleFactor = 1 + (deltaX - deltaY) * sensitivity;\r\n          break;\r\n        case 'sw': // Юго-запад: тянем влево-вниз = уменьшаем влево, увеличиваем вниз\r\n          scaleFactor = 1 + (-deltaX + deltaY) * sensitivity;\r\n          break;\r\n        case 'se': // Юго-восток: тянем вправо-вниз = увеличиваем\r\n          scaleFactor = 1 + (deltaX + deltaY) * sensitivity;\r\n          break;\r\n      }\r\n      \r\n      // Применяем новый масштаб\r\n      const newScale = Math.max(0.2, Math.min(4, overlayDragStart.startScale * scaleFactor));\r\n      \r\n      // Простое обновление без сложной компенсации позиции\r\n      updateOverlayTransform(selectedOverlay.id, { \r\n        scale: newScale\r\n      });\r\n    }\r\n  }, [selectedOverlay, isDraggingOverlay, isResizingOverlay, overlayDragStart, initialOverlayTransform, updateOverlayTransform, getOverlayTransform, resizeOverlayHandle]);\r\n\r\n  const handleOverlayMouseUp = useCallback(() => {\r\n    console.log('Mouse up - stopping drag/resize'); // Для отладки\r\n    setIsDraggingOverlay(false);\r\n    setIsResizingOverlay(false);\r\n    setResizeOverlayHandle(null);\r\n    setInitialOverlayTransform(null);\r\n  }, []);\r\n\r\n  const handleOverlayWheel = useCallback((e, overlayId) => {\r\n    if (!e.ctrlKey) return;\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const transform = getOverlayTransform(overlayId);\r\n    const scaleDelta = e.deltaY > 0 ? -0.05 : 0.05; // Более плавное масштабирование\r\n    const newScale = Math.max(0.2, Math.min(4, transform.scale + scaleDelta));\r\n    \r\n    updateOverlayTransform(overlayId, { scale: newScale });\r\n  }, [getOverlayTransform, updateOverlayTransform]);\r\n\r\n  // Функции для работы с элементами таймлайна\r\n  const splitTimelineItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    \r\n    const item = selectedTimelineItem;\r\n    const splitTime = currentTime;\r\n    \r\n    if (splitTime <= item.startTime || splitTime >= item.startTime + item.duration) {\r\n      return;\r\n    }\r\n    \r\n    const firstPartDuration = splitTime - item.startTime;\r\n    const secondPartStart = splitTime;\r\n    const secondPartDuration = item.duration - firstPartDuration;\r\n    \r\n    const secondPart = {\r\n      ...item,\r\n      id: Date.now() + Math.random(),\r\n      startTime: secondPartStart,\r\n      duration: secondPartDuration,\r\n    };\r\n    \r\n    const updatedFirstPart = {\r\n      ...item,\r\n      duration: firstPartDuration,\r\n    };\r\n    \r\n    setTimelineItems(prev => prev.map(timelineItem => \r\n      timelineItem.id === item.id ? updatedFirstPart : timelineItem\r\n    ).concat(secondPart));\r\n    \r\n    setSelectedTimelineItem(null);\r\n  }, [selectedTimelineItem, currentTime]);\r\n\r\n  const copyTimelineItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    setCopiedItem(selectedTimelineItem);\r\n  }, [selectedTimelineItem]);\r\n\r\n  const pasteTimelineItem = useCallback(() => {\r\n    if (!copiedItem) return;\r\n    \r\n    const targetTrackId = copiedItem.trackId;\r\n    const insertResult = insertWithRipple(targetTrackId, currentTime, copiedItem.duration);\r\n    \r\n    // Применяем ripple effect если нужно\r\n    if (insertResult.shouldRipple && insertResult.affectedItems?.length > 0) {\r\n      applyRippleEffect(insertResult.affectedItems, copiedItem.duration);\r\n    }\r\n    \r\n    const newItem = {\r\n      ...copiedItem,\r\n      id: Date.now() + Math.random(),\r\n      startTime: insertResult.time,\r\n    };\r\n\r\n    setTimelineItems(prev => [...prev, newItem]);\r\n\r\n    const newEndTime = newItem.startTime + newItem.duration;\r\n    if (newEndTime > videoDuration) {\r\n      setVideoDuration(newEndTime + 10);\r\n    }\r\n    \r\n    setSelectedTimelineItem(newItem);\r\n  }, [copiedItem, currentTime, insertWithRipple, applyRippleEffect, videoDuration]);\r\n\r\n  const deleteSelectedItem = useCallback(() => {\r\n    if (!selectedTimelineItem) return;\r\n    removeFromTimeline(selectedTimelineItem.id);\r\n  }, [selectedTimelineItem]);\r\n\r\n  // Автопрокрутка и зум\r\n  const stopAutoScroll = useCallback(() => {\r\n    if (autoScrollIntervalRef.current) {\r\n      clearInterval(autoScrollIntervalRef.current);\r\n      autoScrollIntervalRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const startAutoScroll = useCallback((direction, speed = 1) => {\r\n    stopAutoScroll();\r\n    \r\n    autoScrollIntervalRef.current = setInterval(() => {\r\n      if (timelineScrollRef.current) {\r\n        const scrollAmount = 15 * speed;\r\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\r\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\r\n        \r\n        if (direction === 'left' && currentScrollLeft > 0) {\r\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\r\n        } else if (direction === 'right' && currentScrollLeft < maxScroll) {\r\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\r\n        }\r\n      }\r\n    }, 16); // 60fps для плавности\r\n  }, [stopAutoScroll]);\r\n\r\n  const checkAutoScroll = useCallback((clientX) => {\r\n    if (!timelineScrollRef.current) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const scrollZoneWidth = 120;\r\n    const relativeX = clientX - rect.left;\r\n    \r\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\r\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\r\n      startAutoScroll('left', speed);\r\n    }\r\n    else if (relativeX > rect.width - scrollZoneWidth) {\r\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\r\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\r\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\r\n        startAutoScroll('right', speed);\r\n      }\r\n    }\r\n    else {\r\n      stopAutoScroll();\r\n    }\r\n  }, [startAutoScroll, stopAutoScroll]);\r\n\r\n  // Функции зума\r\n  const zoomIn = () => {\r\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\r\n  };\r\n\r\n  const zoomOut = () => {\r\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\r\n  };\r\n\r\n  const resetZoom = () => {\r\n    setTimelineZoom(1);\r\n  };\r\n\r\n  // Функции для resize\r\n  const handleResizeStart = useCallback((e, item, handle) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setIsResizing(true);\r\n    setResizeHandle(handle);\r\n    setResizeItem(item);\r\n    setOriginalItemData({\r\n      startTime: item.startTime,\r\n      duration: item.duration\r\n    });\r\n    \r\n    // Предотвращаем drag\r\n    setIsTimelineDragging(false);\r\n    setDraggedTimelineItem(null);\r\n  }, []);\r\n\r\n  const handleResizeEnd = useCallback(() => {\r\n    setIsResizing(false);\r\n    setResizeHandle(null);\r\n    setResizeItem(null);\r\n    setOriginalItemData(null);\r\n    stopAutoScroll();\r\n  }, [stopAutoScroll]);\r\n\r\n  // Синхронизация скролла\r\n  const handleTrackAreaScroll = (e) => {\r\n    if (trackLabelsRef.current) {\r\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const handleTrackLabelsScroll = (e) => {\r\n    if (timelineScrollRef.current) {\r\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const getTimelineWidth = () => {\r\n    const baseWidth = videoDuration * 50 * timelineZoom;\r\n    return Math.max(baseWidth, 2000);\r\n  };\r\n\r\n  const getPixelsPerSecond = () => {\r\n    return 50 * timelineZoom;\r\n  };\r\n\r\n  // НОВЫЕ ФУНКЦИИ ДЛЯ РАБОТЫ С MEDIASTORAGE\r\n\r\n  // Обновленная функция загрузки видео с MediaStorage\r\n  const handleVideoUpload = async (event) => {\r\n    if (!isStorageReady) {\r\n      console.error('Storage not ready');\r\n      return;\r\n    }\r\n\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    \r\n    for (const file of files) {\r\n      const fileId = Date.now() + Math.random();\r\n      setUploadingFiles(prev => new Set([...prev, fileId]));\r\n      \r\n      try {\r\n        // Проверяем, можем ли загрузить\r\n        const canUpload = await MediaStorage.canUpload('videos');\r\n        if (!canUpload) {\r\n          const remaining = await MediaStorage.getRemainingSpace('videos');\r\n          throw new Error(`Video storage limit reached. ${remaining} slots remaining.`);\r\n        }\r\n\r\n        // Сохраняем файл в MediaStorage\r\n        const savedFile = await MediaStorage.saveFile(file, 'videos');\r\n        console.log('Video saved to MediaStorage:', savedFile);\r\n\r\n        // Добавляем в медиабиблиотеку\r\n        setMediaLibrary((prev) => ({\r\n          ...prev,\r\n          videos: [...prev.videos, savedFile],\r\n        }));\r\n\r\n      } catch (error) {\r\n        console.error('Failed to upload video:', error);\r\n        setStorageError(error.message);\r\n      } finally {\r\n        setUploadingFiles(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(fileId);\r\n          return newSet;\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Очищаем input\r\n    if (event.target) {\r\n      event.target.value = '';\r\n    }\r\n  };\r\n\r\n  // Обновленная функция загрузки аудио с MediaStorage\r\n  const handleAudioUpload = async (event) => {\r\n    if (!isStorageReady) {\r\n      console.error('Storage not ready');\r\n      return;\r\n    }\r\n\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    \r\n    for (const file of files) {\r\n      const fileId = Date.now() + Math.random();\r\n      setUploadingFiles(prev => new Set([...prev, fileId]));\r\n      \r\n      try {\r\n        // Проверяем, можем ли загрузить\r\n        const canUpload = await MediaStorage.canUpload('audios');\r\n        if (!canUpload) {\r\n          const remaining = await MediaStorage.getRemainingSpace('audios');\r\n          throw new Error(`Audio storage limit reached. ${remaining} slots remaining.`);\r\n        }\r\n\r\n        // Сохраняем файл в MediaStorage\r\n        const savedFile = await MediaStorage.saveFile(file, 'audios');\r\n        console.log('Audio saved to MediaStorage:', savedFile);\r\n\r\n        // Добавляем в медиабиблиотеку\r\n        setMediaLibrary((prev) => ({\r\n          ...prev,\r\n          audios: [...prev.audios, savedFile],\r\n        }));\r\n\r\n      } catch (error) {\r\n        console.error('Failed to upload audio:', error);\r\n        setStorageError(error.message);\r\n      } finally {\r\n        setUploadingFiles(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(fileId);\r\n          return newSet;\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Очищаем input\r\n    if (event.target) {\r\n      event.target.value = '';\r\n    }\r\n  };\r\n\r\n  // Обновленная функция загрузки изображений с MediaStorage\r\n  const handleImageUpload = async (event) => {\r\n    if (!isStorageReady) {\r\n      console.error('Storage not ready');\r\n      return;\r\n    }\r\n\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    \r\n    for (const file of files) {\r\n      const fileId = Date.now() + Math.random();\r\n      setUploadingFiles(prev => new Set([...prev, fileId]));\r\n      \r\n      try {\r\n        // Проверяем, можем ли загрузить\r\n        const canUpload = await MediaStorage.canUpload('images');\r\n        if (!canUpload) {\r\n          const remaining = await MediaStorage.getRemainingSpace('images');\r\n          throw new Error(`Image storage limit reached. ${remaining} slots remaining.`);\r\n        }\r\n\r\n        // Сохраняем файл в MediaStorage\r\n        const savedFile = await MediaStorage.saveFile(file, 'images');\r\n        console.log('Image saved to MediaStorage:', savedFile);\r\n\r\n        // Добавляем в медиабиблиотеку\r\n        setMediaLibrary((prev) => ({\r\n          ...prev,\r\n          images: [...prev.images, savedFile],\r\n        }));\r\n\r\n      } catch (error) {\r\n        console.error('Failed to upload image:', error);\r\n        setStorageError(error.message);\r\n      } finally {\r\n        setUploadingFiles(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(fileId);\r\n          return newSet;\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Очищаем input\r\n    if (event.target) {\r\n      event.target.value = '';\r\n    }\r\n  };\r\n\r\n  // Обновленная функция удаления из библиотеки с MediaStorage\r\n  const removeFromLibrary = async (itemId, type) => {\r\n    try {\r\n      // Удаляем из MediaStorage\r\n      await MediaStorage.deleteFile(itemId);\r\n      console.log('File deleted from MediaStorage:', itemId);\r\n\r\n      // Удаляем из медиабиблиотеки\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        [type]: prev[type].filter((item) => item.id !== itemId),\r\n      }));\r\n\r\n      // Удаляем из таймлайна если есть\r\n      setTimelineItems(prev => prev.filter(item => item.mediaId !== itemId));\r\n\r\n    } catch (error) {\r\n      console.error('Failed to remove from library:', error);\r\n      setStorageError(error.message);\r\n    }\r\n  };\r\n\r\n  // Функция очистки Storage (для отладки)\r\n  const clearStorage = async () => {\r\n    try {\r\n      const allFiles = await MediaStorage.getAllFiles();\r\n      const allItems = [...allFiles.videos, ...allFiles.images, ...allFiles.audios];\r\n      \r\n      for (const item of allItems) {\r\n        await MediaStorage.deleteFile(item.id);\r\n      }\r\n      \r\n      setMediaLibrary({ videos: [], audios: [], images: [] });\r\n      setTimelineItems([]);\r\n      console.log('Storage cleared');\r\n    } catch (error) {\r\n      console.error('Failed to clear storage:', error);\r\n    }\r\n  };\r\n\r\n  // Эффекты для управления overlays\r\n  useEffect(() => {\r\n    if (isDraggingOverlay || isResizingOverlay) {\r\n      document.addEventListener('mousemove', handleOverlayMouseMove);\r\n      document.addEventListener('mouseup', handleOverlayMouseUp);\r\n      document.body.style.cursor = isDraggingOverlay ? 'grabbing' : 'nw-resize';\r\n      \r\n      return () => {\r\n        document.removeEventListener('mousemove', handleOverlayMouseMove);\r\n        document.removeEventListener('mouseup', handleOverlayMouseUp);\r\n        document.body.style.cursor = '';\r\n      };\r\n    }\r\n  }, [isDraggingOverlay, isResizingOverlay, handleOverlayMouseMove, handleOverlayMouseUp]);\r\n\r\n  // Обработка resize во время движения мыши\r\n  useEffect(() => {\r\n    const handleMouseMove = (e) => {\r\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\r\n      \r\n      checkAutoScroll(e.clientX);\r\n      \r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const pixelsPerSecond = getPixelsPerSecond();\r\n      const newTime = mouseX / pixelsPerSecond;\r\n      \r\n      setTimelineItems(prev => prev.map(item => {\r\n        if (item.id !== resizeItem.id) return item;\r\n        \r\n        const minDuration = 0.1;\r\n        \r\n        if (resizeHandle === 'left') {\r\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\r\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\r\n          const newDuration = rightEdge - newStartTime;\r\n          \r\n          return {\r\n            ...item,\r\n            startTime: newStartTime,\r\n            duration: newDuration\r\n          };\r\n          \r\n        } else if (resizeHandle === 'right') {\r\n          const leftEdge = originalItemData.startTime;\r\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\r\n          const newDuration = newEndTime - leftEdge;\r\n          \r\n          return {\r\n            ...item,\r\n            duration: newDuration\r\n          };\r\n        }\r\n        \r\n        return item;\r\n      }));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      if (isResizing) {\r\n        handleResizeEnd();\r\n      }\r\n    };\r\n\r\n    if (isResizing) {\r\n      document.addEventListener('mousemove', handleMouseMove);\r\n      document.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd]);\r\n\r\n  // Основные эффекты\r\n  useEffect(() => {\r\n    const content = getCurrentTimelineContent();\r\n\r\n    if (content.mainVideo && content.mainVideo.url !== currentVideoSource) {\r\n      setCurrentVideoSource(content.mainVideo.url);\r\n      if (videoRef.current) {\r\n        const relativeTime = currentTime - content.mainVideo.startTime;\r\n        videoRef.current.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    } else if (!content.mainVideo && content.overlays.find(o => o.type === 'image')) {\r\n      const firstImage = content.overlays.find(o => o.type === 'image');\r\n      setCurrentVideoSource(firstImage.url);\r\n    } else if (!content.mainVideo && !content.overlays.find(o => o.type === 'image')) {\r\n      setCurrentVideoSource(null);\r\n    }\r\n\r\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\r\n    \r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = createAudioElement(audioItem);\r\n      const relativeTime = currentTime - audioItem.startTime;\r\n      \r\n      audioElement.volume = (audioItem.volume || 1) * volume;\r\n      audioElement.muted = isMuted;\r\n      \r\n      if (isPlaying && relativeTime >= 0) {\r\n        syncAudioTime(audioItem, relativeTime);\r\n        if (audioElement.paused) {\r\n          audioElement.play().catch(console.error);\r\n        }\r\n      } else {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource]);\r\n\r\n  useEffect(() => {\r\n    if (isPlaying) {\r\n      intervalRef.current = setInterval(() => {\r\n        setCurrentTime((prev) => {\r\n          const newTime = prev + 0.1;\r\n          if (newTime >= videoDuration) {\r\n            setIsPlaying(false);\r\n            return videoDuration;\r\n          }\r\n          return newTime;\r\n        });\r\n      }, 100);\r\n    } else {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [isPlaying, videoDuration]);\r\n\r\n  useEffect(() => {\r\n    if (videoRef.current && currentVideoSource) {\r\n      const content = getCurrentTimelineContent();\r\n      if (content.mainVideo) {\r\n        const relativeTime = currentTime - content.mainVideo.startTime;\r\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\r\n\r\n        if (timeDiff > 0.5) {\r\n          videoRef.current.currentTime = Math.max(0, relativeTime);\r\n        }\r\n\r\n        if (isPlaying && videoRef.current.paused) {\r\n          videoRef.current.play().catch(console.error);\r\n        } else if (!isPlaying && !videoRef.current.paused) {\r\n          videoRef.current.pause();\r\n        }\r\n      }\r\n    }\r\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\r\n\r\n  useEffect(() => {\r\n    const currentAudioIds = new Set(\r\n      timelineItems\r\n        .filter(item => item.type === \"audio\")\r\n        .map(item => item.id)\r\n    );\r\n\r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        audioElement.pause();\r\n        audioElement.src = '';\r\n        audioElementsRef.current.delete(id);\r\n      }\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  // Очистка при размонтировании\r\n  useEffect(() => {\r\n    return () => {\r\n      stopAutoScroll();\r\n    };\r\n  }, [stopAutoScroll]);\r\n\r\n  // Обработка клавиатурных шорткатов\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {\r\n        return;\r\n      }\r\n\r\n      if (e.key === 'Delete' || e.key === 'Backspace') {\r\n        e.preventDefault();\r\n        deleteSelectedItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'b') {\r\n        e.preventDefault();\r\n        splitTimelineItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'c') {\r\n        e.preventDefault();\r\n        copyTimelineItem();\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'v') {\r\n        e.preventDefault();\r\n        pasteTimelineItem();\r\n      }\r\n\r\n      if (e.key === ' ' || e.code === 'Space') {\r\n        e.preventDefault();\r\n        setIsPlaying(prev => !prev);\r\n      }\r\n\r\n      if (e.key === 'ArrowLeft') {\r\n        e.preventDefault();\r\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\r\n        seekTo(Math.max(0, currentTime - step));\r\n      }\r\n      if (e.key === 'ArrowRight') {\r\n        e.preventDefault();\r\n        const step = e.ctrlKey ? 5 : e.shiftKey ? 1 : 0.1;\r\n        seekTo(Math.min(videoDuration, currentTime + step));\r\n      }\r\n\r\n      if (e.key === '=' || e.key === '+') {\r\n        e.preventDefault();\r\n        zoomIn();\r\n      }\r\n      if (e.key === '-') {\r\n        e.preventDefault();\r\n        zoomOut();\r\n      }\r\n      if (e.key === '0') {\r\n        e.preventDefault();\r\n        resetZoom();\r\n      }\r\n      \r\n      if (e.key === '?' || (e.shiftKey && e.key === '/')) {\r\n        e.preventDefault();\r\n        setShowHelp(true);\r\n      }\r\n      \r\n      if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        if (showHelp) {\r\n          setShowHelp(false);\r\n        } else if (selectedOverlay) {\r\n          setSelectedOverlay(null);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [selectedTimelineItem, copiedItem, currentTime, videoDuration, showHelp, selectedOverlay, deleteSelectedItem, splitTimelineItem, copyTimelineItem, pasteTimelineItem]);\r\n\r\n  // Обработка колесика мыши для зума\r\n  useEffect(() => {\r\n    const handleWheel = (e) => {\r\n      if (e.ctrlKey && timelineRef.current?.contains(e.target)) {\r\n        e.preventDefault();\r\n        if (e.deltaY < 0) {\r\n          zoomIn();\r\n        } else {\r\n          zoomOut();\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('wheel', handleWheel, { passive: false });\r\n    return () => document.removeEventListener('wheel', handleWheel);\r\n  }, []);\r\n\r\n  const addToTimeline = (mediaItem, startTime = null, targetTrackId = null) => {\r\n    let trackType, trackId;\r\n    \r\n    if (mediaItem.type === \"video\") {\r\n      trackType = targetTrackId && targetTrackId.startsWith('overlay') ? 'overlay' : 'main';\r\n      trackId = targetTrackId || 'main-video';\r\n    } else if (mediaItem.type === \"image\") {\r\n      trackType = 'overlay';\r\n      trackId = targetTrackId || 'overlay-1';\r\n    } else if (mediaItem.type === \"audio\") {\r\n      trackType = 'audio';\r\n      trackId = targetTrackId || 'audio-1';\r\n    }\r\n    \r\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\r\n    \r\n    const finalStartTime = startTime !== null ? \r\n      startTime : \r\n      findNextAvailablePosition(trackId, duration);\r\n\r\n    const newTimelineItem = {\r\n      id: Date.now() + Math.random(),\r\n      mediaId: mediaItem.id,\r\n      type: mediaItem.type,\r\n      name: mediaItem.name,\r\n      url: mediaItem.url,\r\n      startTime: finalStartTime,\r\n      duration: duration,\r\n      trackId: trackId,\r\n      trackType: trackType,\r\n      volume: 1,\r\n      opacity: 1,\r\n    };\r\n\r\n    setTimelineItems((prev) => [...prev, newTimelineItem]);\r\n\r\n    const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\r\n    if (newEndTime > videoDuration) {\r\n      setVideoDuration(newEndTime + 10);\r\n    }\r\n  };\r\n\r\n  const addOverlayTrack = () => {\r\n    const newTrackId = `overlay-${Date.now()}`;\r\n    setTracks(prev => ({\r\n      ...prev,\r\n      overlays: [...prev.overlays, {\r\n        id: newTrackId,\r\n        name: `Overlay ${prev.overlays.length + 1}`,\r\n        type: 'overlay'\r\n      }]\r\n    }));\r\n  };\r\n\r\n  const addAudioTrack = () => {\r\n    const newTrackId = `audio-${Date.now()}`;\r\n    setTracks(prev => ({\r\n      ...prev,\r\n      audio: [...prev.audio, {\r\n        id: newTrackId,\r\n        name: `Audio ${prev.audio.length + 1}`,\r\n        type: 'audio'\r\n      }]\r\n    }));\r\n  };\r\n\r\n  const handleTimelineClick = (e) => {\r\n    if (isDragging || isTimelineDragging || isResizing) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    seekTo(clickTime);\r\n  };\r\n\r\n  const handleDragStart = (e, mediaItem) => {\r\n    setDraggedItem(mediaItem);\r\n    setIsDragging(true);\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    setDraggedItem(null);\r\n    setDropPreview(null);\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const handleTimelineItemDragStart = (e, timelineItem) => {\r\n    if (isResizing) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n    \r\n    e.stopPropagation();\r\n    setDraggedTimelineItem(timelineItem);\r\n    setIsTimelineDragging(true);\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const itemRect = e.target.getBoundingClientRect();\r\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\r\n    \r\n    e.dataTransfer.effectAllowed = \"move\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleTimelineItemDragEnd = () => {\r\n    setDraggedTimelineItem(null);\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n    setDragOffset(0);\r\n    stopAutoScroll();\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (!draggedItem && !draggedTimelineItem) return;\r\n    \r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\r\n    \r\n    if (draggedTimelineItem || isResizing) {\r\n      checkAutoScroll(e.clientX);\r\n    }\r\n    \r\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\r\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\r\n    \r\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\r\n    const trackHeight = 60;\r\n    const timeRulerHeight = 48;\r\n    \r\n    const relativeY = dragY - timeRulerHeight;\r\n    const trackIndex = Math.floor(relativeY / trackHeight);\r\n    \r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const targetTrack = allTracks[trackIndex];\r\n    \r\n    if (draggedItem && targetTrack) {\r\n      // Новый элемент из библиотеки\r\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\r\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\r\n      \r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || []\r\n      });\r\n    } else if (draggedTimelineItem && targetTrack) {\r\n      // Существующий элемент\r\n      const insertResult = insertWithRipple(\r\n        targetTrack.id, \r\n        dropTime, \r\n        draggedTimelineItem.duration, \r\n        draggedTimelineItem.id\r\n      );\r\n      \r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: draggedTimelineItem.duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || []\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    if ((!draggedItem && !draggedTimelineItem) || !dropPreview) return;\r\n    \r\n    e.preventDefault();\r\n    stopAutoScroll();\r\n    \r\n    console.log('Dropping with ripple:', { \r\n      dropPreview,\r\n      shouldRipple: dropPreview.shouldRipple,\r\n      affectedItems: dropPreview.affectedItems?.length || 0\r\n    });\r\n    \r\n    if (dropPreview.isValid) {\r\n      if (draggedItem) {\r\n        // Новый элемент из библиотеки\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          // Сначала сдвигаем существующие блоки\r\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\r\n        }\r\n        \r\n        // Добавляем новый элемент\r\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\r\n        \r\n        console.log('Added with ripple effect:', dropPreview.shouldRipple);\r\n        \r\n      } else if (draggedTimelineItem) {\r\n        // Перемещение существующего элемента\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          // Сначала сдвигаем блоки, которые нужно освободить место\r\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\r\n        }\r\n        \r\n        // Перемещаем элемент\r\n        setTimelineItems(prev => prev.map(item => \r\n          item.id === draggedTimelineItem.id \r\n            ? { \r\n                ...item, \r\n                startTime: dropPreview.time, \r\n                trackId: dropPreview.trackId, \r\n                trackType: dropPreview.trackType \r\n              }\r\n            : item\r\n        ));\r\n        \r\n        console.log('Moved with ripple effect:', dropPreview.shouldRipple);\r\n        \r\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\r\n        if (newEndTime > videoDuration) {\r\n          setVideoDuration(newEndTime + 10);\r\n        }\r\n      }\r\n    }\r\n    \r\n    setDropPreview(null);\r\n    setDraggedItem(null);\r\n    setDraggedTimelineItem(null);\r\n    setIsDragging(false);\r\n    setIsTimelineDragging(false);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    if (!timelineRef.current?.contains(e.relatedTarget)) {\r\n      setDropPreview(null);\r\n      stopAutoScroll();\r\n    }\r\n  };\r\n\r\n  const getTimelineItemStyle = (item) => {\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    \r\n    return {\r\n      left: `${item.startTime * pixelsPerSecond}px`,\r\n      width: `${item.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getDropPreviewStyle = () => {\r\n    if (!dropPreview) return {};\r\n    \r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    \r\n    return {\r\n      left: `${dropPreview.time * pixelsPerSecond}px`,\r\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getTrackColor = (trackType) => {\r\n    switch (trackType) {\r\n      case 'overlay': return 'bg-purple-500 border-purple-400';\r\n      case 'main': return 'bg-blue-500 border-blue-400';\r\n      case 'audio': return 'bg-green-500 border-green-400';\r\n      default: return 'bg-gray-500 border-gray-400';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex h-screen w-full gap-4 p-4 bg-gray-100 overflow-hidden\">\r\n      {/* Media Library */}\r\n      <div className=\"w-80 min-w-72 max-w-80 bg-white border-2 border-blue-200 flex flex-col rounded-2xl shadow-lg overflow-hidden flex-shrink-0\">\r\n        <div className=\"bg-blue-50 px-4 py-3 border-b border-blue-100\">\r\n          <h3 className=\"font-bold text-blue-800 flex items-center\">\r\n            <Upload size={18} className=\"mr-2\" />\r\n            Media Library\r\n            {!isStorageReady && (\r\n              <Loader size={16} className=\"ml-2 animate-spin text-orange-500\" />\r\n            )}\r\n          </h3>\r\n          \r\n          {/* Storage Info */}\r\n          {storageInfo && (\r\n            <div className=\"text-xs text-blue-600 mt-1 flex items-center justify-between\">\r\n              <span>\r\n                {storageInfo.usage.totalSizeMB}MB used • {storageInfo.mode}\r\n              </span>\r\n              {storageInfo.mode === 'fallback' && (\r\n                <span className=\"text-orange-600 font-medium\">Fallback Mode</span>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Storage Error */}\r\n        {storageError && (\r\n          <div className=\"p-3 bg-red-50 border-b border-red-200 flex items-center\">\r\n            <AlertCircle size={16} className=\"text-red-500 mr-2 flex-shrink-0\" />\r\n            <span className=\"text-sm text-red-700\">{storageError}</span>\r\n            <button\r\n              onClick={() => setStorageError(null)}\r\n              className=\"ml-auto text-red-500 hover:text-red-700\"\r\n            >\r\n              <X size={14} />\r\n            </button>\r\n          </div>\r\n        )}\r\n        \r\n        <div className=\"p-4 pb-0\">\r\n          <div className=\"flex bg-gray-100 rounded-xl p-1\">\r\n            {[\r\n              { id: \"videos\", name: \"Videos\", icon: Video },\r\n              { id: \"audios\", name: \"Audio\", icon: Music },\r\n              { id: \"images\", name: \"Images\", icon: Image },\r\n            ].map((tab) => {\r\n              const IconComponent = tab.icon;\r\n              const count = mediaLibrary[tab.id]?.length || 0;\r\n              const limit = storageInfo?.limits?.[tab.id] || 0;\r\n              \r\n              return (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id)}\r\n                  className={`flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${\r\n                    activeTab === tab.id\r\n                      ? \"bg-white text-blue-600 shadow-sm\"\r\n                      : \"text-gray-600 hover:text-gray-800\"\r\n                  }`}\r\n                >\r\n                  <IconComponent size={16} className=\"mr-2 inline\" />\r\n                  {tab.name}\r\n                  {storageInfo && (\r\n                    <span className={`ml-1 text-xs ${count >= limit ? 'text-red-500' : 'text-gray-400'}`}>\r\n                      ({count}/{limit})\r\n                    </span>\r\n                  )}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4\">\r\n          <button\r\n            onClick={() => {\r\n              if (!isStorageReady) return;\r\n              if (activeTab === \"videos\") fileInputRef.current?.click();\r\n              else if (activeTab === \"audios\") audioInputRef.current?.click();\r\n              else imageInputRef.current?.click();\r\n            }}\r\n            disabled={!isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])}\r\n            className={`w-full p-6 border-2 border-dashed rounded-2xl transition-all duration-200 text-center group ${\r\n              !isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])\r\n                ? \"border-gray-200 bg-gray-50 cursor-not-allowed\"\r\n                : \"border-gray-300 hover:border-blue-400 hover:bg-blue-50/50\"\r\n            }`}\r\n          >\r\n            <div className={`w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-3 transition-colors ${\r\n              !isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])\r\n                ? \"bg-gray-100\"\r\n                : \"bg-gray-100 group-hover:bg-blue-100\"\r\n            }`}>\r\n              {uploadingFiles.size > 0 ? (\r\n                <Loader size={20} className=\"text-blue-500 animate-spin\" />\r\n              ) : (\r\n                <Upload\r\n                  size={20}\r\n                  className={`${\r\n                    !isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])\r\n                      ? \"text-gray-400\"\r\n                      : \"text-gray-500 group-hover:text-blue-500\"\r\n                  }`}\r\n                />\r\n              )}\r\n            </div>\r\n            <span className={`text-sm font-medium ${\r\n              !isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])\r\n                ? \"text-gray-400\"\r\n                : \"text-gray-700 group-hover:text-blue-600\"\r\n            }`}>\r\n              {!isStorageReady ? \"Initializing...\" : \r\n               uploadingFiles.size > 0 ? \"Uploading...\" :\r\n               storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab] ? \"Storage Full\" :\r\n               `Upload ${activeTab === \"videos\" ? \"Video\" : activeTab === \"audios\" ? \"Audio\" : \"Images\"}`}\r\n            </span>\r\n            <p className={`text-xs mt-1 ${\r\n              !isStorageReady || (storageInfo && mediaLibrary[activeTab]?.length >= storageInfo.limits[activeTab])\r\n                ? \"text-gray-400\"\r\n                : \"text-gray-500\"\r\n            }`}>\r\n              {activeTab === \"videos\"\r\n                ? \"MP4, AVI, MOV up to 100MB\"\r\n                : activeTab === \"audios\"\r\n                ? \"MP3, WAV, M4A up to 100MB\"\r\n                : \"JPG, PNG, GIF up to 10MB\"}\r\n            </p>\r\n          </button>\r\n        </div>\r\n\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\"video/*\"\r\n          multiple\r\n          onChange={handleVideoUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={audioInputRef}\r\n          type=\"file\"\r\n          accept=\"audio/*\"\r\n          multiple\r\n          onChange={handleAudioUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={imageInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          multiple\r\n          onChange={handleImageUpload}\r\n          className=\"hidden\"\r\n        />\r\n\r\n        <div className=\"flex-1 overflow-y-auto px-4 pb-4\">\r\n          <div className=\"space-y-2\">\r\n            {mediaLibrary[activeTab]?.map((item) => (\r\n              <div\r\n                key={item.id}\r\n                draggable=\"true\"\r\n                onDragStart={(e) => handleDragStart(e, item)}\r\n                onDragEnd={handleDragEnd}\r\n                className={`flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${\r\n                  draggedItem?.id === item.id ? \"opacity-50\" : \"\"\r\n                }`}\r\n                onClick={() => addToTimeline(item)}\r\n              >\r\n                <div className=\"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\">\r\n                  {activeTab === \"videos\" && (\r\n                    <Video size={20} className=\"text-blue-500\" />\r\n                  )}\r\n                  {activeTab === \"audios\" && (\r\n                    <Music size={20} className=\"text-green-500\" />\r\n                  )}\r\n                  {activeTab === \"images\" && (\r\n                    <Image size={20} className=\"text-purple-500\" />\r\n                  )}\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <p className=\"text-sm font-medium text-gray-900 truncate\">\r\n                    {item.name}\r\n                  </p>\r\n                  <div className=\"flex items-center justify-between text-xs text-gray-500\">\r\n                    <span>\r\n                      {activeTab === \"images\"\r\n                        ? item.width && item.height \r\n                          ? `${item.width}×${item.height}px`\r\n                          : \"Image\"\r\n                        : formatTime(item.duration || 0)}\r\n                    </span>\r\n                    {item.size && (\r\n                      <span>{formatFileSize(item.size)}</span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    removeFromLibrary(item.id, activeTab);\r\n                  }}\r\n                  className=\"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\"\r\n                >\r\n                  <Trash2 size={14} />\r\n                </button>\r\n              </div>\r\n            )) || []}\r\n            \r\n            {mediaLibrary[activeTab]?.length === 0 && isStorageReady && (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3\">\r\n                  {activeTab === \"videos\" && <Video size={24} className=\"text-gray-400\" />}\r\n                  {activeTab === \"audios\" && <Music size={24} className=\"text-gray-400\" />}\r\n                  {activeTab === \"images\" && <Image size={24} className=\"text-gray-400\" />}\r\n                </div>\r\n                <p className=\"text-sm text-gray-500\">No {activeTab} uploaded yet</p>\r\n                <p className=\"text-xs text-gray-400 mt-1\">Click upload button above</p>\r\n              </div>\r\n            )}\r\n            \r\n            {!isStorageReady && (\r\n              <div className=\"text-center py-8\">\r\n                <Loader size={32} className=\"text-blue-500 animate-spin mx-auto mb-3\" />\r\n                <p className=\"text-sm text-gray-500\">Initializing storage...</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Storage Debug Controls (можно убрать в продакшене) */}\r\n        {process.env.NODE_ENV === 'development' && storageInfo && (\r\n          <div className=\"p-4 border-t border-gray-200 bg-gray-50\">\r\n            <div className=\"text-xs text-gray-600 space-y-1\">\r\n              <div>Mode: {storageInfo.mode}</div>\r\n              <div>Total: {storageInfo.usage.totalSizeMB}MB</div>\r\n              <button\r\n                onClick={clearStorage}\r\n                className=\"text-red-600 hover:text-red-800 underline\"\r\n              >\r\n                Clear Storage (Debug)\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col gap-4 min-w-0 overflow-hidden\">\r\n        {/* Video Preview */}\r\n        <div \r\n          ref={videoContainerRef}\r\n          className=\"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm min-h-0\" \r\n          title=\"Video Preview - Click overlays to select, drag to move, Ctrl+scroll to resize, use opacity slider\"\r\n        >\r\n          {currentVideoSource ? (\r\n            <div \r\n              className=\"relative w-full h-full\"\r\n              onClick={(e) => {\r\n                // Снимаем выделение overlay при клике на пустое место\r\n                if (e.target === e.currentTarget) {\r\n                  setSelectedOverlay(null);\r\n                }\r\n              }}\r\n            >\r\n              {getCurrentTimelineContent().mainVideo ? (\r\n                <video\r\n                  ref={videoRef}\r\n                  src={currentVideoSource}\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                  muted={isMuted}\r\n                />\r\n              ) : (\r\n                <img\r\n                  src={currentVideoSource}\r\n                  alt=\"Timeline content\"\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                />\r\n              )}\r\n              \r\n              {getCurrentTimelineContent().overlays.map((item, index) => {\r\n                const transform = getOverlayTransform(item.id);\r\n                const isSelected = selectedOverlay?.id === item.id;\r\n                const isDraggingThis = isDraggingOverlay && isSelected;\r\n                const isResizingThis = isResizingOverlay && isSelected;\r\n                \r\n                return (\r\n                  <div\r\n                    key={item.id}\r\n                    className={`absolute select-none ${\r\n                      isSelected ? 'ring-2 ring-blue-400 ring-opacity-75 shadow-xl' : 'hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50'\r\n                    } ${isDraggingThis ? 'cursor-grabbing z-50' : isResizingThis ? 'cursor-nw-resize' : 'cursor-grab hover:shadow-lg'}`}\r\n                    style={{ \r\n                      left: `${200 + transform.x}px`,\r\n                      top: `${50 + index * 120 + transform.y}px`,\r\n                      width: `${128 * transform.scale}px`,\r\n                      height: `${96 * transform.scale}px`,\r\n                      opacity: transform.opacity,\r\n                      zIndex: isSelected ? 1000 : 10 + index,\r\n                      transform: isDraggingThis ? 'scale(1.02)' : 'scale(1)',\r\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'transform 0.2s ease, box-shadow 0.2s ease',\r\n                    }}\r\n                    onMouseDown={(e) => handleOverlayMouseDown(e, {...item, index})}\r\n                    onWheel={(e) => handleOverlayWheel(e, item.id)}\r\n                  >\r\n                    <div className={`relative w-full h-full border-2 rounded-lg overflow-hidden shadow-lg group ${\r\n                      isSelected ? 'border-blue-400' : 'border-white hover:border-blue-300'\r\n                    }`}\r\n                    style={{\r\n                      transition: isDraggingThis || isResizingThis ? 'none' : 'border-color 0.2s ease',\r\n                    }}>\r\n                      {item.type === 'video' ? (\r\n                        <video\r\n                          src={item.url}\r\n                          className=\"w-full h-full object-cover pointer-events-none\"\r\n                          muted\r\n                        />\r\n                      ) : (\r\n                        <img\r\n                          src={item.url}\r\n                          alt={item.name}\r\n                          className=\"w-full h-full object-cover pointer-events-none\"\r\n                          draggable={false}\r\n                        />\r\n                      )}\r\n                      \r\n                      {/* Overlay hover effect */}\r\n                      <div className={`absolute inset-0 bg-blue-500 bg-opacity-0 hover:bg-opacity-10 ${\r\n                        isSelected ? 'bg-opacity-10' : ''\r\n                      }`}\r\n                      style={{\r\n                        transition: isDraggingThis || isResizingThis ? 'none' : 'background-color 0.2s ease',\r\n                      }}></div>\r\n                      \r\n                      {isSelected && (\r\n                        <>\r\n                          {/* Resize handles - с визуальной обратной связью */}\r\n                          <div \r\n                            className={`resize-handle absolute -top-2 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-nw-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${\r\n                              isResizingThis && resizeOverlayHandle === 'nw' ? 'scale-150 bg-red-500' : ''\r\n                            }`}\r\n                            onMouseDown={(e) => handleOverlayResizeStart(e, item, 'nw')}\r\n                            style={{\r\n                              transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease',\r\n                            }}\r\n                          ></div>\r\n                          <div \r\n                            className={`resize-handle absolute -top-2 -right-2 w-4 h-4 bg-blue-500 rounded-full cursor-ne-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${\r\n                              isResizingThis && resizeOverlayHandle === 'ne' ? 'scale-150 bg-red-500' : ''\r\n                            }`}\r\n                            onMouseDown={(e) => handleOverlayResizeStart(e, item, 'ne')}\r\n                            style={{\r\n                              transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease',\r\n                            }}\r\n                          ></div>\r\n                          <div \r\n                            className={`resize-handle absolute -bottom-2 -left-2 w-4 h-4 bg-blue-500 rounded-full cursor-sw-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${\r\n                              isResizingThis && resizeOverlayHandle === 'sw' ? 'scale-150 bg-red-500' : ''\r\n                            }`}\r\n                            onMouseDown={(e) => handleOverlayResizeStart(e, item, 'sw')}\r\n                            style={{\r\n                              transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease',\r\n                            }}\r\n                          ></div>\r\n                          <div \r\n                            className={`resize-handle absolute -bottom-2 -right-2 w-4 h-4 bg-blue-500 rounded-full cursor-se-resize opacity-90 hover:opacity-100 hover:scale-125 shadow-md border-2 border-white ${\r\n                              isResizingThis && resizeOverlayHandle === 'se' ? 'scale-150 bg-red-500' : ''\r\n                            }`}\r\n                            onMouseDown={(e) => handleOverlayResizeStart(e, item, 'se')}\r\n                            style={{\r\n                              transition: isDraggingThis || isResizingThis ? 'none' : 'all 0.2s ease',\r\n                            }}\r\n                          ></div>\r\n                          \r\n                          {/* Центральная точка для перетаскивания */}\r\n                          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-blue-500 rounded-full opacity-60 pointer-events-none\"></div>\r\n                          \r\n                          {/* Opacity slider - улучшенный */}\r\n                          <div className=\"absolute -bottom-12 left-0 right-0 bg-black/80 backdrop-blur-sm rounded-lg px-3 py-2 border border-white/20 shadow-lg\">\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <span className=\"text-white text-xs font-medium min-w-fit\">Opacity:</span>\r\n                              <input\r\n                                type=\"range\"\r\n                                min=\"0.1\"\r\n                                max=\"1\"\r\n                                step=\"0.05\"\r\n                                value={transform.opacity}\r\n                                onChange={(e) => updateOverlayTransform(item.id, { opacity: parseFloat(e.target.value) })}\r\n                                className=\"flex-1 h-2 accent-blue-500 cursor-pointer\"\r\n                                onMouseDown={(e) => e.stopPropagation()}\r\n                              />\r\n                              <span className=\"text-white text-xs min-w-8 text-right font-mono\">\r\n                                {Math.round(transform.opacity * 100)}%\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        </>\r\n                      )}\r\n                      \r\n                      {/* Layer info - улучшенная */}\r\n                      <div className={`absolute top-1 left-1 bg-black/70 text-white text-xs px-2 py-1 rounded pointer-events-none ${\r\n                        isSelected ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'\r\n                      }`}\r\n                      style={{\r\n                        transition: isDraggingThis || isResizingThis ? 'none' : 'opacity 0.2s ease',\r\n                      }}>\r\n                        {item.name} • {Math.round(transform.scale * 100)}% • {Math.round(transform.opacity * 100)}%\r\n                      </div>\r\n                      \r\n                      {/* Индикатор выделения */}\r\n                      {isSelected && (\r\n                        <div className=\"absolute -top-0.5 -left-0.5 -right-0.5 -bottom-0.5 border-2 border-blue-400 rounded-lg pointer-events-none animate-pulse\"></div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          ) : (\r\n            <div className=\"w-full h-full flex items-center justify-center text-white\">\r\n              <div className=\"text-center\">\r\n                <div className=\"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\">\r\n                  <Film size={40} className=\"opacity-50\" />\r\n                </div>\r\n                <p className=\"text-xl opacity-75 font-medium\">\r\n                  No content at current time\r\n                </p>\r\n                <p className=\"text-sm opacity-50 mb-4\">\r\n                  Drag media to timeline tracks to start editing\r\n                </p>\r\n                <div className=\"text-xs opacity-40 space-y-1\">\r\n                  <p>💡 Overlays are interactive • Ripple mode enabled</p>\r\n                  <p>📁 Files stored in {storageInfo?.mode || 'storage'} mode</p>\r\n                  <p>Press <kbd className=\"px-1 py-0.5 bg-gray-700 rounded text-xs\">?</kbd> for help & shortcuts</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\">\r\n            <div className=\"flex items-center space-x-6\">\r\n              <button\r\n                onClick={() => seekTo(Math.max(0, currentTime - 10))}\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n                title=\"Skip back 10 seconds\"\r\n              >\r\n                <SkipBack size={20} />\r\n              </button>\r\n              <button\r\n                onClick={handlePlayPause}\r\n                className=\"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\"\r\n                title=\"Play/Pause (Space)\"\r\n              >\r\n                {isPlaying ? <Pause size={24} /> : <Play size={24} />}\r\n              </button>\r\n              <button\r\n                onClick={() =>\r\n                  seekTo(Math.min(videoDuration, currentTime + 10))\r\n                }\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n                title=\"Skip forward 10 seconds\"\r\n              >\r\n                <SkipForward size={20} />\r\n              </button>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <button\r\n                  onClick={() => setIsMuted(!isMuted)}\r\n                  className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n                  title=\"Toggle mute\"\r\n                >\r\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\r\n                </button>\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                  value={volume}\r\n                  onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                  className=\"w-24 accent-blue-500\"\r\n                  title=\"Volume control\"\r\n                />\r\n              </div>\r\n              <span className=\"text-white text-sm font-medium min-w-0\" title=\"Current time / Total duration\">\r\n                {formatTime(currentTime)} / {formatTime(videoDuration)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Timeline */}\r\n        <div \r\n          className={`h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${\r\n            isDragging || isTimelineDragging || isResizing\r\n              ? \"border-blue-400 bg-blue-50/20\" \r\n              : \"border-gray-200\"\r\n          }`}\r\n        >\r\n          <div className=\"bg-gray-50 p-4 border-b border-gray-200 space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n                <Film size={18} />\r\n                <span>Timeline Pro</span>\r\n                {storageInfo && (\r\n                  <span className={`text-xs px-2 py-1 rounded-full ${\r\n                    storageInfo.mode === 'indexeddb' \r\n                      ? 'bg-green-100 text-green-700' \r\n                      : 'bg-orange-100 text-orange-700'\r\n                  }`}>\r\n                    {storageInfo.mode === 'indexeddb' ? '💾 IndexedDB' : '🔄 Fallback'}\r\n                  </span>\r\n                )}\r\n                {isDragging && dropPreview && (\r\n                  <span className=\"text-green-600\">\r\n                    - Adding \"{draggedItem?.name}\" {dropPreview.shouldRipple ? '⚡ ripple' : '📍 exact'}\r\n                  </span>\r\n                )}\r\n                {isTimelineDragging && dropPreview && (\r\n                  <span className=\"text-blue-600\">\r\n                    - Moving \"{draggedTimelineItem?.name}\" {dropPreview.shouldRipple ? '⚡ push blocks' : '📍 exact'}\r\n                  </span>\r\n                )}\r\n                {isResizing && resizeItem && (\r\n                  <span className=\"text-orange-600\">\r\n                    - Trimming \"{resizeItem.name}\" ({resizeHandle} edge)\r\n                  </span>\r\n                )}\r\n                {copiedItem && (\r\n                  <span className=\"text-blue-600 text-sm\">\r\n                    - \"{copiedItem.name}\" copied (Ctrl+V to paste)\r\n                  </span>\r\n                )}\r\n              </h4>\r\n              \r\n              <div className=\"flex items-center space-x-3\">\r\n                <button\r\n                  onClick={() => setShowHelp(true)}\r\n                  className=\"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200\"\r\n                  title=\"📖 Help & Shortcuts Guide - Learn all controls and hotkeys (Press ? key)\"\r\n                >\r\n                  <HelpCircle size={18} />\r\n                </button>\r\n                \r\n                <div className=\"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\">\r\n                  <button\r\n                    onClick={zoomOut}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom Out (-)\"\r\n                  >\r\n                    <ZoomOut size={16} />\r\n                  </button>\r\n                  <span className=\"text-xs text-gray-500 min-w-12 text-center\">\r\n                    {(timelineZoom * 100).toFixed(0)}%\r\n                  </span>\r\n                  <button\r\n                    onClick={zoomIn}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom In (+), or Ctrl+Wheel\"\r\n                  >\r\n                    <ZoomIn size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={resetZoom}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Reset Zoom (0)\"\r\n                  >\r\n                    <RotateCcw size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-6\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button\r\n                    onClick={addOverlayTrack}\r\n                    className=\"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Overlay Track\"\r\n                  >\r\n                    <Plus size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={addAudioTrack}\r\n                    className=\"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Audio Track\"\r\n                  >\r\n                    <Music size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={splitTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Split Selected Item (Ctrl+B) - Cuts item at current time\"\r\n                  >\r\n                    <Scissors size={16} />\r\n                  </button>\r\n                  <button \r\n                    onClick={copyTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Copy Selected Item (Ctrl+C) - Copy item to clipboard\"\r\n                  >\r\n                    <Copy size={16} />\r\n                  </button>\r\n                  <button \r\n                    onClick={deleteSelectedItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem \r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" \r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Delete Selected Item (Del/Backspace) - Remove from timeline\"\r\n                  >\r\n                    <Trash2 size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 flex min-h-0\">\r\n            <div className=\"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\">\r\n              <div className=\"h-12 border-b border-gray-200 flex-shrink-0\"></div>\r\n              \r\n              <div \r\n                ref={trackLabelsRef}\r\n                className=\"flex-1 overflow-y-auto overflow-x-hidden\"\r\n                onScroll={handleTrackLabelsScroll}\r\n              >\r\n                {tracks.overlays.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Layers size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n                \r\n                {tracks.main.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Video size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n                \r\n                {tracks.audio.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\"\r\n                    style={{ height: '60px' }}\r\n                  >\r\n                    <Music size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div \r\n              ref={(el) => {\r\n                timelineRef.current = el;\r\n                timelineScrollRef.current = el;\r\n              }}\r\n              className=\"flex-1 relative overflow-auto bg-white\"\r\n              onScroll={handleTrackAreaScroll}\r\n              onDragOver={handleDragOver}\r\n              onDrop={handleDrop}\r\n              onDragLeave={handleDragLeave}\r\n              style={{ \r\n                overflowX: 'auto', \r\n                overflowY: 'auto',\r\n                scrollbarWidth: 'thin'\r\n              }}\r\n            >\r\n              <div \r\n                style={{ \r\n                  width: `${getTimelineWidth()}px`, \r\n                  minHeight: '100%',\r\n                  position: 'relative'\r\n                }}\r\n                onClick={handleTimelineClick}\r\n              >\r\n                <div className=\"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\">\r\n                  {Array.from({ length: Math.ceil(videoDuration * timelineZoom / 5) + 1 }, (_, i) => {\r\n                    const timeValue = i * 5 / timelineZoom;\r\n                    const pixelsPerSecond = getPixelsPerSecond();\r\n                    return (\r\n                      <div\r\n                        key={i}\r\n                        className=\"absolute top-0 h-full border-l border-gray-300\"\r\n                        style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                      >\r\n                        <span className=\"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\">\r\n                          {formatTime(timeValue)}\r\n                        </span>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                  \r\n                  {timelineZoom > 2 && Array.from({ length: Math.ceil(videoDuration * timelineZoom) + 1 }, (_, i) => {\r\n                    const timeValue = i / timelineZoom;\r\n                    const pixelsPerSecond = getPixelsPerSecond();\r\n                    return (\r\n                      <div\r\n                        key={`sub-${i}`}\r\n                        className=\"absolute top-8 w-0 h-4 border-l border-gray-200\"\r\n                        style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                      />\r\n                    );\r\n                  })}\r\n                  \r\n                  <div\r\n                    className=\"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\"\r\n                    style={{\r\n                      left: `${currentTime * getPixelsPerSecond()}px`,\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div \r\n                  className=\"relative flex-1\" \r\n                  style={{ \r\n                    height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\r\n                    minHeight: '100%'\r\n                  }}\r\n                >\r\n                  {timelineItems.map((item) => (\r\n                    <div\r\n                      key={item.id}\r\n                      className={`absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${\r\n                        getTrackColor(item.trackType)\r\n                      } ${\r\n                        selectedTimelineItem?.id === item.id ? \"ring-2 ring-blue-300\" : \"\"\r\n                      } ${\r\n                        draggedTimelineItem?.id === item.id ? \"opacity-50 z-30\" : \"\"\r\n                      } ${\r\n                        copiedItem?.id === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"\r\n                      }`}\r\n                      style={getTimelineItemStyle(item)}\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setSelectedTimelineItem(item);\r\n                      }}\r\n                    >\r\n                      <div\r\n                        className=\"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, 'left')}\r\n                        title=\"Trim start - Drag to adjust start time\"\r\n                        style={{ background: 'linear-gradient(to right, rgba(255,255,255,0.8), transparent)' }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n                      \r\n                      <div\r\n                        draggable=\"true\"\r\n                        onDragStart={(e) => handleTimelineItemDragStart(e, item)}\r\n                        onDragEnd={handleTimelineItemDragEnd}\r\n                        className=\"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\"\r\n                        title=\"Drag to move item on timeline - Ripple mode: pushes other blocks\"\r\n                      >\r\n                        {item.name}\r\n                        {copiedItem?.id === item.id && (\r\n                          <span className=\"ml-2 text-green-200\">📋</span>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div\r\n                        className=\"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, 'right')}\r\n                        title=\"Trim end - Drag to adjust duration\"\r\n                        style={{ background: 'linear-gradient(to left, rgba(255,255,255,0.8), transparent)' }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  \r\n                  {dropPreview && (\r\n                    <div\r\n                      className={`absolute h-10 rounded-lg border-2 transition-all ${\r\n                        dropPreview.isValid \r\n                          ? dropPreview.isExact \r\n                            ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` \r\n                            : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse`\r\n                          : \"bg-red-300 border-red-500 border-dashed\"\r\n                      }`}\r\n                      style={getDropPreviewStyle()}\r\n                    >\r\n                      {dropPreview.isValid && !dropPreview.isExact && (\r\n                        <div className=\"flex items-center justify-center h-full text-white text-xs font-bold\">\r\n                          🧲\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Help Modal */}\r\n      {showHelp && (\r\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\r\n          <div className=\"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto\">\r\n            <div className=\"p-6 border-b border-gray-200 flex items-center justify-between\">\r\n              <h3 className=\"text-xl font-bold text-gray-800 flex items-center\">\r\n                <HelpCircle size={24} className=\"mr-3 text-blue-600\" />\r\n                CapCut Pro - Help & Shortcuts\r\n              </h3>\r\n              <button\r\n                onClick={() => setShowHelp(false)}\r\n                className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all\"\r\n              >\r\n                <X size={20} />\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"p-6 space-y-6\">\r\n              {/* MediaStorage Info */}\r\n              <div>\r\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center\">\r\n                  💾 Smart Storage System\r\n                </h4>\r\n                <div className=\"grid grid-cols-1 gap-3 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Current mode:</span>\r\n                    <span className=\"font-medium\">{storageInfo?.mode || 'Loading...'}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Storage limits:</span>\r\n                    <span className=\"font-medium\">5 videos, 10 images, 5 audios</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Auto cleanup:</span>\r\n                    <span className=\"font-medium\">Files expire after 7 days</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Fallback mode:</span>\r\n                    <span className=\"font-medium\">If IndexedDB unavailable</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Timeline Controls */}\r\n              <div>\r\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center\">\r\n                  <Film size={18} className=\"mr-2 text-blue-600\" />\r\n                  Timeline Controls\r\n                </h4>\r\n                <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Drag center:</span>\r\n                    <span className=\"font-medium\">Move item</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Drag edges:</span>\r\n                    <span className=\"font-medium\">Trim duration</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Auto ripple:</span>\r\n                    <span className=\"font-medium\">Push other blocks</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Ctrl + Wheel:</span>\r\n                    <span className=\"font-medium\">Zoom timeline</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Video Overlays */}\r\n              <div>\r\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center\">\r\n                  <Layers size={18} className=\"mr-2 text-purple-600\" />\r\n                  Video Overlays (CapCut Style)\r\n                </h4>\r\n                <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Click overlay:</span>\r\n                    <span className=\"font-medium\">Select & show controls</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Drag anywhere:</span>\r\n                    <span className=\"font-medium\">Move position</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Drag corner dots:</span>\r\n                    <span className=\"font-medium\">Resize overlay</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Ctrl + Scroll:</span>\r\n                    <span className=\"font-medium\">Smooth zoom</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Opacity slider:</span>\r\n                    <span className=\"font-medium\">0-100% transparency</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Auto bounds:</span>\r\n                    <span className=\"font-medium\">Stays in view area</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Keyboard Shortcuts */}\r\n              <div>\r\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center\">\r\n                  ⌨️ Keyboard Shortcuts\r\n                </h4>\r\n                <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Space</kbd>\r\n                    <span className=\"font-medium\">Play / Pause</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">← →</kbd>\r\n                    <span className=\"font-medium\">Seek (0.1s)</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Shift + ← →</kbd>\r\n                    <span className=\"font-medium\">Seek (1s)</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Ctrl + ← →</kbd>\r\n                    <span className=\"font-medium\">Seek (5s)</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Ctrl + B</kbd>\r\n                    <span className=\"font-medium\">Split item</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Ctrl + C</kbd>\r\n                    <span className=\"font-medium\">Copy item</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Ctrl + V</kbd>\r\n                    <span className=\"font-medium\">Paste item</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">Del</kbd>\r\n                    <span className=\"font-medium\">Delete item</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">+ -</kbd>\r\n                    <span className=\"font-medium\">Zoom in/out</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <kbd className=\"px-2 py-1 bg-gray-100 rounded text-xs font-mono\">0</kbd>\r\n                    <span className=\"font-medium\">Reset zoom</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Tips & Tricks */}\r\n              <div>\r\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center\">\r\n                  💡 Pro Tips\r\n                </h4>\r\n                <ul className=\"space-y-2 text-sm text-gray-600\">\r\n                  <li className=\"flex items-start\">\r\n                    <span className=\"inline-block w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0\"></span>\r\n                    <span>Files are automatically saved to smart storage with 7-day retention</span>\r\n                  </li>\r\n                  <li className=\"flex items-start\">\r\n                    <span className=\"inline-block w-2 h-2 bg-purple-500 rounded-full mt-2 mr-3 flex-shrink-0\"></span>\r\n                    <span>Storage automatically switches to fallback mode if IndexedDB unavailable</span>\r\n                  </li>\r\n                  <li className=\"flex items-start\">\r\n                    <span className=\"inline-block w-2 h-2 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0\"></span>\r\n                    <span>Upload limits prevent storage overflow (5 videos, 10 images, 5 audios)</span>\r\n                  </li>\r\n                  <li className=\"flex items-start\">\r\n                    <span className=\"inline-block w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0\"></span>\r\n                    <span>Ripple mode automatically pushes blocks when inserting new content</span>\r\n                  </li>\r\n                  <li className=\"flex items-start\">\r\n                    <span className=\"inline-block w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0\"></span>\r\n                    <span>Use Ctrl+scroll over overlays for precise size control like in CapCut</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl\">\r\n              <p className=\"text-center text-sm text-gray-500\">\r\n                🎬 Made with CapCut Pro styling • 💾 Smart MediaStorage • Press <kbd className=\"px-1 py-0.5 bg-white rounded text-xs font-mono border\">?</kbd> anytime\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoEditor;"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAChE,SACEC,MAAM,EACNC,IAAI,EACJC,KAAK,EACLC,OAAO,EACPC,KAAK,EACLC,KAAK,EACLC,QAAQ,EACRC,WAAW,EACXC,OAAO,EACPC,IAAI,EACJC,MAAM,EACNC,QAAQ,EACRC,KAAK,EACLC,IAAI,EACJC,IAAI,EACJC,MAAM,EACNC,MAAM,EACNC,OAAO,EACPC,SAAS,EACTC,UAAU,EACVC,CAAC,EACDC,WAAW,EACXC,WAAW,EACXC,MAAM,QACD,cAAc;AACrB;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,oBAAoB,CAAC;EACzBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,MAAM,GAAG,eAAe;IAC7B,IAAI,CAACC,OAAO,GAAG,CAAC;IAChB,IAAI,CAACC,EAAE,GAAG,IAAI;IACd,IAAI,CAACC,YAAY,GAAG,KAAK;IACzB,IAAI,CAACC,aAAa,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC9B,IAAI,CAACC,MAAM,GAAG;MACZC,MAAM,EAAE,CAAC;MACTC,MAAM,EAAE,EAAE;MACVC,MAAM,EAAE,CAAC;MACTC,WAAW,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI;MAAE;MAChCC,aAAa,EAAE;IACjB,CAAC;EACH;EAEAC,oBAAoBA,CAAA,EAAG;IACrB,OAAO,WAAW,IAAIC,MAAM,IAAIC,SAAS,KAAK,IAAI;EACpD;EAEA,MAAMC,IAAIA,CAAA,EAAG;IACX,IAAI,CAAC,IAAI,CAACH,oBAAoB,CAAC,CAAC,EAAE;MAChCI,OAAO,CAACC,IAAI,CAAC,8CAA8C,CAAC;MAC5D,IAAI,CAACd,YAAY,GAAG,IAAI;MACxB,OAAO,IAAI,CAACe,YAAY,CAAC,CAAC;IAC5B;IAEA,IAAI;MACF,OAAO,MAAM,IAAI,CAACC,aAAa,CAAC,CAAC;IACnC,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdJ,OAAO,CAACC,IAAI,CAAC,8DAA8D,EAAEG,KAAK,CAAC;MACnF,IAAI,CAACjB,YAAY,GAAG,IAAI;MACxB,OAAO,IAAI,CAACe,YAAY,CAAC,CAAC;IAC5B;EACF;EAEA,MAAMC,aAAaA,CAAA,EAAG;IACpB,OAAO,IAAIE,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI;QACF,MAAMC,OAAO,GAAGV,SAAS,CAACW,IAAI,CAAC,IAAI,CAACzB,MAAM,EAAE,IAAI,CAACC,OAAO,CAAC;QAEzDuB,OAAO,CAACE,OAAO,GAAG,MAAM;UAAA,IAAAC,cAAA;UACtBX,OAAO,CAACI,KAAK,CAAC,kBAAkB,EAAEI,OAAO,CAACJ,KAAK,CAAC;UAChDG,MAAM,CAAC,IAAIK,KAAK,CAAC,oBAAoB,EAAAD,cAAA,GAAAH,OAAO,CAACJ,KAAK,cAAAO,cAAA,uBAAbA,cAAA,CAAeE,OAAO,KAAI,eAAe,EAAE,CAAC,CAAC;QACpF,CAAC;QAEDL,OAAO,CAACM,SAAS,GAAG,MAAM;UACxB,IAAI,CAAC5B,EAAE,GAAGsB,OAAO,CAACO,MAAM;UACxBf,OAAO,CAACgB,GAAG,CAAC,oCAAoC,CAAC;UACjDV,OAAO,CAAC,IAAI,CAACpB,EAAE,CAAC;QAClB,CAAC;QAEDsB,OAAO,CAACS,eAAe,GAAIC,KAAK,IAAK;UACnC,IAAI;YACF,MAAMhC,EAAE,GAAGgC,KAAK,CAACC,MAAM,CAACJ,MAAM;YAC9B,IAAI,CAAC7B,EAAE,CAACkC,gBAAgB,CAACC,QAAQ,CAAC,OAAO,CAAC,EAAE;cAC1C,MAAMC,SAAS,GAAGpC,EAAE,CAACqC,iBAAiB,CAAC,OAAO,EAAE;gBAAEC,OAAO,EAAE;cAAK,CAAC,CAAC;cAClEF,SAAS,CAACG,WAAW,CAAC,MAAM,EAAE,MAAM,CAAC;cACrCH,SAAS,CAACG,WAAW,CAAC,WAAW,EAAE,WAAW,CAAC;cAC/CzB,OAAO,CAACgB,GAAG,CAAC,yBAAyB,CAAC;YACxC;UACF,CAAC,CAAC,OAAOU,YAAY,EAAE;YACrB1B,OAAO,CAACI,KAAK,CAAC,0BAA0B,EAAEsB,YAAY,CAAC;YACvDnB,MAAM,CAACmB,YAAY,CAAC;UACtB;QACF,CAAC;QAEDlB,OAAO,CAACmB,SAAS,GAAG,MAAM;UACxB3B,OAAO,CAACC,IAAI,CAAC,6CAA6C,CAAC;UAC3DM,MAAM,CAAC,IAAIK,KAAK,CAAC,kCAAkC,CAAC,CAAC;QACvD,CAAC;MAEH,CAAC,CAAC,OAAOR,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;QACvDG,MAAM,CAACH,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ;EAEA,MAAMF,YAAYA,CAAA,EAAG;IACnBF,OAAO,CAACgB,GAAG,CAAC,oCAAoC,CAAC;IACjD,IAAI,CAAC7B,YAAY,GAAG,IAAI;IAExB,IAAI;MACF,MAAMyC,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;MACpD,IAAIF,SAAS,EAAE;QACb,MAAMG,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC;QACxC,KAAK,MAAM,CAACM,GAAG,EAAEC,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACN,UAAU,CAAC,EAAE;UACrD;UACA,IAAII,KAAK,CAACG,UAAU,EAAE;YACpB,IAAI;cACF,MAAMC,IAAI,GAAG,IAAI,CAACC,YAAY,CAACL,KAAK,CAACG,UAAU,EAAEH,KAAK,CAACM,QAAQ,CAAC;cAChEN,KAAK,CAACI,IAAI,GAAGA,IAAI;cACjBJ,KAAK,CAACO,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;YACvC,CAAC,CAAC,OAAOM,CAAC,EAAE;cACV7C,OAAO,CAACC,IAAI,CAAC,qCAAqC,EAAE4C,CAAC,CAAC;cACtD;YACF;UACF;UACA,IAAI,CAACzD,aAAa,CAAC0D,GAAG,CAACZ,GAAG,EAAEC,KAAK,CAAC;QACpC;MACF;IACF,CAAC,CAAC,OAAO/B,KAAK,EAAE;MACdJ,OAAO,CAACC,IAAI,CAAC,mCAAmC,EAAEG,KAAK,CAAC;IAC1D;IAEA,OAAO,IAAI;EACb;;EAEA;EACA,MAAM2C,YAAYA,CAACR,IAAI,EAAE;IACvB,OAAO,IAAIlC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,MAAMyC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,MAAM,GAAG,MAAM5C,OAAO,CAAC0C,MAAM,CAACjC,MAAM,CAACoC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;MAC1DH,MAAM,CAACtC,OAAO,GAAGH,MAAM;MACvByC,MAAM,CAACI,aAAa,CAACb,IAAI,CAAC;IAC5B,CAAC,CAAC;EACJ;;EAEA;EACAC,YAAYA,CAACa,MAAM,EAAEC,QAAQ,EAAE;IAC7B,MAAMC,cAAc,GAAGC,IAAI,CAACH,MAAM,CAAC;IACnC,MAAMI,WAAW,GAAG,IAAIC,KAAK,CAACH,cAAc,CAACI,MAAM,CAAC;IACpD,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,cAAc,CAACI,MAAM,EAAEC,CAAC,EAAE,EAAE;MAC9CH,WAAW,CAACG,CAAC,CAAC,GAAGL,cAAc,CAACM,UAAU,CAACD,CAAC,CAAC;IAC/C;IACA,MAAME,SAAS,GAAG,IAAIC,UAAU,CAACN,WAAW,CAAC;IAC7C,OAAO,IAAIO,IAAI,CAAC,CAACF,SAAS,CAAC,EAAE;MAAEG,IAAI,EAAEX;IAAS,CAAC,CAAC;EAClD;EAEA,MAAMY,QAAQA,CAACC,IAAI,EAAEF,IAAI,EAAE;IACzB,IAAIE,IAAI,CAACC,IAAI,GAAG,IAAI,CAAC9E,MAAM,CAACI,WAAW,EAAE;MACvC,MAAM,IAAIkB,KAAK,CAAC,6BAA6B,IAAI,CAACtB,MAAM,CAACI,WAAW,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;IAC3F;IAEA,MAAM2E,YAAY,GAAG,MAAM,IAAI,CAACC,cAAc,CAACL,IAAI,CAAC;IACpD,IAAII,YAAY,CAACV,MAAM,IAAI,IAAI,CAACrE,MAAM,CAAC2E,IAAI,CAAC,EAAE;MAC5C,MAAM,IAAIrD,KAAK,CAAC,8BAA8B,IAAI,CAACtB,MAAM,CAAC2E,IAAI,CAAC,IAAIA,IAAI,WAAW,CAAC;IACrF;IAEA,MAAMM,QAAQ,GAAG;MACfC,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC9BC,IAAI,EAAEV,IAAI,CAACU,IAAI;MACfZ,IAAI,EAAEA,IAAI;MACVG,IAAI,EAAED,IAAI,CAACC,IAAI;MACf3B,QAAQ,EAAE0B,IAAI,CAACF,IAAI;MACnB1B,IAAI,EAAE4B,IAAI;MACVzB,GAAG,EAAEC,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC;MAC9BW,SAAS,EAAE,IAAIL,IAAI,CAAC,CAAC,CAACM,WAAW,CAAC,CAAC;MACnCC,SAAS,EAAE,IAAIP,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI,CAACpF,MAAM,CAACK,aAAa,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAACoF,WAAW,CAAC;IAChG,CAAC;;IAED;IACA,IAAI;MACF,IAAId,IAAI,KAAK,QAAQ,EAAE;QACrBM,QAAQ,CAACU,QAAQ,GAAG,MAAM,IAAI,CAACC,gBAAgB,CAACf,IAAI,CAAC;MACvD,CAAC,MAAM,IAAIF,IAAI,KAAK,QAAQ,EAAE;QAC5B,MAAMkB,UAAU,GAAG,MAAM,IAAI,CAACC,kBAAkB,CAACjB,IAAI,CAAC;QACtDI,QAAQ,CAACc,KAAK,GAAGF,UAAU,CAACE,KAAK;QACjCd,QAAQ,CAACe,MAAM,GAAGH,UAAU,CAACG,MAAM;MACrC,CAAC,MAAM,IAAIrB,IAAI,KAAK,QAAQ,EAAE;QAC5BM,QAAQ,CAACU,QAAQ,GAAG,MAAM,IAAI,CAACM,gBAAgB,CAACpB,IAAI,CAAC;MACvD;IACF,CAAC,CAAC,OAAOqB,SAAS,EAAE;MAClBxF,OAAO,CAACC,IAAI,CAAC,8BAA8B,EAAEuF,SAAS,CAAC;IACzD;IAEA,IAAI,IAAI,CAACrG,YAAY,EAAE;MACrB,OAAO,IAAI,CAACsG,cAAc,CAAClB,QAAQ,CAAC;IACtC,CAAC,MAAM;MACL,OAAO,IAAI,CAACmB,eAAe,CAACnB,QAAQ,CAAC;IACvC;EACF;EAEA,MAAMmB,eAAeA,CAACnB,QAAQ,EAAE;IAC9B,OAAO,IAAIlE,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI;QACF,MAAMoF,WAAW,GAAG,IAAI,CAACzG,EAAE,CAACyG,WAAW,CAAC,CAAC,OAAO,CAAC,EAAE,WAAW,CAAC;QAC/D,MAAMC,KAAK,GAAGD,WAAW,CAACE,WAAW,CAAC,OAAO,CAAC;QAC9C,MAAMrF,OAAO,GAAGoF,KAAK,CAACE,GAAG,CAACvB,QAAQ,CAAC;QAEnC/D,OAAO,CAACM,SAAS,GAAG,MAAM;UACxB,IAAI,CAACiF,iBAAiB,CAAC,CAAC;UACxBzF,OAAO,CAACiE,QAAQ,CAAC;QACnB,CAAC;QAED/D,OAAO,CAACE,OAAO,GAAG,MAAM;UAAA,IAAAsF,eAAA;UACtBhG,OAAO,CAACI,KAAK,CAAC,uBAAuB,EAAEI,OAAO,CAACJ,KAAK,CAAC;UACrDG,MAAM,CAAC,IAAIK,KAAK,CAAC,gCAAgC,EAAAoF,eAAA,GAAAxF,OAAO,CAACJ,KAAK,cAAA4F,eAAA,uBAAbA,eAAA,CAAenF,OAAO,KAAI,eAAe,EAAE,CAAC,CAAC;QAChG,CAAC;MACH,CAAC,CAAC,OAAOT,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpDG,MAAM,CAACH,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ;EAEA,MAAMqF,cAAcA,CAAClB,QAAQ,EAAE;IAC7B,IAAI;MACF;MACA,MAAMjC,UAAU,GAAG,MAAM,IAAI,CAACS,YAAY,CAACwB,QAAQ,CAAChC,IAAI,CAAC;MACzD,MAAM0D,WAAW,GAAG;QAAE,GAAG1B;MAAS,CAAC;MACnC0B,WAAW,CAAC3D,UAAU,GAAGA,UAAU;MACnC,OAAO2D,WAAW,CAAC1D,IAAI,CAAC,CAAC;;MAEzB,IAAI,CAACnD,aAAa,CAAC0D,GAAG,CAACyB,QAAQ,CAACC,EAAE,CAAC0B,QAAQ,CAAC,CAAC,EAAE3B,QAAQ,CAAC;;MAExD;MACA,IAAI;QACF,MAAM4B,OAAO,GAAG,CAAC,CAAC;QAClB,KAAK,MAAM,CAACjE,GAAG,EAAEC,KAAK,CAAC,IAAI,IAAI,CAAC/C,aAAa,CAACiD,OAAO,CAAC,CAAC,EAAE;UACvD,MAAMgB,MAAM,GAAG,MAAM,IAAI,CAACN,YAAY,CAACZ,KAAK,CAACI,IAAI,CAAC;UAClD4D,OAAO,CAACjE,GAAG,CAAC,GAAG;YACb,GAAGC,KAAK;YACRG,UAAU,EAAEe,MAAM;YAClBd,IAAI,EAAE6D,SAAS;YACf1D,GAAG,EAAE0D,SAAS,CAAC;UACjB,CAAC;QACH;QACAvE,YAAY,CAACwE,OAAO,CAAC,YAAY,EAAErE,IAAI,CAACsE,SAAS,CAACH,OAAO,CAAC,CAAC;MAC7D,CAAC,CAAC,OAAOI,OAAO,EAAE;QAChBvG,OAAO,CAACC,IAAI,CAAC,iCAAiC,EAAEsG,OAAO,CAAC;MAC1D;MAEA,IAAI,CAACR,iBAAiB,CAAC,CAAC;MACxB,OAAOxB,QAAQ;IACjB,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,MAAMA,KAAK;IACb;EACF;EAEA,MAAMkE,cAAcA,CAACL,IAAI,EAAE;IACzB,IAAI,IAAI,CAAC9E,YAAY,EAAE;MACrB,OAAO,IAAI,CAACqH,eAAe,CAACvC,IAAI,CAAC;IACnC,CAAC,MAAM;MACL,OAAO,IAAI,CAACwC,gBAAgB,CAACxC,IAAI,CAAC;IACpC;EACF;EAEA,MAAMwC,gBAAgBA,CAACxC,IAAI,EAAE;IAC3B,OAAO,IAAI5D,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI;QACF,MAAMoF,WAAW,GAAG,IAAI,CAACzG,EAAE,CAACyG,WAAW,CAAC,CAAC,OAAO,CAAC,EAAE,UAAU,CAAC;QAC9D,MAAMC,KAAK,GAAGD,WAAW,CAACE,WAAW,CAAC,OAAO,CAAC;QAC9C,MAAMa,KAAK,GAAGd,KAAK,CAACc,KAAK,CAAC,MAAM,CAAC;QACjC,MAAMlG,OAAO,GAAGkG,KAAK,CAACC,MAAM,CAAC1C,IAAI,CAAC;QAElCzD,OAAO,CAACM,SAAS,GAAG,MAAM;UACxB,MAAM4D,GAAG,GAAG,IAAID,IAAI,CAAC,CAAC;UACtB,MAAMmC,UAAU,GAAGpG,OAAO,CAACO,MAAM,CAAC8F,MAAM,CAAC1C,IAAI,IAAI;YAC/C,OAAO,IAAIM,IAAI,CAACN,IAAI,CAACa,SAAS,CAAC,GAAGN,GAAG;UACvC,CAAC,CAAC,CAACoC,GAAG,CAAC3C,IAAI,IAAI;YACb;YACA,IAAI,CAACA,IAAI,CAACzB,GAAG,IAAIyB,IAAI,CAAC5B,IAAI,EAAE;cAC1B4B,IAAI,CAACzB,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC5B,IAAI,CAAC;YAC3C;YACA,OAAO4B,IAAI;UACb,CAAC,CAAC;UACF7D,OAAO,CAACsG,UAAU,CAAC;QACrB,CAAC;QAEDpG,OAAO,CAACE,OAAO,GAAG,MAAM;UAAA,IAAAqG,eAAA;UACtB/G,OAAO,CAACI,KAAK,CAAC,sBAAsB,EAAEI,OAAO,CAACJ,KAAK,CAAC;UACpDG,MAAM,CAAC,IAAIK,KAAK,CAAC,iCAAiC,EAAAmG,eAAA,GAAAvG,OAAO,CAACJ,KAAK,cAAA2G,eAAA,uBAAbA,eAAA,CAAelG,OAAO,KAAI,eAAe,EAAE,CAAC,CAAC;QACjG,CAAC;MACH,CAAC,CAAC,OAAOT,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;QACxDG,MAAM,CAACH,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ;EAEA,MAAMoG,eAAeA,CAACvC,IAAI,EAAE;IAC1B,MAAMS,GAAG,GAAG,IAAID,IAAI,CAAC,CAAC;IACtB,MAAMuC,KAAK,GAAG,EAAE;IAEhB,KAAK,MAAM,CAAC9E,GAAG,EAAEiC,IAAI,CAAC,IAAI,IAAI,CAAC/E,aAAa,CAACiD,OAAO,CAAC,CAAC,EAAE;MACtD,IAAI8B,IAAI,CAACF,IAAI,KAAKA,IAAI,IAAI,IAAIQ,IAAI,CAACN,IAAI,CAACa,SAAS,CAAC,GAAGN,GAAG,EAAE;QACxD;QACA,IAAI,CAACP,IAAI,CAACzB,GAAG,IAAIyB,IAAI,CAAC5B,IAAI,EAAE;UAC1B4B,IAAI,CAACzB,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC5B,IAAI,CAAC;QAC3C;QACAyE,KAAK,CAACC,IAAI,CAAC9C,IAAI,CAAC;MAClB;IACF;IAEA,OAAO6C,KAAK;EACd;EAEA,MAAME,WAAWA,CAAA,EAAG;IAClB,IAAI;MACF,MAAM3H,MAAM,GAAG,MAAM,IAAI,CAAC+E,cAAc,CAAC,QAAQ,CAAC;MAClD,MAAM9E,MAAM,GAAG,MAAM,IAAI,CAAC8E,cAAc,CAAC,QAAQ,CAAC;MAClD,MAAM7E,MAAM,GAAG,MAAM,IAAI,CAAC6E,cAAc,CAAC,QAAQ,CAAC;MAElD,OAAO;QAAE/E,MAAM;QAAEC,MAAM;QAAEC;MAAO,CAAC;IACnC,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,OAAO;QAAEb,MAAM,EAAE,EAAE;QAAEC,MAAM,EAAE,EAAE;QAAEC,MAAM,EAAE;MAAG,CAAC;IAC/C;EACF;EAEA,MAAM0H,UAAUA,CAAC3C,EAAE,EAAE;IACnB,IAAI,IAAI,CAACrF,YAAY,EAAE;MACrB,OAAO,IAAI,CAACiI,kBAAkB,CAAC5C,EAAE,CAAC;IACpC,CAAC,MAAM;MACL,OAAO,IAAI,CAAC6C,mBAAmB,CAAC7C,EAAE,CAAC;IACrC;EACF;EAEA,MAAM6C,mBAAmBA,CAAC7C,EAAE,EAAE;IAC5B,OAAO,IAAInE,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI;QACF,MAAMoF,WAAW,GAAG,IAAI,CAACzG,EAAE,CAACyG,WAAW,CAAC,CAAC,OAAO,CAAC,EAAE,WAAW,CAAC;QAC/D,MAAMC,KAAK,GAAGD,WAAW,CAACE,WAAW,CAAC,OAAO,CAAC;QAC9C,MAAMrF,OAAO,GAAGoF,KAAK,CAAC0B,MAAM,CAAC9C,EAAE,CAAC;QAEhChE,OAAO,CAACM,SAAS,GAAG,MAAM;UACxB,IAAI,CAACiF,iBAAiB,CAAC,CAAC;UACxBzF,OAAO,CAAC,CAAC;QACX,CAAC;QAEDE,OAAO,CAACE,OAAO,GAAG,MAAM;UAAA,IAAA6G,eAAA;UACtBvH,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEI,OAAO,CAACJ,KAAK,CAAC;UACvDG,MAAM,CAAC,IAAIK,KAAK,CAAC,oCAAoC,EAAA2G,eAAA,GAAA/G,OAAO,CAACJ,KAAK,cAAAmH,eAAA,uBAAbA,eAAA,CAAe1G,OAAO,KAAI,eAAe,EAAE,CAAC,CAAC;QACpG,CAAC;MACH,CAAC,CAAC,OAAOT,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;QAC3DG,MAAM,CAACH,KAAK,CAAC;MACf;IACF,CAAC,CAAC;EACJ;EAEA,MAAMgH,kBAAkBA,CAAC5C,EAAE,EAAE;IAC3B,IAAI;MACF,MAAML,IAAI,GAAG,IAAI,CAAC/E,aAAa,CAACoI,GAAG,CAAChD,EAAE,CAAC0B,QAAQ,CAAC,CAAC,CAAC;MAClD,IAAI/B,IAAI,IAAIA,IAAI,CAACzB,GAAG,EAAE;QACpBC,GAAG,CAAC8E,eAAe,CAACtD,IAAI,CAACzB,GAAG,CAAC;MAC/B;MAEA,IAAI,CAACtD,aAAa,CAACkI,MAAM,CAAC9C,EAAE,CAAC0B,QAAQ,CAAC,CAAC,CAAC;;MAExC;MACA,IAAI;QACF,MAAMC,OAAO,GAAG,CAAC,CAAC;QAClB,KAAK,MAAM,CAACjE,GAAG,EAAEC,KAAK,CAAC,IAAI,IAAI,CAAC/C,aAAa,CAACiD,OAAO,CAAC,CAAC,EAAE;UACvD,MAAMgB,MAAM,GAAG,MAAM,IAAI,CAACN,YAAY,CAACZ,KAAK,CAACI,IAAI,CAAC;UAClD4D,OAAO,CAACjE,GAAG,CAAC,GAAG;YACb,GAAGC,KAAK;YACRG,UAAU,EAAEe,MAAM;YAClBd,IAAI,EAAE6D,SAAS;YACf1D,GAAG,EAAE0D;UACP,CAAC;QACH;QACAvE,YAAY,CAACwE,OAAO,CAAC,YAAY,EAAErE,IAAI,CAACsE,SAAS,CAACH,OAAO,CAAC,CAAC;MAC7D,CAAC,CAAC,OAAOI,OAAO,EAAE;QAChBvG,OAAO,CAACC,IAAI,CAAC,6CAA6C,EAAEsG,OAAO,CAAC;MACtE;MAEA,IAAI,CAACR,iBAAiB,CAAC,CAAC;MACxB,OAAO,IAAI;IACb,CAAC,CAAC,OAAO3F,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9C,MAAMA,KAAK;IACb;EACF;EAEA,MAAMsH,SAASA,CAACzD,IAAI,EAAE;IACpB,IAAI;MACF,MAAM+C,KAAK,GAAG,MAAM,IAAI,CAAC1C,cAAc,CAACL,IAAI,CAAC;MAC7C,OAAO+C,KAAK,CAACrD,MAAM,GAAG,IAAI,CAACrE,MAAM,CAAC2E,IAAI,CAAC;IACzC,CAAC,CAAC,OAAO7D,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,OAAO,KAAK;IACd;EACF;EAEA,MAAMuH,iBAAiBA,CAAC1D,IAAI,EAAE;IAC5B,IAAI;MACF,MAAM+C,KAAK,GAAG,MAAM,IAAI,CAAC1C,cAAc,CAACL,IAAI,CAAC;MAC7C,OAAO,IAAI,CAAC3E,MAAM,CAAC2E,IAAI,CAAC,GAAG+C,KAAK,CAACrD,MAAM;IACzC,CAAC,CAAC,OAAOvD,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClD,OAAO,CAAC;IACV;EACF;EAEA,MAAMwH,cAAcA,CAAA,EAAG;IACrB,IAAI;MACF,MAAMZ,KAAK,GAAG,MAAM,IAAI,CAACE,WAAW,CAAC,CAAC;MACtC,MAAMW,SAAS,GAAG,CAAC,GAAGb,KAAK,CAACzH,MAAM,EAAE,GAAGyH,KAAK,CAACxH,MAAM,EAAE,GAAGwH,KAAK,CAACvH,MAAM,CAAC,CAClEqI,MAAM,CAAC,CAACC,GAAG,EAAE5D,IAAI,KAAK4D,GAAG,GAAG5D,IAAI,CAACC,IAAI,EAAE,CAAC,CAAC;MAE5C,OAAO;QACL4D,KAAK,EAAE;UACLzI,MAAM,EAAEyH,KAAK,CAACzH,MAAM,CAACoE,MAAM;UAC3BnE,MAAM,EAAEwH,KAAK,CAACxH,MAAM,CAACmE,MAAM;UAC3BlE,MAAM,EAAEuH,KAAK,CAACvH,MAAM,CAACkE,MAAM;UAC3BkE,SAAS,EAAEA,SAAS;UACpBI,WAAW,EAAEtD,IAAI,CAACuD,KAAK,CAACL,SAAS,IAAI,IAAI,GAAG,IAAI,CAAC;QACnD,CAAC;QACDvI,MAAM,EAAE,IAAI,CAACA,MAAM;QACnB0H,KAAK,EAAEA,KAAK;QACZmB,IAAI,EAAE,IAAI,CAAChJ,YAAY,GAAG,UAAU,GAAG;MACzC,CAAC;IACH,CAAC,CAAC,OAAOiB,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,OAAO;QACL4H,KAAK,EAAE;UAAEzI,MAAM,EAAE,CAAC;UAAEC,MAAM,EAAE,CAAC;UAAEC,MAAM,EAAE,CAAC;UAAEoI,SAAS,EAAE,CAAC;UAAEI,WAAW,EAAE;QAAE,CAAC;QACxE3I,MAAM,EAAE,IAAI,CAACA,MAAM;QACnB0H,KAAK,EAAE;UAAEzH,MAAM,EAAE,EAAE;UAAEC,MAAM,EAAE,EAAE;UAAEC,MAAM,EAAE;QAAG,CAAC;QAC7C0I,IAAI,EAAE,IAAI,CAAChJ,YAAY,GAAG,UAAU,GAAG;MACzC,CAAC;IACH;EACF;EAEA,MAAM4G,iBAAiBA,CAAA,EAAG;IACxB,IAAI;MACF,MAAMqC,IAAI,GAAG,MAAM,IAAI,CAACR,cAAc,CAAC,CAAC;MACxC/F,YAAY,CAACwE,OAAO,CAAC,kBAAkB,EAAErE,IAAI,CAACsE,SAAS,CAAC8B,IAAI,CAAC,CAAC;MAC9DvI,MAAM,CAACwI,aAAa,CAAC,IAAIC,WAAW,CAAC,gBAAgB,EAAE;QAAEC,MAAM,EAAEH;MAAK,CAAC,CAAC,CAAC;IAC3E,CAAC,CAAC,OAAOhI,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IACpD;EACF;EAEA,MAAM8E,gBAAgBA,CAACf,IAAI,EAAE;IAC3B,OAAO,IAAI9D,OAAO,CAAEC,OAAO,IAAK;MAC9B,IAAI;QACF,MAAMkI,KAAK,GAAGC,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;QAC7CF,KAAK,CAACG,OAAO,GAAG,UAAU;QAE1B,MAAMC,OAAO,GAAGC,UAAU,CAAC,MAAM;UAC/BL,KAAK,CAACM,GAAG,GAAG,EAAE;UACdxI,OAAO,CAAC,EAAE,CAAC;QACb,CAAC,EAAE,IAAI,CAAC;QAERkI,KAAK,CAACO,gBAAgB,GAAG,MAAM;UAC7BC,YAAY,CAACJ,OAAO,CAAC;UACrBjG,GAAG,CAAC8E,eAAe,CAACe,KAAK,CAACM,GAAG,CAAC;UAC9BxI,OAAO,CAACkI,KAAK,CAACvD,QAAQ,IAAI,EAAE,CAAC;QAC/B,CAAC;QAEDuD,KAAK,CAAC9H,OAAO,GAAG,MAAM;UACpBsI,YAAY,CAACJ,OAAO,CAAC;UACrBtI,OAAO,CAAC,EAAE,CAAC;QACb,CAAC;QAEDkI,KAAK,CAACM,GAAG,GAAGnG,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC;MACvC,CAAC,CAAC,OAAO/D,KAAK,EAAE;QACdJ,OAAO,CAACC,IAAI,CAAC,uBAAuB,EAAEG,KAAK,CAAC;QAC5CE,OAAO,CAAC,EAAE,CAAC;MACb;IACF,CAAC,CAAC;EACJ;EAEA,MAAMiF,gBAAgBA,CAACpB,IAAI,EAAE;IAC3B,OAAO,IAAI9D,OAAO,CAAEC,OAAO,IAAK;MAC9B,IAAI;QACF,MAAM2I,KAAK,GAAGR,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;QAC7CO,KAAK,CAACN,OAAO,GAAG,UAAU;QAE1B,MAAMC,OAAO,GAAGC,UAAU,CAAC,MAAM;UAC/BI,KAAK,CAACH,GAAG,GAAG,EAAE;UACdxI,OAAO,CAAC,EAAE,CAAC;QACb,CAAC,EAAE,IAAI,CAAC;QAER2I,KAAK,CAACF,gBAAgB,GAAG,MAAM;UAC7BC,YAAY,CAACJ,OAAO,CAAC;UACrBjG,GAAG,CAAC8E,eAAe,CAACwB,KAAK,CAACH,GAAG,CAAC;UAC9BxI,OAAO,CAAC2I,KAAK,CAAChE,QAAQ,IAAI,EAAE,CAAC;QAC/B,CAAC;QAEDgE,KAAK,CAACvI,OAAO,GAAG,MAAM;UACpBsI,YAAY,CAACJ,OAAO,CAAC;UACrBtI,OAAO,CAAC,EAAE,CAAC;QACb,CAAC;QAED2I,KAAK,CAACH,GAAG,GAAGnG,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC;MACvC,CAAC,CAAC,OAAO/D,KAAK,EAAE;QACdJ,OAAO,CAACC,IAAI,CAAC,uBAAuB,EAAEG,KAAK,CAAC;QAC5CE,OAAO,CAAC,EAAE,CAAC;MACb;IACF,CAAC,CAAC;EACJ;EAEA,MAAM8E,kBAAkBA,CAACjB,IAAI,EAAE;IAC7B,OAAO,IAAI9D,OAAO,CAAEC,OAAO,IAAK;MAC9B,IAAI;QACF,MAAM4I,GAAG,GAAG,IAAIpL,KAAK,CAAC,CAAC;QAEvB,MAAM8K,OAAO,GAAGC,UAAU,CAAC,MAAM;UAC/BK,GAAG,CAACJ,GAAG,GAAG,EAAE;UACZxI,OAAO,CAAC;YAAE+E,KAAK,EAAE,CAAC;YAAEC,MAAM,EAAE;UAAE,CAAC,CAAC;QAClC,CAAC,EAAE,IAAI,CAAC;QAER4D,GAAG,CAAChG,MAAM,GAAG,MAAM;UACjB8F,YAAY,CAACJ,OAAO,CAAC;UACrBjG,GAAG,CAAC8E,eAAe,CAACyB,GAAG,CAACJ,GAAG,CAAC;UAC5BxI,OAAO,CAAC;YAAE+E,KAAK,EAAE6D,GAAG,CAAC7D,KAAK;YAAEC,MAAM,EAAE4D,GAAG,CAAC5D;UAAO,CAAC,CAAC;QACnD,CAAC;QAED4D,GAAG,CAACxI,OAAO,GAAG,MAAM;UAClBsI,YAAY,CAACJ,OAAO,CAAC;UACrBtI,OAAO,CAAC;YAAE+E,KAAK,EAAE,CAAC;YAAEC,MAAM,EAAE;UAAE,CAAC,CAAC;QAClC,CAAC;QAED4D,GAAG,CAACJ,GAAG,GAAGnG,GAAG,CAACC,eAAe,CAACuB,IAAI,CAAC;MACrC,CAAC,CAAC,OAAO/D,KAAK,EAAE;QACdJ,OAAO,CAACC,IAAI,CAAC,yBAAyB,EAAEG,KAAK,CAAC;QAC9CE,OAAO,CAAC;UAAE+E,KAAK,EAAE,CAAC;UAAEC,MAAM,EAAE;QAAE,CAAC,CAAC;MAClC;IACF,CAAC,CAAC;EACJ;EAEA,MAAM6D,mBAAmBA,CAAA,EAAG;IAC1B,IAAI;MACF,MAAMzE,GAAG,GAAG,IAAID,IAAI,CAAC,CAAC;MACtB,IAAI2E,YAAY,GAAG,CAAC;MAEpB,IAAI,IAAI,CAACjK,YAAY,EAAE;QACrB,MAAMkK,YAAY,GAAG,EAAE;QACvB,KAAK,MAAM,CAACnH,GAAG,EAAEiC,IAAI,CAAC,IAAI,IAAI,CAAC/E,aAAa,CAACiD,OAAO,CAAC,CAAC,EAAE;UACtD,IAAI,IAAIoC,IAAI,CAACN,IAAI,CAACa,SAAS,CAAC,IAAIN,GAAG,EAAE;YACnC2E,YAAY,CAACpC,IAAI,CAAC/E,GAAG,CAAC;YACtB,IAAIiC,IAAI,CAACzB,GAAG,EAAE;cACZC,GAAG,CAAC8E,eAAe,CAACtD,IAAI,CAACzB,GAAG,CAAC;YAC/B;UACF;QACF;QAEA2G,YAAY,CAACC,OAAO,CAACpH,GAAG,IAAI,IAAI,CAAC9C,aAAa,CAACkI,MAAM,CAACpF,GAAG,CAAC,CAAC;QAC3DkH,YAAY,GAAGC,YAAY,CAAC1F,MAAM;MACpC,CAAC,MAAM;QACL,MAAM4F,QAAQ,GAAG,MAAM,IAAIlJ,OAAO,CAAEC,OAAO,IAAK;UAC9C,MAAMqF,WAAW,GAAG,IAAI,CAACzG,EAAE,CAACyG,WAAW,CAAC,CAAC,OAAO,CAAC,EAAE,UAAU,CAAC;UAC9D,MAAMC,KAAK,GAAGD,WAAW,CAACE,WAAW,CAAC,OAAO,CAAC;UAC9C,MAAMrF,OAAO,GAAGoF,KAAK,CAACe,MAAM,CAAC,CAAC;UAE9BnG,OAAO,CAACM,SAAS,GAAG,MAAMR,OAAO,CAACE,OAAO,CAACO,MAAM,IAAI,EAAE,CAAC;UACvDP,OAAO,CAACE,OAAO,GAAG,MAAMJ,OAAO,CAAC,EAAE,CAAC;QACrC,CAAC,CAAC;QAEF,MAAMkJ,YAAY,GAAGD,QAAQ,CAAC1C,MAAM,CAAC1C,IAAI,IAAI;UAC3C,OAAO,IAAIM,IAAI,CAACN,IAAI,CAACa,SAAS,CAAC,IAAIN,GAAG;QACxC,CAAC,CAAC;QAEF,KAAK,MAAMP,IAAI,IAAIqF,YAAY,EAAE;UAC/B,IAAI;YACF,MAAM,IAAI,CAACnC,mBAAmB,CAAClD,IAAI,CAACK,EAAE,CAAC;YACvC,IAAIL,IAAI,CAACzB,GAAG,EAAE;cACZC,GAAG,CAAC8E,eAAe,CAACtD,IAAI,CAACzB,GAAG,CAAC;YAC/B;YACA0G,YAAY,EAAE;UAChB,CAAC,CAAC,OAAOK,WAAW,EAAE;YACpBzJ,OAAO,CAACC,IAAI,CAAC,gCAAgC,EAAEwJ,WAAW,CAAC;UAC7D;QACF;MACF;MAEAzJ,OAAO,CAACgB,GAAG,CAAC,cAAcoI,YAAY,gBAAgB,CAAC;MACvD,OAAOA,YAAY;IACrB,CAAC,CAAC,OAAOhJ,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAAC;MACtC,OAAO,CAAC;IACV;EACF;AACF;AAEA,MAAMsJ,YAAY,GAAG,IAAI5K,oBAAoB,CAAC,CAAC;AAE/C,MAAM6K,WAAW,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAAA,IAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EACxB,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGzN,QAAQ,CAAC;IAC/CyC,MAAM,EAAE,EAAE;IACVE,MAAM,EAAE,EAAE;IACVD,MAAM,EAAE;EACV,CAAC,CAAC;;EAEF;EACA,MAAM,CAACgL,WAAW,EAAEC,cAAc,CAAC,GAAG3N,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC4N,cAAc,EAAEC,iBAAiB,CAAC,GAAG7N,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAAC8N,cAAc,EAAEC,iBAAiB,CAAC,GAAG/N,QAAQ,CAAC,IAAIgO,GAAG,CAAC,CAAC,CAAC;EAC/D,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGlO,QAAQ,CAAC,IAAI,CAAC;EAEtD,MAAM,CAACmO,aAAa,EAAEC,gBAAgB,CAAC,GAAGpO,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACqO,WAAW,EAAEC,cAAc,CAAC,GAAGtO,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACuO,aAAa,EAAEC,gBAAgB,CAAC,GAAGxO,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACyO,oBAAoB,EAAEC,uBAAuB,CAAC,GAAG1O,QAAQ,CAAC,IAAI,CAAC;EACtE,MAAM,CAAC2O,YAAY,EAAEC,eAAe,CAAC,GAAG5O,QAAQ,CAAC,CAAC,CAAC;EACnD,MAAM,CAAC6O,SAAS,EAAEC,YAAY,CAAC,GAAG9O,QAAQ,CAAC,QAAQ,CAAC;EACpD,MAAM,CAAC+O,MAAM,EAAEC,SAAS,CAAC,GAAGhP,QAAQ,CAAC,CAAC,CAAC;EACvC,MAAM,CAACiP,OAAO,EAAEC,UAAU,CAAC,GAAGlP,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACmP,SAAS,EAAEC,YAAY,CAAC,GAAGpP,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACqP,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGtP,QAAQ,CAAC,IAAI,CAAC;EAClE,MAAM,CAACuP,WAAW,EAAEC,cAAc,CAAC,GAAGxP,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACyP,mBAAmB,EAAEC,sBAAsB,CAAC,GAAG1P,QAAQ,CAAC,IAAI,CAAC;EACpE,MAAM,CAAC2P,WAAW,EAAEC,cAAc,CAAC,GAAG5P,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC6P,UAAU,EAAEC,aAAa,CAAC,GAAG9P,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAAC+P,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGhQ,QAAQ,CAAC,KAAK,CAAC;EACnE,MAAM,CAACiQ,UAAU,EAAEC,aAAa,CAAC,GAAGlQ,QAAQ,CAAC,CAAC,CAAC;EAC/C,MAAM,CAACmQ,UAAU,EAAEC,aAAa,CAAC,GAAGpQ,QAAQ,CAAC,IAAI,CAAC;;EAElD;EACA,MAAM,CAACqQ,UAAU,EAAEC,aAAa,CAAC,GAAGtQ,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACuQ,YAAY,EAAEC,eAAe,CAAC,GAAGxQ,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EACxD,MAAM,CAACyQ,UAAU,EAAEC,aAAa,CAAC,GAAG1Q,QAAQ,CAAC,IAAI,CAAC;EAClD,MAAM,CAAC2Q,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG5Q,QAAQ,CAAC,IAAI,CAAC;;EAE9D;EACA,MAAM,CAAC6Q,eAAe,EAAEC,kBAAkB,CAAC,GAAG9Q,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC+Q,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGhR,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAChE,MAAM,CAACiR,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGlR,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACmR,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGpR,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACqR,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGtR,QAAQ,CAAC;IAAEuR,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;EAAE,CAAC,CAAC;EACxE,MAAM,CAACC,mBAAmB,EAAEC,sBAAsB,CAAC,GAAG1R,QAAQ,CAAC,IAAI,CAAC;EACpE,MAAM,CAAC2R,uBAAuB,EAAEC,0BAA0B,CAAC,GAAG5R,QAAQ,CAAC,IAAI,CAAC;;EAE5E;EACA,MAAM,CAAC6R,QAAQ,EAAEC,WAAW,CAAC,GAAG9R,QAAQ,CAAC,KAAK,CAAC;;EAE/C;EACA,MAAM,CAAC+R,MAAM,EAAEC,SAAS,CAAC,GAAGhS,QAAQ,CAAC;IACnCiS,QAAQ,EAAE,CACR;MAAEvK,EAAE,EAAE,WAAW;MAAEK,IAAI,EAAE,WAAW;MAAEZ,IAAI,EAAE;IAAU,CAAC,EACvD;MAAEO,EAAE,EAAE,WAAW;MAAEK,IAAI,EAAE,WAAW;MAAEZ,IAAI,EAAE;IAAU,CAAC,CACxD;IACD+K,IAAI,EAAE,CACJ;MAAExK,EAAE,EAAE,YAAY;MAAEK,IAAI,EAAE,YAAY;MAAEZ,IAAI,EAAE;IAAO,CAAC,CACvD;IACDgF,KAAK,EAAE,CACL;MAAEzE,EAAE,EAAE,SAAS;MAAEK,IAAI,EAAE,SAAS;MAAEZ,IAAI,EAAE;IAAQ,CAAC,EACjD;MAAEO,EAAE,EAAE,SAAS;MAAEK,IAAI,EAAE,SAAS;MAAEZ,IAAI,EAAE;IAAQ,CAAC;EAErD,CAAC,CAAC;EAEF,MAAMgL,WAAW,GAAGlS,MAAM,CAAC,IAAI,CAAC;EAChC,MAAMmS,iBAAiB,GAAGnS,MAAM,CAAC,IAAI,CAAC;EACtC,MAAMoS,cAAc,GAAGpS,MAAM,CAAC,IAAI,CAAC;EACnC,MAAMqS,WAAW,GAAGrS,MAAM,CAAC,IAAI,CAAC;EAChC,MAAMsS,gBAAgB,GAAGtS,MAAM,CAAC,IAAIsC,GAAG,CAAC,CAAC,CAAC;EAC1C,MAAMiQ,YAAY,GAAGvS,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMwS,aAAa,GAAGxS,MAAM,CAAC,IAAI,CAAC;EAClC,MAAMyS,aAAa,GAAGzS,MAAM,CAAC,IAAI,CAAC;EAClC,MAAM0S,QAAQ,GAAG1S,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAM2S,qBAAqB,GAAG3S,MAAM,CAAC,IAAI,CAAC;EAC1C,MAAM4S,iBAAiB,GAAG5S,MAAM,CAAC,IAAI,CAAC;;EAEtC;EACAC,SAAS,CAAC,MAAM;IACd,MAAM4S,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI;QACF5E,eAAe,CAAC,IAAI,CAAC;QACrB,MAAMtB,YAAY,CAAC3J,IAAI,CAAC,CAAC;QACzB4K,iBAAiB,CAAC,IAAI,CAAC;;QAEvB;QACA,MAAMkF,iBAAiB,CAAC,CAAC;;QAEzB;QACA,MAAMzH,IAAI,GAAG,MAAMsB,YAAY,CAAC9B,cAAc,CAAC,CAAC;QAChD6C,cAAc,CAACrC,IAAI,CAAC;;QAEpB;QACA,MAAMsB,YAAY,CAACP,mBAAmB,CAAC,CAAC;QAExCnJ,OAAO,CAACgB,GAAG,CAAC,uCAAuC,CAAC;MACtD,CAAC,CAAC,OAAOZ,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;QAC1D4K,eAAe,CAAC5K,KAAK,CAACS,OAAO,CAAC;QAC9B8J,iBAAiB,CAAC,KAAK,CAAC;MAC1B;IACF,CAAC;IAEDiF,WAAW,CAAC,CAAC;;IAEb;IACA,MAAME,mBAAmB,GAAI5O,KAAK,IAAK;MACrCuJ,cAAc,CAACvJ,KAAK,CAACqH,MAAM,CAAC;IAC9B,CAAC;IAED1I,MAAM,CAACkQ,gBAAgB,CAAC,gBAAgB,EAAED,mBAAmB,CAAC;IAE9D,OAAO,MAAM;MACXjQ,MAAM,CAACmQ,mBAAmB,CAAC,gBAAgB,EAAEF,mBAAmB,CAAC;IACnE,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMD,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI;MACF,MAAM7I,KAAK,GAAG,MAAM0C,YAAY,CAACxC,WAAW,CAAC,CAAC;MAC9CqD,eAAe,CAACvD,KAAK,CAAC;MACtBhH,OAAO,CAACgB,GAAG,CAAC,qCAAqC,EAAEgG,KAAK,CAAC;IAC3D,CAAC,CAAC,OAAO5G,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACxD;EACF,CAAC;;EAED;EACA,MAAM6P,UAAU,GAAIC,OAAO,IAAK;IAC9B,MAAMC,IAAI,GAAGxL,IAAI,CAACyL,KAAK,CAACF,OAAO,GAAG,EAAE,CAAC;IACrC,MAAMG,IAAI,GAAG1L,IAAI,CAACyL,KAAK,CAACF,OAAO,GAAG,EAAE,CAAC;IACrC,MAAMI,EAAE,GAAG3L,IAAI,CAACyL,KAAK,CAAEF,OAAO,GAAG,CAAC,GAAI,GAAG,CAAC;IAC1C,OAAOzE,YAAY,GAAG,CAAC,GAAG,GAAG0E,IAAI,IAAIE,IAAI,CAACnK,QAAQ,CAAC,CAAC,CAACqK,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAID,EAAE,CAACpK,QAAQ,CAAC,CAAC,CAACqK,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,GAAG,GAAGJ,IAAI,IAAIE,IAAI,CAACnK,QAAQ,CAAC,CAAC,CAACqK,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;EAC3J,CAAC;EAED,MAAMC,cAAc,GAAIC,KAAK,IAAK;IAChC,IAAIA,KAAK,KAAK,CAAC,EAAE,OAAO,KAAK;IAC7B,MAAMC,CAAC,GAAG,IAAI;IACd,MAAMC,KAAK,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IACrC,MAAM/M,CAAC,GAAGe,IAAI,CAACyL,KAAK,CAACzL,IAAI,CAAC3D,GAAG,CAACyP,KAAK,CAAC,GAAG9L,IAAI,CAAC3D,GAAG,CAAC0P,CAAC,CAAC,CAAC;IACnD,OAAOE,UAAU,CAAC,CAACH,KAAK,GAAG9L,IAAI,CAACkM,GAAG,CAACH,CAAC,EAAE9M,CAAC,CAAC,EAAEkN,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGH,KAAK,CAAC/M,CAAC,CAAC;EACzE,CAAC;EAED,MAAMmN,eAAe,GAAGA,CAAA,KAAM;IAC5B7E,YAAY,CAAC,CAACD,SAAS,CAAC;EAC1B,CAAC;EAED,MAAM+E,MAAM,GAAIC,IAAI,IAAK;IACvB,MAAMC,OAAO,GAAGvM,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAExM,IAAI,CAACyM,GAAG,CAAC/F,aAAa,EAAE4F,IAAI,CAAC,CAAC;IAC1D7F,cAAc,CAAC8F,OAAO,CAAC;IAEvB,MAAMG,OAAO,GAAGC,yBAAyB,CAAC,CAAC;IAC3CD,OAAO,CAACpI,KAAK,CAACK,OAAO,CAACiI,SAAS,IAAI;MACjC,MAAMC,YAAY,GAAGnC,gBAAgB,CAACoC,OAAO,CAACjK,GAAG,CAAC+J,SAAS,CAAC/M,EAAE,CAAC;MAC/D,IAAIgN,YAAY,EAAE;QAChB,MAAME,YAAY,GAAGR,OAAO,GAAGK,SAAS,CAACI,SAAS;QAClDH,YAAY,CAACrG,WAAW,GAAGxG,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEO,YAAY,CAAC;MACtD;IACF,CAAC,CAAC;EACJ,CAAC;EAED,MAAMJ,yBAAyB,GAAGrU,WAAW,CAAC,MAAM;IAClD,MAAM2U,YAAY,GAAG3G,aAAa,CAACpE,MAAM,CACtCgL,IAAI,IACH1G,WAAW,IAAI0G,IAAI,CAACF,SAAS,IAC7BxG,WAAW,GAAG0G,IAAI,CAACF,SAAS,GAAGE,IAAI,CAAC5M,QACxC,CAAC;IAED,OAAO;MACL6M,SAAS,EAAEF,YAAY,CAACG,IAAI,CAACF,IAAI,IAAIA,IAAI,CAACG,SAAS,KAAK,MAAM,IAAIH,IAAI,CAAC5N,IAAI,KAAK,OAAO,CAAC;MACxF8K,QAAQ,EAAE6C,YAAY,CAAC/K,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACG,SAAS,KAAK,SAAS,CAAC;MACnE/I,KAAK,EAAE2I,YAAY,CAAC/K,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACG,SAAS,KAAK,OAAO;IAC/D,CAAC;EACH,CAAC,EAAE,CAAC7G,WAAW,EAAEF,aAAa,CAAC,CAAC;EAEhC,MAAMgH,kBAAkB,GAAGhV,WAAW,CAAEsU,SAAS,IAAK;IACpD,IAAI,CAAClC,gBAAgB,CAACoC,OAAO,CAACS,GAAG,CAACX,SAAS,CAAC/M,EAAE,CAAC,EAAE;MAC/C,MAAMyE,KAAK,GAAGR,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MAC7CO,KAAK,CAACH,GAAG,GAAGyI,SAAS,CAAC7O,GAAG;MACzBuG,KAAK,CAAC4C,MAAM,GAAG,CAAC0F,SAAS,CAAC1F,MAAM,IAAI,CAAC,IAAIA,MAAM;MAC/C5C,KAAK,CAACkJ,KAAK,GAAGpG,OAAO;MACrB9C,KAAK,CAACN,OAAO,GAAG,UAAU;MAC1B0G,gBAAgB,CAACoC,OAAO,CAAC3O,GAAG,CAACyO,SAAS,CAAC/M,EAAE,EAAEyE,KAAK,CAAC;IACnD;IACA,OAAOoG,gBAAgB,CAACoC,OAAO,CAACjK,GAAG,CAAC+J,SAAS,CAAC/M,EAAE,CAAC;EACnD,CAAC,EAAE,CAACqH,MAAM,EAAEE,OAAO,CAAC,CAAC;EAErB,MAAMqG,aAAa,GAAGnV,WAAW,CAAC,CAACsU,SAAS,EAAEG,YAAY,KAAK;IAC7D,MAAMF,YAAY,GAAGnC,gBAAgB,CAACoC,OAAO,CAACjK,GAAG,CAAC+J,SAAS,CAAC/M,EAAE,CAAC;IAC/D,IAAIgN,YAAY,EAAE;MAChB,MAAMa,QAAQ,GAAG1N,IAAI,CAAC2N,GAAG,CAACd,YAAY,CAACrG,WAAW,GAAGuG,YAAY,CAAC;MAClE,IAAIW,QAAQ,GAAG,GAAG,EAAE;QAClBb,YAAY,CAACrG,WAAW,GAAGxG,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEO,YAAY,CAAC;MACtD;IACF;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMa,cAAc,GAAGtV,WAAW,CAAC,CAACuV,OAAO,EAAEC,SAAS,GAAG,IAAI,KAAK;IAChE,OAAOxH,aAAa,CAACyH,IAAI,CAACb,IAAI,IAAI;MAChC,IAAIA,IAAI,CAACrN,EAAE,KAAKiO,SAAS,EAAE,OAAO,KAAK;MACvC,IAAIZ,IAAI,CAACc,OAAO,KAAKH,OAAO,CAACG,OAAO,EAAE,OAAO,KAAK;MAElD,MAAMC,SAAS,GAAGf,IAAI,CAACF,SAAS;MAChC,MAAMkB,OAAO,GAAGhB,IAAI,CAACF,SAAS,GAAGE,IAAI,CAAC5M,QAAQ;MAC9C,MAAM6N,QAAQ,GAAGN,OAAO,CAACb,SAAS;MAClC,MAAMoB,MAAM,GAAGP,OAAO,CAACb,SAAS,GAAGa,OAAO,CAACvN,QAAQ;MAEnD,OAAQ6N,QAAQ,GAAGD,OAAO,IAAIE,MAAM,GAAGH,SAAS;IAClD,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC3H,aAAa,CAAC,CAAC;;EAEnB;EACA,MAAM+H,gBAAgB,GAAG/V,WAAW,CAAC,CAAC0V,OAAO,EAAEM,UAAU,EAAEhO,QAAQ,EAAEwN,SAAS,GAAG,IAAI,KAAK;IACxF,MAAMS,UAAU,GAAGjI,aAAa,CAC7BpE,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACc,OAAO,KAAKA,OAAO,IAAId,IAAI,CAACrN,EAAE,KAAKiO,SAAS,CAAC,CACjEU,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACzB,SAAS,GAAG0B,CAAC,CAAC1B,SAAS,CAAC;;IAE5C;IACA,IAAIuB,UAAU,CAACvP,MAAM,KAAK,CAAC,EAAE;MAC3B,OAAO;QAAEsN,IAAI,EAAEtM,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAE8B,UAAU,CAAC;QAAEK,YAAY,EAAE,KAAK;QAAEC,aAAa,EAAE;MAAG,CAAC;IAClF;;IAEA;IACA,IAAIC,cAAc,GAAGP,UAAU;IAC/B,IAAIK,YAAY,GAAG,KAAK;IACxB,IAAIC,aAAa,GAAG,EAAE;;IAEtB;IACA,MAAME,eAAe,GAAGP,UAAU,CAACnB,IAAI,CAACF,IAAI,IAC1CoB,UAAU,IAAIpB,IAAI,CAACF,SAAS,IAAIsB,UAAU,GAAGpB,IAAI,CAACF,SAAS,GAAGE,IAAI,CAAC5M,QACrE,CAAC;IAED,IAAIwO,eAAe,EAAE;MACnB;MACAD,cAAc,GAAGC,eAAe,CAAC9B,SAAS;MAC1C2B,YAAY,GAAG,IAAI;MACnBC,aAAa,GAAGL,UAAU,CAACrM,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACF,SAAS,IAAI6B,cAAc,CAAC;IAC7E,CAAC,MAAM;MACL;MACA,MAAME,aAAa,GAAGR,UAAU,CAACrM,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACF,SAAS,IAAIsB,UAAU,CAAC;MAE7E,IAAIS,aAAa,CAAC/P,MAAM,GAAG,CAAC,EAAE;QAC5B;QACA,MAAMgQ,SAAS,GAAGD,aAAa,CAAC,CAAC,CAAC;QAClC,MAAME,cAAc,GAAGD,SAAS,CAAChC,SAAS,GAAGsB,UAAU;QAEvD,IAAIW,cAAc,IAAI3O,QAAQ,EAAE;UAC9B;UACAuO,cAAc,GAAGP,UAAU;UAC3BK,YAAY,GAAG,KAAK;QACtB,CAAC,MAAM;UACL;UACAE,cAAc,GAAGP,UAAU;UAC3BK,YAAY,GAAG,IAAI;UACnBC,aAAa,GAAGG,aAAa;QAC/B;MACF,CAAC,MAAM;QACL;QACAF,cAAc,GAAGP,UAAU;QAC3BK,YAAY,GAAG,KAAK;MACtB;IACF;IAEA,OAAO;MACLrC,IAAI,EAAEtM,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEqC,cAAc,CAAC;MACjCF,YAAY;MACZC,aAAa;MACbM,WAAW,EAAEP,YAAY,GAAGrO,QAAQ,GAAG;IACzC,CAAC;EACH,CAAC,EAAE,CAACgG,aAAa,CAAC,CAAC;;EAEnB;EACA,MAAM6I,wBAAwB,GAAG7W,WAAW,CAAC,CAAC0V,OAAO,EAAEoB,QAAQ,EAAE9O,QAAQ,EAAEwN,SAAS,GAAG,IAAI,KAAK;IAC9F,MAAM1R,MAAM,GAAGiS,gBAAgB,CAACL,OAAO,EAAEoB,QAAQ,EAAE9O,QAAQ,EAAEwN,SAAS,CAAC;IACvE,OAAO;MACLxB,IAAI,EAAElQ,MAAM,CAACkQ,IAAI;MACjB+C,OAAO,EAAE,CAACjT,MAAM,CAACuS;IACnB,CAAC;EACH,CAAC,EAAE,CAACN,gBAAgB,CAAC,CAAC;;EAEtB;EACA,MAAMiB,iBAAiB,GAAGhX,WAAW,CAAC,CAACsW,aAAa,EAAEM,WAAW,KAAK;IACpE,IAAI,CAACN,aAAa,CAAC5P,MAAM,IAAIkQ,WAAW,IAAI,CAAC,EAAE;IAE/C7T,OAAO,CAACgB,GAAG,CAAC,yBAAyB,EAAE;MACrCkT,aAAa,EAAEX,aAAa,CAAC5P,MAAM;MACnCkQ,WAAW;MACXN,aAAa,EAAEA,aAAa,CAACzM,GAAG,CAAC+K,IAAI,KAAK;QAAEhN,IAAI,EAAEgN,IAAI,CAAChN,IAAI;QAAEsP,QAAQ,EAAEtC,IAAI,CAACF;MAAU,CAAC,CAAC;IAC1F,CAAC,CAAC;IAEFzG,gBAAgB,CAACkJ,IAAI,IAAIA,IAAI,CAACtN,GAAG,CAAC+K,IAAI,IAAI;MACxC,MAAMwC,YAAY,GAAGd,aAAa,CAACxB,IAAI,CAACuC,QAAQ,IAAIA,QAAQ,CAAC9P,EAAE,KAAKqN,IAAI,CAACrN,EAAE,CAAC;MAC5E,IAAI6P,YAAY,EAAE;QAChBrU,OAAO,CAACgB,GAAG,CAAC,YAAY6Q,IAAI,CAAChN,IAAI,SAASgN,IAAI,CAACF,SAAS,OAAOE,IAAI,CAACF,SAAS,GAAGkC,WAAW,EAAE,CAAC;QAC9F,OAAO;UACL,GAAGhC,IAAI;UACPF,SAAS,EAAEE,IAAI,CAACF,SAAS,GAAGkC;QAC9B,CAAC;MACH;MACA,OAAOhC,IAAI;IACb,CAAC,CAAC,CAAC;;IAEH;IACA,IAAI0B,aAAa,CAAC5P,MAAM,GAAG,CAAC,EAAE;MAC5B,MAAM4Q,UAAU,GAAG5P,IAAI,CAACwM,GAAG,CAAC,GAAGoC,aAAa,CAACzM,GAAG,CAAC+K,IAAI,IAAIA,IAAI,CAACF,SAAS,GAAGE,IAAI,CAAC5M,QAAQ,GAAG4O,WAAW,CAAC,CAAC;MACvG,IAAIU,UAAU,GAAGlJ,aAAa,EAAE;QAC9BC,gBAAgB,CAACiJ,UAAU,GAAG,EAAE,CAAC;MACnC;IACF;EACF,CAAC,EAAE,CAAClJ,aAAa,CAAC,CAAC;EAEnB,MAAMmJ,yBAAyB,GAAGvX,WAAW,CAAC,CAAC0V,OAAO,EAAE1N,QAAQ,EAAEwP,cAAc,GAAG,CAAC,KAAK;IACvF,MAAMvB,UAAU,GAAGjI,aAAa,CAC7BpE,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAACc,OAAO,KAAKA,OAAO,CAAC,CACxCQ,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACzB,SAAS,GAAG0B,CAAC,CAAC1B,SAAS,CAAC;IAE5C,IAAI8C,cAAc,IAAI,CAAC,EAAE;MACvB,MAAMC,QAAQ,GAAG;QAAE/B,OAAO;QAAEhB,SAAS,EAAE8C,cAAc;QAAExP;MAAS,CAAC;MACjE,IAAI,CAACsN,cAAc,CAACmC,QAAQ,CAAC,EAAE;QAC7B,OAAOD,cAAc;MACvB;IACF;IAEA,KAAK,IAAI7Q,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsP,UAAU,CAACvP,MAAM,EAAEC,CAAC,EAAE,EAAE;MAC1C,MAAM+Q,WAAW,GAAGzB,UAAU,CAACtP,CAAC,CAAC;MACjC,MAAMgR,QAAQ,GAAG1B,UAAU,CAACtP,CAAC,GAAG,CAAC,CAAC;MAElC,IAAIA,CAAC,KAAK,CAAC,IAAI+Q,WAAW,CAAChD,SAAS,IAAI1M,QAAQ,EAAE;QAChD,OAAO,CAAC;MACV;MAEA,IAAI2P,QAAQ,EAAE;QACZ,MAAMC,QAAQ,GAAGF,WAAW,CAAChD,SAAS,GAAGgD,WAAW,CAAC1P,QAAQ;QAC7D,MAAM6P,MAAM,GAAGF,QAAQ,CAACjD,SAAS;QACjC,MAAMoD,OAAO,GAAGD,MAAM,GAAGD,QAAQ;QAEjC,IAAIE,OAAO,IAAI9P,QAAQ,EAAE;UACvB,OAAO4P,QAAQ;QACjB;MACF;IACF;IAEA,IAAI3B,UAAU,CAACvP,MAAM,KAAK,CAAC,EAAE,OAAO,CAAC;IACrC,MAAMqR,QAAQ,GAAG9B,UAAU,CAACA,UAAU,CAACvP,MAAM,GAAG,CAAC,CAAC;IAClD,OAAOqR,QAAQ,CAACrD,SAAS,GAAGqD,QAAQ,CAAC/P,QAAQ;EAC/C,CAAC,EAAE,CAACgG,aAAa,EAAEsH,cAAc,CAAC,CAAC;EAEnC,MAAM0C,kBAAkB,GAAIC,MAAM,IAAK;IACrC,MAAM1D,YAAY,GAAGnC,gBAAgB,CAACoC,OAAO,CAACjK,GAAG,CAAC0N,MAAM,CAAC;IACzD,IAAI1D,YAAY,EAAE;MAChBA,YAAY,CAAC2D,KAAK,CAAC,CAAC;MACpB3D,YAAY,CAAC1I,GAAG,GAAG,EAAE;MACrBuG,gBAAgB,CAACoC,OAAO,CAACnK,MAAM,CAAC4N,MAAM,CAAC;IACzC;IAEAhK,gBAAgB,CAAEkJ,IAAI,IAAKA,IAAI,CAACvN,MAAM,CAAEgL,IAAI,IAAKA,IAAI,CAACrN,EAAE,KAAK0Q,MAAM,CAAC,CAAC;IACrE1J,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC;;EAED;EACA,MAAM4J,mBAAmB,GAAGnY,WAAW,CAAEoY,SAAS,IAAK;IACrD,OAAOxH,iBAAiB,CAACwH,SAAS,CAAC,IAAI;MAAEhH,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE,CAAC;MAAEgH,KAAK,EAAE,CAAC;MAAEC,OAAO,EAAE;IAAE,CAAC;EAC7E,CAAC,EAAE,CAAC1H,iBAAiB,CAAC,CAAC;EAEvB,MAAM2H,sBAAsB,GAAGvY,WAAW,CAAC,CAACoY,SAAS,EAAEI,OAAO,KAAK;IACjE3H,oBAAoB,CAACsG,IAAI,KAAK;MAC5B,GAAGA,IAAI;MACP,CAACiB,SAAS,GAAG;QAAE,GAAGD,mBAAmB,CAACC,SAAS,CAAC;QAAE,GAAGI;MAAQ;IAC/D,CAAC,CAAC,CAAC;EACL,CAAC,EAAE,CAACL,mBAAmB,CAAC,CAAC;EAEzB,MAAMM,sBAAsB,GAAGzY,WAAW,CAAC,CAAC4F,CAAC,EAAE8S,OAAO,KAAK;IACzD,IAAI9S,CAAC,CAAC1B,MAAM,CAACyU,OAAO,CAAC,gBAAgB,CAAC,EAAE,OAAO,CAAC;;IAEhD/S,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBhT,CAAC,CAACiT,eAAe,CAAC,CAAC;IAEnBlI,kBAAkB,CAAC+H,OAAO,CAAC;IAC3B3H,oBAAoB,CAAC,IAAI,CAAC;IAE1B,MAAM+H,SAAS,GAAGpG,iBAAiB,CAAC8B,OAAO;IAC3C,IAAI,CAACsE,SAAS,EAAE;IAEhB,MAAMC,aAAa,GAAGD,SAAS,CAACE,qBAAqB,CAAC,CAAC;IACvD,MAAMC,cAAc,GAAGrT,CAAC,CAACsT,aAAa;IACtC,MAAMC,WAAW,GAAGF,cAAc,CAACD,qBAAqB,CAAC,CAAC;IAC1D,MAAMI,SAAS,GAAGjB,mBAAmB,CAACO,OAAO,CAACnR,EAAE,CAAC;;IAEjD;IACA4J,mBAAmB,CAAC;MAClBC,CAAC,EAAExL,CAAC,CAACyT,OAAO,GAAGF,WAAW,CAACG,IAAI;MAC/BjI,CAAC,EAAEzL,CAAC,CAAC2T,OAAO,GAAGJ,WAAW,CAACK,GAAG;MAC9BC,UAAU,EAAEV,aAAa,CAACO,IAAI;MAC9BI,UAAU,EAAEX,aAAa,CAACS;IAC5B,CAAC,CAAC;EACJ,CAAC,EAAE,CAACrB,mBAAmB,CAAC,CAAC;EAEzB,MAAMwB,wBAAwB,GAAG3Z,WAAW,CAAC,CAAC4F,CAAC,EAAE8S,OAAO,EAAEkB,MAAM,KAAK;IACnEhU,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBhT,CAAC,CAACiT,eAAe,CAAC,CAAC;IAEnB9V,OAAO,CAACgB,GAAG,CAAC,kBAAkB,EAAE6V,MAAM,CAAC,CAAC,CAAC;;IAEzCjJ,kBAAkB,CAAC+H,OAAO,CAAC;IAC3BzH,oBAAoB,CAAC,IAAI,CAAC;IAC1BM,sBAAsB,CAACqI,MAAM,CAAC;IAE9B,MAAMC,gBAAgB,GAAG1B,mBAAmB,CAACO,OAAO,CAACnR,EAAE,CAAC;IACxDkK,0BAA0B,CAACoI,gBAAgB,CAAC;IAE5C1I,mBAAmB,CAAC;MAClBC,CAAC,EAAExL,CAAC,CAACyT,OAAO;MACZhI,CAAC,EAAEzL,CAAC,CAAC2T,OAAO;MACZO,UAAU,EAAED,gBAAgB,CAACxB,KAAK;MAClC0B,MAAM,EAAEF,gBAAgB,CAACzI,CAAC;MAC1B4I,MAAM,EAAEH,gBAAgB,CAACxI;IAC3B,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC8G,mBAAmB,CAAC,CAAC;EAEzB,MAAM8B,sBAAsB,GAAGja,WAAW,CAAE4F,CAAC,IAAK;IAChD,IAAI,CAAC8K,eAAe,EAAE;IAEtB,IAAII,iBAAiB,EAAE;MACrB;MACA,MAAMgI,SAAS,GAAGpG,iBAAiB,CAAC8B,OAAO;MAC3C,IAAI,CAACsE,SAAS,EAAE;MAEhB,MAAMoB,IAAI,GAAGpB,SAAS,CAACE,qBAAqB,CAAC,CAAC;MAC9C,MAAMmB,WAAW,GAAG,GAAG,GAAGhC,mBAAmB,CAACzH,eAAe,CAACnJ,EAAE,CAAC,CAAC8Q,KAAK;;MAEvE;MACA,MAAM+B,IAAI,GAAGxU,CAAC,CAACyT,OAAO,GAAGnI,gBAAgB,CAACuI,UAAU,GAAGvI,gBAAgB,CAACE,CAAC;MACzE,MAAMiJ,IAAI,GAAGzU,CAAC,CAAC2T,OAAO,GAAGrI,gBAAgB,CAACwI,UAAU,GAAGxI,gBAAgB,CAACG,CAAC;;MAEzE;MACA,MAAMiJ,OAAO,GAAG,CAAC,CAAC,CAAC;MACnB,MAAMC,QAAQ,GAAG7S,IAAI,CAACwM,GAAG,CAACoG,OAAO,EAAE5S,IAAI,CAACyM,GAAG,CAAC+F,IAAI,CAAC9R,KAAK,GAAG+R,WAAW,GAAGG,OAAO,EAAEF,IAAI,CAAC,CAAC;MACtF,MAAMI,QAAQ,GAAG9S,IAAI,CAACwM,GAAG,CAACoG,OAAO,EAAE5S,IAAI,CAACyM,GAAG,CAAC+F,IAAI,CAAC7R,MAAM,GAAG8R,WAAW,GAAGG,OAAO,EAAED,IAAI,CAAC,CAAC;;MAEvF;MACA,MAAMI,KAAK,GAAG,GAAG;MACjB,MAAMC,KAAK,GAAG,EAAE,GAAGhK,eAAe,CAACjH,KAAK,GAAG,GAAG;;MAE9C;MACA8O,sBAAsB,CAAC7H,eAAe,CAACnJ,EAAE,EAAE;QACzC6J,CAAC,EAAEmJ,QAAQ,GAAGE,KAAK;QACnBpJ,CAAC,EAAEmJ,QAAQ,GAAGE;MAChB,CAAC,CAAC;IAEJ,CAAC,MAAM,IAAI1J,iBAAiB,IAAIE,gBAAgB,CAAC4I,UAAU,KAAK3Q,SAAS,IAAImI,mBAAmB,EAAE;MAChGvO,OAAO,CAACgB,GAAG,CAAC,aAAa,EAAEuN,mBAAmB,CAAC,CAAC,CAAC;;MAEjD;MACA,MAAMqJ,MAAM,GAAG/U,CAAC,CAACyT,OAAO,GAAGnI,gBAAgB,CAACE,CAAC;MAC7C,MAAMwJ,MAAM,GAAGhV,CAAC,CAAC2T,OAAO,GAAGrI,gBAAgB,CAACG,CAAC;;MAE7C;MACA,IAAIwJ,WAAW,GAAG,CAAC;MACnB,MAAMC,WAAW,GAAG,KAAK,CAAC,CAAC;;MAE3B,QAAQxJ,mBAAmB;QACzB,KAAK,IAAI;UAAE;UACTuJ,WAAW,GAAG,CAAC,GAAG,CAACF,MAAM,GAAGC,MAAM,IAAIE,WAAW;UACjD;QACF,KAAK,IAAI;UAAE;UACTD,WAAW,GAAG,CAAC,GAAG,CAACF,MAAM,GAAGC,MAAM,IAAIE,WAAW;UACjD;QACF,KAAK,IAAI;UAAE;UACTD,WAAW,GAAG,CAAC,GAAG,CAAC,CAACF,MAAM,GAAGC,MAAM,IAAIE,WAAW;UAClD;QACF,KAAK,IAAI;UAAE;UACTD,WAAW,GAAG,CAAC,GAAG,CAACF,MAAM,GAAGC,MAAM,IAAIE,WAAW;UACjD;MACJ;;MAEA;MACA,MAAMC,QAAQ,GAAGrT,IAAI,CAACwM,GAAG,CAAC,GAAG,EAAExM,IAAI,CAACyM,GAAG,CAAC,CAAC,EAAEjD,gBAAgB,CAAC4I,UAAU,GAAGe,WAAW,CAAC,CAAC;;MAEtF;MACAtC,sBAAsB,CAAC7H,eAAe,CAACnJ,EAAE,EAAE;QACzC8Q,KAAK,EAAE0C;MACT,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACrK,eAAe,EAAEI,iBAAiB,EAAEE,iBAAiB,EAAEE,gBAAgB,EAAEM,uBAAuB,EAAE+G,sBAAsB,EAAEJ,mBAAmB,EAAE7G,mBAAmB,CAAC,CAAC;EAExK,MAAM0J,oBAAoB,GAAGhb,WAAW,CAAC,MAAM;IAC7C+C,OAAO,CAACgB,GAAG,CAAC,iCAAiC,CAAC,CAAC,CAAC;IAChDgN,oBAAoB,CAAC,KAAK,CAAC;IAC3BE,oBAAoB,CAAC,KAAK,CAAC;IAC3BM,sBAAsB,CAAC,IAAI,CAAC;IAC5BE,0BAA0B,CAAC,IAAI,CAAC;EAClC,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMwJ,kBAAkB,GAAGjb,WAAW,CAAC,CAAC4F,CAAC,EAAEwS,SAAS,KAAK;IACvD,IAAI,CAACxS,CAAC,CAACsV,OAAO,EAAE;IAChBtV,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBhT,CAAC,CAACiT,eAAe,CAAC,CAAC;IAEnB,MAAMO,SAAS,GAAGjB,mBAAmB,CAACC,SAAS,CAAC;IAChD,MAAM+C,UAAU,GAAGvV,CAAC,CAACgV,MAAM,GAAG,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC;IAChD,MAAMG,QAAQ,GAAGrT,IAAI,CAACwM,GAAG,CAAC,GAAG,EAAExM,IAAI,CAACyM,GAAG,CAAC,CAAC,EAAEiF,SAAS,CAACf,KAAK,GAAG8C,UAAU,CAAC,CAAC;IAEzE5C,sBAAsB,CAACH,SAAS,EAAE;MAAEC,KAAK,EAAE0C;IAAS,CAAC,CAAC;EACxD,CAAC,EAAE,CAAC5C,mBAAmB,EAAEI,sBAAsB,CAAC,CAAC;;EAEjD;EACA,MAAM6C,iBAAiB,GAAGpb,WAAW,CAAC,MAAM;IAC1C,IAAI,CAACsO,oBAAoB,EAAE;IAE3B,MAAMsG,IAAI,GAAGtG,oBAAoB;IACjC,MAAM+M,SAAS,GAAGnN,WAAW;IAE7B,IAAImN,SAAS,IAAIzG,IAAI,CAACF,SAAS,IAAI2G,SAAS,IAAIzG,IAAI,CAACF,SAAS,GAAGE,IAAI,CAAC5M,QAAQ,EAAE;MAC9E;IACF;IAEA,MAAMsT,iBAAiB,GAAGD,SAAS,GAAGzG,IAAI,CAACF,SAAS;IACpD,MAAM6G,eAAe,GAAGF,SAAS;IACjC,MAAMG,kBAAkB,GAAG5G,IAAI,CAAC5M,QAAQ,GAAGsT,iBAAiB;IAE5D,MAAMG,UAAU,GAAG;MACjB,GAAG7G,IAAI;MACPrN,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC9B+M,SAAS,EAAE6G,eAAe;MAC1BvT,QAAQ,EAAEwT;IACZ,CAAC;IAED,MAAME,gBAAgB,GAAG;MACvB,GAAG9G,IAAI;MACP5M,QAAQ,EAAEsT;IACZ,CAAC;IAEDrN,gBAAgB,CAACkJ,IAAI,IAAIA,IAAI,CAACtN,GAAG,CAAC8R,YAAY,IAC5CA,YAAY,CAACpU,EAAE,KAAKqN,IAAI,CAACrN,EAAE,GAAGmU,gBAAgB,GAAGC,YACnD,CAAC,CAACC,MAAM,CAACH,UAAU,CAAC,CAAC;IAErBlN,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC,EAAE,CAACD,oBAAoB,EAAEJ,WAAW,CAAC,CAAC;EAEvC,MAAM2N,gBAAgB,GAAG7b,WAAW,CAAC,MAAM;IACzC,IAAI,CAACsO,oBAAoB,EAAE;IAC3B2B,aAAa,CAAC3B,oBAAoB,CAAC;EACrC,CAAC,EAAE,CAACA,oBAAoB,CAAC,CAAC;EAE1B,MAAMwN,iBAAiB,GAAG9b,WAAW,CAAC,MAAM;IAAA,IAAA+b,qBAAA;IAC1C,IAAI,CAAC/L,UAAU,EAAE;IAEjB,MAAMgM,aAAa,GAAGhM,UAAU,CAAC0F,OAAO;IACxC,MAAMuG,YAAY,GAAGlG,gBAAgB,CAACiG,aAAa,EAAE9N,WAAW,EAAE8B,UAAU,CAAChI,QAAQ,CAAC;;IAEtF;IACA,IAAIiU,YAAY,CAAC5F,YAAY,IAAI,EAAA0F,qBAAA,GAAAE,YAAY,CAAC3F,aAAa,cAAAyF,qBAAA,uBAA1BA,qBAAA,CAA4BrV,MAAM,IAAG,CAAC,EAAE;MACvEsQ,iBAAiB,CAACiF,YAAY,CAAC3F,aAAa,EAAEtG,UAAU,CAAChI,QAAQ,CAAC;IACpE;IAEA,MAAMuN,OAAO,GAAG;MACd,GAAGvF,UAAU;MACbzI,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC9B+M,SAAS,EAAEuH,YAAY,CAACjI;IAC1B,CAAC;IAED/F,gBAAgB,CAACkJ,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE5B,OAAO,CAAC,CAAC;IAE5C,MAAM2G,UAAU,GAAG3G,OAAO,CAACb,SAAS,GAAGa,OAAO,CAACvN,QAAQ;IACvD,IAAIkU,UAAU,GAAG9N,aAAa,EAAE;MAC9BC,gBAAgB,CAAC6N,UAAU,GAAG,EAAE,CAAC;IACnC;IAEA3N,uBAAuB,CAACgH,OAAO,CAAC;EAClC,CAAC,EAAE,CAACvF,UAAU,EAAE9B,WAAW,EAAE6H,gBAAgB,EAAEiB,iBAAiB,EAAE5I,aAAa,CAAC,CAAC;EAEjF,MAAM+N,kBAAkB,GAAGnc,WAAW,CAAC,MAAM;IAC3C,IAAI,CAACsO,oBAAoB,EAAE;IAC3B0J,kBAAkB,CAAC1J,oBAAoB,CAAC/G,EAAE,CAAC;EAC7C,CAAC,EAAE,CAAC+G,oBAAoB,CAAC,CAAC;;EAE1B;EACA,MAAM8N,cAAc,GAAGpc,WAAW,CAAC,MAAM;IACvC,IAAIyS,qBAAqB,CAAC+B,OAAO,EAAE;MACjC6H,aAAa,CAAC5J,qBAAqB,CAAC+B,OAAO,CAAC;MAC5C/B,qBAAqB,CAAC+B,OAAO,GAAG,IAAI;IACtC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM8H,eAAe,GAAGtc,WAAW,CAAC,CAACuc,SAAS,EAAEC,KAAK,GAAG,CAAC,KAAK;IAC5DJ,cAAc,CAAC,CAAC;IAEhB3J,qBAAqB,CAAC+B,OAAO,GAAGiI,WAAW,CAAC,MAAM;MAChD,IAAIxK,iBAAiB,CAACuC,OAAO,EAAE;QAC7B,MAAMkI,YAAY,GAAG,EAAE,GAAGF,KAAK;QAC/B,MAAMG,iBAAiB,GAAG1K,iBAAiB,CAACuC,OAAO,CAACoI,UAAU;QAC9D,MAAMC,SAAS,GAAG5K,iBAAiB,CAACuC,OAAO,CAACsI,WAAW,GAAG7K,iBAAiB,CAACuC,OAAO,CAACuI,WAAW;QAE/F,IAAIR,SAAS,KAAK,MAAM,IAAII,iBAAiB,GAAG,CAAC,EAAE;UACjD1K,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,GAAGlV,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEyI,iBAAiB,GAAGD,YAAY,CAAC;QACtF,CAAC,MAAM,IAAIH,SAAS,KAAK,OAAO,IAAII,iBAAiB,GAAGE,SAAS,EAAE;UACjE5K,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,GAAGlV,IAAI,CAACyM,GAAG,CAAC0I,SAAS,EAAEF,iBAAiB,GAAGD,YAAY,CAAC;QAC9F;MACF;IACF,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;EACV,CAAC,EAAE,CAACN,cAAc,CAAC,CAAC;EAEpB,MAAMY,eAAe,GAAGhd,WAAW,CAAEqZ,OAAO,IAAK;IAC/C,IAAI,CAACpH,iBAAiB,CAACuC,OAAO,EAAE;IAEhC,MAAM0F,IAAI,GAAGjI,iBAAiB,CAACuC,OAAO,CAACwE,qBAAqB,CAAC,CAAC;IAC9D,MAAMiE,eAAe,GAAG,GAAG;IAC3B,MAAMC,SAAS,GAAG7D,OAAO,GAAGa,IAAI,CAACZ,IAAI;IAErC,IAAI4D,SAAS,GAAGD,eAAe,IAAIhL,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,GAAG,CAAC,EAAE;MAC3E,MAAMJ,KAAK,GAAG,CAACS,eAAe,GAAGC,SAAS,IAAID,eAAe,GAAG,CAAC;MACjEX,eAAe,CAAC,MAAM,EAAEE,KAAK,CAAC;IAChC,CAAC,MACI,IAAIU,SAAS,GAAGhD,IAAI,CAAC9R,KAAK,GAAG6U,eAAe,EAAE;MACjD,MAAMJ,SAAS,GAAG5K,iBAAiB,CAACuC,OAAO,CAACsI,WAAW,GAAG7K,iBAAiB,CAACuC,OAAO,CAACuI,WAAW;MAC/F,IAAI9K,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,GAAGC,SAAS,EAAE;QACpD,MAAML,KAAK,GAAG,CAACU,SAAS,IAAIhD,IAAI,CAAC9R,KAAK,GAAG6U,eAAe,CAAC,IAAIA,eAAe,GAAG,CAAC;QAChFX,eAAe,CAAC,OAAO,EAAEE,KAAK,CAAC;MACjC;IACF,CAAC,MACI;MACHJ,cAAc,CAAC,CAAC;IAClB;EACF,CAAC,EAAE,CAACE,eAAe,EAAEF,cAAc,CAAC,CAAC;;EAErC;EACA,MAAMe,MAAM,GAAGA,CAAA,KAAM;IACnB1O,eAAe,CAAC0I,IAAI,IAAIzP,IAAI,CAACyM,GAAG,CAAC,EAAE,EAAEgD,IAAI,GAAG,GAAG,CAAC,CAAC;EACnD,CAAC;EAED,MAAMiG,OAAO,GAAGA,CAAA,KAAM;IACpB3O,eAAe,CAAC0I,IAAI,IAAIzP,IAAI,CAACwM,GAAG,CAAC,GAAG,EAAEiD,IAAI,GAAG,GAAG,CAAC,CAAC;EACpD,CAAC;EAED,MAAMkG,SAAS,GAAGA,CAAA,KAAM;IACtB5O,eAAe,CAAC,CAAC,CAAC;EACpB,CAAC;;EAED;EACA,MAAM6O,iBAAiB,GAAGtd,WAAW,CAAC,CAAC4F,CAAC,EAAEgP,IAAI,EAAEgF,MAAM,KAAK;IACzDhU,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBhT,CAAC,CAACiT,eAAe,CAAC,CAAC;IACnB1I,aAAa,CAAC,IAAI,CAAC;IACnBE,eAAe,CAACuJ,MAAM,CAAC;IACvBrJ,aAAa,CAACqE,IAAI,CAAC;IACnBnE,mBAAmB,CAAC;MAClBiE,SAAS,EAAEE,IAAI,CAACF,SAAS;MACzB1M,QAAQ,EAAE4M,IAAI,CAAC5M;IACjB,CAAC,CAAC;;IAEF;IACA6H,qBAAqB,CAAC,KAAK,CAAC;IAC5BN,sBAAsB,CAAC,IAAI,CAAC;EAC9B,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMgO,eAAe,GAAGvd,WAAW,CAAC,MAAM;IACxCmQ,aAAa,CAAC,KAAK,CAAC;IACpBE,eAAe,CAAC,IAAI,CAAC;IACrBE,aAAa,CAAC,IAAI,CAAC;IACnBE,mBAAmB,CAAC,IAAI,CAAC;IACzB2L,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACA,cAAc,CAAC,CAAC;;EAEpB;EACA,MAAMoB,qBAAqB,GAAI5X,CAAC,IAAK;IACnC,IAAIsM,cAAc,CAACsC,OAAO,EAAE;MAC1BtC,cAAc,CAACsC,OAAO,CAACiJ,SAAS,GAAG7X,CAAC,CAAC1B,MAAM,CAACuZ,SAAS;IACvD;EACF,CAAC;EAED,MAAMC,uBAAuB,GAAI9X,CAAC,IAAK;IACrC,IAAIqM,iBAAiB,CAACuC,OAAO,EAAE;MAC7BvC,iBAAiB,CAACuC,OAAO,CAACiJ,SAAS,GAAG7X,CAAC,CAAC1B,MAAM,CAACuZ,SAAS;IAC1D;EACF,CAAC;EAED,MAAME,gBAAgB,GAAGA,CAAA,KAAM;IAC7B,MAAMC,SAAS,GAAGxP,aAAa,GAAG,EAAE,GAAGI,YAAY;IACnD,OAAO9G,IAAI,CAACwM,GAAG,CAAC0J,SAAS,EAAE,IAAI,CAAC;EAClC,CAAC;EAED,MAAMC,kBAAkB,GAAGA,CAAA,KAAM;IAC/B,OAAO,EAAE,GAAGrP,YAAY;EAC1B,CAAC;;EAED;;EAEA;EACA,MAAMsP,iBAAiB,GAAG,MAAO7Z,KAAK,IAAK;IACzC,IAAI,CAACwJ,cAAc,EAAE;MACnB1K,OAAO,CAACI,KAAK,CAAC,mBAAmB,CAAC;MAClC;IACF;IAEA,MAAM4G,KAAK,GAAG9F,KAAK,CAACC,MAAM,CAAC6F,KAAK,GAAGtD,KAAK,CAACsX,IAAI,CAAC9Z,KAAK,CAACC,MAAM,CAAC6F,KAAK,CAAC,GAAG,EAAE;IAEtE,KAAK,MAAM7C,IAAI,IAAI6C,KAAK,EAAE;MACxB,MAAMiU,MAAM,GAAGxW,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MACzCiG,iBAAiB,CAACuJ,IAAI,IAAI,IAAItJ,GAAG,CAAC,CAAC,GAAGsJ,IAAI,EAAE6G,MAAM,CAAC,CAAC,CAAC;MAErD,IAAI;QACF;QACA,MAAMvT,SAAS,GAAG,MAAMgC,YAAY,CAAChC,SAAS,CAAC,QAAQ,CAAC;QACxD,IAAI,CAACA,SAAS,EAAE;UACd,MAAMwT,SAAS,GAAG,MAAMxR,YAAY,CAAC/B,iBAAiB,CAAC,QAAQ,CAAC;UAChE,MAAM,IAAI/G,KAAK,CAAC,gCAAgCsa,SAAS,mBAAmB,CAAC;QAC/E;;QAEA;QACA,MAAMC,SAAS,GAAG,MAAMzR,YAAY,CAACxF,QAAQ,CAACC,IAAI,EAAE,QAAQ,CAAC;QAC7DnE,OAAO,CAACgB,GAAG,CAAC,8BAA8B,EAAEma,SAAS,CAAC;;QAEtD;QACA5Q,eAAe,CAAE6J,IAAI,KAAM;UACzB,GAAGA,IAAI;UACP7U,MAAM,EAAE,CAAC,GAAG6U,IAAI,CAAC7U,MAAM,EAAE4b,SAAS;QACpC,CAAC,CAAC,CAAC;MAEL,CAAC,CAAC,OAAO/a,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/C4K,eAAe,CAAC5K,KAAK,CAACS,OAAO,CAAC;MAChC,CAAC,SAAS;QACRgK,iBAAiB,CAACuJ,IAAI,IAAI;UACxB,MAAMgH,MAAM,GAAG,IAAItQ,GAAG,CAACsJ,IAAI,CAAC;UAC5BgH,MAAM,CAAC9T,MAAM,CAAC2T,MAAM,CAAC;UACrB,OAAOG,MAAM;QACf,CAAC,CAAC;MACJ;IACF;;IAEA;IACA,IAAIla,KAAK,CAACC,MAAM,EAAE;MAChBD,KAAK,CAACC,MAAM,CAACgB,KAAK,GAAG,EAAE;IACzB;EACF,CAAC;;EAED;EACA,MAAMkZ,iBAAiB,GAAG,MAAOna,KAAK,IAAK;IACzC,IAAI,CAACwJ,cAAc,EAAE;MACnB1K,OAAO,CAACI,KAAK,CAAC,mBAAmB,CAAC;MAClC;IACF;IAEA,MAAM4G,KAAK,GAAG9F,KAAK,CAACC,MAAM,CAAC6F,KAAK,GAAGtD,KAAK,CAACsX,IAAI,CAAC9Z,KAAK,CAACC,MAAM,CAAC6F,KAAK,CAAC,GAAG,EAAE;IAEtE,KAAK,MAAM7C,IAAI,IAAI6C,KAAK,EAAE;MACxB,MAAMiU,MAAM,GAAGxW,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MACzCiG,iBAAiB,CAACuJ,IAAI,IAAI,IAAItJ,GAAG,CAAC,CAAC,GAAGsJ,IAAI,EAAE6G,MAAM,CAAC,CAAC,CAAC;MAErD,IAAI;QACF;QACA,MAAMvT,SAAS,GAAG,MAAMgC,YAAY,CAAChC,SAAS,CAAC,QAAQ,CAAC;QACxD,IAAI,CAACA,SAAS,EAAE;UACd,MAAMwT,SAAS,GAAG,MAAMxR,YAAY,CAAC/B,iBAAiB,CAAC,QAAQ,CAAC;UAChE,MAAM,IAAI/G,KAAK,CAAC,gCAAgCsa,SAAS,mBAAmB,CAAC;QAC/E;;QAEA;QACA,MAAMC,SAAS,GAAG,MAAMzR,YAAY,CAACxF,QAAQ,CAACC,IAAI,EAAE,QAAQ,CAAC;QAC7DnE,OAAO,CAACgB,GAAG,CAAC,8BAA8B,EAAEma,SAAS,CAAC;;QAEtD;QACA5Q,eAAe,CAAE6J,IAAI,KAAM;UACzB,GAAGA,IAAI;UACP3U,MAAM,EAAE,CAAC,GAAG2U,IAAI,CAAC3U,MAAM,EAAE0b,SAAS;QACpC,CAAC,CAAC,CAAC;MAEL,CAAC,CAAC,OAAO/a,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/C4K,eAAe,CAAC5K,KAAK,CAACS,OAAO,CAAC;MAChC,CAAC,SAAS;QACRgK,iBAAiB,CAACuJ,IAAI,IAAI;UACxB,MAAMgH,MAAM,GAAG,IAAItQ,GAAG,CAACsJ,IAAI,CAAC;UAC5BgH,MAAM,CAAC9T,MAAM,CAAC2T,MAAM,CAAC;UACrB,OAAOG,MAAM;QACf,CAAC,CAAC;MACJ;IACF;;IAEA;IACA,IAAIla,KAAK,CAACC,MAAM,EAAE;MAChBD,KAAK,CAACC,MAAM,CAACgB,KAAK,GAAG,EAAE;IACzB;EACF,CAAC;;EAED;EACA,MAAMmZ,iBAAiB,GAAG,MAAOpa,KAAK,IAAK;IACzC,IAAI,CAACwJ,cAAc,EAAE;MACnB1K,OAAO,CAACI,KAAK,CAAC,mBAAmB,CAAC;MAClC;IACF;IAEA,MAAM4G,KAAK,GAAG9F,KAAK,CAACC,MAAM,CAAC6F,KAAK,GAAGtD,KAAK,CAACsX,IAAI,CAAC9Z,KAAK,CAACC,MAAM,CAAC6F,KAAK,CAAC,GAAG,EAAE;IAEtE,KAAK,MAAM7C,IAAI,IAAI6C,KAAK,EAAE;MACxB,MAAMiU,MAAM,GAAGxW,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MACzCiG,iBAAiB,CAACuJ,IAAI,IAAI,IAAItJ,GAAG,CAAC,CAAC,GAAGsJ,IAAI,EAAE6G,MAAM,CAAC,CAAC,CAAC;MAErD,IAAI;QACF;QACA,MAAMvT,SAAS,GAAG,MAAMgC,YAAY,CAAChC,SAAS,CAAC,QAAQ,CAAC;QACxD,IAAI,CAACA,SAAS,EAAE;UACd,MAAMwT,SAAS,GAAG,MAAMxR,YAAY,CAAC/B,iBAAiB,CAAC,QAAQ,CAAC;UAChE,MAAM,IAAI/G,KAAK,CAAC,gCAAgCsa,SAAS,mBAAmB,CAAC;QAC/E;;QAEA;QACA,MAAMC,SAAS,GAAG,MAAMzR,YAAY,CAACxF,QAAQ,CAACC,IAAI,EAAE,QAAQ,CAAC;QAC7DnE,OAAO,CAACgB,GAAG,CAAC,8BAA8B,EAAEma,SAAS,CAAC;;QAEtD;QACA5Q,eAAe,CAAE6J,IAAI,KAAM;UACzB,GAAGA,IAAI;UACP5U,MAAM,EAAE,CAAC,GAAG4U,IAAI,CAAC5U,MAAM,EAAE2b,SAAS;QACpC,CAAC,CAAC,CAAC;MAEL,CAAC,CAAC,OAAO/a,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/C4K,eAAe,CAAC5K,KAAK,CAACS,OAAO,CAAC;MAChC,CAAC,SAAS;QACRgK,iBAAiB,CAACuJ,IAAI,IAAI;UACxB,MAAMgH,MAAM,GAAG,IAAItQ,GAAG,CAACsJ,IAAI,CAAC;UAC5BgH,MAAM,CAAC9T,MAAM,CAAC2T,MAAM,CAAC;UACrB,OAAOG,MAAM;QACf,CAAC,CAAC;MACJ;IACF;;IAEA;IACA,IAAIla,KAAK,CAACC,MAAM,EAAE;MAChBD,KAAK,CAACC,MAAM,CAACgB,KAAK,GAAG,EAAE;IACzB;EACF,CAAC;;EAED;EACA,MAAMoZ,iBAAiB,GAAG,MAAAA,CAAOrG,MAAM,EAAEjR,IAAI,KAAK;IAChD,IAAI;MACF;MACA,MAAMyF,YAAY,CAACvC,UAAU,CAAC+N,MAAM,CAAC;MACrClV,OAAO,CAACgB,GAAG,CAAC,iCAAiC,EAAEkU,MAAM,CAAC;;MAEtD;MACA3K,eAAe,CAAE6J,IAAI,KAAM;QACzB,GAAGA,IAAI;QACP,CAACnQ,IAAI,GAAGmQ,IAAI,CAACnQ,IAAI,CAAC,CAAC4C,MAAM,CAAEgL,IAAI,IAAKA,IAAI,CAACrN,EAAE,KAAK0Q,MAAM;MACxD,CAAC,CAAC,CAAC;;MAEH;MACAhK,gBAAgB,CAACkJ,IAAI,IAAIA,IAAI,CAACvN,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAAC2J,OAAO,KAAKtG,MAAM,CAAC,CAAC;IAExE,CAAC,CAAC,OAAO9U,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtD4K,eAAe,CAAC5K,KAAK,CAACS,OAAO,CAAC;IAChC;EACF,CAAC;;EAED;EACA,MAAM4a,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,IAAI;MACF,MAAMlS,QAAQ,GAAG,MAAMG,YAAY,CAACxC,WAAW,CAAC,CAAC;MACjD,MAAMwU,QAAQ,GAAG,CAAC,GAAGnS,QAAQ,CAAChK,MAAM,EAAE,GAAGgK,QAAQ,CAAC/J,MAAM,EAAE,GAAG+J,QAAQ,CAAC9J,MAAM,CAAC;MAE7E,KAAK,MAAMoS,IAAI,IAAI6J,QAAQ,EAAE;QAC3B,MAAMhS,YAAY,CAACvC,UAAU,CAAC0K,IAAI,CAACrN,EAAE,CAAC;MACxC;MAEA+F,eAAe,CAAC;QAAEhL,MAAM,EAAE,EAAE;QAAEE,MAAM,EAAE,EAAE;QAAED,MAAM,EAAE;MAAG,CAAC,CAAC;MACvD0L,gBAAgB,CAAC,EAAE,CAAC;MACpBlL,OAAO,CAACgB,GAAG,CAAC,iBAAiB,CAAC;IAChC,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD;EACF,CAAC;;EAED;EACApD,SAAS,CAAC,MAAM;IACd,IAAI+Q,iBAAiB,IAAIE,iBAAiB,EAAE;MAC1CxF,QAAQ,CAACsH,gBAAgB,CAAC,WAAW,EAAEmH,sBAAsB,CAAC;MAC9DzO,QAAQ,CAACsH,gBAAgB,CAAC,SAAS,EAAEkI,oBAAoB,CAAC;MAC1DxP,QAAQ,CAACkT,IAAI,CAACC,KAAK,CAACC,MAAM,GAAG9N,iBAAiB,GAAG,UAAU,GAAG,WAAW;MAEzE,OAAO,MAAM;QACXtF,QAAQ,CAACuH,mBAAmB,CAAC,WAAW,EAAEkH,sBAAsB,CAAC;QACjEzO,QAAQ,CAACuH,mBAAmB,CAAC,SAAS,EAAEiI,oBAAoB,CAAC;QAC7DxP,QAAQ,CAACkT,IAAI,CAACC,KAAK,CAACC,MAAM,GAAG,EAAE;MACjC,CAAC;IACH;EACF,CAAC,EAAE,CAAC9N,iBAAiB,EAAEE,iBAAiB,EAAEiJ,sBAAsB,EAAEe,oBAAoB,CAAC,CAAC;;EAExF;EACAjb,SAAS,CAAC,MAAM;IACd,MAAM8e,eAAe,GAAIjZ,CAAC,IAAK;MAC7B,IAAI,CAACsK,UAAU,IAAI,CAACI,UAAU,IAAI,CAAC2B,iBAAiB,CAACuC,OAAO,EAAE;MAE9DwI,eAAe,CAACpX,CAAC,CAACyT,OAAO,CAAC;MAE1B,MAAMa,IAAI,GAAGjI,iBAAiB,CAACuC,OAAO,CAACwE,qBAAqB,CAAC,CAAC;MAC9D,MAAM8F,MAAM,GAAGlZ,CAAC,CAACyT,OAAO,GAAGa,IAAI,CAACZ,IAAI,GAAGrH,iBAAiB,CAACuC,OAAO,CAACoI,UAAU;MAC3E,MAAMmC,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;MAC5C,MAAM5J,OAAO,GAAG6K,MAAM,GAAGC,eAAe;MAExC9Q,gBAAgB,CAACkJ,IAAI,IAAIA,IAAI,CAACtN,GAAG,CAAC+K,IAAI,IAAI;QACxC,IAAIA,IAAI,CAACrN,EAAE,KAAK+I,UAAU,CAAC/I,EAAE,EAAE,OAAOqN,IAAI;QAE1C,MAAMoK,WAAW,GAAG,GAAG;QAEvB,IAAI5O,YAAY,KAAK,MAAM,EAAE;UAC3B,MAAM6O,SAAS,GAAGzO,gBAAgB,CAACkE,SAAS,GAAGlE,gBAAgB,CAACxI,QAAQ;UACxE,MAAMkX,YAAY,GAAGxX,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAExM,IAAI,CAACyM,GAAG,CAAC8K,SAAS,GAAGD,WAAW,EAAE/K,OAAO,CAAC,CAAC;UAC5E,MAAMkL,WAAW,GAAGF,SAAS,GAAGC,YAAY;UAE5C,OAAO;YACL,GAAGtK,IAAI;YACPF,SAAS,EAAEwK,YAAY;YACvBlX,QAAQ,EAAEmX;UACZ,CAAC;QAEH,CAAC,MAAM,IAAI/O,YAAY,KAAK,OAAO,EAAE;UACnC,MAAMgP,QAAQ,GAAG5O,gBAAgB,CAACkE,SAAS;UAC3C,MAAMwH,UAAU,GAAGxU,IAAI,CAACwM,GAAG,CAACkL,QAAQ,GAAGJ,WAAW,EAAE/K,OAAO,CAAC;UAC5D,MAAMkL,WAAW,GAAGjD,UAAU,GAAGkD,QAAQ;UAEzC,OAAO;YACL,GAAGxK,IAAI;YACP5M,QAAQ,EAAEmX;UACZ,CAAC;QACH;QAEA,OAAOvK,IAAI;MACb,CAAC,CAAC,CAAC;IACL,CAAC;IAED,MAAMyK,aAAa,GAAGA,CAAA,KAAM;MAC1B,IAAInP,UAAU,EAAE;QACdqN,eAAe,CAAC,CAAC;MACnB;IACF,CAAC;IAED,IAAIrN,UAAU,EAAE;MACd1E,QAAQ,CAACsH,gBAAgB,CAAC,WAAW,EAAE+L,eAAe,CAAC;MACvDrT,QAAQ,CAACsH,gBAAgB,CAAC,SAAS,EAAEuM,aAAa,CAAC;IACrD;IAEA,OAAO,MAAM;MACX7T,QAAQ,CAACuH,mBAAmB,CAAC,WAAW,EAAE8L,eAAe,CAAC;MAC1DrT,QAAQ,CAACuH,mBAAmB,CAAC,SAAS,EAAEsM,aAAa,CAAC;IACxD,CAAC;EACH,CAAC,EAAE,CAACnP,UAAU,EAAEI,UAAU,EAAEF,YAAY,EAAEI,gBAAgB,EAAEqN,kBAAkB,EAAEb,eAAe,EAAEO,eAAe,CAAC,CAAC;;EAElH;EACAxd,SAAS,CAAC,MAAM;IACd,MAAMqU,OAAO,GAAGC,yBAAyB,CAAC,CAAC;IAE3C,IAAID,OAAO,CAACS,SAAS,IAAIT,OAAO,CAACS,SAAS,CAACpP,GAAG,KAAKyJ,kBAAkB,EAAE;MACrEC,qBAAqB,CAACiF,OAAO,CAACS,SAAS,CAACpP,GAAG,CAAC;MAC5C,IAAI+M,QAAQ,CAACgC,OAAO,EAAE;QACpB,MAAMC,YAAY,GAAGvG,WAAW,GAAGkG,OAAO,CAACS,SAAS,CAACH,SAAS;QAC9DlC,QAAQ,CAACgC,OAAO,CAACtG,WAAW,GAAGxG,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEO,YAAY,CAAC;MAC1D;IACF,CAAC,MAAM,IAAI,CAACL,OAAO,CAACS,SAAS,IAAIT,OAAO,CAACtC,QAAQ,CAACgD,IAAI,CAACwK,CAAC,IAAIA,CAAC,CAACtY,IAAI,KAAK,OAAO,CAAC,EAAE;MAC/E,MAAMuY,UAAU,GAAGnL,OAAO,CAACtC,QAAQ,CAACgD,IAAI,CAACwK,CAAC,IAAIA,CAAC,CAACtY,IAAI,KAAK,OAAO,CAAC;MACjEmI,qBAAqB,CAACoQ,UAAU,CAAC9Z,GAAG,CAAC;IACvC,CAAC,MAAM,IAAI,CAAC2O,OAAO,CAACS,SAAS,IAAI,CAACT,OAAO,CAACtC,QAAQ,CAACgD,IAAI,CAACwK,CAAC,IAAIA,CAAC,CAACtY,IAAI,KAAK,OAAO,CAAC,EAAE;MAChFmI,qBAAqB,CAAC,IAAI,CAAC;IAC7B;IAEA,MAAMqQ,eAAe,GAAG,IAAI3R,GAAG,CAACuG,OAAO,CAACpI,KAAK,CAACnC,GAAG,CAAC+K,IAAI,IAAIA,IAAI,CAACrN,EAAE,CAAC,CAAC;IAEnE6K,gBAAgB,CAACoC,OAAO,CAACnI,OAAO,CAAC,CAACkI,YAAY,EAAEhN,EAAE,KAAK;MACrD,IAAI,CAACiY,eAAe,CAACvK,GAAG,CAAC1N,EAAE,CAAC,EAAE;QAC5B,IAAI,CAACgN,YAAY,CAACkL,MAAM,EAAE;UACxBlL,YAAY,CAAC2D,KAAK,CAAC,CAAC;QACtB;MACF;IACF,CAAC,CAAC;IAEF9D,OAAO,CAACpI,KAAK,CAACK,OAAO,CAACiI,SAAS,IAAI;MACjC,MAAMC,YAAY,GAAGS,kBAAkB,CAACV,SAAS,CAAC;MAClD,MAAMG,YAAY,GAAGvG,WAAW,GAAGoG,SAAS,CAACI,SAAS;MAEtDH,YAAY,CAAC3F,MAAM,GAAG,CAAC0F,SAAS,CAAC1F,MAAM,IAAI,CAAC,IAAIA,MAAM;MACtD2F,YAAY,CAACW,KAAK,GAAGpG,OAAO;MAE5B,IAAIE,SAAS,IAAIyF,YAAY,IAAI,CAAC,EAAE;QAClCU,aAAa,CAACb,SAAS,EAAEG,YAAY,CAAC;QACtC,IAAIF,YAAY,CAACkL,MAAM,EAAE;UACvBlL,YAAY,CAACmL,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC5c,OAAO,CAACI,KAAK,CAAC;QAC1C;MACF,CAAC,MAAM;QACL,IAAI,CAACoR,YAAY,CAACkL,MAAM,EAAE;UACxBlL,YAAY,CAAC2D,KAAK,CAAC,CAAC;QACtB;MACF;IACF,CAAC,CAAC;EAEJ,CAAC,EAAE,CAAChK,WAAW,EAAEF,aAAa,EAAEqG,yBAAyB,EAAErF,SAAS,EAAEJ,MAAM,EAAEE,OAAO,EAAEkG,kBAAkB,EAAEG,aAAa,EAAEjG,kBAAkB,CAAC,CAAC;EAE9InP,SAAS,CAAC,MAAM;IACd,IAAIiP,SAAS,EAAE;MACbmD,WAAW,CAACqC,OAAO,GAAGiI,WAAW,CAAC,MAAM;QACtCtO,cAAc,CAAEgJ,IAAI,IAAK;UACvB,MAAMlD,OAAO,GAAGkD,IAAI,GAAG,GAAG;UAC1B,IAAIlD,OAAO,IAAI7F,aAAa,EAAE;YAC5Ba,YAAY,CAAC,KAAK,CAAC;YACnB,OAAOb,aAAa;UACtB;UACA,OAAO6F,OAAO;QAChB,CAAC,CAAC;MACJ,CAAC,EAAE,GAAG,CAAC;IACT,CAAC,MAAM;MACL,IAAI9B,WAAW,CAACqC,OAAO,EAAE;QACvB6H,aAAa,CAAClK,WAAW,CAACqC,OAAO,CAAC;MACpC;IACF;IAEA,OAAO,MAAM;MACX,IAAIrC,WAAW,CAACqC,OAAO,EAAE;QACvB6H,aAAa,CAAClK,WAAW,CAACqC,OAAO,CAAC;MACpC;IACF,CAAC;EACH,CAAC,EAAE,CAACxF,SAAS,EAAEZ,aAAa,CAAC,CAAC;EAE9BrO,SAAS,CAAC,MAAM;IACd,IAAIyS,QAAQ,CAACgC,OAAO,IAAItF,kBAAkB,EAAE;MAC1C,MAAMkF,OAAO,GAAGC,yBAAyB,CAAC,CAAC;MAC3C,IAAID,OAAO,CAACS,SAAS,EAAE;QACrB,MAAMJ,YAAY,GAAGvG,WAAW,GAAGkG,OAAO,CAACS,SAAS,CAACH,SAAS;QAC9D,MAAMU,QAAQ,GAAG1N,IAAI,CAAC2N,GAAG,CAAC7C,QAAQ,CAACgC,OAAO,CAACtG,WAAW,GAAGuG,YAAY,CAAC;QAEtE,IAAIW,QAAQ,GAAG,GAAG,EAAE;UAClB5C,QAAQ,CAACgC,OAAO,CAACtG,WAAW,GAAGxG,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEO,YAAY,CAAC;QAC1D;QAEA,IAAIzF,SAAS,IAAIwD,QAAQ,CAACgC,OAAO,CAACiL,MAAM,EAAE;UACxCjN,QAAQ,CAACgC,OAAO,CAACkL,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC5c,OAAO,CAACI,KAAK,CAAC;QAC9C,CAAC,MAAM,IAAI,CAAC6L,SAAS,IAAI,CAACwD,QAAQ,CAACgC,OAAO,CAACiL,MAAM,EAAE;UACjDjN,QAAQ,CAACgC,OAAO,CAAC0D,KAAK,CAAC,CAAC;QAC1B;MACF;IACF;EACF,CAAC,EAAE,CAAChK,WAAW,EAAEgB,kBAAkB,EAAEmF,yBAAyB,EAAErF,SAAS,CAAC,CAAC;EAE3EjP,SAAS,CAAC,MAAM;IACd,MAAMyf,eAAe,GAAG,IAAI3R,GAAG,CAC7BG,aAAa,CACVpE,MAAM,CAACgL,IAAI,IAAIA,IAAI,CAAC5N,IAAI,KAAK,OAAO,CAAC,CACrC6C,GAAG,CAAC+K,IAAI,IAAIA,IAAI,CAACrN,EAAE,CACxB,CAAC;IAED6K,gBAAgB,CAACoC,OAAO,CAACnI,OAAO,CAAC,CAACkI,YAAY,EAAEhN,EAAE,KAAK;MACrD,IAAI,CAACiY,eAAe,CAACvK,GAAG,CAAC1N,EAAE,CAAC,EAAE;QAC5BgN,YAAY,CAAC2D,KAAK,CAAC,CAAC;QACpB3D,YAAY,CAAC1I,GAAG,GAAG,EAAE;QACrBuG,gBAAgB,CAACoC,OAAO,CAACnK,MAAM,CAAC9C,EAAE,CAAC;MACrC;IACF,CAAC,CAAC;EACJ,CAAC,EAAE,CAACyG,aAAa,CAAC,CAAC;;EAEnB;EACAjO,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACXqc,cAAc,CAAC,CAAC;IAClB,CAAC;EACH,CAAC,EAAE,CAACA,cAAc,CAAC,CAAC;;EAEpB;EACArc,SAAS,CAAC,MAAM;IACd,MAAM6f,aAAa,GAAIha,CAAC,IAAK;MAC3B,IAAIA,CAAC,CAAC1B,MAAM,CAAC2b,OAAO,KAAK,OAAO,IAAIja,CAAC,CAAC1B,MAAM,CAAC2b,OAAO,KAAK,UAAU,EAAE;QACnE;MACF;MAEA,IAAIja,CAAC,CAACX,GAAG,KAAK,QAAQ,IAAIW,CAAC,CAACX,GAAG,KAAK,WAAW,EAAE;QAC/CW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBuD,kBAAkB,CAAC,CAAC;MACtB;MAEA,IAAIvW,CAAC,CAACsV,OAAO,IAAItV,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QAC9BW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBwC,iBAAiB,CAAC,CAAC;MACrB;MAEA,IAAIxV,CAAC,CAACsV,OAAO,IAAItV,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QAC9BW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBiD,gBAAgB,CAAC,CAAC;MACpB;MAEA,IAAIjW,CAAC,CAACsV,OAAO,IAAItV,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QAC9BW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBkD,iBAAiB,CAAC,CAAC;MACrB;MAEA,IAAIlW,CAAC,CAACX,GAAG,KAAK,GAAG,IAAIW,CAAC,CAACka,IAAI,KAAK,OAAO,EAAE;QACvCla,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClB3J,YAAY,CAACkI,IAAI,IAAI,CAACA,IAAI,CAAC;MAC7B;MAEA,IAAIvR,CAAC,CAACX,GAAG,KAAK,WAAW,EAAE;QACzBW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClB,MAAMmH,IAAI,GAAGna,CAAC,CAACsV,OAAO,GAAG,CAAC,GAAGtV,CAAC,CAACoa,QAAQ,GAAG,CAAC,GAAG,GAAG;QACjDjM,MAAM,CAACrM,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEhG,WAAW,GAAG6R,IAAI,CAAC,CAAC;MACzC;MACA,IAAIna,CAAC,CAACX,GAAG,KAAK,YAAY,EAAE;QAC1BW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClB,MAAMmH,IAAI,GAAGna,CAAC,CAACsV,OAAO,GAAG,CAAC,GAAGtV,CAAC,CAACoa,QAAQ,GAAG,CAAC,GAAG,GAAG;QACjDjM,MAAM,CAACrM,IAAI,CAACyM,GAAG,CAAC/F,aAAa,EAAEF,WAAW,GAAG6R,IAAI,CAAC,CAAC;MACrD;MAEA,IAAIna,CAAC,CAACX,GAAG,KAAK,GAAG,IAAIW,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QAClCW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBuE,MAAM,CAAC,CAAC;MACV;MACA,IAAIvX,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QACjBW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBwE,OAAO,CAAC,CAAC;MACX;MACA,IAAIxX,CAAC,CAACX,GAAG,KAAK,GAAG,EAAE;QACjBW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClByE,SAAS,CAAC,CAAC;MACb;MAEA,IAAIzX,CAAC,CAACX,GAAG,KAAK,GAAG,IAAKW,CAAC,CAACoa,QAAQ,IAAIpa,CAAC,CAACX,GAAG,KAAK,GAAI,EAAE;QAClDW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClBjH,WAAW,CAAC,IAAI,CAAC;MACnB;MAEA,IAAI/L,CAAC,CAACX,GAAG,KAAK,QAAQ,EAAE;QACtBW,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClB,IAAIlH,QAAQ,EAAE;UACZC,WAAW,CAAC,KAAK,CAAC;QACpB,CAAC,MAAM,IAAIjB,eAAe,EAAE;UAC1BC,kBAAkB,CAAC,IAAI,CAAC;QAC1B;MACF;IACF,CAAC;IAED/N,MAAM,CAACkQ,gBAAgB,CAAC,SAAS,EAAE8M,aAAa,CAAC;IACjD,OAAO,MAAMhd,MAAM,CAACmQ,mBAAmB,CAAC,SAAS,EAAE6M,aAAa,CAAC;EACnE,CAAC,EAAE,CAACtR,oBAAoB,EAAE0B,UAAU,EAAE9B,WAAW,EAAEE,aAAa,EAAEsD,QAAQ,EAAEhB,eAAe,EAAEyL,kBAAkB,EAAEf,iBAAiB,EAAES,gBAAgB,EAAEC,iBAAiB,CAAC,CAAC;;EAEzK;EACA/b,SAAS,CAAC,MAAM;IACd,MAAMkgB,WAAW,GAAIra,CAAC,IAAK;MAAA,IAAAsa,oBAAA;MACzB,IAAIta,CAAC,CAACsV,OAAO,KAAAgF,oBAAA,GAAIlO,WAAW,CAACwC,OAAO,cAAA0L,oBAAA,eAAnBA,oBAAA,CAAqB9b,QAAQ,CAACwB,CAAC,CAAC1B,MAAM,CAAC,EAAE;QACxD0B,CAAC,CAACgT,cAAc,CAAC,CAAC;QAClB,IAAIhT,CAAC,CAACgV,MAAM,GAAG,CAAC,EAAE;UAChBuC,MAAM,CAAC,CAAC;QACV,CAAC,MAAM;UACLC,OAAO,CAAC,CAAC;QACX;MACF;IACF,CAAC;IAED5R,QAAQ,CAACsH,gBAAgB,CAAC,OAAO,EAAEmN,WAAW,EAAE;MAAEE,OAAO,EAAE;IAAM,CAAC,CAAC;IACnE,OAAO,MAAM3U,QAAQ,CAACuH,mBAAmB,CAAC,OAAO,EAAEkN,WAAW,CAAC;EACjE,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,aAAa,GAAGA,CAACC,SAAS,EAAE3L,SAAS,GAAG,IAAI,EAAEsH,aAAa,GAAG,IAAI,KAAK;IAC3E,IAAIjH,SAAS,EAAEW,OAAO;IAEtB,IAAI2K,SAAS,CAACrZ,IAAI,KAAK,OAAO,EAAE;MAC9B+N,SAAS,GAAGiH,aAAa,IAAIA,aAAa,CAACsE,UAAU,CAAC,SAAS,CAAC,GAAG,SAAS,GAAG,MAAM;MACrF5K,OAAO,GAAGsG,aAAa,IAAI,YAAY;IACzC,CAAC,MAAM,IAAIqE,SAAS,CAACrZ,IAAI,KAAK,OAAO,EAAE;MACrC+N,SAAS,GAAG,SAAS;MACrBW,OAAO,GAAGsG,aAAa,IAAI,WAAW;IACxC,CAAC,MAAM,IAAIqE,SAAS,CAACrZ,IAAI,KAAK,OAAO,EAAE;MACrC+N,SAAS,GAAG,OAAO;MACnBW,OAAO,GAAGsG,aAAa,IAAI,SAAS;IACtC;IAEA,MAAMhU,QAAQ,GAAGqY,SAAS,CAACrY,QAAQ,KAAKqY,SAAS,CAACrZ,IAAI,KAAK,OAAO,GAAG,CAAC,GAAG,EAAE,CAAC;IAE5E,MAAMuZ,cAAc,GAAG7L,SAAS,KAAK,IAAI,GACvCA,SAAS,GACT6C,yBAAyB,CAAC7B,OAAO,EAAE1N,QAAQ,CAAC;IAE9C,MAAMwY,eAAe,GAAG;MACtBjZ,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC9B4W,OAAO,EAAE8B,SAAS,CAAC9Y,EAAE;MACrBP,IAAI,EAAEqZ,SAAS,CAACrZ,IAAI;MACpBY,IAAI,EAAEyY,SAAS,CAACzY,IAAI;MACpBnC,GAAG,EAAE4a,SAAS,CAAC5a,GAAG;MAClBiP,SAAS,EAAE6L,cAAc;MACzBvY,QAAQ,EAAEA,QAAQ;MAClB0N,OAAO,EAAEA,OAAO;MAChBX,SAAS,EAAEA,SAAS;MACpBnG,MAAM,EAAE,CAAC;MACT0J,OAAO,EAAE;IACX,CAAC;IAEDrK,gBAAgB,CAAEkJ,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAEqJ,eAAe,CAAC,CAAC;IAEtD,MAAMtE,UAAU,GAAGsE,eAAe,CAAC9L,SAAS,GAAG8L,eAAe,CAACxY,QAAQ;IACvE,IAAIkU,UAAU,GAAG9N,aAAa,EAAE;MAC9BC,gBAAgB,CAAC6N,UAAU,GAAG,EAAE,CAAC;IACnC;EACF,CAAC;EAED,MAAMuE,eAAe,GAAGA,CAAA,KAAM;IAC5B,MAAMC,UAAU,GAAG,WAAWlZ,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IAC1CoK,SAAS,CAACsF,IAAI,KAAK;MACjB,GAAGA,IAAI;MACPrF,QAAQ,EAAE,CAAC,GAAGqF,IAAI,CAACrF,QAAQ,EAAE;QAC3BvK,EAAE,EAAEmZ,UAAU;QACd9Y,IAAI,EAAE,WAAWuP,IAAI,CAACrF,QAAQ,CAACpL,MAAM,GAAG,CAAC,EAAE;QAC3CM,IAAI,EAAE;MACR,CAAC;IACH,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAM2Z,aAAa,GAAGA,CAAA,KAAM;IAC1B,MAAMD,UAAU,GAAG,SAASlZ,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IACxCoK,SAAS,CAACsF,IAAI,KAAK;MACjB,GAAGA,IAAI;MACPnL,KAAK,EAAE,CAAC,GAAGmL,IAAI,CAACnL,KAAK,EAAE;QACrBzE,EAAE,EAAEmZ,UAAU;QACd9Y,IAAI,EAAE,SAASuP,IAAI,CAACnL,KAAK,CAACtF,MAAM,GAAG,CAAC,EAAE;QACtCM,IAAI,EAAE;MACR,CAAC;IACH,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAM4Z,mBAAmB,GAAIhb,CAAC,IAAK;IACjC,IAAI8J,UAAU,IAAIE,kBAAkB,IAAIM,UAAU,EAAE;IAEpD,MAAMgK,IAAI,GAAGjI,iBAAiB,CAACuC,OAAO,CAACwE,qBAAqB,CAAC,CAAC;IAC9D,MAAM6H,MAAM,GAAGjb,CAAC,CAACyT,OAAO,GAAGa,IAAI,CAACZ,IAAI,GAAGrH,iBAAiB,CAACuC,OAAO,CAACoI,UAAU;IAC3E,MAAMmC,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;IAC5C,MAAMiD,SAAS,GAAGD,MAAM,GAAG9B,eAAe;IAC1ChL,MAAM,CAAC+M,SAAS,CAAC;EACnB,CAAC;EAED,MAAMC,eAAe,GAAGA,CAACnb,CAAC,EAAEya,SAAS,KAAK;IACxChR,cAAc,CAACgR,SAAS,CAAC;IACzB1Q,aAAa,CAAC,IAAI,CAAC;IACnB/J,CAAC,CAACob,YAAY,CAACC,aAAa,GAAG,MAAM;IACrCrb,CAAC,CAACob,YAAY,CAACE,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC;EAC1C,CAAC;EAED,MAAMC,aAAa,GAAGA,CAAA,KAAM;IAC1B9R,cAAc,CAAC,IAAI,CAAC;IACpBI,cAAc,CAAC,IAAI,CAAC;IACpBE,aAAa,CAAC,KAAK,CAAC;EACtB,CAAC;EAED,MAAMyR,2BAA2B,GAAGA,CAACxb,CAAC,EAAE+V,YAAY,KAAK;IACvD,IAAIzL,UAAU,EAAE;MACdtK,CAAC,CAACgT,cAAc,CAAC,CAAC;MAClB;IACF;IAEAhT,CAAC,CAACiT,eAAe,CAAC,CAAC;IACnBtJ,sBAAsB,CAACoM,YAAY,CAAC;IACpC9L,qBAAqB,CAAC,IAAI,CAAC;IAE3B,MAAMqK,IAAI,GAAGjI,iBAAiB,CAACuC,OAAO,CAACwE,qBAAqB,CAAC,CAAC;IAC9D,MAAMqI,QAAQ,GAAGzb,CAAC,CAAC1B,MAAM,CAAC8U,qBAAqB,CAAC,CAAC;IACjDjJ,aAAa,CAACnK,CAAC,CAACyT,OAAO,GAAGgI,QAAQ,CAAC/H,IAAI,GAAGrH,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,CAAC;IAE/EhX,CAAC,CAACob,YAAY,CAACC,aAAa,GAAG,MAAM;IACrCrb,CAAC,CAACob,YAAY,CAACE,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC;EAC1C,CAAC;EAED,MAAMI,yBAAyB,GAAGA,CAAA,KAAM;IACtC/R,sBAAsB,CAAC,IAAI,CAAC;IAC5BE,cAAc,CAAC,IAAI,CAAC;IACpBI,qBAAqB,CAAC,KAAK,CAAC;IAC5BE,aAAa,CAAC,CAAC,CAAC;IAChBqM,cAAc,CAAC,CAAC;EAClB,CAAC;EAED,MAAMmF,cAAc,GAAI3b,CAAC,IAAK;IAC5B,IAAI,CAACwJ,WAAW,IAAI,CAACE,mBAAmB,EAAE;IAE1C1J,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBhT,CAAC,CAACob,YAAY,CAACQ,UAAU,GAAGpS,WAAW,GAAG,MAAM,GAAG,MAAM;IAEzD,IAAIE,mBAAmB,IAAIY,UAAU,EAAE;MACrC8M,eAAe,CAACpX,CAAC,CAACyT,OAAO,CAAC;IAC5B;IAEA,MAAMoI,YAAY,GAAGxP,iBAAiB,CAACuC,OAAO,CAACwE,qBAAqB,CAAC,CAAC;IACtE,MAAM0I,KAAK,GAAG9b,CAAC,CAACyT,OAAO,GAAGoI,YAAY,CAACnI,IAAI,GAAGrH,iBAAiB,CAACuC,OAAO,CAACoI,UAAU,IAAItN,mBAAmB,GAAGQ,UAAU,GAAG,CAAC,CAAC;IAC3H,MAAMiP,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;IAC5C,MAAM/G,QAAQ,GAAGpP,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEwN,KAAK,GAAG3C,eAAe,CAAC;IAErD,MAAM4C,KAAK,GAAG/b,CAAC,CAAC2T,OAAO,GAAGkI,YAAY,CAACjI,GAAG,GAAGvH,iBAAiB,CAACuC,OAAO,CAACiJ,SAAS;IAChF,MAAMmE,WAAW,GAAG,EAAE;IACtB,MAAMC,eAAe,GAAG,EAAE;IAE1B,MAAMC,SAAS,GAAGH,KAAK,GAAGE,eAAe;IACzC,MAAME,UAAU,GAAGra,IAAI,CAACyL,KAAK,CAAC2O,SAAS,GAAGF,WAAW,CAAC;IAEtD,MAAMI,SAAS,GAAG,CAAC,GAAGpQ,MAAM,CAACE,QAAQ,EAAE,GAAGF,MAAM,CAACG,IAAI,EAAE,GAAGH,MAAM,CAAC5F,KAAK,CAAC;IACvE,MAAMiW,WAAW,GAAGD,SAAS,CAACD,UAAU,CAAC;IAEzC,IAAI3S,WAAW,IAAI6S,WAAW,EAAE;MAC9B;MACA,MAAMja,QAAQ,GAAGoH,WAAW,CAACpH,QAAQ,KAAKoH,WAAW,CAACpI,IAAI,KAAK,OAAO,GAAG,CAAC,GAAG,EAAE,CAAC;MAChF,MAAMiV,YAAY,GAAGlG,gBAAgB,CAACkM,WAAW,CAAC1a,EAAE,EAAEuP,QAAQ,EAAE9O,QAAQ,CAAC;MAEzEyH,cAAc,CAAC;QACbuE,IAAI,EAAEiI,YAAY,CAACjI,IAAI;QACvBhM,QAAQ,EAAEA,QAAQ;QAClB0N,OAAO,EAAEuM,WAAW,CAAC1a,EAAE;QACvBwN,SAAS,EAAEkN,WAAW,CAACjb,IAAI;QAC3Bkb,OAAO,EAAE,IAAI;QACb7L,YAAY,EAAE4F,YAAY,CAAC5F,YAAY;QACvCC,aAAa,EAAE2F,YAAY,CAAC3F,aAAa,IAAI;MAC/C,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIhH,mBAAmB,IAAI2S,WAAW,EAAE;MAC7C;MACA,MAAMhG,YAAY,GAAGlG,gBAAgB,CACnCkM,WAAW,CAAC1a,EAAE,EACduP,QAAQ,EACRxH,mBAAmB,CAACtH,QAAQ,EAC5BsH,mBAAmB,CAAC/H,EACtB,CAAC;MAEDkI,cAAc,CAAC;QACbuE,IAAI,EAAEiI,YAAY,CAACjI,IAAI;QACvBhM,QAAQ,EAAEsH,mBAAmB,CAACtH,QAAQ;QACtC0N,OAAO,EAAEuM,WAAW,CAAC1a,EAAE;QACvBwN,SAAS,EAAEkN,WAAW,CAACjb,IAAI;QAC3Bkb,OAAO,EAAE,IAAI;QACb7L,YAAY,EAAE4F,YAAY,CAAC5F,YAAY;QACvCC,aAAa,EAAE2F,YAAY,CAAC3F,aAAa,IAAI;MAC/C,CAAC,CAAC;IACJ;EACF,CAAC;EAED,MAAM6L,UAAU,GAAIvc,CAAC,IAAK;IAAA,IAAAwc,qBAAA;IACxB,IAAK,CAAChT,WAAW,IAAI,CAACE,mBAAmB,IAAK,CAACE,WAAW,EAAE;IAE5D5J,CAAC,CAACgT,cAAc,CAAC,CAAC;IAClBwD,cAAc,CAAC,CAAC;IAEhBrZ,OAAO,CAACgB,GAAG,CAAC,uBAAuB,EAAE;MACnCyL,WAAW;MACX6G,YAAY,EAAE7G,WAAW,CAAC6G,YAAY;MACtCC,aAAa,EAAE,EAAA8L,qBAAA,GAAA5S,WAAW,CAAC8G,aAAa,cAAA8L,qBAAA,uBAAzBA,qBAAA,CAA2B1b,MAAM,KAAI;IACtD,CAAC,CAAC;IAEF,IAAI8I,WAAW,CAAC0S,OAAO,EAAE;MACvB,IAAI9S,WAAW,EAAE;QAAA,IAAAiT,sBAAA;QACf;QACA,IAAI7S,WAAW,CAAC6G,YAAY,IAAI,EAAAgM,sBAAA,GAAA7S,WAAW,CAAC8G,aAAa,cAAA+L,sBAAA,uBAAzBA,sBAAA,CAA2B3b,MAAM,IAAG,CAAC,EAAE;UACrE;UACAsQ,iBAAiB,CAACxH,WAAW,CAAC8G,aAAa,EAAE9G,WAAW,CAACxH,QAAQ,CAAC;QACpE;;QAEA;QACAoY,aAAa,CAAChR,WAAW,EAAEI,WAAW,CAACwE,IAAI,EAAExE,WAAW,CAACkG,OAAO,CAAC;QAEjE3S,OAAO,CAACgB,GAAG,CAAC,2BAA2B,EAAEyL,WAAW,CAAC6G,YAAY,CAAC;MAEpE,CAAC,MAAM,IAAI/G,mBAAmB,EAAE;QAAA,IAAAgT,sBAAA;QAC9B;QACA,IAAI9S,WAAW,CAAC6G,YAAY,IAAI,EAAAiM,sBAAA,GAAA9S,WAAW,CAAC8G,aAAa,cAAAgM,sBAAA,uBAAzBA,sBAAA,CAA2B5b,MAAM,IAAG,CAAC,EAAE;UACrE;UACAsQ,iBAAiB,CAACxH,WAAW,CAAC8G,aAAa,EAAEhH,mBAAmB,CAACtH,QAAQ,CAAC;QAC5E;;QAEA;QACAiG,gBAAgB,CAACkJ,IAAI,IAAIA,IAAI,CAACtN,GAAG,CAAC+K,IAAI,IACpCA,IAAI,CAACrN,EAAE,KAAK+H,mBAAmB,CAAC/H,EAAE,GAC9B;UACE,GAAGqN,IAAI;UACPF,SAAS,EAAElF,WAAW,CAACwE,IAAI;UAC3B0B,OAAO,EAAElG,WAAW,CAACkG,OAAO;UAC5BX,SAAS,EAAEvF,WAAW,CAACuF;QACzB,CAAC,GACDH,IACN,CAAC,CAAC;QAEF7R,OAAO,CAACgB,GAAG,CAAC,2BAA2B,EAAEyL,WAAW,CAAC6G,YAAY,CAAC;QAElE,MAAM6F,UAAU,GAAG1M,WAAW,CAACwE,IAAI,GAAG1E,mBAAmB,CAACtH,QAAQ;QAClE,IAAIkU,UAAU,GAAG9N,aAAa,EAAE;UAC9BC,gBAAgB,CAAC6N,UAAU,GAAG,EAAE,CAAC;QACnC;MACF;IACF;IAEAzM,cAAc,CAAC,IAAI,CAAC;IACpBJ,cAAc,CAAC,IAAI,CAAC;IACpBE,sBAAsB,CAAC,IAAI,CAAC;IAC5BI,aAAa,CAAC,KAAK,CAAC;IACpBE,qBAAqB,CAAC,KAAK,CAAC;EAC9B,CAAC;EAED,MAAM0S,eAAe,GAAI3c,CAAC,IAAK;IAAA,IAAA4c,qBAAA;IAC7B,IAAI,GAAAA,qBAAA,GAACxQ,WAAW,CAACwC,OAAO,cAAAgO,qBAAA,eAAnBA,qBAAA,CAAqBpe,QAAQ,CAACwB,CAAC,CAAC6c,aAAa,CAAC,GAAE;MACnDhT,cAAc,CAAC,IAAI,CAAC;MACpB2M,cAAc,CAAC,CAAC;IAClB;EACF,CAAC;EAED,MAAMsG,oBAAoB,GAAI9N,IAAI,IAAK;IACrC,MAAMoN,SAAS,GAAG,CAAC,GAAGpQ,MAAM,CAACE,QAAQ,EAAE,GAAGF,MAAM,CAACG,IAAI,EAAE,GAAGH,MAAM,CAAC5F,KAAK,CAAC;IACvE,MAAM+V,UAAU,GAAGC,SAAS,CAACW,SAAS,CAACC,KAAK,IAAIA,KAAK,CAACrb,EAAE,KAAKqN,IAAI,CAACc,OAAO,CAAC;IAC1E,MAAMqJ,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;IAE5C,OAAO;MACLvE,IAAI,EAAE,GAAG1E,IAAI,CAACF,SAAS,GAAGqK,eAAe,IAAI;MAC7C3W,KAAK,EAAE,GAAGwM,IAAI,CAAC5M,QAAQ,GAAG+W,eAAe,IAAI;MAC7CvF,GAAG,EAAE,GAAGuI,UAAU,GAAG,EAAE,GAAG,EAAE;IAC9B,CAAC;EACH,CAAC;EAED,MAAMc,mBAAmB,GAAGA,CAAA,KAAM;IAChC,IAAI,CAACrT,WAAW,EAAE,OAAO,CAAC,CAAC;IAE3B,MAAMwS,SAAS,GAAG,CAAC,GAAGpQ,MAAM,CAACE,QAAQ,EAAE,GAAGF,MAAM,CAACG,IAAI,EAAE,GAAGH,MAAM,CAAC5F,KAAK,CAAC;IACvE,MAAM+V,UAAU,GAAGC,SAAS,CAACW,SAAS,CAACC,KAAK,IAAIA,KAAK,CAACrb,EAAE,KAAKiI,WAAW,CAACkG,OAAO,CAAC;IACjF,MAAMqJ,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;IAE5C,OAAO;MACLvE,IAAI,EAAE,GAAG9J,WAAW,CAACwE,IAAI,GAAG+K,eAAe,IAAI;MAC/C3W,KAAK,EAAE,GAAGoH,WAAW,CAACxH,QAAQ,GAAG+W,eAAe,IAAI;MACpDvF,GAAG,EAAE,GAAGuI,UAAU,GAAG,EAAE,GAAG,EAAE;IAC9B,CAAC;EACH,CAAC;EAED,MAAMe,aAAa,GAAI/N,SAAS,IAAK;IACnC,QAAQA,SAAS;MACf,KAAK,SAAS;QAAE,OAAO,iCAAiC;MACxD,KAAK,MAAM;QAAE,OAAO,6BAA6B;MACjD,KAAK,OAAO;QAAE,OAAO,+BAA+B;MACpD;QAAS,OAAO,6BAA6B;IAC/C;EACF,CAAC;EAED,oBACErT,OAAA;IAAKqhB,SAAS,EAAC,4DAA4D;IAAAC,QAAA,gBAEzEthB,OAAA;MAAKqhB,SAAS,EAAC,4HAA4H;MAAAC,QAAA,gBACzIthB,OAAA;QAAKqhB,SAAS,EAAC,+CAA+C;QAAAC,QAAA,gBAC5DthB,OAAA;UAAIqhB,SAAS,EAAC,2CAA2C;UAAAC,QAAA,gBACvDthB,OAAA,CAACzB,MAAM;YAACkH,IAAI,EAAE,EAAG;YAAC4b,SAAS,EAAC;UAAM;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,iBAErC,EAAC,CAAC3V,cAAc,iBACd/L,OAAA,CAACF,MAAM;YAAC2F,IAAI,EAAE,EAAG;YAAC4b,SAAS,EAAC;UAAmC;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAClE;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,EAGJ7V,WAAW,iBACV7L,OAAA;UAAKqhB,SAAS,EAAC,8DAA8D;UAAAC,QAAA,gBAC3EthB,OAAA;YAAAshB,QAAA,GACGzV,WAAW,CAACxC,KAAK,CAACC,WAAW,EAAC,iBAAU,EAACuC,WAAW,CAACrC,IAAI;UAAA;YAAA+X,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtD,CAAC,EACN7V,WAAW,CAACrC,IAAI,KAAK,UAAU,iBAC9BxJ,OAAA;YAAMqhB,SAAS,EAAC,6BAA6B;YAAAC,QAAA,EAAC;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAClE;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,EAGLtV,YAAY,iBACXpM,OAAA;QAAKqhB,SAAS,EAAC,yDAAyD;QAAAC,QAAA,gBACtEthB,OAAA,CAACJ,WAAW;UAAC6F,IAAI,EAAE,EAAG;UAAC4b,SAAS,EAAC;QAAiC;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACrE1hB,OAAA;UAAMqhB,SAAS,EAAC,sBAAsB;UAAAC,QAAA,EAAElV;QAAY;UAAAmV,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC5D1hB,OAAA;UACE2hB,OAAO,EAAEA,CAAA,KAAMtV,eAAe,CAAC,IAAI,CAAE;UACrCgV,SAAS,EAAC,yCAAyC;UAAAC,QAAA,eAEnDthB,OAAA,CAACL,CAAC;YAAC8F,IAAI,EAAE;UAAG;YAAA8b,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACT,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CACN,eAED1hB,OAAA;QAAKqhB,SAAS,EAAC,UAAU;QAAAC,QAAA,eACvBthB,OAAA;UAAKqhB,SAAS,EAAC,iCAAiC;UAAAC,QAAA,EAC7C,CACC;YAAEzb,EAAE,EAAE,QAAQ;YAAEK,IAAI,EAAE,QAAQ;YAAE0b,IAAI,EAAEjjB;UAAM,CAAC,EAC7C;YAAEkH,EAAE,EAAE,QAAQ;YAAEK,IAAI,EAAE,OAAO;YAAE0b,IAAI,EAAEhjB;UAAM,CAAC,EAC5C;YAAEiH,EAAE,EAAE,QAAQ;YAAEK,IAAI,EAAE,QAAQ;YAAE0b,IAAI,EAAEziB;UAAM,CAAC,CAC9C,CAACgJ,GAAG,CAAE0Z,GAAG,IAAK;YAAA,IAAAC,oBAAA,EAAAC,mBAAA;YACb,MAAMC,aAAa,GAAGH,GAAG,CAACD,IAAI;YAC9B,MAAMK,KAAK,GAAG,EAAAH,oBAAA,GAAAnW,YAAY,CAACkW,GAAG,CAAChc,EAAE,CAAC,cAAAic,oBAAA,uBAApBA,oBAAA,CAAsB9c,MAAM,KAAI,CAAC;YAC/C,MAAMkd,KAAK,GAAG,CAAArW,WAAW,aAAXA,WAAW,wBAAAkW,mBAAA,GAAXlW,WAAW,CAAElL,MAAM,cAAAohB,mBAAA,uBAAnBA,mBAAA,CAAsBF,GAAG,CAAChc,EAAE,CAAC,KAAI,CAAC;YAEhD,oBACE7F,OAAA;cAEE2hB,OAAO,EAAEA,CAAA,KAAM1U,YAAY,CAAC4U,GAAG,CAAChc,EAAE,CAAE;cACpCwb,SAAS,EAAE,yEACTrU,SAAS,KAAK6U,GAAG,CAAChc,EAAE,GAChB,kCAAkC,GAClC,mCAAmC,EACtC;cAAAyb,QAAA,gBAEHthB,OAAA,CAACgiB,aAAa;gBAACvc,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAa;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EAClDG,GAAG,CAAC3b,IAAI,EACR2F,WAAW,iBACV7L,OAAA;gBAAMqhB,SAAS,EAAE,gBAAgBY,KAAK,IAAIC,KAAK,GAAG,cAAc,GAAG,eAAe,EAAG;gBAAAZ,QAAA,GAAC,GACnF,EAACW,KAAK,EAAC,GAAC,EAACC,KAAK,EAAC,GAClB;cAAA;gBAAAX,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CACP;YAAA,GAdIG,GAAG,CAAChc,EAAE;cAAA0b,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAeL,CAAC;UAEb,CAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN1hB,OAAA;QAAKqhB,SAAS,EAAC,KAAK;QAAAC,QAAA,eAClBthB,OAAA;UACE2hB,OAAO,EAAEA,CAAA,KAAM;YAAA,IAAAQ,qBAAA,EAAAC,qBAAA,EAAAC,qBAAA;YACb,IAAI,CAACtW,cAAc,EAAE;YACrB,IAAIiB,SAAS,KAAK,QAAQ,EAAE,CAAAmV,qBAAA,GAAAxR,YAAY,CAACmC,OAAO,cAAAqP,qBAAA,uBAApBA,qBAAA,CAAsBG,KAAK,CAAC,CAAC,CAAC,KACrD,IAAItV,SAAS,KAAK,QAAQ,EAAE,CAAAoV,qBAAA,GAAAxR,aAAa,CAACkC,OAAO,cAAAsP,qBAAA,uBAArBA,qBAAA,CAAuBE,KAAK,CAAC,CAAC,CAAC,KAC3D,CAAAD,qBAAA,GAAAxR,aAAa,CAACiC,OAAO,cAAAuP,qBAAA,uBAArBA,qBAAA,CAAuBC,KAAK,CAAC,CAAC;UACrC,CAAE;UACFC,QAAQ,EAAE,CAACxW,cAAc,IAAKF,WAAW,IAAI,EAAAX,qBAAA,GAAAS,YAAY,CAACqB,SAAS,CAAC,cAAA9B,qBAAA,uBAAvBA,qBAAA,CAAyBlG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAG;UAC/GqU,SAAS,EAAE,+FACT,CAACtV,cAAc,IAAKF,WAAW,IAAI,EAAAV,sBAAA,GAAAQ,YAAY,CAACqB,SAAS,CAAC,cAAA7B,sBAAA,uBAAvBA,sBAAA,CAAyBnG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAE,GAChG,+CAA+C,GAC/C,2DAA2D,EAC9D;UAAAsU,QAAA,gBAEHthB,OAAA;YAAKqhB,SAAS,EAAE,wFACd,CAACtV,cAAc,IAAKF,WAAW,IAAI,EAAAT,sBAAA,GAAAO,YAAY,CAACqB,SAAS,CAAC,cAAA5B,sBAAA,uBAAvBA,sBAAA,CAAyBpG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAE,GAChG,aAAa,GACb,qCAAqC,EACxC;YAAAsU,QAAA,EACArV,cAAc,CAACxG,IAAI,GAAG,CAAC,gBACtBzF,OAAA,CAACF,MAAM;cAAC2F,IAAI,EAAE,EAAG;cAAC4b,SAAS,EAAC;YAA4B;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,gBAE3D1hB,OAAA,CAACzB,MAAM;cACLkH,IAAI,EAAE,EAAG;cACT4b,SAAS,EAAE,GACT,CAACtV,cAAc,IAAKF,WAAW,IAAI,EAAAR,sBAAA,GAAAM,YAAY,CAACqB,SAAS,CAAC,cAAA3B,sBAAA,uBAAvBA,sBAAA,CAAyBrG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAE,GAChG,eAAe,GACf,yCAAyC;YAC5C;cAAAuU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ;UACF;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eACN1hB,OAAA;YAAMqhB,SAAS,EAAE,uBACf,CAACtV,cAAc,IAAKF,WAAW,IAAI,EAAAP,sBAAA,GAAAK,YAAY,CAACqB,SAAS,CAAC,cAAA1B,sBAAA,uBAAvBA,sBAAA,CAAyBtG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAE,GAChG,eAAe,GACf,yCAAyC,EAC5C;YAAAsU,QAAA,EACA,CAACvV,cAAc,GAAG,iBAAiB,GACnCE,cAAc,CAACxG,IAAI,GAAG,CAAC,GAAG,cAAc,GACxCoG,WAAW,IAAI,EAAAN,sBAAA,GAAAI,YAAY,CAACqB,SAAS,CAAC,cAAAzB,sBAAA,uBAAvBA,sBAAA,CAAyBvG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAC,GAAG,cAAc,GAChG,UAAUA,SAAS,KAAK,QAAQ,GAAG,OAAO,GAAGA,SAAS,KAAK,QAAQ,GAAG,OAAO,GAAG,QAAQ;UAAE;YAAAuU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvF,CAAC,eACP1hB,OAAA;YAAGqhB,SAAS,EAAE,gBACZ,CAACtV,cAAc,IAAKF,WAAW,IAAI,EAAAL,sBAAA,GAAAG,YAAY,CAACqB,SAAS,CAAC,cAAAxB,sBAAA,uBAAvBA,sBAAA,CAAyBxG,MAAM,KAAI6G,WAAW,CAAClL,MAAM,CAACqM,SAAS,CAAE,GAChG,eAAe,GACf,eAAe,EAClB;YAAAsU,QAAA,EACAtU,SAAS,KAAK,QAAQ,GACnB,2BAA2B,GAC3BA,SAAS,KAAK,QAAQ,GACtB,2BAA2B,GAC3B;UAA0B;YAAAuU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7B,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eAEN1hB,OAAA;QACEwiB,GAAG,EAAE7R,YAAa;QAClBrL,IAAI,EAAC,MAAM;QACXmd,MAAM,EAAC,SAAS;QAChBC,QAAQ;QACRC,QAAQ,EAAEvG,iBAAkB;QAC5BiF,SAAS,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnB,CAAC,eACF1hB,OAAA;QACEwiB,GAAG,EAAE5R,aAAc;QACnBtL,IAAI,EAAC,MAAM;QACXmd,MAAM,EAAC,SAAS;QAChBC,QAAQ;QACRC,QAAQ,EAAEjG,iBAAkB;QAC5B2E,SAAS,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnB,CAAC,eACF1hB,OAAA;QACEwiB,GAAG,EAAE3R,aAAc;QACnBvL,IAAI,EAAC,MAAM;QACXmd,MAAM,EAAC,SAAS;QAChBC,QAAQ;QACRC,QAAQ,EAAEhG,iBAAkB;QAC5B0E,SAAS,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnB,CAAC,eAEF1hB,OAAA;QAAKqhB,SAAS,EAAC,kCAAkC;QAAAC,QAAA,eAC/CthB,OAAA;UAAKqhB,SAAS,EAAC,WAAW;UAAAC,QAAA,GACvB,EAAA7V,sBAAA,GAAAE,YAAY,CAACqB,SAAS,CAAC,cAAAvB,sBAAA,uBAAvBA,sBAAA,CAAyBtD,GAAG,CAAE+K,IAAI,iBACjClT,OAAA;YAEE4iB,SAAS,EAAC,MAAM;YAChBC,WAAW,EAAG3e,CAAC,IAAKmb,eAAe,CAACnb,CAAC,EAAEgP,IAAI,CAAE;YAC7C4P,SAAS,EAAErD,aAAc;YACzB4B,SAAS,EAAE,sJACT,CAAA3T,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAE7H,EAAE,MAAKqN,IAAI,CAACrN,EAAE,GAAG,YAAY,GAAG,EAAE,EAC9C;YACH8b,OAAO,EAAEA,CAAA,KAAMjD,aAAa,CAACxL,IAAI,CAAE;YAAAoO,QAAA,gBAEnCthB,OAAA;cAAKqhB,SAAS,EAAC,kGAAkG;cAAAC,QAAA,GAC9GtU,SAAS,KAAK,QAAQ,iBACrBhN,OAAA,CAACrB,KAAK;gBAAC8G,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAC7C,EACA1U,SAAS,KAAK,QAAQ,iBACrBhN,OAAA,CAACpB,KAAK;gBAAC6G,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAgB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAC9C,EACA1U,SAAS,KAAK,QAAQ,iBACrBhN,OAAA,CAACb,KAAK;gBAACsG,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAiB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAC/C;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,eACN1hB,OAAA;cAAKqhB,SAAS,EAAC,gBAAgB;cAAAC,QAAA,gBAC7BthB,OAAA;gBAAGqhB,SAAS,EAAC,4CAA4C;gBAAAC,QAAA,EACtDpO,IAAI,CAAChN;cAAI;gBAAAqb,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACT,CAAC,eACJ1hB,OAAA;gBAAKqhB,SAAS,EAAC,yDAAyD;gBAAAC,QAAA,gBACtEthB,OAAA;kBAAAshB,QAAA,EACGtU,SAAS,KAAK,QAAQ,GACnBkG,IAAI,CAACxM,KAAK,IAAIwM,IAAI,CAACvM,MAAM,GACvB,GAAGuM,IAAI,CAACxM,KAAK,IAAIwM,IAAI,CAACvM,MAAM,IAAI,GAChC,OAAO,GACT2K,UAAU,CAAC4B,IAAI,CAAC5M,QAAQ,IAAI,CAAC;gBAAC;kBAAAib,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC9B,CAAC,EACNxO,IAAI,CAACzN,IAAI,iBACRzF,OAAA;kBAAAshB,QAAA,EAAOzP,cAAc,CAACqB,IAAI,CAACzN,IAAI;gBAAC;kBAAA8b,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CACxC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACN1hB,OAAA;cACE2hB,OAAO,EAAGzd,CAAC,IAAK;gBACdA,CAAC,CAACiT,eAAe,CAAC,CAAC;gBACnByF,iBAAiB,CAAC1J,IAAI,CAACrN,EAAE,EAAEmH,SAAS,CAAC;cACvC,CAAE;cACFqU,SAAS,EAAC,8HAA8H;cAAAC,QAAA,eAExIthB,OAAA,CAACf,MAAM;gBAACwG,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACd,CAAC;UAAA,GA7CJxO,IAAI,CAACrN,EAAE;YAAA0b,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OA8CT,CACN,CAAC,KAAI,EAAE,EAEP,EAAAhW,sBAAA,GAAAC,YAAY,CAACqB,SAAS,CAAC,cAAAtB,sBAAA,uBAAvBA,sBAAA,CAAyB1G,MAAM,MAAK,CAAC,IAAI+G,cAAc,iBACtD/L,OAAA;YAAKqhB,SAAS,EAAC,kBAAkB;YAAAC,QAAA,gBAC/BthB,OAAA;cAAKqhB,SAAS,EAAC,iFAAiF;cAAAC,QAAA,GAC7FtU,SAAS,KAAK,QAAQ,iBAAIhN,OAAA,CAACrB,KAAK;gBAAC8G,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EACvE1U,SAAS,KAAK,QAAQ,iBAAIhN,OAAA,CAACpB,KAAK;gBAAC6G,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EACvE1U,SAAS,KAAK,QAAQ,iBAAIhN,OAAA,CAACb,KAAK;gBAACsG,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrE,CAAC,eACN1hB,OAAA;cAAGqhB,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAC,KAAG,EAACtU,SAAS,EAAC,eAAa;YAAA;cAAAuU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACpE1hB,OAAA;cAAGqhB,SAAS,EAAC,4BAA4B;cAAAC,QAAA,EAAC;YAAyB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpE,CACN,EAEA,CAAC3V,cAAc,iBACd/L,OAAA;YAAKqhB,SAAS,EAAC,kBAAkB;YAAAC,QAAA,gBAC/BthB,OAAA,CAACF,MAAM;cAAC2F,IAAI,EAAE,EAAG;cAAC4b,SAAS,EAAC;YAAyC;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACxE1hB,OAAA;cAAGqhB,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAC;YAAuB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7D,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAGLqB,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAIpX,WAAW,iBACpD7L,OAAA;QAAKqhB,SAAS,EAAC,yCAAyC;QAAAC,QAAA,eACtDthB,OAAA;UAAKqhB,SAAS,EAAC,iCAAiC;UAAAC,QAAA,gBAC9CthB,OAAA;YAAAshB,QAAA,GAAK,QAAM,EAACzV,WAAW,CAACrC,IAAI;UAAA;YAAA+X,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACnC1hB,OAAA;YAAAshB,QAAA,GAAK,SAAO,EAACzV,WAAW,CAACxC,KAAK,CAACC,WAAW,EAAC,IAAE;UAAA;YAAAiY,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACnD1hB,OAAA;YACE2hB,OAAO,EAAE7E,YAAa;YACtBuE,SAAS,EAAC,2CAA2C;YAAAC,QAAA,EACtD;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGN1hB,OAAA;MAAKqhB,SAAS,EAAC,oDAAoD;MAAAC,QAAA,gBAEjEthB,OAAA;QACEwiB,GAAG,EAAExR,iBAAkB;QACvBqQ,SAAS,EAAC,wEAAwE;QAClF6B,KAAK,EAAC,mGAAmG;QAAA5B,QAAA,GAExG9T,kBAAkB,gBACjBxN,OAAA;UACEqhB,SAAS,EAAC,wBAAwB;UAClCM,OAAO,EAAGzd,CAAC,IAAK;YACd;YACA,IAAIA,CAAC,CAAC1B,MAAM,KAAK0B,CAAC,CAACsT,aAAa,EAAE;cAChCvI,kBAAkB,CAAC,IAAI,CAAC;YAC1B;UACF,CAAE;UAAAqS,QAAA,GAED3O,yBAAyB,CAAC,CAAC,CAACQ,SAAS,gBACpCnT,OAAA;YACEwiB,GAAG,EAAE1R,QAAS;YACd3G,GAAG,EAAEqD,kBAAmB;YACxB6T,SAAS,EAAC,0CAA0C;YACpD7N,KAAK,EAAEpG;UAAQ;YAAAmU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChB,CAAC,gBAEF1hB,OAAA;YACEmK,GAAG,EAAEqD,kBAAmB;YACxB2V,GAAG,EAAC,kBAAkB;YACtB9B,SAAS,EAAC;UAA0C;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrD,CACF,EAEA/O,yBAAyB,CAAC,CAAC,CAACvC,QAAQ,CAACjI,GAAG,CAAC,CAAC+K,IAAI,EAAEnL,KAAK,KAAK;YACzD,MAAM2P,SAAS,GAAGjB,mBAAmB,CAACvD,IAAI,CAACrN,EAAE,CAAC;YAC9C,MAAMud,UAAU,GAAG,CAAApU,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEnJ,EAAE,MAAKqN,IAAI,CAACrN,EAAE;YAClD,MAAMwd,cAAc,GAAGjU,iBAAiB,IAAIgU,UAAU;YACtD,MAAME,cAAc,GAAGhU,iBAAiB,IAAI8T,UAAU;YAEtD,oBACEpjB,OAAA;cAEEqhB,SAAS,EAAE,wBACT+B,UAAU,GAAG,gDAAgD,GAAG,wDAAwD,IACtHC,cAAc,GAAG,sBAAsB,GAAGC,cAAc,GAAG,kBAAkB,GAAG,6BAA6B,EAAG;cACpHrG,KAAK,EAAE;gBACLrF,IAAI,EAAE,GAAG,GAAG,GAAGF,SAAS,CAAChI,CAAC,IAAI;gBAC9BoI,GAAG,EAAE,GAAG,EAAE,GAAG/P,KAAK,GAAG,GAAG,GAAG2P,SAAS,CAAC/H,CAAC,IAAI;gBAC1CjJ,KAAK,EAAE,GAAG,GAAG,GAAGgR,SAAS,CAACf,KAAK,IAAI;gBACnChQ,MAAM,EAAE,GAAG,EAAE,GAAG+Q,SAAS,CAACf,KAAK,IAAI;gBACnCC,OAAO,EAAEc,SAAS,CAACd,OAAO;gBAC1B2M,MAAM,EAAEH,UAAU,GAAG,IAAI,GAAG,EAAE,GAAGrb,KAAK;gBACtC2P,SAAS,EAAE2L,cAAc,GAAG,aAAa,GAAG,UAAU;gBACtDG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;cAC1D,CAAE;cACFG,WAAW,EAAGvf,CAAC,IAAK6S,sBAAsB,CAAC7S,CAAC,EAAE;gBAAC,GAAGgP,IAAI;gBAAEnL;cAAK,CAAC,CAAE;cAChE2b,OAAO,EAAGxf,CAAC,IAAKqV,kBAAkB,CAACrV,CAAC,EAAEgP,IAAI,CAACrN,EAAE,CAAE;cAAAyb,QAAA,eAE/CthB,OAAA;gBAAKqhB,SAAS,EAAE,8EACd+B,UAAU,GAAG,iBAAiB,GAAG,oCAAoC,EACpE;gBACHnG,KAAK,EAAE;kBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;gBAC1D,CAAE;gBAAAhC,QAAA,GACCpO,IAAI,CAAC5N,IAAI,KAAK,OAAO,gBACpBtF,OAAA;kBACEmK,GAAG,EAAE+I,IAAI,CAACnP,GAAI;kBACdsd,SAAS,EAAC,gDAAgD;kBAC1D7N,KAAK;gBAAA;kBAAA+N,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACN,CAAC,gBAEF1hB,OAAA;kBACEmK,GAAG,EAAE+I,IAAI,CAACnP,GAAI;kBACdof,GAAG,EAAEjQ,IAAI,CAAChN,IAAK;kBACfmb,SAAS,EAAC,gDAAgD;kBAC1DuB,SAAS,EAAE;gBAAM;kBAAArB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAClB,CACF,eAGD1hB,OAAA;kBAAKqhB,SAAS,EAAE,iEACd+B,UAAU,GAAG,eAAe,GAAG,EAAE,EAChC;kBACHnG,KAAK,EAAE;oBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;kBAC1D;gBAAE;kBAAA/B,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,EAER0B,UAAU,iBACTpjB,OAAA,CAAAE,SAAA;kBAAAohB,QAAA,gBAEEthB,OAAA;oBACEqhB,SAAS,EAAE,wKACTiC,cAAc,IAAI1T,mBAAmB,KAAK,IAAI,GAAG,sBAAsB,GAAG,EAAE,EAC3E;oBACH6T,WAAW,EAAGvf,CAAC,IAAK+T,wBAAwB,CAAC/T,CAAC,EAAEgP,IAAI,EAAE,IAAI,CAAE;oBAC5D+J,KAAK,EAAE;sBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;oBAC1D;kBAAE;oBAAA/B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,eACP1hB,OAAA;oBACEqhB,SAAS,EAAE,yKACTiC,cAAc,IAAI1T,mBAAmB,KAAK,IAAI,GAAG,sBAAsB,GAAG,EAAE,EAC3E;oBACH6T,WAAW,EAAGvf,CAAC,IAAK+T,wBAAwB,CAAC/T,CAAC,EAAEgP,IAAI,EAAE,IAAI,CAAE;oBAC5D+J,KAAK,EAAE;sBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;oBAC1D;kBAAE;oBAAA/B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,eACP1hB,OAAA;oBACEqhB,SAAS,EAAE,2KACTiC,cAAc,IAAI1T,mBAAmB,KAAK,IAAI,GAAG,sBAAsB,GAAG,EAAE,EAC3E;oBACH6T,WAAW,EAAGvf,CAAC,IAAK+T,wBAAwB,CAAC/T,CAAC,EAAEgP,IAAI,EAAE,IAAI,CAAE;oBAC5D+J,KAAK,EAAE;sBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;oBAC1D;kBAAE;oBAAA/B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,eACP1hB,OAAA;oBACEqhB,SAAS,EAAE,4KACTiC,cAAc,IAAI1T,mBAAmB,KAAK,IAAI,GAAG,sBAAsB,GAAG,EAAE,EAC3E;oBACH6T,WAAW,EAAGvf,CAAC,IAAK+T,wBAAwB,CAAC/T,CAAC,EAAEgP,IAAI,EAAE,IAAI,CAAE;oBAC5D+J,KAAK,EAAE;sBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;oBAC1D;kBAAE;oBAAA/B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,eAGP1hB,OAAA;oBAAKqhB,SAAS,EAAC;kBAAuI;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC,eAG7J1hB,OAAA;oBAAKqhB,SAAS,EAAC,uHAAuH;oBAAAC,QAAA,eACpIthB,OAAA;sBAAKqhB,SAAS,EAAC,6BAA6B;sBAAAC,QAAA,gBAC1CthB,OAAA;wBAAMqhB,SAAS,EAAC,0CAA0C;wBAAAC,QAAA,EAAC;sBAAQ;wBAAAC,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAM,CAAC,eAC1E1hB,OAAA;wBACEsF,IAAI,EAAC,OAAO;wBACZmN,GAAG,EAAC,KAAK;wBACTD,GAAG,EAAC,GAAG;wBACP6L,IAAI,EAAC,MAAM;wBACX7a,KAAK,EAAEkU,SAAS,CAACd,OAAQ;wBACzB+L,QAAQ,EAAGze,CAAC,IAAK2S,sBAAsB,CAAC3D,IAAI,CAACrN,EAAE,EAAE;0BAAE+Q,OAAO,EAAE3E,UAAU,CAAC/N,CAAC,CAAC1B,MAAM,CAACgB,KAAK;wBAAE,CAAC,CAAE;wBAC1F6d,SAAS,EAAC,2CAA2C;wBACrDoC,WAAW,EAAGvf,CAAC,IAAKA,CAAC,CAACiT,eAAe,CAAC;sBAAE;wBAAAoK,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACzC,CAAC,eACF1hB,OAAA;wBAAMqhB,SAAS,EAAC,iDAAiD;wBAAAC,QAAA,GAC9Dtb,IAAI,CAACuD,KAAK,CAACmO,SAAS,CAACd,OAAO,GAAG,GAAG,CAAC,EAAC,GACvC;sBAAA;wBAAA2K,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAM,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACJ;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACH,CAAC;gBAAA,eACN,CACH,eAGD1hB,OAAA;kBAAKqhB,SAAS,EAAE,8FACd+B,UAAU,GAAG,aAAa,GAAG,mCAAmC,EAC/D;kBACHnG,KAAK,EAAE;oBACLuG,UAAU,EAAEH,cAAc,IAAIC,cAAc,GAAG,MAAM,GAAG;kBAC1D,CAAE;kBAAAhC,QAAA,GACCpO,IAAI,CAAChN,IAAI,EAAC,UAAG,EAACF,IAAI,CAACuD,KAAK,CAACmO,SAAS,CAACf,KAAK,GAAG,GAAG,CAAC,EAAC,WAAI,EAAC3Q,IAAI,CAACuD,KAAK,CAACmO,SAAS,CAACd,OAAO,GAAG,GAAG,CAAC,EAAC,GAC5F;gBAAA;kBAAA2K,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,EAGL0B,UAAU,iBACTpjB,OAAA;kBAAKqhB,SAAS,EAAC;gBAA0H;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAChJ;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE;YAAC,GA7HDxO,IAAI,CAACrN,EAAE;cAAA0b,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OA8HT,CAAC;UAEV,CAAC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,gBAEN1hB,OAAA;UAAKqhB,SAAS,EAAC,2DAA2D;UAAAC,QAAA,eACxEthB,OAAA;YAAKqhB,SAAS,EAAC,aAAa;YAAAC,QAAA,gBAC1BthB,OAAA;cAAKqhB,SAAS,EAAC,iFAAiF;cAAAC,QAAA,eAC9FthB,OAAA,CAACZ,IAAI;gBAACqG,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAY;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACtC,CAAC,eACN1hB,OAAA;cAAGqhB,SAAS,EAAC,gCAAgC;cAAAC,QAAA,EAAC;YAE9C;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACJ1hB,OAAA;cAAGqhB,SAAS,EAAC,yBAAyB;cAAAC,QAAA,EAAC;YAEvC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACJ1hB,OAAA;cAAKqhB,SAAS,EAAC,8BAA8B;cAAAC,QAAA,gBAC3CthB,OAAA;gBAAAshB,QAAA,EAAG;cAAiD;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eACxD1hB,OAAA;gBAAAshB,QAAA,GAAG,+BAAmB,EAAC,CAAAzV,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAErC,IAAI,KAAI,SAAS,EAAC,OAAK;cAAA;gBAAA+X,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eAC/D1hB,OAAA;gBAAAshB,QAAA,GAAG,QAAM,eAAAthB,OAAA;kBAAKqhB,SAAS,EAAC,yCAAyC;kBAAAC,QAAA,EAAC;gBAAC;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,yBAAqB;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC/F,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CACN,eAED1hB,OAAA;UAAKqhB,SAAS,EAAC,oGAAoG;UAAAC,QAAA,eACjHthB,OAAA;YAAKqhB,SAAS,EAAC,6BAA6B;YAAAC,QAAA,gBAC1CthB,OAAA;cACE2hB,OAAO,EAAEA,CAAA,KAAMtP,MAAM,CAACrM,IAAI,CAACwM,GAAG,CAAC,CAAC,EAAEhG,WAAW,GAAG,EAAE,CAAC,CAAE;cACrD6U,SAAS,EAAC,mFAAmF;cAC7F6B,KAAK,EAAC,sBAAsB;cAAA5B,QAAA,eAE5BthB,OAAA,CAACnB,QAAQ;gBAAC4G,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChB,CAAC,eACT1hB,OAAA;cACE2hB,OAAO,EAAEvP,eAAgB;cACzBiP,SAAS,EAAC,gIAAgI;cAC1I6B,KAAK,EAAC,oBAAoB;cAAA5B,QAAA,EAEzBhU,SAAS,gBAAGtN,OAAA,CAACvB,KAAK;gBAACgH,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,gBAAG1hB,OAAA,CAACxB,IAAI;gBAACiH,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC/C,CAAC,eACT1hB,OAAA;cACE2hB,OAAO,EAAEA,CAAA,KACPtP,MAAM,CAACrM,IAAI,CAACyM,GAAG,CAAC/F,aAAa,EAAEF,WAAW,GAAG,EAAE,CAAC,CACjD;cACD6U,SAAS,EAAC,mFAAmF;cAC7F6B,KAAK,EAAC,yBAAyB;cAAA5B,QAAA,eAE/BthB,OAAA,CAAClB,WAAW;gBAAC2G,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnB,CAAC,eACT1hB,OAAA;cAAKqhB,SAAS,EAAC,6BAA6B;cAAAC,QAAA,gBAC1CthB,OAAA;gBACE2hB,OAAO,EAAEA,CAAA,KAAMtU,UAAU,CAAC,CAACD,OAAO,CAAE;gBACpCiU,SAAS,EAAC,mFAAmF;gBAC7F6B,KAAK,EAAC,aAAa;gBAAA5B,QAAA,EAElBlU,OAAO,gBAAGpN,OAAA,CAACjB,OAAO;kBAAC0G,IAAI,EAAE;gBAAG;kBAAA8b,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,gBAAG1hB,OAAA,CAACtB,OAAO;kBAAC+G,IAAI,EAAE;gBAAG;kBAAA8b,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAClD,CAAC,eACT1hB,OAAA;gBACEsF,IAAI,EAAC,OAAO;gBACZmN,GAAG,EAAC,GAAG;gBACPD,GAAG,EAAC,GAAG;gBACP6L,IAAI,EAAC,KAAK;gBACV7a,KAAK,EAAE0J,MAAO;gBACdyV,QAAQ,EAAGze,CAAC,IAAKiJ,SAAS,CAAC8E,UAAU,CAAC/N,CAAC,CAAC1B,MAAM,CAACgB,KAAK,CAAC,CAAE;gBACvD6d,SAAS,EAAC,sBAAsB;gBAChC6B,KAAK,EAAC;cAAgB;gBAAA3B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACvB,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,eACN1hB,OAAA;cAAMqhB,SAAS,EAAC,wCAAwC;cAAC6B,KAAK,EAAC,+BAA+B;cAAA5B,QAAA,GAC3FhQ,UAAU,CAAC9E,WAAW,CAAC,EAAC,KAAG,EAAC8E,UAAU,CAAC5E,aAAa,CAAC;YAAA;cAAA6U,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGN1hB,OAAA;QACEqhB,SAAS,EAAE,wHACTrT,UAAU,IAAIE,kBAAkB,IAAIM,UAAU,GAC1C,+BAA+B,GAC/B,iBAAiB,EACpB;QAAA8S,QAAA,gBAEHthB,OAAA;UAAKqhB,SAAS,EAAC,mDAAmD;UAAAC,QAAA,gBAChEthB,OAAA;YAAKqhB,SAAS,EAAC,mCAAmC;YAAAC,QAAA,gBAChDthB,OAAA;cAAIqhB,SAAS,EAAC,yDAAyD;cAAAC,QAAA,gBACrEthB,OAAA,CAACZ,IAAI;gBAACqG,IAAI,EAAE;cAAG;gBAAA8b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAClB1hB,OAAA;gBAAAshB,QAAA,EAAM;cAAY;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,EACxB7V,WAAW,iBACV7L,OAAA;gBAAMqhB,SAAS,EAAE,kCACfxV,WAAW,CAACrC,IAAI,KAAK,WAAW,GAC5B,6BAA6B,GAC7B,+BAA+B,EAClC;gBAAA8X,QAAA,EACAzV,WAAW,CAACrC,IAAI,KAAK,WAAW,GAAG,cAAc,GAAG;cAAa;gBAAA+X,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC9D,CACP,EACA1T,UAAU,IAAIF,WAAW,iBACxB9N,OAAA;gBAAMqhB,SAAS,EAAC,gBAAgB;gBAAAC,QAAA,GAAC,aACrB,EAAC5T,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAExH,IAAI,EAAC,KAAE,EAAC4H,WAAW,CAAC6G,YAAY,GAAG,UAAU,GAAG,UAAU;cAAA;gBAAA4M,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC9E,CACP,EACAxT,kBAAkB,IAAIJ,WAAW,iBAChC9N,OAAA;gBAAMqhB,SAAS,EAAC,eAAe;gBAAAC,QAAA,GAAC,aACpB,EAAC1T,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAE1H,IAAI,EAAC,KAAE,EAAC4H,WAAW,CAAC6G,YAAY,GAAG,eAAe,GAAG,UAAU;cAAA;gBAAA4M,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3F,CACP,EACAlT,UAAU,IAAII,UAAU,iBACvB5O,OAAA;gBAAMqhB,SAAS,EAAC,iBAAiB;gBAAAC,QAAA,GAAC,eACpB,EAAC1S,UAAU,CAAC1I,IAAI,EAAC,MAAG,EAACwI,YAAY,EAAC,QAChD;cAAA;gBAAA6S,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CACP,EACApT,UAAU,iBACTtO,OAAA;gBAAMqhB,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,GAAC,MACnC,EAAChT,UAAU,CAACpI,IAAI,EAAC,6BACtB;cAAA;gBAAAqb,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CACP;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,eAEL1hB,OAAA;cAAKqhB,SAAS,EAAC,6BAA6B;cAAAC,QAAA,gBAC1CthB,OAAA;gBACE2hB,OAAO,EAAEA,CAAA,KAAM1R,WAAW,CAAC,IAAI,CAAE;gBACjCoR,SAAS,EAAC,+FAA+F;gBACzG6B,KAAK,EAAC,oFAA0E;gBAAA5B,QAAA,eAEhFthB,OAAA,CAACN,UAAU;kBAAC+F,IAAI,EAAE;gBAAG;kBAAA8b,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAClB,CAAC,eAET1hB,OAAA;gBAAKqhB,SAAS,EAAC,4EAA4E;gBAAAC,QAAA,gBACzFthB,OAAA;kBACE2hB,OAAO,EAAEjG,OAAQ;kBACjB2F,SAAS,EAAC,yDAAyD;kBACnE6B,KAAK,EAAC,cAAc;kBAAA5B,QAAA,eAEpBthB,OAAA,CAACR,OAAO;oBAACiG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACf,CAAC,eACT1hB,OAAA;kBAAMqhB,SAAS,EAAC,4CAA4C;kBAAAC,QAAA,GACzD,CAACxU,YAAY,GAAG,GAAG,EAAEqF,OAAO,CAAC,CAAC,CAAC,EAAC,GACnC;gBAAA;kBAAAoP,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACP1hB,OAAA;kBACE2hB,OAAO,EAAElG,MAAO;kBAChB4F,SAAS,EAAC,yDAAyD;kBACnE6B,KAAK,EAAC,4BAA4B;kBAAA5B,QAAA,eAElCthB,OAAA,CAACT,MAAM;oBAACkG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACd,CAAC,eACT1hB,OAAA;kBACE2hB,OAAO,EAAEhG,SAAU;kBACnB0F,SAAS,EAAC,yDAAyD;kBACnE6B,KAAK,EAAC,gBAAgB;kBAAA5B,QAAA,eAEtBthB,OAAA,CAACP,SAAS;oBAACgG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjB,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACN,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAEN1hB,OAAA;YAAKqhB,SAAS,EAAC,mCAAmC;YAAAC,QAAA,eAChDthB,OAAA;cAAKqhB,SAAS,EAAC,6BAA6B;cAAAC,QAAA,eAC1CthB,OAAA;gBAAKqhB,SAAS,EAAC,6BAA6B;gBAAAC,QAAA,gBAC1CthB,OAAA;kBACE2hB,OAAO,EAAE5C,eAAgB;kBACzBsC,SAAS,EAAC,qGAAqG;kBAC/G6B,KAAK,EAAC,mBAAmB;kBAAA5B,QAAA,eAEzBthB,OAAA,CAACX,IAAI;oBAACoG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACZ,CAAC,eACT1hB,OAAA;kBACE2hB,OAAO,EAAE1C,aAAc;kBACvBoC,SAAS,EAAC,kGAAkG;kBAC5G6B,KAAK,EAAC,iBAAiB;kBAAA5B,QAAA,eAEvBthB,OAAA,CAACpB,KAAK;oBAAC6G,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACb,CAAC,eACT1hB,OAAA;kBACE2hB,OAAO,EAAEjI,iBAAkB;kBAC3B6I,QAAQ,EAAE,CAAC3V,oBAAqB;kBAChCyU,SAAS,EAAE,8CACTzU,oBAAoB,GAChB,iDAAiD,GACjD,kCAAkC,EACrC;kBACHsW,KAAK,EAAC,0DAA0D;kBAAA5B,QAAA,eAEhEthB,OAAA,CAACd,QAAQ;oBAACuG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAChB,CAAC,eACT1hB,OAAA;kBACE2hB,OAAO,EAAExH,gBAAiB;kBAC1BoI,QAAQ,EAAE,CAAC3V,oBAAqB;kBAChCyU,SAAS,EAAE,8CACTzU,oBAAoB,GAChB,oDAAoD,GACpD,kCAAkC,EACrC;kBACHsW,KAAK,EAAC,sDAAsD;kBAAA5B,QAAA,eAE5DthB,OAAA,CAAChB,IAAI;oBAACyG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACZ,CAAC,eACT1hB,OAAA;kBACE2hB,OAAO,EAAElH,kBAAmB;kBAC5B8H,QAAQ,EAAE,CAAC3V,oBAAqB;kBAChCyU,SAAS,EAAE,8CACTzU,oBAAoB,GAChB,iDAAiD,GACjD,kCAAkC,EACrC;kBACHsW,KAAK,EAAC,6DAA6D;kBAAA5B,QAAA,eAEnEthB,OAAA,CAACf,MAAM;oBAACwG,IAAI,EAAE;kBAAG;oBAAA8b,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACd,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACN;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAEN1hB,OAAA;UAAKqhB,SAAS,EAAC,qBAAqB;UAAAC,QAAA,gBAClCthB,OAAA;YAAKqhB,SAAS,EAAC,sEAAsE;YAAAC,QAAA,gBACnFthB,OAAA;cAAKqhB,SAAS,EAAC;YAA6C;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAEnE1hB,OAAA;cACEwiB,GAAG,EAAEhS,cAAe;cACpB6Q,SAAS,EAAC,0CAA0C;cACpDsC,QAAQ,EAAE3H,uBAAwB;cAAAsF,QAAA,GAEjCpR,MAAM,CAACE,QAAQ,CAACjI,GAAG,CAAE+Y,KAAK,iBACzBlhB,OAAA;gBAEEqhB,SAAS,EAAC,qHAAqH;gBAC/HpE,KAAK,EAAE;kBAAEtW,MAAM,EAAE;gBAAO,CAAE;gBAAA2a,QAAA,gBAE1BthB,OAAA,CAACV,MAAM;kBAACmG,IAAI,EAAE,EAAG;kBAAC4b,SAAS,EAAC;gBAAM;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,EACpCR,KAAK,CAAChb,IAAI;cAAA,GALNgb,KAAK,CAACrb,EAAE;gBAAA0b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAMV,CACN,CAAC,EAEDxR,MAAM,CAACG,IAAI,CAAClI,GAAG,CAAE+Y,KAAK,iBACrBlhB,OAAA;gBAEEqhB,SAAS,EAAC,iHAAiH;gBAC3HpE,KAAK,EAAE;kBAAEtW,MAAM,EAAE;gBAAO,CAAE;gBAAA2a,QAAA,gBAE1BthB,OAAA,CAACrB,KAAK;kBAAC8G,IAAI,EAAE,EAAG;kBAAC4b,SAAS,EAAC;gBAAM;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,EACnCR,KAAK,CAAChb,IAAI;cAAA,GALNgb,KAAK,CAACrb,EAAE;gBAAA0b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAMV,CACN,CAAC,EAEDxR,MAAM,CAAC5F,KAAK,CAACnC,GAAG,CAAE+Y,KAAK,iBACtBlhB,OAAA;gBAEEqhB,SAAS,EAAC,mHAAmH;gBAC7HpE,KAAK,EAAE;kBAAEtW,MAAM,EAAE;gBAAO,CAAE;gBAAA2a,QAAA,gBAE1BthB,OAAA,CAACpB,KAAK;kBAAC6G,IAAI,EAAE,EAAG;kBAAC4b,SAAS,EAAC;gBAAM;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,EACnCR,KAAK,CAAChb,IAAI;cAAA,GALNgb,KAAK,CAACrb,EAAE;gBAAA0b,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAMV,CACN,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAEN1hB,OAAA;YACEwiB,GAAG,EAAGoB,EAAE,IAAK;cACXtT,WAAW,CAACwC,OAAO,GAAG8Q,EAAE;cACxBrT,iBAAiB,CAACuC,OAAO,GAAG8Q,EAAE;YAChC,CAAE;YACFvC,SAAS,EAAC,wCAAwC;YAClDsC,QAAQ,EAAE7H,qBAAsB;YAChC+H,UAAU,EAAEhE,cAAe;YAC3BiE,MAAM,EAAErD,UAAW;YACnBsD,WAAW,EAAElD,eAAgB;YAC7B5D,KAAK,EAAE;cACL+G,SAAS,EAAE,MAAM;cACjBC,SAAS,EAAE,MAAM;cACjBC,cAAc,EAAE;YAClB,CAAE;YAAA5C,QAAA,eAEFthB,OAAA;cACEid,KAAK,EAAE;gBACLvW,KAAK,EAAE,GAAGuV,gBAAgB,CAAC,CAAC,IAAI;gBAChCkI,SAAS,EAAE,MAAM;gBACjBC,QAAQ,EAAE;cACZ,CAAE;cACFzC,OAAO,EAAEzC,mBAAoB;cAAAoC,QAAA,gBAE7BthB,OAAA;gBAAKqhB,SAAS,EAAC,iEAAiE;gBAAAC,QAAA,GAC7Evc,KAAK,CAACsX,IAAI,CAAC;kBAAErX,MAAM,EAAEgB,IAAI,CAACqe,IAAI,CAAC3X,aAAa,GAAGI,YAAY,GAAG,CAAC,CAAC,GAAG;gBAAE,CAAC,EAAE,CAACwX,CAAC,EAAErf,CAAC,KAAK;kBACjF,MAAMsf,SAAS,GAAGtf,CAAC,GAAG,CAAC,GAAG6H,YAAY;kBACtC,MAAMuQ,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;kBAC5C,oBACEnc,OAAA;oBAEEqhB,SAAS,EAAC,gDAAgD;oBAC1DpE,KAAK,EAAE;sBAAErF,IAAI,EAAE,GAAG2M,SAAS,GAAGlH,eAAe;oBAAK,CAAE;oBAAAiE,QAAA,eAEpDthB,OAAA;sBAAMqhB,SAAS,EAAC,0DAA0D;sBAAAC,QAAA,EACvEhQ,UAAU,CAACiT,SAAS;oBAAC;sBAAAhD,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAClB;kBAAC,GANFzc,CAAC;oBAAAsc,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAOH,CAAC;gBAEV,CAAC,CAAC,EAED5U,YAAY,GAAG,CAAC,IAAI/H,KAAK,CAACsX,IAAI,CAAC;kBAAErX,MAAM,EAAEgB,IAAI,CAACqe,IAAI,CAAC3X,aAAa,GAAGI,YAAY,CAAC,GAAG;gBAAE,CAAC,EAAE,CAACwX,CAAC,EAAErf,CAAC,KAAK;kBACjG,MAAMsf,SAAS,GAAGtf,CAAC,GAAG6H,YAAY;kBAClC,MAAMuQ,eAAe,GAAGlB,kBAAkB,CAAC,CAAC;kBAC5C,oBACEnc,OAAA;oBAEEqhB,SAAS,EAAC,iDAAiD;oBAC3DpE,KAAK,EAAE;sBAAErF,IAAI,EAAE,GAAG2M,SAAS,GAAGlH,eAAe;oBAAK;kBAAE,GAF/C,OAAOpY,CAAC,EAAE;oBAAAsc,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAGhB,CAAC;gBAEN,CAAC,CAAC,eAEF1hB,OAAA;kBACEqhB,SAAS,EAAC,uDAAuD;kBACjEpE,KAAK,EAAE;oBACLrF,IAAI,EAAE,GAAGpL,WAAW,GAAG2P,kBAAkB,CAAC,CAAC;kBAC7C;gBAAE;kBAAAoF,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC,eAEN1hB,OAAA;gBACEqhB,SAAS,EAAC,iBAAiB;gBAC3BpE,KAAK,EAAE;kBACLtW,MAAM,EAAE,GAAG,CAACuJ,MAAM,CAACE,QAAQ,CAACpL,MAAM,GAAGkL,MAAM,CAACG,IAAI,CAACrL,MAAM,GAAGkL,MAAM,CAAC5F,KAAK,CAACtF,MAAM,IAAI,EAAE,IAAI;kBACvFmf,SAAS,EAAE;gBACb,CAAE;gBAAA7C,QAAA,GAEDhV,aAAa,CAACnE,GAAG,CAAE+K,IAAI,iBACtBlT,OAAA;kBAEEqhB,SAAS,EAAE,uHACTD,aAAa,CAAClO,IAAI,CAACG,SAAS,CAAC,IAE7B,CAAAzG,oBAAoB,aAApBA,oBAAoB,uBAApBA,oBAAoB,CAAE/G,EAAE,MAAKqN,IAAI,CAACrN,EAAE,GAAG,sBAAsB,GAAG,EAAE,IAElE,CAAA+H,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAE/H,EAAE,MAAKqN,IAAI,CAACrN,EAAE,GAAG,iBAAiB,GAAG,EAAE,IAE5D,CAAAyI,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEzI,EAAE,MAAKqN,IAAI,CAACrN,EAAE,GAAG,mCAAmC,GAAG,EAAE,EACpE;kBACHoX,KAAK,EAAE+D,oBAAoB,CAAC9N,IAAI,CAAE;kBAClCyO,OAAO,EAAGzd,CAAC,IAAK;oBACdA,CAAC,CAACiT,eAAe,CAAC,CAAC;oBACnBtK,uBAAuB,CAACqG,IAAI,CAAC;kBAC/B,CAAE;kBAAAoO,QAAA,gBAEFthB,OAAA;oBACEqhB,SAAS,EAAC,oJAAoJ;oBAC9JoC,WAAW,EAAGvf,CAAC,IAAK0X,iBAAiB,CAAC1X,CAAC,EAAEgP,IAAI,EAAE,MAAM,CAAE;oBACvDgQ,KAAK,EAAC,wCAAwC;oBAC9CjG,KAAK,EAAE;sBAAEuH,UAAU,EAAE;oBAAgE,CAAE;oBAAAlD,QAAA,eAEvFthB,OAAA;sBAAKqhB,SAAS,EAAC;oBAA4C;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAC/D,CAAC,eAEN1hB,OAAA;oBACE4iB,SAAS,EAAC,MAAM;oBAChBC,WAAW,EAAG3e,CAAC,IAAKwb,2BAA2B,CAACxb,CAAC,EAAEgP,IAAI,CAAE;oBACzD4P,SAAS,EAAElD,yBAA0B;oBACrCyB,SAAS,EAAC,8GAA8G;oBACxH6B,KAAK,EAAC,kEAAkE;oBAAA5B,QAAA,GAEvEpO,IAAI,CAAChN,IAAI,EACT,CAAAoI,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEzI,EAAE,MAAKqN,IAAI,CAACrN,EAAE,iBACzB7F,OAAA;sBAAMqhB,SAAS,EAAC,qBAAqB;sBAAAC,QAAA,EAAC;oBAAE;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAC/C;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,eAEN1hB,OAAA;oBACEqhB,SAAS,EAAC,qJAAqJ;oBAC/JoC,WAAW,EAAGvf,CAAC,IAAK0X,iBAAiB,CAAC1X,CAAC,EAAEgP,IAAI,EAAE,OAAO,CAAE;oBACxDgQ,KAAK,EAAC,oCAAoC;oBAC1CjG,KAAK,EAAE;sBAAEuH,UAAU,EAAE;oBAA+D,CAAE;oBAAAlD,QAAA,eAEtFthB,OAAA;sBAAKqhB,SAAS,EAAC;oBAA4C;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAC/D,CAAC;gBAAA,GA7CDxO,IAAI,CAACrN,EAAE;kBAAA0b,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OA8CT,CACN,CAAC,EAED5T,WAAW,iBACV9N,OAAA;kBACEqhB,SAAS,EAAE,oDACTvT,WAAW,CAAC0S,OAAO,GACf1S,WAAW,CAACuH,OAAO,GACjB,GAAG+L,aAAa,CAACtT,WAAW,CAACuF,SAAS,CAAC,6BAA6B,GACpE,GAAG+N,aAAa,CAACtT,WAAW,CAACuF,SAAS,CAAC,4CAA4C,GACrF,yCAAyC,EAC5C;kBACH4J,KAAK,EAAEkE,mBAAmB,CAAC,CAAE;kBAAAG,QAAA,EAE5BxT,WAAW,CAAC0S,OAAO,IAAI,CAAC1S,WAAW,CAACuH,OAAO,iBAC1CrV,OAAA;oBAAKqhB,SAAS,EAAC,sEAAsE;oBAAAC,QAAA,EAAC;kBAEtF;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK;gBACN;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACE,CACN;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAGL1R,QAAQ,iBACPhQ,OAAA;MAAKqhB,SAAS,EAAC,sFAAsF;MAAAC,QAAA,eACnGthB,OAAA;QAAKqhB,SAAS,EAAC,+EAA+E;QAAAC,QAAA,gBAC5FthB,OAAA;UAAKqhB,SAAS,EAAC,gEAAgE;UAAAC,QAAA,gBAC7EthB,OAAA;YAAIqhB,SAAS,EAAC,mDAAmD;YAAAC,QAAA,gBAC/DthB,OAAA,CAACN,UAAU;cAAC+F,IAAI,EAAE,EAAG;cAAC4b,SAAS,EAAC;YAAoB;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,iCAEzD;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACL1hB,OAAA;YACE2hB,OAAO,EAAEA,CAAA,KAAM1R,WAAW,CAAC,KAAK,CAAE;YAClCoR,SAAS,EAAC,mFAAmF;YAAAC,QAAA,eAE7FthB,OAAA,CAACL,CAAC;cAAC8F,IAAI,EAAE;YAAG;cAAA8b,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACT,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAEN1hB,OAAA;UAAKqhB,SAAS,EAAC,eAAe;UAAAC,QAAA,gBAE5BthB,OAAA;YAAAshB,QAAA,gBACEthB,OAAA;cAAIqhB,SAAS,EAAC,oDAAoD;cAAAC,QAAA,EAAC;YAEnE;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL1hB,OAAA;cAAKqhB,SAAS,EAAC,gCAAgC;cAAAC,QAAA,gBAC7CthB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACpD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAE,CAAAzV,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAErC,IAAI,KAAI;gBAAY;kBAAA+X,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrE,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAe;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACtD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAA6B;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/D,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACpD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAyB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3D,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACrD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAwB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC1D,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN1hB,OAAA;YAAAshB,QAAA,gBACEthB,OAAA;cAAIqhB,SAAS,EAAC,oDAAoD;cAAAC,QAAA,gBAChEthB,OAAA,CAACZ,IAAI;gBAACqG,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAoB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,qBAEnD;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL1hB,OAAA;cAAKqhB,SAAS,EAAC,gCAAgC;cAAAC,QAAA,gBAC7CthB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACnD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eAClD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACnD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAiB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnD,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACpD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/C,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN1hB,OAAA;YAAAshB,QAAA,gBACEthB,OAAA;cAAIqhB,SAAS,EAAC,oDAAoD;cAAAC,QAAA,gBAChEthB,OAAA,CAACV,MAAM;gBAACmG,IAAI,EAAE,EAAG;gBAAC4b,SAAS,EAAC;cAAsB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,iCAEvD;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL1hB,OAAA;cAAKqhB,SAAS,EAAC,gCAAgC;cAAAC,QAAA,gBAC7CthB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACrD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAsB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACxD,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACrD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAa;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAiB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACxD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChD,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACrD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAe;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACtD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAmB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrD,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAMqhB,SAAS,EAAC,eAAe;kBAAAC,QAAA,EAAC;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACnD1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAkB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACpD,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN1hB,OAAA;YAAAshB,QAAA,gBACEthB,OAAA;cAAIqhB,SAAS,EAAC,oDAAoD;cAAAC,QAAA,EAAC;YAEnE;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL1hB,OAAA;cAAKqhB,SAAS,EAAC,gCAAgC;cAAAC,QAAA,gBAC7CthB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC5E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC9C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAG;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC1E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAClF1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAU;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eACjF1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAQ;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC/E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAU;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAQ;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC/E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAQ;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC/E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAU;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAG;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC1E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAG;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC1E1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAW;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7C,CAAC,eACN1hB,OAAA;gBAAKqhB,SAAS,EAAC,sBAAsB;gBAAAC,QAAA,gBACnCthB,OAAA;kBAAKqhB,SAAS,EAAC,iDAAiD;kBAAAC,QAAA,EAAC;gBAAC;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eACxE1hB,OAAA;kBAAMqhB,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAU;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5C,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN1hB,OAAA;YAAAshB,QAAA,gBACEthB,OAAA;cAAIqhB,SAAS,EAAC,oDAAoD;cAAAC,QAAA,EAAC;YAEnE;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL1hB,OAAA;cAAIqhB,SAAS,EAAC,iCAAiC;cAAAC,QAAA,gBAC7CthB,OAAA;gBAAIqhB,SAAS,EAAC,kBAAkB;gBAAAC,QAAA,gBAC9BthB,OAAA;kBAAMqhB,SAAS,EAAC;gBAAuE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAC/F1hB,OAAA;kBAAAshB,QAAA,EAAM;gBAAmE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC9E,CAAC,eACL1hB,OAAA;gBAAIqhB,SAAS,EAAC,kBAAkB;gBAAAC,QAAA,gBAC9BthB,OAAA;kBAAMqhB,SAAS,EAAC;gBAAyE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACjG1hB,OAAA;kBAAAshB,QAAA,EAAM;gBAAwE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnF,CAAC,eACL1hB,OAAA;gBAAIqhB,SAAS,EAAC,kBAAkB;gBAAAC,QAAA,gBAC9BthB,OAAA;kBAAMqhB,SAAS,EAAC;gBAAyE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACjG1hB,OAAA;kBAAAshB,QAAA,EAAM;gBAAsE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACjF,CAAC,eACL1hB,OAAA;gBAAIqhB,SAAS,EAAC,kBAAkB;gBAAAC,QAAA,gBAC9BthB,OAAA;kBAAMqhB,SAAS,EAAC;gBAAwE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAChG1hB,OAAA;kBAAAshB,QAAA,EAAM;gBAAkE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7E,CAAC,eACL1hB,OAAA;gBAAIqhB,SAAS,EAAC,kBAAkB;gBAAAC,QAAA,gBAC9BthB,OAAA;kBAAMqhB,SAAS,EAAC;gBAAsE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAC9F1hB,OAAA;kBAAAshB,QAAA,EAAM;gBAAqE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChF,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAEN1hB,OAAA;UAAKqhB,SAAS,EAAC,uDAAuD;UAAAC,QAAA,eACpEthB,OAAA;YAAGqhB,SAAS,EAAC,mCAAmC;YAAAC,QAAA,GAAC,gGACiB,eAAAthB,OAAA;cAAKqhB,SAAS,EAAC,uDAAuD;cAAAC,QAAA,EAAC;YAAC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,YAChJ;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACzW,EAAA,CA54EID,WAAW;AAAAyZ,EAAA,GAAXzZ,WAAW;AA84EjB,eAAeA,WAAW;AAAC,IAAAyZ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}