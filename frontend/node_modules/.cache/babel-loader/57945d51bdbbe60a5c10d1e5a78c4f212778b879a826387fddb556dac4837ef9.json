{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\Timeline.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Video, Music, Copy, Trash2, Scissors, Film, Plus, Layers, ZoomIn, ZoomOut, RotateCcw, HelpCircle, Play, Pause, SkipBack, SkipForward, Volume2, Image, FileText } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoTimelineSystem = () => {\n  _s();\n  // Состояния для timeline\n  const [timelineItems, setTimelineItems] = useState([]);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [videoDuration, setVideoDuration] = useState(60);\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\n  const [timelineZoom, setTimelineZoom] = useState(1);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [volume, setVolume] = useState(1);\n\n  // Состояния для drag & drop\n  const [draggedItem, setDraggedItem] = useState(null);\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\n  const [dropPreview, setDropPreview] = useState(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\n  const [isResizing, setIsResizing] = useState(false);\n  const [copiedItem, setCopiedItem] = useState(null);\n\n  // Timeline-specific states\n  const [dragOffset, setDragOffset] = useState(0);\n  const [resizeHandle, setResizeHandle] = useState(null);\n  const [resizeItem, setResizeItem] = useState(null);\n  const [originalItemData, setOriginalItemData] = useState(null);\n\n  // Refs\n  const timelineRef = useRef(null);\n  const timelineScrollRef = useRef(null);\n  const trackLabelsRef = useRef(null);\n  const autoScrollIntervalRef = useRef(null);\n  const videoRef = useRef(null);\n\n  // Дорожки\n  const [tracks, setTracks] = useState({\n    overlays: [{\n      id: \"overlay-1\",\n      name: \"Overlay 1\",\n      type: \"overlay\"\n    }],\n    main: [{\n      id: \"main-1\",\n      name: \"Main Video\",\n      type: \"main\"\n    }],\n    audio: [{\n      id: \"audio-1\",\n      name: \"Audio 1\",\n      type: \"audio\"\n    }]\n  });\n\n  // Тестовые медиа файлы\n  const [mediaLibrary] = useState([{\n    id: \"video-1\",\n    name: \"Sample Video 1\",\n    type: \"video\",\n    duration: 15,\n    src: \"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4\",\n    thumbnail: \"https://via.placeholder.com/200x112/3b82f6/ffffff?text=Video+1\"\n  }, {\n    id: \"video-2\",\n    name: \"Sample Video 2\",\n    type: \"video\",\n    duration: 12,\n    src: \"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4\",\n    thumbnail: \"https://via.placeholder.com/200x112/3b82f6/ffffff?text=Video+2\"\n  }, {\n    id: \"audio-1\",\n    name: \"Background Music\",\n    type: \"audio\",\n    duration: 30,\n    src: \"https://www.soundjay.com/misc/sounds/bell-ringing-05.wav\",\n    thumbnail: \"https://via.placeholder.com/200x112/10b981/ffffff?text=Audio\"\n  }, {\n    id: \"image-1\",\n    name: \"Logo Overlay\",\n    type: \"image\",\n    duration: 5,\n    src: \"https://via.placeholder.com/400x300/8b5cf6/ffffff?text=Logo\",\n    thumbnail: \"https://via.placeholder.com/200x112/8b5cf6/ffffff?text=Image\"\n  }, {\n    id: \"text-1\",\n    name: \"Title Text\",\n    type: \"text\",\n    duration: 3,\n    text: \"Welcome to Our Video\",\n    fontSize: \"32px\",\n    color: \"#ffffff\",\n    thumbnail: \"https://via.placeholder.com/200x112/f59e0b/ffffff?text=Text\"\n  }]);\n\n  // Получаем активные элементы в текущем времени\n  const getActiveItems = useCallback(() => {\n    return timelineItems.filter(item => {\n      const itemStart = item.startTime;\n      const itemEnd = item.startTime + item.duration;\n      return currentTime >= itemStart && currentTime < itemEnd;\n    }).sort((a, b) => {\n      // Сортируем по типу дорожки: main -> overlays -> audio\n      const trackOrder = {\n        main: 0,\n        overlay: 1,\n        audio: 2\n      };\n      const aOrder = trackOrder[a.trackType] || 3;\n      const bOrder = trackOrder[b.trackType] || 3;\n      return aOrder - bOrder;\n    });\n  }, [timelineItems, currentTime]);\n  const activeItems = getActiveItems();\n  const mainVideoItem = activeItems.find(item => item.trackType === 'main');\n  const overlayItems = activeItems.filter(item => item.trackType === 'overlay');\n  const audioItems = activeItems.filter(item => item.trackType === 'audio');\n\n  // Автообновление времени при воспроизведении\n  useEffect(() => {\n    let interval = null;\n    if (isPlaying) {\n      interval = setInterval(() => {\n        setCurrentTime(prevTime => {\n          const newTime = prevTime + 0.1;\n          if (newTime >= videoDuration) {\n            setIsPlaying(false);\n            return videoDuration;\n          }\n          return newTime;\n        });\n      }, 100);\n    }\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [isPlaying, videoDuration]);\n\n  // Обновляем время видео при изменении currentTime\n  useEffect(() => {\n    if (videoRef.current && mainVideoItem) {\n      const videoElement = videoRef.current;\n      const relativeTime = currentTime - mainVideoItem.startTime;\n      if (Math.abs(videoElement.currentTime - relativeTime) > 0.1) {\n        videoElement.currentTime = Math.max(0, relativeTime);\n      }\n    }\n  }, [currentTime, mainVideoItem]);\n\n  // Управление воспроизведением\n  useEffect(() => {\n    if (videoRef.current && mainVideoItem) {\n      if (isPlaying) {\n        videoRef.current.play().catch(console.error);\n      } else {\n        videoRef.current.pause();\n      }\n    }\n  }, [isPlaying, mainVideoItem]);\n\n  // Обновление громкости\n  useEffect(() => {\n    if (videoRef.current) {\n      videoRef.current.volume = volume;\n    }\n  }, [volume]);\n\n  // Утилитарные функции\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    const frames = Math.floor(seconds % 1 * 30);\n    return `${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}:${frames.toString().padStart(2, \"0\")}`;\n  };\n  const seekTo = time => {\n    setCurrentTime(Math.max(0, Math.min(videoDuration, time)));\n  };\n\n  // Автопрокрутка\n  const stopAutoScroll = useCallback(() => {\n    if (autoScrollIntervalRef.current) {\n      clearInterval(autoScrollIntervalRef.current);\n      autoScrollIntervalRef.current = null;\n    }\n  }, []);\n  const startAutoScroll = useCallback((direction, speed = 1) => {\n    stopAutoScroll();\n    autoScrollIntervalRef.current = setInterval(() => {\n      if (timelineScrollRef.current) {\n        const scrollAmount = 15 * speed;\n        const currentScrollLeft = timelineScrollRef.current.scrollLeft;\n        const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n        if (direction === \"left\" && currentScrollLeft > 0) {\n          timelineScrollRef.current.scrollLeft = Math.max(0, currentScrollLeft - scrollAmount);\n        } else if (direction === \"right\" && currentScrollLeft < maxScroll) {\n          timelineScrollRef.current.scrollLeft = Math.min(maxScroll, currentScrollLeft + scrollAmount);\n        }\n      }\n    }, 16);\n  }, [stopAutoScroll]);\n  const checkAutoScroll = useCallback(clientX => {\n    if (!timelineScrollRef.current) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const scrollZoneWidth = 120;\n    const relativeX = clientX - rect.left;\n    if (relativeX < scrollZoneWidth && timelineScrollRef.current.scrollLeft > 0) {\n      const speed = (scrollZoneWidth - relativeX) / scrollZoneWidth * 3;\n      startAutoScroll(\"left\", speed);\n    } else if (relativeX > rect.width - scrollZoneWidth) {\n      const maxScroll = timelineScrollRef.current.scrollWidth - timelineScrollRef.current.clientWidth;\n      if (timelineScrollRef.current.scrollLeft < maxScroll) {\n        const speed = (relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth * 3;\n        startAutoScroll(\"right\", speed);\n      }\n    } else {\n      stopAutoScroll();\n    }\n  }, [startAutoScroll, stopAutoScroll]);\n\n  // Автоматическое определение дорожки по типу медиа\n  const getTargetTrackForType = useCallback(mediaType => {\n    var _tracks$main, _tracks$audio, _tracks$overlays, _tracks$main2, _tracks$main2$;\n    switch (mediaType) {\n      case \"video\":\n        const mainTrack = (_tracks$main = tracks.main) === null || _tracks$main === void 0 ? void 0 : _tracks$main[0];\n        return mainTrack === null || mainTrack === void 0 ? void 0 : mainTrack.id;\n      case \"audio\":\n      case \"music\":\n        const audioTrack = (_tracks$audio = tracks.audio) === null || _tracks$audio === void 0 ? void 0 : _tracks$audio[0];\n        return audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.id;\n      case \"image\":\n      case \"text\":\n        const overlayTrack = (_tracks$overlays = tracks.overlays) === null || _tracks$overlays === void 0 ? void 0 : _tracks$overlays[0];\n        return overlayTrack === null || overlayTrack === void 0 ? void 0 : overlayTrack.id;\n      default:\n        return (_tracks$main2 = tracks.main) === null || _tracks$main2 === void 0 ? void 0 : (_tracks$main2$ = _tracks$main2[0]) === null || _tracks$main2$ === void 0 ? void 0 : _tracks$main2$.id;\n    }\n  }, [tracks]);\n\n  // Находим лучшую позицию для размещения элемента\n  const findBestPositionForItem = useCallback((item, targetTrackId) => {\n    const duration = item.duration || (item.type === \"image\" ? 5 : 10);\n\n    // Получаем все элементы на целевой дорожке\n    const itemsOnTrack = timelineItems.filter(timelineItem => timelineItem.trackId === targetTrackId).sort((a, b) => a.startTime - b.startTime);\n\n    // Если нет элементов на дорожке, размещаем в текущей позиции\n    if (itemsOnTrack.length === 0) {\n      return currentTime;\n    }\n\n    // Проверяем, есть ли место в текущей позиции\n    const hasSpaceAtCurrentTime = !itemsOnTrack.some(existingItem => {\n      const existingStart = existingItem.startTime;\n      const existingEnd = existingItem.startTime + existingItem.duration;\n      const newStart = currentTime;\n      const newEnd = currentTime + duration;\n\n      // Проверяем пересечение\n      return !(newEnd <= existingStart || newStart >= existingEnd);\n    });\n    if (hasSpaceAtCurrentTime) {\n      return currentTime;\n    }\n\n    // Если в текущей позиции нет места, размещаем после последнего элемента\n    const lastItem = itemsOnTrack[itemsOnTrack.length - 1];\n    return lastItem.startTime + lastItem.duration;\n  }, [timelineItems, currentTime]);\n\n  // Функции timeline\n  const addToTimeline = (item, startTime, trackId) => {\n    const trackType = tracks.overlays.find(t => t.id === trackId) ? 'overlay' : tracks.main.find(t => t.id === trackId) ? 'main' : 'audio';\n    const newTimelineItem = {\n      ...item,\n      id: `timeline-${Date.now()}`,\n      originalId: item.id,\n      startTime,\n      trackId,\n      trackType\n    };\n    setTimelineItems(prev => [...prev, newTimelineItem]);\n\n    // Расширяем duration если нужно\n    const newEndTime = startTime + item.duration;\n    if (newEndTime > videoDuration) {\n      setVideoDuration(newEndTime + 10);\n    }\n  };\n  const insertWithRipple = (trackId, time, duration, excludeId = null) => {\n    return {\n      time,\n      shouldRipple: false,\n      affectedItems: []\n    };\n  };\n  const applyRippleEffect = (affectedItems, shiftDuration) => {\n    // Логика ripple effect\n  };\n  const removeFromTimeline = itemId => {\n    setTimelineItems(prev => prev.filter(item => item.id !== itemId));\n  };\n\n  // Умное размещение элемента на правильной дорожке\n  const addToTimelineAtCurrentTime = useCallback(() => {\n    if (!draggedItem) return;\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\n    if (!targetTrackId) return;\n\n    // Находим лучшую позицию для размещения\n    const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\n    addToTimeline(draggedItem, bestPosition, targetTrackId);\n  }, [draggedItem, getTargetTrackForType, findBestPositionForItem]);\n  const splitTimelineItem = () => {\n    if (!selectedTimelineItem) return;\n    const item = selectedTimelineItem;\n    const splitTime = currentTime - item.startTime;\n    if (splitTime <= 0 || splitTime >= item.duration) return;\n    const firstPart = {\n      ...item,\n      id: `timeline-${Date.now()}-1`,\n      duration: splitTime\n    };\n    const secondPart = {\n      ...item,\n      id: `timeline-${Date.now()}-2`,\n      startTime: item.startTime + splitTime,\n      duration: item.duration - splitTime\n    };\n    setTimelineItems(prev => prev.map(timelineItem => timelineItem.id === item.id ? firstPart : timelineItem).concat(secondPart));\n    setSelectedTimelineItem(firstPart);\n  };\n  const copyTimelineItem = () => {\n    if (selectedTimelineItem) {\n      setCopiedItem(selectedTimelineItem);\n    }\n  };\n  const pasteTimelineItem = () => {\n    if (!copiedItem) return;\n    const newItem = {\n      ...copiedItem,\n      id: `timeline-${Date.now()}`,\n      startTime: currentTime\n    };\n    setTimelineItems(prev => [...prev, newItem]);\n  };\n  const deleteSelectedItem = () => {\n    if (selectedTimelineItem) {\n      removeFromTimeline(selectedTimelineItem.id);\n      setSelectedTimelineItem(null);\n    }\n  };\n\n  // Зум и прокрутка колесом мыши\n  const handleWheel = useCallback(e => {\n    if (e.ctrlKey) {\n      e.preventDefault();\n      if (!timelineScrollRef.current) return;\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const currentPixelsPerSecond = 50 * timelineZoom;\n      const timeAtMouse = mouseX / currentPixelsPerSecond;\n      const zoomDirection = e.deltaY < 0 ? 1 : -1;\n      const zoomStep = 1.2;\n      setTimelineZoom(prevZoom => {\n        let newZoom;\n        if (zoomDirection > 0) {\n          newZoom = Math.min(20, prevZoom * zoomStep);\n        } else {\n          newZoom = Math.max(0.1, prevZoom / zoomStep);\n        }\n        requestAnimationFrame(() => {\n          if (timelineScrollRef.current) {\n            const newPixelsPerSecond = 50 * newZoom;\n            const newMouseX = timeAtMouse * newPixelsPerSecond;\n            const targetScrollLeft = newMouseX - (e.clientX - rect.left);\n            timelineScrollRef.current.scrollLeft = Math.max(0, targetScrollLeft);\n          }\n        });\n        return newZoom;\n      });\n    } else if (e.shiftKey) {\n      e.preventDefault();\n      if (timelineScrollRef.current) {\n        const scrollAmount = e.deltaY * 2;\n        timelineScrollRef.current.scrollLeft += scrollAmount;\n      }\n    }\n  }, [timelineZoom, setTimelineZoom]);\n\n  // Функции зума\n  const zoomIn = () => {\n    setTimelineZoom(prev => Math.min(20, prev * 1.5));\n  };\n  const zoomOut = () => {\n    setTimelineZoom(prev => Math.max(0.1, prev / 1.5));\n  };\n  const resetZoom = () => {\n    setTimelineZoom(1);\n  };\n\n  // Player controls\n  const handlePlayPause = () => {\n    setIsPlaying(!isPlaying);\n  };\n  const handleSeekBackward = () => {\n    seekTo(Math.max(0, currentTime - 10));\n  };\n  const handleSeekForward = () => {\n    seekTo(Math.min(videoDuration, currentTime + 10));\n  };\n\n  // Функции для resize\n  const handleResizeStart = useCallback((e, item, handle) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsResizing(true);\n    setResizeHandle(handle);\n    setResizeItem(item);\n    setOriginalItemData({\n      startTime: item.startTime,\n      duration: item.duration\n    });\n    setIsTimelineDragging(false);\n    setDraggedTimelineItem(null);\n  }, [setIsResizing, setIsTimelineDragging, setDraggedTimelineItem]);\n  const handleResizeEnd = useCallback(() => {\n    setIsResizing(false);\n    setResizeHandle(null);\n    setResizeItem(null);\n    setOriginalItemData(null);\n    stopAutoScroll();\n  }, [setIsResizing, stopAutoScroll]);\n\n  // Добавление треков\n  const addOverlayTrack = () => {\n    const newTrackId = `overlay-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      overlays: [...prev.overlays, {\n        id: newTrackId,\n        name: `Overlay ${prev.overlays.length + 1}`,\n        type: \"overlay\"\n      }]\n    }));\n  };\n  const addAudioTrack = () => {\n    const newTrackId = `audio-${Date.now()}`;\n    setTracks(prev => ({\n      ...prev,\n      audio: [...prev.audio, {\n        id: newTrackId,\n        name: `Audio ${prev.audio.length + 1}`,\n        type: \"audio\"\n      }]\n    }));\n  };\n\n  // Синхронизация скролла\n  const handleTrackAreaScroll = e => {\n    if (trackLabelsRef.current) {\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const handleTrackLabelsScroll = e => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\n    }\n  };\n  const getTimelineWidth = () => {\n    const baseWidth = videoDuration * 50 * timelineZoom;\n    return Math.max(baseWidth, 2000);\n  };\n  const getPixelsPerSecond = () => {\n    return 50 * timelineZoom;\n  };\n\n  // Обработчики событий timeline\n  const handleTimelineClick = e => {\n    if (isDragging || isTimelineDragging || isResizing) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    seekTo(clickTime);\n  };\n  const handleTimelineDoubleClick = useCallback(e => {\n    if (isDragging || isTimelineDragging || isResizing || !draggedItem) return;\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n    const pixelsPerSecond = getPixelsPerSecond();\n    const clickTime = clickX / pixelsPerSecond;\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\n    if (targetTrackId) {\n      addToTimeline(draggedItem, clickTime, targetTrackId);\n    }\n  }, [isDragging, isTimelineDragging, isResizing, draggedItem, getTargetTrackForType, addToTimeline]);\n  const handleTimelineItemDragStart = (e, timelineItem) => {\n    if (isResizing) {\n      e.preventDefault();\n      return;\n    }\n    e.stopPropagation();\n    setDraggedTimelineItem(timelineItem);\n    setIsTimelineDragging(true);\n    const rect = timelineScrollRef.current.getBoundingClientRect();\n    const itemRect = e.target.getBoundingClientRect();\n    setDragOffset(e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleTimelineItemDragEnd = () => {\n    setDraggedTimelineItem(null);\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n    setDragOffset(0);\n    stopAutoScroll();\n  };\n  const handleDragOver = e => {\n    if (!draggedItem && !draggedTimelineItem) return;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\n    if (draggedTimelineItem || isResizing) {\n      checkAutoScroll(e.clientX);\n    }\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\n    const dragX = e.clientX - timelineRect.left + timelineScrollRef.current.scrollLeft - (draggedTimelineItem ? dragOffset : 0);\n    const pixelsPerSecond = getPixelsPerSecond();\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\n    const dragY = e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\n    const trackHeight = 60;\n    const timeRulerHeight = 48;\n    const relativeY = dragY - timeRulerHeight;\n    const trackIndex = Math.floor(relativeY / trackHeight);\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const targetTrack = allTracks[trackIndex];\n    if (draggedItem && targetTrack) {\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\n      setDropPreview({\n        time: insertResult.time,\n        duration: duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    } else if (draggedTimelineItem && targetTrack) {\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, draggedTimelineItem.duration, draggedTimelineItem.id);\n      setDropPreview({\n        time: insertResult.time,\n        duration: draggedTimelineItem.duration,\n        trackId: targetTrack.id,\n        trackType: targetTrack.type,\n        isValid: true,\n        shouldRipple: insertResult.shouldRipple,\n        affectedItems: insertResult.affectedItems || []\n      });\n    }\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    stopAutoScroll();\n\n    // Если нет валидного preview, но есть draggedItem - используем умную логику размещения\n    if (!dropPreview && draggedItem) {\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\n      if (targetTrackId) {\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\n        addToTimeline(draggedItem, bestPosition, targetTrackId);\n      }\n      setDropPreview(null);\n      setIsTimelineDragging(false);\n      return;\n    }\n    if (!draggedItem && !draggedTimelineItem || !dropPreview) return;\n    if (dropPreview.isValid) {\n      if (draggedItem) {\n        var _dropPreview$affected;\n        if (dropPreview.shouldRipple && ((_dropPreview$affected = dropPreview.affectedItems) === null || _dropPreview$affected === void 0 ? void 0 : _dropPreview$affected.length) > 0) {\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\n        }\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\n      } else if (draggedTimelineItem) {\n        var _dropPreview$affected2;\n        if (dropPreview.shouldRipple && ((_dropPreview$affected2 = dropPreview.affectedItems) === null || _dropPreview$affected2 === void 0 ? void 0 : _dropPreview$affected2.length) > 0) {\n          applyRippleEffect(dropPreview.affectedItems, draggedTimelineItem.duration);\n        }\n        setTimelineItems(prev => prev.map(item => item.id === draggedTimelineItem.id ? {\n          ...item,\n          startTime: dropPreview.time,\n          trackId: dropPreview.trackId,\n          trackType: dropPreview.trackType\n        } : item));\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\n        if (newEndTime > videoDuration) {\n          setVideoDuration(newEndTime + 10);\n        }\n      }\n    }\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n  };\n  const handleDragLeave = e => {\n    var _timelineRef$current;\n    if (!((_timelineRef$current = timelineRef.current) !== null && _timelineRef$current !== void 0 && _timelineRef$current.contains(e.relatedTarget))) {\n      setDropPreview(null);\n      stopAutoScroll();\n    }\n  };\n  const getTimelineItemStyle = item => {\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === item.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${item.startTime * pixelsPerSecond}px`,\n      width: `${item.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getDropPreviewStyle = () => {\n    if (!dropPreview) return {};\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\n    const trackIndex = allTracks.findIndex(track => track.id === dropPreview.trackId);\n    const pixelsPerSecond = getPixelsPerSecond();\n    return {\n      left: `${dropPreview.time * pixelsPerSecond}px`,\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\n      top: `${trackIndex * 60 + 10}px`\n    };\n  };\n  const getTrackColor = trackType => {\n    switch (trackType) {\n      case \"overlay\":\n        return \"bg-purple-500 border-purple-400\";\n      case \"main\":\n        return \"bg-blue-500 border-blue-400\";\n      case \"audio\":\n        return \"bg-green-500 border-green-400\";\n      default:\n        return \"bg-gray-500 border-gray-400\";\n    }\n  };\n\n  // Обработчики drag & drop для медиа библиотеки\n  const handleMediaDragStart = (e, item) => {\n    setDraggedItem(item);\n    setIsDragging(true);\n    e.dataTransfer.effectAllowed = \"copy\";\n  };\n  const handleMediaDragEnd = () => {\n    setDraggedItem(null);\n    setIsDragging(false);\n  };\n\n  // Рендер видео контента\n  const renderVideoContent = () => {\n    if (!mainVideoItem) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full h-full bg-gray-900 flex items-center justify-center text-white\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(Video, {\n            size: 64,\n            className: \"mx-auto mb-4 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 817,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg\",\n            children: \"No video content at current time\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 818,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-400 mt-2\",\n            children: \"Add video to timeline or move playhead to video content\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 819,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 816,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 815,\n        columnNumber: 9\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative w-full h-full bg-black\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        className: \"w-full h-full object-contain\",\n        src: mainVideoItem.src,\n        onTimeUpdate: e => {\n          if (isPlaying) {\n            const videoTime = e.target.currentTime;\n            const timelineTime = mainVideoItem.startTime + videoTime;\n            if (timelineTime <= mainVideoItem.startTime + mainVideoItem.duration) {\n              seekTo(timelineTime);\n            } else {\n              setIsPlaying(false);\n            }\n          }\n        },\n        onLoadedMetadata: () => {\n          if (videoRef.current) {\n            const relativeTime = currentTime - mainVideoItem.startTime;\n            videoRef.current.currentTime = Math.max(0, relativeTime);\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 829,\n        columnNumber: 9\n      }, this), overlayItems.map((overlay, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0 flex items-center justify-center pointer-events-none\",\n        style: {\n          zIndex: 10 + index\n        },\n        children: overlay.type === 'image' ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: overlay.src,\n          alt: overlay.name,\n          className: \"max-w-full max-h-full object-contain\",\n          style: {\n            opacity: overlay.opacity || 1,\n            transform: `scale(${overlay.scale || 1})`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 860,\n          columnNumber: 15\n        }, this) : overlay.type === 'text' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-white text-center p-4 bg-black bg-opacity-50 rounded\",\n          style: {\n            fontSize: overlay.fontSize || '24px',\n            color: overlay.color || 'white'\n          },\n          children: overlay.text || overlay.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 870,\n          columnNumber: 15\n        }, this) : null\n      }, overlay.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 854,\n        columnNumber: 11\n      }, this)), overlayItems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-4 right-4 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-sm\",\n        children: [overlayItems.length, \" overlay\", overlayItems.length > 1 ? 's' : '']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 885,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 828,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Эффекты\n  useEffect(() => {\n    const handleMouseMove = e => {\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\n      checkAutoScroll(e.clientX);\n      const rect = timelineScrollRef.current.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\n      const pixelsPerSecond = getPixelsPerSecond();\n      const newTime = mouseX / pixelsPerSecond;\n      setTimelineItems(prev => prev.map(item => {\n        if (item.id !== resizeItem.id) return item;\n        const minDuration = 0.1;\n        if (resizeHandle === \"left\") {\n          const rightEdge = originalItemData.startTime + originalItemData.duration;\n          const newStartTime = Math.max(0, Math.min(rightEdge - minDuration, newTime));\n          const newDuration = rightEdge - newStartTime;\n          return {\n            ...item,\n            startTime: newStartTime,\n            duration: newDuration\n          };\n        } else if (resizeHandle === \"right\") {\n          const leftEdge = originalItemData.startTime;\n          const newEndTime = Math.max(leftEdge + minDuration, newTime);\n          const newDuration = newEndTime - leftEdge;\n          return {\n            ...item,\n            duration: newDuration\n          };\n        }\n        return item;\n      }));\n    };\n    const handleMouseUp = () => {\n      if (isResizing) {\n        handleResizeEnd();\n      }\n    };\n    if (isResizing) {\n      document.addEventListener(\"mousemove\", handleMouseMove);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n    return () => {\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n    };\n  }, [isResizing, resizeItem, resizeHandle, originalItemData, getPixelsPerSecond, checkAutoScroll, handleResizeEnd, setTimelineItems]);\n  useEffect(() => {\n    return () => {\n      stopAutoScroll();\n    };\n  }, [stopAutoScroll]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 p-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold text-gray-900 mb-2\",\n          children: \"Video Timeline System\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 978,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"\\u041F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0435\\u043E \\u0432 timeline \\u0438 \\u043D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 Play \\u0434\\u043B\\u044F \\u0432\\u043E\\u0441\\u043F\\u0440\\u043E\\u0438\\u0437\\u0432\\u0435\\u0434\\u0435\\u043D\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 981,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 977,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow-sm border-2 border-gray-200 overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 p-4 border-b border-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Video, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 992,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Video Player\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 993,\n                columnNumber: 17\n              }, this), mainVideoItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600 text-sm\",\n                children: [\"- Playing: \\\"\", mainVideoItem.name, \"\\\"\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 995,\n                columnNumber: 19\n              }, this), overlayItems.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-purple-600 text-sm\",\n                children: [\"+ \", overlayItems.length, \" overlay\", overlayItems.length > 1 ? 's' : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1000,\n                columnNumber: 19\n              }, this), audioItems.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-600 text-sm\",\n                children: [\"+ \", audioItems.length, \" audio track\", audioItems.length > 1 ? 's' : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1005,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 991,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: [formatTime(currentTime), \" / \", formatTime(videoDuration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1011,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 990,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 989,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aspect-video bg-gray-900 relative\",\n          children: [renderVideoContent(), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute bottom-4 left-4 right-4 bg-black bg-opacity-50 rounded-lg p-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between text-white\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleSeekBackward,\n                  className: \"p-2 hover:bg-white hover:bg-opacity-20 rounded transition-colors\",\n                  title: \"Rewind 10s\",\n                  children: /*#__PURE__*/_jsxDEV(SkipBack, {\n                    size: 20\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1030,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1025,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handlePlayPause,\n                  className: \"p-3 bg-blue-600 hover:bg-blue-700 rounded-full transition-colors\",\n                  title: isPlaying ? \"Pause\" : \"Play\",\n                  children: isPlaying ? /*#__PURE__*/_jsxDEV(Pause, {\n                    size: 24\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1038,\n                    columnNumber: 34\n                  }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                    size: 24\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1038,\n                    columnNumber: 56\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1033,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleSeekForward,\n                  className: \"p-2 hover:bg-white hover:bg-opacity-20 rounded transition-colors\",\n                  title: \"Forward 10s\",\n                  children: /*#__PURE__*/_jsxDEV(SkipForward, {\n                    size: 20\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1046,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1041,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1024,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1051,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"range\",\n                  min: \"0\",\n                  max: \"1\",\n                  step: \"0.1\",\n                  value: volume,\n                  onChange: e => setVolume(parseFloat(e.target.value)),\n                  className: \"w-20\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1052,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1050,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1023,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1022,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 11\n        }, this), activeItems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 bg-gray-50 border-t border-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Active items:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1070,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-1 space-y-1\",\n              children: activeItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [item.type === 'video' && /*#__PURE__*/_jsxDEV(Video, {\n                  size: 14,\n                  className: \"text-blue-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1074,\n                  columnNumber: 49\n                }, this), item.type === 'audio' && /*#__PURE__*/_jsxDEV(Music, {\n                  size: 14,\n                  className: \"text-green-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1075,\n                  columnNumber: 49\n                }, this), item.type === 'image' && /*#__PURE__*/_jsxDEV(Image, {\n                  size: 14,\n                  className: \"text-purple-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1076,\n                  columnNumber: 49\n                }, this), item.type === 'text' && /*#__PURE__*/_jsxDEV(FileText, {\n                  size: 14,\n                  className: \"text-orange-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1077,\n                  columnNumber: 48\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1078,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-400\",\n                  children: [\"(\", formatTime(item.startTime), \" - \", formatTime(item.startTime + item.duration), \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1079,\n                  columnNumber: 23\n                }, this)]\n              }, item.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1073,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1071,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1069,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1068,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 987,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow-sm border-2 border-gray-200 p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-gray-800 mb-4 flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(Film, {\n            size: 20,\n            className: \"mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1093,\n            columnNumber: 13\n          }, this), \"Media Library\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1092,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4\",\n          children: mediaLibrary.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `bg-gray-50 rounded-xl p-3 cursor-grab active:cursor-grabbing border-2 transition-all hover:shadow-md ${(draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.id) === item.id ? 'border-blue-400 bg-blue-50' : 'border-gray-200'}`,\n            draggable: \"true\",\n            onDragStart: e => handleMediaDragStart(e, item),\n            onDragEnd: handleMediaDragEnd,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"aspect-video bg-gray-200 rounded-lg mb-2 overflow-hidden\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: item.thumbnail,\n                alt: item.name,\n                className: \"w-full h-full object-cover\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1108,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1107,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-medium text-gray-900 truncate\",\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1115,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-gray-500 text-xs mt-1 flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"capitalize\",\n                  children: item.type\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1119,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: formatTime(item.duration)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1120,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1118,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1114,\n              columnNumber: 17\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1098,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1096,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1091,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${isDragging || isTimelineDragging || isResizing ? \"border-blue-400 bg-blue-50/20\" : \"border-gray-200\"}`,\n        onWheel: handleWheel,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 p-4 border-b border-gray-200 space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Film, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1140,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Timeline Pro\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1141,\n                columnNumber: 17\n              }, this), draggedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600 text-sm\",\n                children: [\"- \\u0413\\u043E\\u0442\\u043E\\u0432 \\u0434\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C: \\\"\", draggedItem.name, \"\\\" \\u043D\\u0430 \", draggedItem.type === 'video' ? 'Main Video' : draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' : 'Overlay', \" \\u0434\\u043E\\u0440\\u043E\\u0436\\u043A\\u0443\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1143,\n                columnNumber: 19\n              }, this), isDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-600\",\n                children: [\"- Adding \\\"\", draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.name, \"\\\"\", \" \", dropPreview.shouldRipple ? \"⚡ ripple\" : \"📍 exact\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1152,\n                columnNumber: 19\n              }, this), isTimelineDragging && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600\",\n                children: [\"- Moving \\\"\", draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.name, \"\\\"\", \" \", dropPreview.shouldRipple ? \"⚡ push blocks\" : \"📍 exact\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1158,\n                columnNumber: 19\n              }, this), isResizing && resizeItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-orange-600\",\n                children: [\"- Trimming \\\"\", resizeItem.name, \"\\\" (\", resizeHandle, \" edge)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1164,\n                columnNumber: 19\n              }, this), copiedItem && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-600 text-sm\",\n                children: [\"- \\\"\", copiedItem.name, \"\\\" copied (Ctrl+V to paste)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1169,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1139,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomOut,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom Out (-)\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomOut, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1182,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1177,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-gray-500 min-w-12 text-center\",\n                  children: [(timelineZoom * 100).toFixed(0), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1184,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: zoomIn,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Zoom In (+), or Ctrl+Wheel\",\n                  children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1192,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1187,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: resetZoom,\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Reset Zoom (0)\",\n                  children: /*#__PURE__*/_jsxDEV(RotateCcw, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1199,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1194,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"p-1 text-gray-600 hover:text-blue-600 transition-colors\",\n                  title: \"Timeline Controls Help\",\n                  children: /*#__PURE__*/_jsxDEV(HelpCircle, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1205,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1201,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1176,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1175,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1138,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addOverlayTrack,\n                  className: \"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Overlay Track\",\n                  children: /*#__PURE__*/_jsxDEV(Plus, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1219,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1214,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addAudioTrack,\n                  className: \"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Audio Track\",\n                  children: /*#__PURE__*/_jsxDEV(Music, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1226,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1221,\n                  columnNumber: 19\n                }, this), draggedItem && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: addToTimelineAtCurrentTime,\n                  className: \"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200 animate-pulse bg-blue-100\",\n                  title: `Добавить \"${draggedItem.name}\" на ${draggedItem.type === 'video' ? 'Main Video' : draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' : 'Overlay'} дорожку в оптимальную позицию`,\n                  children: /*#__PURE__*/_jsxDEV(Plus, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1238,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1229,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: splitTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Split Selected Item (Ctrl+B) - Cuts item at current time\",\n                  children: /*#__PURE__*/_jsxDEV(Scissors, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1251,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1241,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: copyTimelineItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Copy Selected Item (Ctrl+C) - Copy item to clipboard\",\n                  children: /*#__PURE__*/_jsxDEV(Copy, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1263,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1253,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: pasteTimelineItem,\n                  disabled: !copiedItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${copiedItem ? \"text-green-600 hover:text-green-800 hover:bg-green-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Paste Item (Ctrl+V) - Paste copied item\",\n                  children: /*#__PURE__*/_jsxDEV(Copy, {\n                    size: 16,\n                    className: \"rotate-180\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1275,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1265,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: deleteSelectedItem,\n                  disabled: !selectedTimelineItem,\n                  className: `p-2 rounded-xl transition-all duration-200 ${selectedTimelineItem ? \"text-red-600 hover:text-red-800 hover:bg-red-50\" : \"text-gray-400 cursor-not-allowed\"}`,\n                  title: \"Delete Selected Item (Del/Backspace) - Remove from timeline\",\n                  children: /*#__PURE__*/_jsxDEV(Trash2, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1287,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1277,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1213,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1212,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1211,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 flex min-h-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-12 border-b border-gray-200 flex-shrink-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1296,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: trackLabelsRef,\n              className: \"flex-1 overflow-y-auto overflow-x-hidden\",\n              onScroll: handleTrackLabelsScroll,\n              children: [tracks.overlays.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\",\n                style: {\n                  height: \"60px\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Layers, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1309,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1304,\n                columnNumber: 19\n              }, this)), tracks.main.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\",\n                style: {\n                  height: \"60px\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Video, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1320,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1315,\n                columnNumber: 19\n              }, this)), tracks.audio.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\",\n                style: {\n                  height: \"60px\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Music, {\n                  size: 16,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1331,\n                  columnNumber: 21\n                }, this), track.name]\n              }, track.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1326,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1298,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1295,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: el => {\n              timelineRef.current = el;\n              timelineScrollRef.current = el;\n            },\n            className: \"flex-1 relative overflow-auto bg-white\",\n            onScroll: handleTrackAreaScroll,\n            onDragOver: handleDragOver,\n            onDrop: handleDrop,\n            onDragLeave: handleDragLeave,\n            style: {\n              overflowX: \"auto\",\n              overflowY: \"auto\",\n              scrollbarWidth: \"thin\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${getTimelineWidth()}px`,\n                minHeight: \"100%\",\n                position: \"relative\"\n              },\n              onClick: handleTimelineClick,\n              onDoubleClick: handleTimelineDoubleClick,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\",\n                children: [Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom / 5) + 1\n                }, (_, i) => {\n                  const timeValue = i * 5 / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-0 h-full border-l border-gray-300\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\",\n                      children: formatTime(timeValue)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1375,\n                      columnNumber: 27\n                    }, this)\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1370,\n                    columnNumber: 25\n                  }, this);\n                }), timelineZoom > 2 && Array.from({\n                  length: Math.ceil(videoDuration * timelineZoom) + 1\n                }, (_, i) => {\n                  const timeValue = i / timelineZoom;\n                  const pixelsPerSecond = getPixelsPerSecond();\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute top-8 w-0 h-4 border-l border-gray-200\",\n                    style: {\n                      left: `${timeValue * pixelsPerSecond}px`\n                    }\n                  }, `sub-${i}`, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1390,\n                    columnNumber: 27\n                  }, this);\n                }), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\",\n                  style: {\n                    left: `${currentTime * getPixelsPerSecond()}px`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1399,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1363,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative flex-1\",\n                style: {\n                  height: `${(tracks.overlays.length + tracks.main.length + tracks.audio.length) * 60}px`,\n                  minHeight: \"100%\"\n                },\n                children: [timelineItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(item.trackType)} ${(selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === item.id ? \"ring-2 ring-blue-300\" : \"\"} ${(draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.id) === item.id ? \"opacity-50 z-30\" : \"\"} ${(copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id ? \"ring-2 ring-green-300 ring-dashed\" : \"\"}`,\n                  style: getTimelineItemStyle(item),\n                  onClick: e => {\n                    e.stopPropagation();\n                    setSelectedTimelineItem(item);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, \"left\"),\n                    title: \"Trim start - Drag to adjust start time\",\n                    style: {\n                      background: \"linear-gradient(to right, rgba(255,255,255,0.8), transparent)\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1450,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1441,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    draggable: \"true\",\n                    onDragStart: e => handleTimelineItemDragStart(e, item),\n                    onDragEnd: handleTimelineItemDragEnd,\n                    className: \"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\",\n                    title: \"Drag to move item on timeline - Ripple mode: pushes other blocks\",\n                    children: [item.name, (copiedItem === null || copiedItem === void 0 ? void 0 : copiedItem.id) === item.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"ml-2 text-green-200\",\n                      children: \"\\uD83D\\uDCCB\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1462,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1453,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\",\n                    onMouseDown: e => handleResizeStart(e, item, \"right\"),\n                    title: \"Trim end - Drag to adjust duration\",\n                    style: {\n                      background: \"linear-gradient(to left, rgba(255,255,255,0.8), transparent)\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-0.5 h-6 bg-white rounded-full opacity-80\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1475,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1466,\n                    columnNumber: 23\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1420,\n                  columnNumber: 21\n                }, this)), dropPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `absolute h-10 rounded-lg border-2 transition-all ${dropPreview.isValid ? dropPreview.isExact ? `${getTrackColor(dropPreview.trackType)} bg-opacity-60 border-solid` : `${getTrackColor(dropPreview.trackType)} bg-opacity-40 border-dashed animate-pulse` : \"bg-red-300 border-red-500 border-dashed\"}`,\n                  style: getDropPreviewStyle(),\n                  children: dropPreview.isValid && !dropPreview.isExact && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center h-full text-white text-xs font-bold\",\n                    children: \"\\uD83E\\uDDF2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1496,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1481,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1407,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1354,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1338,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1294,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 border border-blue-200 rounded-2xl p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-semibold text-blue-900 mb-2\",\n          children: \"\\u041A\\u0430\\u043A \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1510,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-blue-800 text-sm space-y-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 \\u041F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u0432\\u0438\\u0434\\u0435\\u043E \\u0438\\u0437 Media Library \\u043D\\u0430 timeline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1512,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 \\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 Play \\u0432 \\u0432\\u0438\\u0434\\u0435\\u043E\\u043F\\u043B\\u0435\\u0435\\u0440\\u0435 \\u0434\\u043B\\u044F \\u0432\\u043E\\u0441\\u043F\\u0440\\u043E\\u0438\\u0437\\u0432\\u0435\\u0434\\u0435\\u043D\\u0438\\u044F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1513,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 \\u041A\\u043B\\u0438\\u043A\\u043D\\u0438\\u0442\\u0435 \\u043F\\u043E timeline \\u0434\\u043B\\u044F \\u043F\\u0435\\u0440\\u0435\\u043C\\u0435\\u0449\\u0435\\u043D\\u0438\\u044F \\u043F\\u043E \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1514,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 Overlay \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u044B \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0430\\u044E\\u0442\\u0441\\u044F \\u043F\\u043E\\u0432\\u0435\\u0440\\u0445 \\u043E\\u0441\\u043D\\u043E\\u0432\\u043D\\u043E\\u0433\\u043E \\u0432\\u0438\\u0434\\u0435\\u043E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1515,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 Audio \\u0434\\u043E\\u0440\\u043E\\u0436\\u043A\\u0438 \\u0432\\u043E\\u0441\\u043F\\u0440\\u043E\\u0438\\u0437\\u0432\\u043E\\u0434\\u044F\\u0442\\u0441\\u044F \\u0432\\u043C\\u0435\\u0441\\u0442\\u0435 \\u0441 \\u0432\\u0438\\u0434\\u0435\\u043E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1516,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2022 \\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0439\\u0442\\u0435 Ctrl+\\u043A\\u043E\\u043B\\u0435\\u0441\\u043E \\u0434\\u043B\\u044F \\u0437\\u0443\\u043C\\u0430, Shift+\\u043A\\u043E\\u043B\\u0435\\u0441\\u043E \\u0434\\u043B\\u044F \\u043F\\u0440\\u043E\\u043A\\u0440\\u0443\\u0442\\u043A\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1517,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1511,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1509,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 976,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 975,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoTimelineSystem, \"C17ni+bfWyw59hzl4jxAmj+/yqo=\");\n_c = VideoTimelineSystem;\nexport default VideoTimelineSystem;\nvar _c;\n$RefreshReg$(_c, \"VideoTimelineSystem\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Video","Music","Copy","Trash2","Scissors","Film","Plus","Layers","ZoomIn","ZoomOut","RotateCcw","HelpCircle","Play","Pause","SkipBack","SkipForward","Volume2","Image","FileText","jsxDEV","_jsxDEV","VideoTimelineSystem","_s","timelineItems","setTimelineItems","currentTime","setCurrentTime","videoDuration","setVideoDuration","selectedTimelineItem","setSelectedTimelineItem","timelineZoom","setTimelineZoom","isPlaying","setIsPlaying","volume","setVolume","draggedItem","setDraggedItem","draggedTimelineItem","setDraggedTimelineItem","dropPreview","setDropPreview","isDragging","setIsDragging","isTimelineDragging","setIsTimelineDragging","isResizing","setIsResizing","copiedItem","setCopiedItem","dragOffset","setDragOffset","resizeHandle","setResizeHandle","resizeItem","setResizeItem","originalItemData","setOriginalItemData","timelineRef","timelineScrollRef","trackLabelsRef","autoScrollIntervalRef","videoRef","tracks","setTracks","overlays","id","name","type","main","audio","mediaLibrary","duration","src","thumbnail","text","fontSize","color","getActiveItems","filter","item","itemStart","startTime","itemEnd","sort","a","b","trackOrder","overlay","aOrder","trackType","bOrder","activeItems","mainVideoItem","find","overlayItems","audioItems","interval","setInterval","prevTime","newTime","clearInterval","current","videoElement","relativeTime","Math","abs","max","play","catch","console","error","pause","formatTime","seconds","mins","floor","secs","frames","toString","padStart","seekTo","time","min","stopAutoScroll","startAutoScroll","direction","speed","scrollAmount","currentScrollLeft","scrollLeft","maxScroll","scrollWidth","clientWidth","checkAutoScroll","clientX","rect","getBoundingClientRect","scrollZoneWidth","relativeX","left","width","getTargetTrackForType","mediaType","_tracks$main","_tracks$audio","_tracks$overlays","_tracks$main2","_tracks$main2$","mainTrack","audioTrack","overlayTrack","findBestPositionForItem","targetTrackId","itemsOnTrack","timelineItem","trackId","length","hasSpaceAtCurrentTime","some","existingItem","existingStart","existingEnd","newStart","newEnd","lastItem","addToTimeline","t","newTimelineItem","Date","now","originalId","prev","newEndTime","insertWithRipple","excludeId","shouldRipple","affectedItems","applyRippleEffect","shiftDuration","removeFromTimeline","itemId","addToTimelineAtCurrentTime","bestPosition","splitTimelineItem","splitTime","firstPart","secondPart","map","concat","copyTimelineItem","pasteTimelineItem","newItem","deleteSelectedItem","handleWheel","e","ctrlKey","preventDefault","mouseX","currentPixelsPerSecond","timeAtMouse","zoomDirection","deltaY","zoomStep","prevZoom","newZoom","requestAnimationFrame","newPixelsPerSecond","newMouseX","targetScrollLeft","shiftKey","zoomIn","zoomOut","resetZoom","handlePlayPause","handleSeekBackward","handleSeekForward","handleResizeStart","handle","stopPropagation","handleResizeEnd","addOverlayTrack","newTrackId","addAudioTrack","handleTrackAreaScroll","scrollTop","target","handleTrackLabelsScroll","getTimelineWidth","baseWidth","getPixelsPerSecond","handleTimelineClick","clickX","pixelsPerSecond","clickTime","handleTimelineDoubleClick","handleTimelineItemDragStart","itemRect","dataTransfer","effectAllowed","setData","handleTimelineItemDragEnd","handleDragOver","dropEffect","timelineRect","dragX","dropTime","dragY","clientY","top","trackHeight","timeRulerHeight","relativeY","trackIndex","allTracks","targetTrack","insertResult","isValid","handleDrop","_dropPreview$affected","_dropPreview$affected2","handleDragLeave","_timelineRef$current","contains","relatedTarget","getTimelineItemStyle","findIndex","track","getDropPreviewStyle","getTrackColor","handleMediaDragStart","handleMediaDragEnd","renderVideoContent","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","ref","onTimeUpdate","videoTime","timelineTime","onLoadedMetadata","index","style","zIndex","alt","opacity","transform","scale","handleMouseMove","minDuration","rightEdge","newStartTime","newDuration","leftEdge","handleMouseUp","document","addEventListener","removeEventListener","onClick","title","step","value","onChange","parseFloat","draggable","onDragStart","onDragEnd","onWheel","toFixed","disabled","onScroll","height","el","onDragOver","onDrop","onDragLeave","overflowX","overflowY","scrollbarWidth","minHeight","position","onDoubleClick","Array","from","ceil","_","i","timeValue","onMouseDown","background","isExact","_c","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/Timeline.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Video,\r\n  Music,\r\n  Copy,\r\n  Trash2,\r\n  Scissors,\r\n  Film,\r\n  Plus,\r\n  Layers,\r\n  ZoomIn,\r\n  ZoomOut,\r\n  RotateCcw,\r\n  HelpCircle,\r\n  Play,\r\n  Pause,\r\n  SkipBack,\r\n  SkipForward,\r\n  Volume2,\r\n  Image,\r\n  FileText,\r\n} from \"lucide-react\";\r\n\r\nconst VideoTimelineSystem = () => {\r\n  // Состояния для timeline\r\n  const [timelineItems, setTimelineItems] = useState([]);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [videoDuration, setVideoDuration] = useState(60);\r\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\r\n  const [timelineZoom, setTimelineZoom] = useState(1);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [volume, setVolume] = useState(1);\r\n  \r\n  // Состояния для drag & drop\r\n  const [draggedItem, setDraggedItem] = useState(null);\r\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\r\n  const [dropPreview, setDropPreview] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\r\n  const [isResizing, setIsResizing] = useState(false);\r\n  const [copiedItem, setCopiedItem] = useState(null);\r\n\r\n  // Timeline-specific states\r\n  const [dragOffset, setDragOffset] = useState(0);\r\n  const [resizeHandle, setResizeHandle] = useState(null);\r\n  const [resizeItem, setResizeItem] = useState(null);\r\n  const [originalItemData, setOriginalItemData] = useState(null);\r\n\r\n  // Refs\r\n  const timelineRef = useRef(null);\r\n  const timelineScrollRef = useRef(null);\r\n  const trackLabelsRef = useRef(null);\r\n  const autoScrollIntervalRef = useRef(null);\r\n  const videoRef = useRef(null);\r\n\r\n  // Дорожки\r\n  const [tracks, setTracks] = useState({\r\n    overlays: [\r\n      { id: \"overlay-1\", name: \"Overlay 1\", type: \"overlay\" },\r\n    ],\r\n    main: [\r\n      { id: \"main-1\", name: \"Main Video\", type: \"main\" },\r\n    ],\r\n    audio: [\r\n      { id: \"audio-1\", name: \"Audio 1\", type: \"audio\" },\r\n    ],\r\n  });\r\n\r\n  // Тестовые медиа файлы\r\n  const [mediaLibrary] = useState([\r\n    {\r\n      id: \"video-1\",\r\n      name: \"Sample Video 1\",\r\n      type: \"video\",\r\n      duration: 15,\r\n      src: \"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4\",\r\n      thumbnail: \"https://via.placeholder.com/200x112/3b82f6/ffffff?text=Video+1\",\r\n    },\r\n    {\r\n      id: \"video-2\", \r\n      name: \"Sample Video 2\",\r\n      type: \"video\",\r\n      duration: 12,\r\n      src: \"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4\",\r\n      thumbnail: \"https://via.placeholder.com/200x112/3b82f6/ffffff?text=Video+2\",\r\n    },\r\n    {\r\n      id: \"audio-1\",\r\n      name: \"Background Music\",\r\n      type: \"audio\",\r\n      duration: 30,\r\n      src: \"https://www.soundjay.com/misc/sounds/bell-ringing-05.wav\",\r\n      thumbnail: \"https://via.placeholder.com/200x112/10b981/ffffff?text=Audio\",\r\n    },\r\n    {\r\n      id: \"image-1\",\r\n      name: \"Logo Overlay\",\r\n      type: \"image\",\r\n      duration: 5,\r\n      src: \"https://via.placeholder.com/400x300/8b5cf6/ffffff?text=Logo\",\r\n      thumbnail: \"https://via.placeholder.com/200x112/8b5cf6/ffffff?text=Image\",\r\n    },\r\n    {\r\n      id: \"text-1\",\r\n      name: \"Title Text\",\r\n      type: \"text\",\r\n      duration: 3,\r\n      text: \"Welcome to Our Video\",\r\n      fontSize: \"32px\",\r\n      color: \"#ffffff\",\r\n      thumbnail: \"https://via.placeholder.com/200x112/f59e0b/ffffff?text=Text\",\r\n    },\r\n  ]);\r\n\r\n  // Получаем активные элементы в текущем времени\r\n  const getActiveItems = useCallback(() => {\r\n    return timelineItems.filter(item => {\r\n      const itemStart = item.startTime;\r\n      const itemEnd = item.startTime + item.duration;\r\n      return currentTime >= itemStart && currentTime < itemEnd;\r\n    }).sort((a, b) => {\r\n      // Сортируем по типу дорожки: main -> overlays -> audio\r\n      const trackOrder = { main: 0, overlay: 1, audio: 2 };\r\n      const aOrder = trackOrder[a.trackType] || 3;\r\n      const bOrder = trackOrder[b.trackType] || 3;\r\n      return aOrder - bOrder;\r\n    });\r\n  }, [timelineItems, currentTime]);\r\n\r\n  const activeItems = getActiveItems();\r\n  const mainVideoItem = activeItems.find(item => item.trackType === 'main');\r\n  const overlayItems = activeItems.filter(item => item.trackType === 'overlay');\r\n  const audioItems = activeItems.filter(item => item.trackType === 'audio');\r\n\r\n  // Автообновление времени при воспроизведении\r\n  useEffect(() => {\r\n    let interval = null;\r\n    if (isPlaying) {\r\n      interval = setInterval(() => {\r\n        setCurrentTime(prevTime => {\r\n          const newTime = prevTime + 0.1;\r\n          if (newTime >= videoDuration) {\r\n            setIsPlaying(false);\r\n            return videoDuration;\r\n          }\r\n          return newTime;\r\n        });\r\n      }, 100);\r\n    }\r\n    return () => {\r\n      if (interval) clearInterval(interval);\r\n    };\r\n  }, [isPlaying, videoDuration]);\r\n\r\n  // Обновляем время видео при изменении currentTime\r\n  useEffect(() => {\r\n    if (videoRef.current && mainVideoItem) {\r\n      const videoElement = videoRef.current;\r\n      const relativeTime = currentTime - mainVideoItem.startTime;\r\n      \r\n      if (Math.abs(videoElement.currentTime - relativeTime) > 0.1) {\r\n        videoElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    }\r\n  }, [currentTime, mainVideoItem]);\r\n\r\n  // Управление воспроизведением\r\n  useEffect(() => {\r\n    if (videoRef.current && mainVideoItem) {\r\n      if (isPlaying) {\r\n        videoRef.current.play().catch(console.error);\r\n      } else {\r\n        videoRef.current.pause();\r\n      }\r\n    }\r\n  }, [isPlaying, mainVideoItem]);\r\n\r\n  // Обновление громкости\r\n  useEffect(() => {\r\n    if (videoRef.current) {\r\n      videoRef.current.volume = volume;\r\n    }\r\n  }, [volume]);\r\n\r\n  // Утилитарные функции\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    const frames = Math.floor((seconds % 1) * 30);\r\n    return `${mins.toString().padStart(2, \"0\")}:${secs\r\n      .toString()\r\n      .padStart(2, \"0\")}:${frames.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  const seekTo = (time) => {\r\n    setCurrentTime(Math.max(0, Math.min(videoDuration, time)));\r\n  };\r\n\r\n  // Автопрокрутка\r\n  const stopAutoScroll = useCallback(() => {\r\n    if (autoScrollIntervalRef.current) {\r\n      clearInterval(autoScrollIntervalRef.current);\r\n      autoScrollIntervalRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const startAutoScroll = useCallback(\r\n    (direction, speed = 1) => {\r\n      stopAutoScroll();\r\n\r\n      autoScrollIntervalRef.current = setInterval(() => {\r\n        if (timelineScrollRef.current) {\r\n          const scrollAmount = 15 * speed;\r\n          const currentScrollLeft = timelineScrollRef.current.scrollLeft;\r\n          const maxScroll =\r\n            timelineScrollRef.current.scrollWidth -\r\n            timelineScrollRef.current.clientWidth;\r\n\r\n          if (direction === \"left\" && currentScrollLeft > 0) {\r\n            timelineScrollRef.current.scrollLeft = Math.max(\r\n              0,\r\n              currentScrollLeft - scrollAmount\r\n            );\r\n          } else if (direction === \"right\" && currentScrollLeft < maxScroll) {\r\n            timelineScrollRef.current.scrollLeft = Math.min(\r\n              maxScroll,\r\n              currentScrollLeft + scrollAmount\r\n            );\r\n          }\r\n        }\r\n      }, 16);\r\n    },\r\n    [stopAutoScroll]\r\n  );\r\n\r\n  const checkAutoScroll = useCallback(\r\n    (clientX) => {\r\n      if (!timelineScrollRef.current) return;\r\n\r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const scrollZoneWidth = 120;\r\n      const relativeX = clientX - rect.left;\r\n\r\n      if (\r\n        relativeX < scrollZoneWidth &&\r\n        timelineScrollRef.current.scrollLeft > 0\r\n      ) {\r\n        const speed = ((scrollZoneWidth - relativeX) / scrollZoneWidth) * 3;\r\n        startAutoScroll(\"left\", speed);\r\n      } else if (relativeX > rect.width - scrollZoneWidth) {\r\n        const maxScroll =\r\n          timelineScrollRef.current.scrollWidth -\r\n          timelineScrollRef.current.clientWidth;\r\n        if (timelineScrollRef.current.scrollLeft < maxScroll) {\r\n          const speed =\r\n            ((relativeX - (rect.width - scrollZoneWidth)) / scrollZoneWidth) *\r\n            3;\r\n          startAutoScroll(\"right\", speed);\r\n        }\r\n      } else {\r\n        stopAutoScroll();\r\n      }\r\n    },\r\n    [startAutoScroll, stopAutoScroll]\r\n  );\r\n\r\n  // Автоматическое определение дорожки по типу медиа\r\n  const getTargetTrackForType = useCallback((mediaType) => {\r\n    switch (mediaType) {\r\n      case \"video\":\r\n        const mainTrack = tracks.main?.[0];\r\n        return mainTrack?.id;\r\n      case \"audio\":\r\n      case \"music\":\r\n        const audioTrack = tracks.audio?.[0];\r\n        return audioTrack?.id;\r\n      case \"image\":\r\n      case \"text\":\r\n        const overlayTrack = tracks.overlays?.[0];\r\n        return overlayTrack?.id;\r\n      default:\r\n        return tracks.main?.[0]?.id;\r\n    }\r\n  }, [tracks]);\r\n\r\n  // Находим лучшую позицию для размещения элемента\r\n  const findBestPositionForItem = useCallback((item, targetTrackId) => {\r\n    const duration = item.duration || (item.type === \"image\" ? 5 : 10);\r\n    \r\n    // Получаем все элементы на целевой дорожке\r\n    const itemsOnTrack = timelineItems\r\n      .filter(timelineItem => timelineItem.trackId === targetTrackId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n    \r\n    // Если нет элементов на дорожке, размещаем в текущей позиции\r\n    if (itemsOnTrack.length === 0) {\r\n      return currentTime;\r\n    }\r\n    \r\n    // Проверяем, есть ли место в текущей позиции\r\n    const hasSpaceAtCurrentTime = !itemsOnTrack.some(existingItem => {\r\n      const existingStart = existingItem.startTime;\r\n      const existingEnd = existingItem.startTime + existingItem.duration;\r\n      const newStart = currentTime;\r\n      const newEnd = currentTime + duration;\r\n      \r\n      // Проверяем пересечение\r\n      return !(newEnd <= existingStart || newStart >= existingEnd);\r\n    });\r\n    \r\n    if (hasSpaceAtCurrentTime) {\r\n      return currentTime;\r\n    }\r\n    \r\n    // Если в текущей позиции нет места, размещаем после последнего элемента\r\n    const lastItem = itemsOnTrack[itemsOnTrack.length - 1];\r\n    return lastItem.startTime + lastItem.duration;\r\n  }, [timelineItems, currentTime]);\r\n\r\n  // Функции timeline\r\n  const addToTimeline = (item, startTime, trackId) => {\r\n    const trackType = tracks.overlays.find(t => t.id === trackId) ? 'overlay' :\r\n                     tracks.main.find(t => t.id === trackId) ? 'main' : 'audio';\r\n    \r\n    const newTimelineItem = {\r\n      ...item,\r\n      id: `timeline-${Date.now()}`,\r\n      originalId: item.id,\r\n      startTime,\r\n      trackId,\r\n      trackType,\r\n    };\r\n\r\n    setTimelineItems(prev => [...prev, newTimelineItem]);\r\n    \r\n    // Расширяем duration если нужно\r\n    const newEndTime = startTime + item.duration;\r\n    if (newEndTime > videoDuration) {\r\n      setVideoDuration(newEndTime + 10);\r\n    }\r\n  };\r\n\r\n  const insertWithRipple = (trackId, time, duration, excludeId = null) => {\r\n    return {\r\n      time,\r\n      shouldRipple: false,\r\n      affectedItems: [],\r\n    };\r\n  };\r\n\r\n  const applyRippleEffect = (affectedItems, shiftDuration) => {\r\n    // Логика ripple effect\r\n  };\r\n\r\n  const removeFromTimeline = (itemId) => {\r\n    setTimelineItems(prev => prev.filter(item => item.id !== itemId));\r\n  };\r\n\r\n  // Умное размещение элемента на правильной дорожке\r\n  const addToTimelineAtCurrentTime = useCallback(() => {\r\n    if (!draggedItem) return;\r\n    \r\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n    if (!targetTrackId) return;\r\n    \r\n    // Находим лучшую позицию для размещения\r\n    const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\r\n    addToTimeline(draggedItem, bestPosition, targetTrackId);\r\n  }, [draggedItem, getTargetTrackForType, findBestPositionForItem]);\r\n\r\n  const splitTimelineItem = () => {\r\n    if (!selectedTimelineItem) return;\r\n    \r\n    const item = selectedTimelineItem;\r\n    const splitTime = currentTime - item.startTime;\r\n    \r\n    if (splitTime <= 0 || splitTime >= item.duration) return;\r\n    \r\n    const firstPart = {\r\n      ...item,\r\n      id: `timeline-${Date.now()}-1`,\r\n      duration: splitTime,\r\n    };\r\n    \r\n    const secondPart = {\r\n      ...item,\r\n      id: `timeline-${Date.now()}-2`,\r\n      startTime: item.startTime + splitTime,\r\n      duration: item.duration - splitTime,\r\n    };\r\n    \r\n    setTimelineItems(prev => \r\n      prev.map(timelineItem => \r\n        timelineItem.id === item.id ? firstPart : timelineItem\r\n      ).concat(secondPart)\r\n    );\r\n    \r\n    setSelectedTimelineItem(firstPart);\r\n  };\r\n\r\n  const copyTimelineItem = () => {\r\n    if (selectedTimelineItem) {\r\n      setCopiedItem(selectedTimelineItem);\r\n    }\r\n  };\r\n\r\n  const pasteTimelineItem = () => {\r\n    if (!copiedItem) return;\r\n    \r\n    const newItem = {\r\n      ...copiedItem,\r\n      id: `timeline-${Date.now()}`,\r\n      startTime: currentTime,\r\n    };\r\n    \r\n    setTimelineItems(prev => [...prev, newItem]);\r\n  };\r\n\r\n  const deleteSelectedItem = () => {\r\n    if (selectedTimelineItem) {\r\n      removeFromTimeline(selectedTimelineItem.id);\r\n      setSelectedTimelineItem(null);\r\n    }\r\n  };\r\n\r\n  // Зум и прокрутка колесом мыши\r\n  const handleWheel = useCallback((e) => {\r\n    if (e.ctrlKey) {\r\n      e.preventDefault();\r\n      \r\n      if (!timelineScrollRef.current) return;\r\n      \r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const currentPixelsPerSecond = 50 * timelineZoom;\r\n      const timeAtMouse = mouseX / currentPixelsPerSecond;\r\n      \r\n      const zoomDirection = e.deltaY < 0 ? 1 : -1;\r\n      const zoomStep = 1.2;\r\n      \r\n      setTimelineZoom((prevZoom) => {\r\n        let newZoom;\r\n        if (zoomDirection > 0) {\r\n          newZoom = Math.min(20, prevZoom * zoomStep);\r\n        } else {\r\n          newZoom = Math.max(0.1, prevZoom / zoomStep);\r\n        }\r\n        \r\n        requestAnimationFrame(() => {\r\n          if (timelineScrollRef.current) {\r\n            const newPixelsPerSecond = 50 * newZoom;\r\n            const newMouseX = timeAtMouse * newPixelsPerSecond;\r\n            const targetScrollLeft = newMouseX - (e.clientX - rect.left);\r\n            timelineScrollRef.current.scrollLeft = Math.max(0, targetScrollLeft);\r\n          }\r\n        });\r\n        \r\n        return newZoom;\r\n      });\r\n    } else if (e.shiftKey) {\r\n      e.preventDefault();\r\n      \r\n      if (timelineScrollRef.current) {\r\n        const scrollAmount = e.deltaY * 2;\r\n        timelineScrollRef.current.scrollLeft += scrollAmount;\r\n      }\r\n    }\r\n  }, [timelineZoom, setTimelineZoom]);\r\n\r\n  // Функции зума\r\n  const zoomIn = () => {\r\n    setTimelineZoom((prev) => Math.min(20, prev * 1.5));\r\n  };\r\n\r\n  const zoomOut = () => {\r\n    setTimelineZoom((prev) => Math.max(0.1, prev / 1.5));\r\n  };\r\n\r\n  const resetZoom = () => {\r\n    setTimelineZoom(1);\r\n  };\r\n\r\n  // Player controls\r\n  const handlePlayPause = () => {\r\n    setIsPlaying(!isPlaying);\r\n  };\r\n\r\n  const handleSeekBackward = () => {\r\n    seekTo(Math.max(0, currentTime - 10));\r\n  };\r\n\r\n  const handleSeekForward = () => {\r\n    seekTo(Math.min(videoDuration, currentTime + 10));\r\n  };\r\n\r\n  // Функции для resize\r\n  const handleResizeStart = useCallback(\r\n    (e, item, handle) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      setIsResizing(true);\r\n      setResizeHandle(handle);\r\n      setResizeItem(item);\r\n      setOriginalItemData({\r\n        startTime: item.startTime,\r\n        duration: item.duration,\r\n      });\r\n\r\n      setIsTimelineDragging(false);\r\n      setDraggedTimelineItem(null);\r\n    },\r\n    [setIsResizing, setIsTimelineDragging, setDraggedTimelineItem]\r\n  );\r\n\r\n  const handleResizeEnd = useCallback(() => {\r\n    setIsResizing(false);\r\n    setResizeHandle(null);\r\n    setResizeItem(null);\r\n    setOriginalItemData(null);\r\n    stopAutoScroll();\r\n  }, [setIsResizing, stopAutoScroll]);\r\n\r\n  // Добавление треков\r\n  const addOverlayTrack = () => {\r\n    const newTrackId = `overlay-${Date.now()}`;\r\n    setTracks((prev) => ({\r\n      ...prev,\r\n      overlays: [\r\n        ...prev.overlays,\r\n        {\r\n          id: newTrackId,\r\n          name: `Overlay ${prev.overlays.length + 1}`,\r\n          type: \"overlay\",\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  const addAudioTrack = () => {\r\n    const newTrackId = `audio-${Date.now()}`;\r\n    setTracks((prev) => ({\r\n      ...prev,\r\n      audio: [\r\n        ...prev.audio,\r\n        {\r\n          id: newTrackId,\r\n          name: `Audio ${prev.audio.length + 1}`,\r\n          type: \"audio\",\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  // Синхронизация скролла\r\n  const handleTrackAreaScroll = (e) => {\r\n    if (trackLabelsRef.current) {\r\n      trackLabelsRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const handleTrackLabelsScroll = (e) => {\r\n    if (timelineScrollRef.current) {\r\n      timelineScrollRef.current.scrollTop = e.target.scrollTop;\r\n    }\r\n  };\r\n\r\n  const getTimelineWidth = () => {\r\n    const baseWidth = videoDuration * 50 * timelineZoom;\r\n    return Math.max(baseWidth, 2000);\r\n  };\r\n\r\n  const getPixelsPerSecond = () => {\r\n    return 50 * timelineZoom;\r\n  };\r\n\r\n  // Обработчики событий timeline\r\n  const handleTimelineClick = (e) => {\r\n    if (isDragging || isTimelineDragging || isResizing) return;\r\n\r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    seekTo(clickTime);\r\n  };\r\n\r\n  const handleTimelineDoubleClick = useCallback((e) => {\r\n    if (isDragging || isTimelineDragging || isResizing || !draggedItem) return;\r\n    \r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const clickTime = clickX / pixelsPerSecond;\r\n    \r\n    const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n    if (targetTrackId) {\r\n      addToTimeline(draggedItem, clickTime, targetTrackId);\r\n    }\r\n  }, [isDragging, isTimelineDragging, isResizing, draggedItem, getTargetTrackForType, addToTimeline]);\r\n\r\n  const handleTimelineItemDragStart = (e, timelineItem) => {\r\n    if (isResizing) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n\r\n    e.stopPropagation();\r\n    setDraggedTimelineItem(timelineItem);\r\n    setIsTimelineDragging(true);\r\n\r\n    const rect = timelineScrollRef.current.getBoundingClientRect();\r\n    const itemRect = e.target.getBoundingClientRect();\r\n    setDragOffset(\r\n      e.clientX - itemRect.left + timelineScrollRef.current.scrollLeft\r\n    );\r\n\r\n    e.dataTransfer.effectAllowed = \"move\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleTimelineItemDragEnd = () => {\r\n    setDraggedTimelineItem(null);\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n    setDragOffset(0);\r\n    stopAutoScroll();\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (!draggedItem && !draggedTimelineItem) return;\r\n\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\r\n\r\n    if (draggedTimelineItem || isResizing) {\r\n      checkAutoScroll(e.clientX);\r\n    }\r\n\r\n    const timelineRect = timelineScrollRef.current.getBoundingClientRect();\r\n    const dragX =\r\n      e.clientX -\r\n      timelineRect.left +\r\n      timelineScrollRef.current.scrollLeft -\r\n      (draggedTimelineItem ? dragOffset : 0);\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n    const dropTime = Math.max(0, dragX / pixelsPerSecond);\r\n\r\n    const dragY =\r\n      e.clientY - timelineRect.top + timelineScrollRef.current.scrollTop;\r\n    const trackHeight = 60;\r\n    const timeRulerHeight = 48;\r\n\r\n    const relativeY = dragY - timeRulerHeight;\r\n    const trackIndex = Math.floor(relativeY / trackHeight);\r\n\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const targetTrack = allTracks[trackIndex];\r\n\r\n    if (draggedItem && targetTrack) {\r\n      const duration =\r\n        draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\r\n      const insertResult = insertWithRipple(targetTrack.id, dropTime, duration);\r\n\r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || [],\r\n      });\r\n    } else if (draggedTimelineItem && targetTrack) {\r\n      const insertResult = insertWithRipple(\r\n        targetTrack.id,\r\n        dropTime,\r\n        draggedTimelineItem.duration,\r\n        draggedTimelineItem.id\r\n      );\r\n\r\n      setDropPreview({\r\n        time: insertResult.time,\r\n        duration: draggedTimelineItem.duration,\r\n        trackId: targetTrack.id,\r\n        trackType: targetTrack.type,\r\n        isValid: true,\r\n        shouldRipple: insertResult.shouldRipple,\r\n        affectedItems: insertResult.affectedItems || [],\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    stopAutoScroll();\r\n\r\n    // Если нет валидного preview, но есть draggedItem - используем умную логику размещения\r\n    if (!dropPreview && draggedItem) {\r\n      const targetTrackId = getTargetTrackForType(draggedItem.type);\r\n      if (targetTrackId) {\r\n        const bestPosition = findBestPositionForItem(draggedItem, targetTrackId);\r\n        addToTimeline(draggedItem, bestPosition, targetTrackId);\r\n      }\r\n      setDropPreview(null);\r\n      setIsTimelineDragging(false);\r\n      return;\r\n    }\r\n\r\n    if ((!draggedItem && !draggedTimelineItem) || !dropPreview) return;\r\n\r\n    if (dropPreview.isValid) {\r\n      if (draggedItem) {\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          applyRippleEffect(dropPreview.affectedItems, dropPreview.duration);\r\n        }\r\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.trackId);\r\n      } else if (draggedTimelineItem) {\r\n        if (dropPreview.shouldRipple && dropPreview.affectedItems?.length > 0) {\r\n          applyRippleEffect(\r\n            dropPreview.affectedItems,\r\n            draggedTimelineItem.duration\r\n          );\r\n        }\r\n\r\n        setTimelineItems((prev) =>\r\n          prev.map((item) =>\r\n            item.id === draggedTimelineItem.id\r\n              ? {\r\n                  ...item,\r\n                  startTime: dropPreview.time,\r\n                  trackId: dropPreview.trackId,\r\n                  trackType: dropPreview.trackType,\r\n                }\r\n              : item\r\n          )\r\n        );\r\n\r\n        const newEndTime = dropPreview.time + draggedTimelineItem.duration;\r\n        if (newEndTime > videoDuration) {\r\n          setVideoDuration(newEndTime + 10);\r\n        }\r\n      }\r\n    }\r\n\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    if (!timelineRef.current?.contains(e.relatedTarget)) {\r\n      setDropPreview(null);\r\n      stopAutoScroll();\r\n    }\r\n  };\r\n\r\n  const getTimelineItemStyle = (item) => {\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(\r\n      (track) => track.id === item.trackId\r\n    );\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n\r\n    return {\r\n      left: `${item.startTime * pixelsPerSecond}px`,\r\n      width: `${item.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getDropPreviewStyle = () => {\r\n    if (!dropPreview) return {};\r\n\r\n    const allTracks = [...tracks.overlays, ...tracks.main, ...tracks.audio];\r\n    const trackIndex = allTracks.findIndex(\r\n      (track) => track.id === dropPreview.trackId\r\n    );\r\n    const pixelsPerSecond = getPixelsPerSecond();\r\n\r\n    return {\r\n      left: `${dropPreview.time * pixelsPerSecond}px`,\r\n      width: `${dropPreview.duration * pixelsPerSecond}px`,\r\n      top: `${trackIndex * 60 + 10}px`,\r\n    };\r\n  };\r\n\r\n  const getTrackColor = (trackType) => {\r\n    switch (trackType) {\r\n      case \"overlay\":\r\n        return \"bg-purple-500 border-purple-400\";\r\n      case \"main\":\r\n        return \"bg-blue-500 border-blue-400\";\r\n      case \"audio\":\r\n        return \"bg-green-500 border-green-400\";\r\n      default:\r\n        return \"bg-gray-500 border-gray-400\";\r\n    }\r\n  };\r\n\r\n  // Обработчики drag & drop для медиа библиотеки\r\n  const handleMediaDragStart = (e, item) => {\r\n    setDraggedItem(item);\r\n    setIsDragging(true);\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n  };\r\n\r\n  const handleMediaDragEnd = () => {\r\n    setDraggedItem(null);\r\n    setIsDragging(false);\r\n  };\r\n\r\n  // Рендер видео контента\r\n  const renderVideoContent = () => {\r\n    if (!mainVideoItem) {\r\n      return (\r\n        <div className=\"w-full h-full bg-gray-900 flex items-center justify-center text-white\">\r\n          <div className=\"text-center\">\r\n            <Video size={64} className=\"mx-auto mb-4 text-gray-500\" />\r\n            <p className=\"text-lg\">No video content at current time</p>\r\n            <p className=\"text-sm text-gray-400 mt-2\">\r\n              Add video to timeline or move playhead to video content\r\n            </p>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"relative w-full h-full bg-black\">\r\n        <video\r\n          ref={videoRef}\r\n          className=\"w-full h-full object-contain\"\r\n          src={mainVideoItem.src}\r\n          onTimeUpdate={(e) => {\r\n            if (isPlaying) {\r\n              const videoTime = e.target.currentTime;\r\n              const timelineTime = mainVideoItem.startTime + videoTime;\r\n              if (timelineTime <= mainVideoItem.startTime + mainVideoItem.duration) {\r\n                seekTo(timelineTime);\r\n              } else {\r\n                setIsPlaying(false);\r\n              }\r\n            }\r\n          }}\r\n          onLoadedMetadata={() => {\r\n            if (videoRef.current) {\r\n              const relativeTime = currentTime - mainVideoItem.startTime;\r\n              videoRef.current.currentTime = Math.max(0, relativeTime);\r\n            }\r\n          }}\r\n        />\r\n        \r\n        {/* Overlays */}\r\n        {overlayItems.map((overlay, index) => (\r\n          <div\r\n            key={overlay.id}\r\n            className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"\r\n            style={{ zIndex: 10 + index }}\r\n          >\r\n            {overlay.type === 'image' ? (\r\n              <img\r\n                src={overlay.src}\r\n                alt={overlay.name}\r\n                className=\"max-w-full max-h-full object-contain\"\r\n                style={{\r\n                  opacity: overlay.opacity || 1,\r\n                  transform: `scale(${overlay.scale || 1})`,\r\n                }}\r\n              />\r\n            ) : overlay.type === 'text' ? (\r\n              <div\r\n                className=\"text-white text-center p-4 bg-black bg-opacity-50 rounded\"\r\n                style={{\r\n                  fontSize: overlay.fontSize || '24px',\r\n                  color: overlay.color || 'white',\r\n                }}\r\n              >\r\n                {overlay.text || overlay.name}\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        ))}\r\n        \r\n        {/* Индикатор активных overlay элементов */}\r\n        {overlayItems.length > 0 && (\r\n          <div className=\"absolute top-4 right-4 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-sm\">\r\n            {overlayItems.length} overlay{overlayItems.length > 1 ? 's' : ''}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Эффекты\r\n  useEffect(() => {\r\n    const handleMouseMove = (e) => {\r\n      if (!isResizing || !resizeItem || !timelineScrollRef.current) return;\r\n\r\n      checkAutoScroll(e.clientX);\r\n\r\n      const rect = timelineScrollRef.current.getBoundingClientRect();\r\n      const mouseX =\r\n        e.clientX - rect.left + timelineScrollRef.current.scrollLeft;\r\n      const pixelsPerSecond = getPixelsPerSecond();\r\n      const newTime = mouseX / pixelsPerSecond;\r\n\r\n      setTimelineItems((prev) =>\r\n        prev.map((item) => {\r\n          if (item.id !== resizeItem.id) return item;\r\n\r\n          const minDuration = 0.1;\r\n\r\n          if (resizeHandle === \"left\") {\r\n            const rightEdge =\r\n              originalItemData.startTime + originalItemData.duration;\r\n            const newStartTime = Math.max(\r\n              0,\r\n              Math.min(rightEdge - minDuration, newTime)\r\n            );\r\n            const newDuration = rightEdge - newStartTime;\r\n\r\n            return {\r\n              ...item,\r\n              startTime: newStartTime,\r\n              duration: newDuration,\r\n            };\r\n          } else if (resizeHandle === \"right\") {\r\n            const leftEdge = originalItemData.startTime;\r\n            const newEndTime = Math.max(leftEdge + minDuration, newTime);\r\n            const newDuration = newEndTime - leftEdge;\r\n\r\n            return {\r\n              ...item,\r\n              duration: newDuration,\r\n            };\r\n          }\r\n\r\n          return item;\r\n        })\r\n      );\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      if (isResizing) {\r\n        handleResizeEnd();\r\n      }\r\n    };\r\n\r\n    if (isResizing) {\r\n      document.addEventListener(\"mousemove\", handleMouseMove);\r\n      document.addEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener(\"mousemove\", handleMouseMove);\r\n      document.removeEventListener(\"mouseup\", handleMouseUp);\r\n    };\r\n  }, [\r\n    isResizing,\r\n    resizeItem,\r\n    resizeHandle,\r\n    originalItemData,\r\n    getPixelsPerSecond,\r\n    checkAutoScroll,\r\n    handleResizeEnd,\r\n    setTimelineItems,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      stopAutoScroll();\r\n    };\r\n  }, [stopAutoScroll]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100 p-6\">\r\n      <div className=\"max-w-7xl mx-auto space-y-6\">\r\n        <div className=\"text-center\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n            Video Timeline System\r\n          </h1>\r\n          <p className=\"text-gray-600\">\r\n            Перетащите видео в timeline и нажмите Play для воспроизведения\r\n          </p>\r\n        </div>\r\n\r\n        {/* Video Player */}\r\n        <div className=\"bg-white rounded-2xl shadow-sm border-2 border-gray-200 overflow-hidden\">\r\n          {/* Заголовок плеера */}\r\n          <div className=\"bg-gray-50 p-4 border-b border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n                <Video size={18} />\r\n                <span>Video Player</span>\r\n                {mainVideoItem && (\r\n                  <span className=\"text-blue-600 text-sm\">\r\n                    - Playing: \"{mainVideoItem.name}\"\r\n                  </span>\r\n                )}\r\n                {overlayItems.length > 0 && (\r\n                  <span className=\"text-purple-600 text-sm\">\r\n                    + {overlayItems.length} overlay{overlayItems.length > 1 ? 's' : ''}\r\n                  </span>\r\n                )}\r\n                {audioItems.length > 0 && (\r\n                  <span className=\"text-green-600 text-sm\">\r\n                    + {audioItems.length} audio track{audioItems.length > 1 ? 's' : ''}\r\n                  </span>\r\n                )}\r\n              </h4>\r\n              \r\n              <div className=\"text-sm text-gray-600\">\r\n                {formatTime(currentTime)} / {formatTime(videoDuration)}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Видео область */}\r\n          <div className=\"aspect-video bg-gray-900 relative\">\r\n            {renderVideoContent()}\r\n            \r\n            {/* Элементы управления поверх видео */}\r\n            <div className=\"absolute bottom-4 left-4 right-4 bg-black bg-opacity-50 rounded-lg p-3\">\r\n              <div className=\"flex items-center justify-between text-white\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <button\r\n                    onClick={handleSeekBackward}\r\n                    className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded transition-colors\"\r\n                    title=\"Rewind 10s\"\r\n                  >\r\n                    <SkipBack size={20} />\r\n                  </button>\r\n                  \r\n                  <button\r\n                    onClick={handlePlayPause}\r\n                    className=\"p-3 bg-blue-600 hover:bg-blue-700 rounded-full transition-colors\"\r\n                    title={isPlaying ? \"Pause\" : \"Play\"}\r\n                  >\r\n                    {isPlaying ? <Pause size={24} /> : <Play size={24} />}\r\n                  </button>\r\n                  \r\n                  <button\r\n                    onClick={handleSeekForward}\r\n                    className=\"p-2 hover:bg-white hover:bg-opacity-20 rounded transition-colors\"\r\n                    title=\"Forward 10s\"\r\n                  >\r\n                    <SkipForward size={20} />\r\n                  </button>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Volume2 size={16} />\r\n                  <input\r\n                    type=\"range\"\r\n                    min=\"0\"\r\n                    max=\"1\"\r\n                    step=\"0.1\"\r\n                    value={volume}\r\n                    onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                    className=\"w-20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Информация о активных элементах */}\r\n          {activeItems.length > 0 && (\r\n            <div className=\"p-3 bg-gray-50 border-t border-gray-200\">\r\n              <div className=\"text-sm text-gray-600\">\r\n                <strong>Active items:</strong>\r\n                <div className=\"mt-1 space-y-1\">\r\n                  {activeItems.map(item => (\r\n                    <div key={item.id} className=\"flex items-center space-x-2\">\r\n                      {item.type === 'video' && <Video size={14} className=\"text-blue-600\" />}\r\n                      {item.type === 'audio' && <Music size={14} className=\"text-green-600\" />}\r\n                      {item.type === 'image' && <Image size={14} className=\"text-purple-600\" />}\r\n                      {item.type === 'text' && <FileText size={14} className=\"text-orange-600\" />}\r\n                      <span>{item.name}</span>\r\n                      <span className=\"text-gray-400\">\r\n                        ({formatTime(item.startTime)} - {formatTime(item.startTime + item.duration)})\r\n                      </span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Media Library */}\r\n        <div className=\"bg-white rounded-2xl shadow-sm border-2 border-gray-200 p-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4 flex items-center\">\r\n            <Film size={20} className=\"mr-2\" />\r\n            Media Library\r\n          </h3>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4\">\r\n            {mediaLibrary.map(item => (\r\n              <div\r\n                key={item.id}\r\n                className={`bg-gray-50 rounded-xl p-3 cursor-grab active:cursor-grabbing border-2 transition-all hover:shadow-md ${\r\n                  draggedItem?.id === item.id ? 'border-blue-400 bg-blue-50' : 'border-gray-200'\r\n                }`}\r\n                draggable=\"true\"\r\n                onDragStart={(e) => handleMediaDragStart(e, item)}\r\n                onDragEnd={handleMediaDragEnd}\r\n              >\r\n                <div className=\"aspect-video bg-gray-200 rounded-lg mb-2 overflow-hidden\">\r\n                  <img \r\n                    src={item.thumbnail} \r\n                    alt={item.name}\r\n                    className=\"w-full h-full object-cover\"\r\n                  />\r\n                </div>\r\n                <div className=\"text-sm\">\r\n                  <div className=\"font-medium text-gray-900 truncate\">\r\n                    {item.name}\r\n                  </div>\r\n                  <div className=\"text-gray-500 text-xs mt-1 flex items-center justify-between\">\r\n                    <span className=\"capitalize\">{item.type}</span>\r\n                    <span>{formatTime(item.duration)}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Timeline */}\r\n        <div\r\n          className={`h-80 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden flex flex-col flex-shrink-0 ${\r\n            isDragging || isTimelineDragging || isResizing\r\n              ? \"border-blue-400 bg-blue-50/20\"\r\n              : \"border-gray-200\"\r\n          }`}\r\n          onWheel={handleWheel}\r\n        >\r\n          <div className=\"bg-gray-50 p-4 border-b border-gray-200 space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n                <Film size={18} />\r\n                <span>Timeline Pro</span>\r\n                {draggedItem && (\r\n                  <span className=\"text-blue-600 text-sm\">\r\n                    - Готов добавить: \"{draggedItem.name}\" на {\r\n                      draggedItem.type === 'video' ? 'Main Video' :\r\n                      draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' :\r\n                      'Overlay'\r\n                    } дорожку\r\n                  </span>\r\n                )}\r\n                {isDragging && dropPreview && (\r\n                  <span className=\"text-green-600\">\r\n                    - Adding \"{draggedItem?.name}\"{\" \"}\r\n                    {dropPreview.shouldRipple ? \"⚡ ripple\" : \"📍 exact\"}\r\n                  </span>\r\n                )}\r\n                {isTimelineDragging && dropPreview && (\r\n                  <span className=\"text-blue-600\">\r\n                    - Moving \"{draggedTimelineItem?.name}\"{\" \"}\r\n                    {dropPreview.shouldRipple ? \"⚡ push blocks\" : \"📍 exact\"}\r\n                  </span>\r\n                )}\r\n                {isResizing && resizeItem && (\r\n                  <span className=\"text-orange-600\">\r\n                    - Trimming \"{resizeItem.name}\" ({resizeHandle} edge)\r\n                  </span>\r\n                )}\r\n                {copiedItem && (\r\n                  <span className=\"text-blue-600 text-sm\">\r\n                    - \"{copiedItem.name}\" copied (Ctrl+V to paste)\r\n                  </span>\r\n                )}\r\n              </h4>\r\n\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"flex items-center space-x-2 bg-white rounded-xl p-2 border border-gray-200\">\r\n                  <button\r\n                    onClick={zoomOut}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom Out (-)\"\r\n                  >\r\n                    <ZoomOut size={16} />\r\n                  </button>\r\n                  <span className=\"text-xs text-gray-500 min-w-12 text-center\">\r\n                    {(timelineZoom * 100).toFixed(0)}%\r\n                  </span>\r\n                  <button\r\n                    onClick={zoomIn}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Zoom In (+), or Ctrl+Wheel\"\r\n                  >\r\n                    <ZoomIn size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={resetZoom}\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Reset Zoom (0)\"\r\n                  >\r\n                    <RotateCcw size={16} />\r\n                  </button>\r\n                  <button\r\n                    className=\"p-1 text-gray-600 hover:text-blue-600 transition-colors\"\r\n                    title=\"Timeline Controls Help\"\r\n                  >\r\n                    <HelpCircle size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-6\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button\r\n                    onClick={addOverlayTrack}\r\n                    className=\"p-2 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Overlay Track\"\r\n                  >\r\n                    <Plus size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={addAudioTrack}\r\n                    className=\"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Audio Track\"\r\n                  >\r\n                    <Music size={16} />\r\n                  </button>\r\n                  {draggedItem && (\r\n                    <button\r\n                      onClick={addToTimelineAtCurrentTime}\r\n                      className=\"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200 animate-pulse bg-blue-100\"\r\n                      title={`Добавить \"${draggedItem.name}\" на ${\r\n                        draggedItem.type === 'video' ? 'Main Video' :\r\n                        draggedItem.type === 'audio' || draggedItem.type === 'music' ? 'Audio' :\r\n                        'Overlay'\r\n                      } дорожку в оптимальную позицию`}\r\n                    >\r\n                      <Plus size={16} />\r\n                    </button>\r\n                  )}\r\n                  <button\r\n                    onClick={splitTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem\r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\"\r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Split Selected Item (Ctrl+B) - Cuts item at current time\"\r\n                  >\r\n                    <Scissors size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={copyTimelineItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem\r\n                        ? \"text-blue-600 hover:text-blue-800 hover:bg-blue-50\"\r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Copy Selected Item (Ctrl+C) - Copy item to clipboard\"\r\n                  >\r\n                    <Copy size={16} />\r\n                  </button>\r\n                  <button\r\n                    onClick={pasteTimelineItem}\r\n                    disabled={!copiedItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      copiedItem\r\n                        ? \"text-green-600 hover:text-green-800 hover:bg-green-50\"\r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Paste Item (Ctrl+V) - Paste copied item\"\r\n                  >\r\n                    <Copy size={16} className=\"rotate-180\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={deleteSelectedItem}\r\n                    disabled={!selectedTimelineItem}\r\n                    className={`p-2 rounded-xl transition-all duration-200 ${\r\n                      selectedTimelineItem\r\n                        ? \"text-red-600 hover:text-red-800 hover:bg-red-50\"\r\n                        : \"text-gray-400 cursor-not-allowed\"\r\n                    }`}\r\n                    title=\"Delete Selected Item (Del/Backspace) - Remove from timeline\"\r\n                  >\r\n                    <Trash2 size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 flex min-h-0\">\r\n            <div className=\"w-48 bg-gray-50 border-r border-gray-200 flex-shrink-0 flex flex-col\">\r\n              <div className=\"h-12 border-b border-gray-200 flex-shrink-0\"></div>\r\n\r\n              <div\r\n                ref={trackLabelsRef}\r\n                className=\"flex-1 overflow-y-auto overflow-x-hidden\"\r\n                onScroll={handleTrackLabelsScroll}\r\n              >\r\n                {tracks.overlays.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-purple-700 bg-purple-50 flex-shrink-0\"\r\n                    style={{ height: \"60px\" }}\r\n                  >\r\n                    <Layers size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n\r\n                {tracks.main.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-blue-700 bg-blue-50 flex-shrink-0\"\r\n                    style={{ height: \"60px\" }}\r\n                  >\r\n                    <Video size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n\r\n                {tracks.audio.map((track) => (\r\n                  <div\r\n                    key={track.id}\r\n                    className=\"h-15 flex items-center px-4 border-b border-gray-100 text-sm font-medium text-green-700 bg-green-50 flex-shrink-0\"\r\n                    style={{ height: \"60px\" }}\r\n                  >\r\n                    <Music size={16} className=\"mr-2\" />\r\n                    {track.name}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div\r\n              ref={(el) => {\r\n                timelineRef.current = el;\r\n                timelineScrollRef.current = el;\r\n              }}\r\n              className=\"flex-1 relative overflow-auto bg-white\"\r\n              onScroll={handleTrackAreaScroll}\r\n              onDragOver={handleDragOver}\r\n              onDrop={handleDrop}\r\n              onDragLeave={handleDragLeave}\r\n              style={{\r\n                overflowX: \"auto\",\r\n                overflowY: \"auto\",\r\n                scrollbarWidth: \"thin\",\r\n              }}\r\n            >\r\n              <div\r\n                style={{\r\n                  width: `${getTimelineWidth()}px`,\r\n                  minHeight: \"100%\",\r\n                  position: \"relative\",\r\n                }}\r\n                onClick={handleTimelineClick}\r\n                onDoubleClick={handleTimelineDoubleClick}\r\n              >\r\n                <div className=\"h-12 bg-gray-50 border-b border-gray-200 relative flex-shrink-0\">\r\n                  {Array.from(\r\n                    { length: Math.ceil((videoDuration * timelineZoom) / 5) + 1 },\r\n                    (_, i) => {\r\n                      const timeValue = (i * 5) / timelineZoom;\r\n                      const pixelsPerSecond = getPixelsPerSecond();\r\n                      return (\r\n                        <div\r\n                          key={i}\r\n                          className=\"absolute top-0 h-full border-l border-gray-300\"\r\n                          style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                        >\r\n                          <span className=\"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\">\r\n                            {formatTime(timeValue)}\r\n                          </span>\r\n                        </div>\r\n                      );\r\n                    }\r\n                  )}\r\n\r\n                  {timelineZoom > 2 &&\r\n                    Array.from(\r\n                      { length: Math.ceil(videoDuration * timelineZoom) + 1 },\r\n                      (_, i) => {\r\n                        const timeValue = i / timelineZoom;\r\n                        const pixelsPerSecond = getPixelsPerSecond();\r\n                        return (\r\n                          <div\r\n                            key={`sub-${i}`}\r\n                            className=\"absolute top-8 w-0 h-4 border-l border-gray-200\"\r\n                            style={{ left: `${timeValue * pixelsPerSecond}px` }}\r\n                          />\r\n                        );\r\n                      }\r\n                    )}\r\n\r\n                  <div\r\n                    className=\"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\"\r\n                    style={{\r\n                      left: `${currentTime * getPixelsPerSecond()}px`,\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div\r\n                  className=\"relative flex-1\"\r\n                  style={{\r\n                    height: `${\r\n                      (tracks.overlays.length +\r\n                        tracks.main.length +\r\n                        tracks.audio.length) *\r\n                      60\r\n                    }px`,\r\n                    minHeight: \"100%\",\r\n                  }}\r\n                >\r\n                  {timelineItems.map((item) => (\r\n                    <div\r\n                      key={item.id}\r\n                      className={`absolute h-10 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md group ${getTrackColor(\r\n                        item.trackType\r\n                      )} ${\r\n                        selectedTimelineItem?.id === item.id\r\n                          ? \"ring-2 ring-blue-300\"\r\n                          : \"\"\r\n                      } ${\r\n                        draggedTimelineItem?.id === item.id ? \"opacity-50 z-30\" : \"\"\r\n                      } ${\r\n                        copiedItem?.id === item.id\r\n                          ? \"ring-2 ring-green-300 ring-dashed\"\r\n                          : \"\"\r\n                      }`}\r\n                      style={getTimelineItemStyle(item)}\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setSelectedTimelineItem(item);\r\n                      }}\r\n                    >\r\n                      <div\r\n                        className=\"absolute left-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-l-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, \"left\")}\r\n                        title=\"Trim start - Drag to adjust start time\"\r\n                        style={{\r\n                          background:\r\n                            \"linear-gradient(to right, rgba(255,255,255,0.8), transparent)\",\r\n                        }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n\r\n                      <div\r\n                        draggable=\"true\"\r\n                        onDragStart={(e) => handleTimelineItemDragStart(e, item)}\r\n                        onDragEnd={handleTimelineItemDragEnd}\r\n                        className=\"p-2 text-white text-xs truncate font-medium flex items-center h-full mx-3 cursor-grab active:cursor-grabbing\"\r\n                        title=\"Drag to move item on timeline - Ripple mode: pushes other blocks\"\r\n                      >\r\n                        {item.name}\r\n                        {copiedItem?.id === item.id && (\r\n                          <span className=\"ml-2 text-green-200\">📋</span>\r\n                        )}\r\n                      </div>\r\n\r\n                      <div\r\n                        className=\"absolute right-0 top-0 w-3 h-full cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/50 rounded-r-lg z-10 flex items-center justify-center\"\r\n                        onMouseDown={(e) => handleResizeStart(e, item, \"right\")}\r\n                        title=\"Trim end - Drag to adjust duration\"\r\n                        style={{\r\n                          background:\r\n                            \"linear-gradient(to left, rgba(255,255,255,0.8), transparent)\",\r\n                        }}\r\n                      >\r\n                        <div className=\"w-0.5 h-6 bg-white rounded-full opacity-80\"></div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n\r\n                  {dropPreview && (\r\n                    <div\r\n                      className={`absolute h-10 rounded-lg border-2 transition-all ${\r\n                        dropPreview.isValid\r\n                          ? dropPreview.isExact\r\n                            ? `${getTrackColor(\r\n                                dropPreview.trackType\r\n                              )} bg-opacity-60 border-solid`\r\n                            : `${getTrackColor(\r\n                                dropPreview.trackType\r\n                              )} bg-opacity-40 border-dashed animate-pulse`\r\n                          : \"bg-red-300 border-red-500 border-dashed\"\r\n                      }`}\r\n                      style={getDropPreviewStyle()}\r\n                    >\r\n                      {dropPreview.isValid && !dropPreview.isExact && (\r\n                        <div className=\"flex items-center justify-center h-full text-white text-xs font-bold\">\r\n                          🧲\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Инструкции */}\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-2xl p-4\">\r\n          <h4 className=\"font-semibold text-blue-900 mb-2\">Как использовать:</h4>\r\n          <ul className=\"text-blue-800 text-sm space-y-1\">\r\n            <li>• Перетащите видео из Media Library на timeline</li>\r\n            <li>• Нажмите Play в видеоплеере для воспроизведения</li>\r\n            <li>• Кликните по timeline для перемещения по времени</li>\r\n            <li>• Overlay элементы отображаются поверх основного видео</li>\r\n            <li>• Audio дорожки воспроизводятся вместе с видео</li>\r\n            <li>• Используйте Ctrl+колесо для зума, Shift+колесо для прокрутки</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoTimelineSystem;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}