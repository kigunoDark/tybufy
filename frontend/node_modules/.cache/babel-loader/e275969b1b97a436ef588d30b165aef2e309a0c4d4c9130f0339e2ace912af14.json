{"ast":null,"code":"var _jsxFileName = \"C:\\\\Scriptify\\\\ai-content-studio\\\\frontend\\\\src\\\\components\\\\VideoEditor\\\\VideoEditor.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { Upload, Play, Pause, Volume2, X, Video, Music, SkipBack, SkipForward, VolumeX, Copy, Trash2, Split, RotateCw, Crop, Filter, Type, Image, Film, Layers, Plus, Eye, EyeOff } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoEditor = () => {\n  _s();\n  const [mediaLibrary, setMediaLibrary] = useState({\n    videos: [],\n    audios: [],\n    images: []\n  });\n  const [timelineItems, setTimelineItems] = useState([]);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [videoDuration, setVideoDuration] = useState(60);\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\n  const [timelineZoom, setTimelineZoom] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"videos\");\n  const [playbackSpeed, setPlaybackSpeed] = useState(1);\n  const [volume, setVolume] = useState(1);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\n  const [draggedItem, setDraggedItem] = useState(null);\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\n  const [dropPreview, setDropPreview] = useState(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState(0);\n\n  // Новые состояния для слоев\n  const [layers, setLayers] = useState({\n    video: [{\n      id: 'video-0',\n      name: 'Video Layer 1',\n      visible: true,\n      track: 0\n    }, {\n      id: 'video-1',\n      name: 'Video Layer 2',\n      visible: true,\n      track: 0\n    }, {\n      id: 'video-2',\n      name: 'Video Layer 3',\n      visible: true,\n      track: 0\n    }],\n    audio: [{\n      id: 'audio-0',\n      name: 'Audio Layer 1',\n      visible: true,\n      track: 1\n    }, {\n      id: 'audio-1',\n      name: 'Audio Layer 2',\n      visible: true,\n      track: 1\n    }, {\n      id: 'audio-2',\n      name: 'Audio Layer 3',\n      visible: true,\n      track: 1\n    }],\n    effects: [{\n      id: 'effects-0',\n      name: 'Effects Layer 1',\n      visible: true,\n      track: 2\n    }]\n  });\n  const videoRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const audioInputRef = useRef(null);\n  const imageInputRef = useRef(null);\n  const timelineRef = useRef(null);\n  const intervalRef = useRef(null);\n  const audioElementsRef = useRef(new Map());\n  const overlayCanvasRef = useRef(null);\n  const getCurrentTimelineContent = useCallback(() => {\n    const currentItems = timelineItems.filter(item => {\n      const layer = layers.video.find(l => l.id === item.layerId) || layers.audio.find(l => l.id === item.layerId) || layers.effects.find(l => l.id === item.layerId);\n      return (layer === null || layer === void 0 ? void 0 : layer.visible) && currentTime >= item.startTime && currentTime < item.startTime + item.duration;\n    });\n\n    // Сортируем по слоям (верхние слои имеют больший индекс)\n    const sortedItems = currentItems.sort((a, b) => {\n      const aLayerIndex = getLayerIndex(a.layerId);\n      const bLayerIndex = getLayerIndex(b.layerId);\n      return aLayerIndex - bLayerIndex;\n    });\n    return {\n      video: sortedItems.filter(item => item.type === \"video\" && item.track === 0),\n      audio: sortedItems.filter(item => item.type === \"audio\" && item.track === 1),\n      images: sortedItems.filter(item => item.type === \"image\"),\n      allVisual: sortedItems.filter(item => item.track === 0 || item.type === \"image\")\n    };\n  }, [currentTime, timelineItems, layers]);\n  const getLayerIndex = useCallback(layerId => {\n    const allLayers = [...layers.video, ...layers.audio, ...layers.effects];\n    return allLayers.findIndex(layer => layer.id === layerId);\n  }, [layers]);\n  const createAudioElement = useCallback(audioItem => {\n    if (!audioElementsRef.current.has(audioItem.id)) {\n      const audio = document.createElement('audio');\n      audio.src = audioItem.url;\n      audio.volume = (audioItem.volume || 1) * volume;\n      audio.muted = isMuted;\n      audio.preload = \"metadata\";\n      audioElementsRef.current.set(audioItem.id, audio);\n    }\n    return audioElementsRef.current.get(audioItem.id);\n  }, [volume, isMuted]);\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\n    const audioElement = audioElementsRef.current.get(audioItem.id);\n    if (audioElement) {\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\n      if (timeDiff > 0.2) {\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    }\n  }, []);\n  const checkCollision = useCallback((newItem, excludeId = null) => {\n    return timelineItems.some(item => {\n      if (item.id === excludeId) return false;\n      if (item.layerId !== newItem.layerId) return false;\n      const itemStart = item.startTime;\n      const itemEnd = item.startTime + item.duration;\n      const newStart = newItem.startTime;\n      const newEnd = newItem.startTime + newItem.duration;\n      return newStart < itemEnd && newEnd > itemStart;\n    });\n  }, [timelineItems]);\n  const findNextAvailablePosition = useCallback((layerId, duration, preferredStart = 0) => {\n    const layerItems = timelineItems.filter(item => item.layerId === layerId).sort((a, b) => a.startTime - b.startTime);\n    if (preferredStart >= 0) {\n      const testItem = {\n        layerId,\n        startTime: preferredStart,\n        duration\n      };\n      if (!checkCollision(testItem)) {\n        return preferredStart;\n      }\n    }\n    for (let i = 0; i < layerItems.length; i++) {\n      const currentItem = layerItems[i];\n      const nextItem = layerItems[i + 1];\n      if (i === 0 && currentItem.startTime >= duration) {\n        return 0;\n      }\n      if (nextItem) {\n        const gapStart = currentItem.startTime + currentItem.duration;\n        const gapEnd = nextItem.startTime;\n        const gapSize = gapEnd - gapStart;\n        if (gapSize >= duration) {\n          return gapStart;\n        }\n      }\n    }\n    if (layerItems.length === 0) return 0;\n    const lastItem = layerItems[layerItems.length - 1];\n    return lastItem.startTime + lastItem.duration;\n  }, [timelineItems, checkCollision]);\n\n  // Отрисовка наложения элементов\n  const renderOverlay = useCallback(() => {\n    if (!overlayCanvasRef.current) return;\n    const canvas = overlayCanvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const content = getCurrentTimelineContent();\n\n    // Очищаем canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Отрисовываем элементы по порядку слоев (снизу вверх)\n    content.allVisual.forEach((item, index) => {\n      if (item.type === 'image') {\n        const img = new Image();\n        img.onload = () => {\n          // Здесь можно добавить эффекты позиционирования, масштабирования и т.д.\n          ctx.globalAlpha = item.opacity || 1;\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n          ctx.globalAlpha = 1;\n        };\n        img.src = item.url;\n      }\n    });\n  }, [getCurrentTimelineContent]);\n\n  // Основной effect для управления видео и аудио\n  useEffect(() => {\n    const content = getCurrentTimelineContent();\n\n    // Управление основным видео (нижний слой)\n    const mainVideo = content.video[0]; // Берем самый нижний видео слой\n    if (mainVideo && mainVideo.url !== currentVideoSource) {\n      setCurrentVideoSource(mainVideo.url);\n      if (videoRef.current) {\n        const relativeTime = currentTime - mainVideo.startTime;\n        videoRef.current.currentTime = Math.max(0, relativeTime);\n      }\n    } else if (!mainVideo && content.images.length > 0) {\n      setCurrentVideoSource(content.images[0].url);\n    } else if (!mainVideo && !content.images.length) {\n      setCurrentVideoSource(null);\n    }\n\n    // Отрисовываем наложения\n    renderOverlay();\n\n    // Управление аудио\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n    content.audio.forEach(audioItem => {\n      const audioElement = createAudioElement(audioItem);\n      const relativeTime = currentTime - audioItem.startTime;\n      audioElement.volume = (audioItem.volume || 1) * volume;\n      audioElement.muted = isMuted;\n      if (isPlaying && relativeTime >= 0) {\n        syncAudioTime(audioItem, relativeTime);\n        if (audioElement.paused) {\n          audioElement.play().catch(console.error);\n        }\n      } else {\n        if (!audioElement.paused) {\n          audioElement.pause();\n        }\n      }\n    });\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource, renderOverlay]);\n  useEffect(() => {\n    if (isPlaying) {\n      intervalRef.current = setInterval(() => {\n        setCurrentTime(prev => {\n          const newTime = prev + 0.1;\n          if (newTime >= videoDuration) {\n            setIsPlaying(false);\n            return videoDuration;\n          }\n          return newTime;\n        });\n      }, 100);\n    } else {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    }\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [isPlaying, videoDuration]);\n  useEffect(() => {\n    if (videoRef.current && currentVideoSource) {\n      const content = getCurrentTimelineContent();\n      const mainVideo = content.video[0];\n      if (mainVideo) {\n        const relativeTime = currentTime - mainVideo.startTime;\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\n        if (timeDiff > 0.5) {\n          videoRef.current.currentTime = Math.max(0, relativeTime);\n        }\n        if (isPlaying && videoRef.current.paused) {\n          videoRef.current.play().catch(console.error);\n        } else if (!isPlaying && !videoRef.current.paused) {\n          videoRef.current.pause();\n        }\n      }\n    }\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\n  useEffect(() => {\n    const currentAudioIds = new Set(timelineItems.filter(item => item.type === \"audio\").map(item => item.id));\n    audioElementsRef.current.forEach((audioElement, id) => {\n      if (!currentAudioIds.has(id)) {\n        audioElement.pause();\n        audioElement.src = '';\n        audioElementsRef.current.delete(id);\n      }\n    });\n  }, [timelineItems]);\n  const handleVideoUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newVideo = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        duration: 10,\n        type: \"video\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        videos: [...prev.videos, newVideo]\n      }));\n    });\n  };\n  const handleAudioUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newAudio = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        duration: 10,\n        type: \"audio\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        audios: [...prev.audios, newAudio]\n      }));\n    });\n  };\n  const handleImageUpload = event => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach(file => {\n      const url = URL.createObjectURL(file);\n      const newImage = {\n        id: Date.now() + Math.random(),\n        name: file.name,\n        url: url,\n        file: file,\n        type: \"image\"\n      };\n      setMediaLibrary(prev => ({\n        ...prev,\n        images: [...prev.images, newImage]\n      }));\n    });\n  };\n  const addToTimeline = (mediaItem, startTime = null, targetLayerId = null) => {\n    const track = mediaItem.type === \"video\" ? 0 : mediaItem.type === \"audio\" ? 1 : 2;\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\n\n    // Определяем слой\n    let layerId = targetLayerId;\n    if (!layerId) {\n      if (mediaItem.type === \"video\" || mediaItem.type === \"image\") {\n        layerId = layers.video[0].id; // Первый видео слой по умолчанию\n      } else if (mediaItem.type === \"audio\") {\n        layerId = layers.audio[0].id; // Первый аудио слой по умолчанию\n      } else {\n        layerId = layers.effects[0].id;\n      }\n    }\n    const finalStartTime = startTime !== null ? startTime : findNextAvailablePosition(layerId, duration);\n    const newTimelineItem = {\n      id: Date.now() + Math.random(),\n      mediaId: mediaItem.id,\n      type: mediaItem.type,\n      name: mediaItem.name,\n      url: mediaItem.url,\n      startTime: finalStartTime,\n      duration: duration,\n      track: track,\n      layerId: layerId,\n      volume: 1,\n      opacity: 1,\n      effects: []\n    };\n    if (!checkCollision(newTimelineItem)) {\n      setTimelineItems(prev => [...prev, newTimelineItem]);\n      const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\n      if (newEndTime > videoDuration) {\n        setVideoDuration(newEndTime);\n      }\n    }\n  };\n  const toggleLayerVisibility = layerId => {\n    setLayers(prev => {\n      const newLayers = {\n        ...prev\n      };\n      Object.keys(newLayers).forEach(trackType => {\n        newLayers[trackType] = newLayers[trackType].map(layer => layer.id === layerId ? {\n          ...layer,\n          visible: !layer.visible\n        } : layer);\n      });\n      return newLayers;\n    });\n  };\n  const addLayer = trackType => {\n    const track = trackType === 'video' ? 0 : trackType === 'audio' ? 1 : 2;\n    const newLayerId = `${trackType}-${Date.now()}`;\n    const newLayer = {\n      id: newLayerId,\n      name: `${trackType.charAt(0).toUpperCase() + trackType.slice(1)} Layer ${layers[trackType].length + 1}`,\n      visible: true,\n      track: track\n    };\n    setLayers(prev => ({\n      ...prev,\n      [trackType]: [...prev[trackType], newLayer]\n    }));\n  };\n  const handlePlayPause = () => {\n    setIsPlaying(!isPlaying);\n  };\n  const seekTo = time => {\n    const newTime = Math.max(0, Math.min(videoDuration, time));\n    setCurrentTime(newTime);\n    const content = getCurrentTimelineContent();\n    content.audio.forEach(audioItem => {\n      const audioElement = audioElementsRef.current.get(audioItem.id);\n      if (audioElement) {\n        const relativeTime = newTime - audioItem.startTime;\n        audioElement.currentTime = Math.max(0, relativeTime);\n      }\n    });\n  };\n  const removeFromLibrary = (itemId, type) => {\n    setMediaLibrary(prev => ({\n      ...prev,\n      [type]: prev[type].filter(item => item.id !== itemId)\n    }));\n  };\n  const removeFromTimeline = itemId => {\n    const audioElement = audioElementsRef.current.get(itemId);\n    if (audioElement) {\n      audioElement.pause();\n      audioElement.src = '';\n      audioElementsRef.current.delete(itemId);\n    }\n    setTimelineItems(prev => prev.filter(item => item.id !== itemId));\n    setSelectedTimelineItem(null);\n  };\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n  };\n  const handleTimelineClick = e => {\n    if (isDragging || isTimelineDragging) return;\n    const rect = timelineRef.current.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const timePerPixel = videoDuration / (rect.width * timelineZoom);\n    const clickTime = clickX * timePerPixel;\n    seekTo(clickTime);\n  };\n  const handleDragStart = (e, mediaItem) => {\n    setDraggedItem(mediaItem);\n    setIsDragging(true);\n    e.dataTransfer.effectAllowed = \"copy\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleDragEnd = () => {\n    setDraggedItem(null);\n    setDropPreview(null);\n    setIsDragging(false);\n  };\n  const handleTimelineItemDragStart = (e, timelineItem) => {\n    e.stopPropagation();\n    setDraggedTimelineItem(timelineItem);\n    setIsTimelineDragging(true);\n    const rect = timelineRef.current.getBoundingClientRect();\n    const itemRect = e.target.getBoundingClientRect();\n    setDragOffset(e.clientX - itemRect.left);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", \"\");\n  };\n  const handleTimelineItemDragEnd = () => {\n    setDraggedTimelineItem(null);\n    setDropPreview(null);\n    setIsTimelineDragging(false);\n    setDragOffset(0);\n  };\n  const handleDragOver = e => {\n    if (!draggedItem && !draggedTimelineItem) return;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\n    const rect = timelineRef.current.getBoundingClientRect();\n    const dragX = e.clientX - rect.left - (draggedTimelineItem ? dragOffset : 0);\n    const timePerPixel = videoDuration / (rect.width * timelineZoom);\n    const dropTime = Math.max(0, dragX * timePerPixel);\n\n    // Определяем на какой слой перетаскиваем\n    const dragY = e.clientY - rect.top;\n    const layerHeight = 24; // Высота одного слоя\n    const headerHeight = 48; // Высота заголовка таймлайна\n    const timeRulerHeight = 48; // Высота временной линейки\n\n    const relativeY = dragY - timeRulerHeight;\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\n    const targetLayerIndex = Math.floor(relativeY / layerHeight);\n    const targetLayer = allLayersFlat[targetLayerIndex];\n    if (draggedItem && targetLayer) {\n      const track = targetLayer.track;\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\n      const testItem = {\n        layerId: targetLayer.id,\n        startTime: dropTime,\n        duration\n      };\n      setDropPreview({\n        time: dropTime,\n        duration: duration,\n        layerId: targetLayer.id,\n        track: track,\n        isValid: !checkCollision(testItem)\n      });\n    } else if (draggedTimelineItem && targetLayer) {\n      const testItem = {\n        ...draggedTimelineItem,\n        startTime: dropTime,\n        layerId: targetLayer.id\n      };\n      setDropPreview({\n        time: dropTime,\n        duration: draggedTimelineItem.duration,\n        layerId: targetLayer.id,\n        track: targetLayer.track,\n        isValid: !checkCollision(testItem, draggedTimelineItem.id)\n      });\n    }\n  };\n  const handleDrop = e => {\n    if (!draggedItem && !draggedTimelineItem || !dropPreview) return;\n    e.preventDefault();\n    if (dropPreview.isValid) {\n      if (draggedItem) {\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.layerId);\n      } else if (draggedTimelineItem) {\n        setTimelineItems(prev => prev.map(item => item.id === draggedTimelineItem.id ? {\n          ...item,\n          startTime: dropPreview.time,\n          layerId: dropPreview.layerId\n        } : item));\n        if ((selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === draggedTimelineItem.id) {\n          setSelectedTimelineItem(prev => ({\n            ...prev,\n            startTime: dropPreview.time,\n            layerId: dropPreview.layerId\n          }));\n        }\n      }\n    }\n    setDropPreview(null);\n    setDraggedItem(null);\n    setDraggedTimelineItem(null);\n    setIsDragging(false);\n    setIsTimelineDragging(false);\n  };\n  const handleDragLeave = e => {\n    var _timelineRef$current;\n    if (!((_timelineRef$current = timelineRef.current) !== null && _timelineRef$current !== void 0 && _timelineRef$current.contains(e.relatedTarget))) {\n      setDropPreview(null);\n    }\n  };\n  const getTimelineItemStyle = item => {\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\n    const layerIndex = allLayersFlat.findIndex(layer => layer.id === item.layerId);\n    return {\n      left: `${item.startTime / videoDuration * videoDuration * 20 * timelineZoom}px`,\n      width: `${item.duration / videoDuration * videoDuration * 20 * timelineZoom}px`,\n      top: `${layerIndex * 24 + 4}px`\n    };\n  };\n  const getDropPreviewStyle = () => {\n    if (!dropPreview) return {};\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\n    const layerIndex = allLayersFlat.findIndex(layer => layer.id === dropPreview.layerId);\n    return {\n      left: `${dropPreview.time / videoDuration * videoDuration * 20 * timelineZoom}px`,\n      width: `${dropPreview.duration / videoDuration * videoDuration * 20 * timelineZoom}px`,\n      top: `${layerIndex * 24 + 4}px`\n    };\n  };\n  const getLayerColor = layerId => {\n    if (layerId.startsWith('video')) return 'bg-blue-500 border-blue-400';\n    if (layerId.startsWith('audio')) return 'bg-green-500 border-green-400';\n    return 'bg-purple-500 border-purple-400';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-1 h-screen gap-4 p-4 bg-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-80 bg-white border border-gray-200 flex flex-col rounded-2xl shadow-sm overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 pb-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex bg-gray-100 rounded-xl p-1\",\n          children: [{\n            id: \"videos\",\n            name: \"Videos\",\n            icon: Video\n          }, {\n            id: \"audios\",\n            name: \"Audio\",\n            icon: Music\n          }, {\n            id: \"images\",\n            name: \"Images\",\n            icon: Image\n          }].map(tab => {\n            const IconComponent = tab.icon;\n            return /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setActiveTab(tab.id),\n              className: `flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${activeTab === tab.id ? \"bg-white text-blue-600 shadow-sm\" : \"text-gray-600 hover:text-gray-800\"}`,\n              children: [/*#__PURE__*/_jsxDEV(IconComponent, {\n                size: 16,\n                className: \"mr-2 inline\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 701,\n                columnNumber: 19\n              }, this), tab.name]\n            }, tab.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 692,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 684,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 683,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            var _fileInputRef$current, _audioInputRef$curren, _imageInputRef$curren;\n            if (activeTab === \"videos\") (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();else if (activeTab === \"audios\") (_audioInputRef$curren = audioInputRef.current) === null || _audioInputRef$curren === void 0 ? void 0 : _audioInputRef$curren.click();else (_imageInputRef$curren = imageInputRef.current) === null || _imageInputRef$curren === void 0 ? void 0 : _imageInputRef$curren.click();\n          },\n          className: \"w-full p-6 border-2 border-dashed border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-200 text-center group\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-100 transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(Upload, {\n              size: 20,\n              className: \"text-gray-500 group-hover:text-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 719,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 718,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium text-gray-700 group-hover:text-blue-600\",\n            children: [\"Upload\", \" \", activeTab === \"videos\" ? \"Video\" : activeTab === \"audios\" ? \"Audio\" : \"Images\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 724,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 mt-1\",\n            children: activeTab === \"videos\" ? \"MP4, AVI, MOV up to 2GB\" : activeTab === \"audios\" ? \"MP3, WAV, M4A up to 100MB\" : \"JPG, PNG, GIF up to 10MB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 732,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 709,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        type: \"file\",\n        accept: \"video/*\",\n        multiple: true,\n        onChange: handleVideoUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 742,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: audioInputRef,\n        type: \"file\",\n        accept: \"audio/*\",\n        multiple: true,\n        onChange: handleAudioUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: imageInputRef,\n        type: \"file\",\n        accept: \"image/*\",\n        multiple: true,\n        onChange: handleImageUpload,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 758,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto px-4 pb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: mediaLibrary[activeTab].map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n            draggable: \"true\",\n            onDragStart: e => handleDragStart(e, item),\n            onDragEnd: handleDragEnd,\n            className: `flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${(draggedItem === null || draggedItem === void 0 ? void 0 : draggedItem.id) === item.id ? \"opacity-50\" : \"\"}`,\n            onClick: () => addToTimeline(item),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\",\n              children: [activeTab === \"videos\" && /*#__PURE__*/_jsxDEV(Video, {\n                size: 20,\n                className: \"text-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 782,\n                columnNumber: 21\n              }, this), activeTab === \"audios\" && /*#__PURE__*/_jsxDEV(Music, {\n                size: 20,\n                className: \"text-green-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 785,\n                columnNumber: 21\n              }, this), activeTab === \"images\" && /*#__PURE__*/_jsxDEV(Image, {\n                size: 20,\n                className: \"text-purple-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 788,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 780,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1 min-w-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-gray-900 truncate\",\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 792,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500\",\n                children: activeTab === \"images\" ? \"Image\" : formatTime(item.duration || 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 795,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 791,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => {\n                e.stopPropagation();\n                removeFromLibrary(item.id, activeTab);\n              },\n              className: \"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\",\n              children: /*#__PURE__*/_jsxDEV(Trash2, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 808,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 801,\n              columnNumber: 17\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 770,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 768,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 767,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 682,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm\",\n        children: [currentVideoSource ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative w-full h-full\",\n          children: [getCurrentTimelineContent().video[0] ? /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            src: currentVideoSource,\n            className: \"w-full h-full object-contain rounded-2xl\",\n            muted: isMuted\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 821,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: currentVideoSource,\n            alt: \"Timeline content\",\n            className: \"w-full h-full object-contain rounded-2xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 828,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n            ref: overlayCanvasRef,\n            className: \"absolute top-0 left-0 w-full h-full pointer-events-none\",\n            width: 1920,\n            height: 1080,\n            style: {\n              mixBlendMode: 'normal'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 836,\n            columnNumber: 15\n          }, this), getCurrentTimelineContent().images.map((item, index) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: item.url,\n            alt: item.name,\n            className: \"absolute top-0 left-0 w-full h-full object-contain pointer-events-none\",\n            style: {\n              zIndex: 10 + index,\n              opacity: item.opacity || 1,\n              mixBlendMode: 'normal'\n            }\n          }, item.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 846,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 819,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full h-full flex items-center justify-center text-white\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\",\n              children: /*#__PURE__*/_jsxDEV(Film, {\n                size: 40,\n                className: \"opacity-50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 863,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 862,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl opacity-75 font-medium\",\n              children: \"No content at current time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 865,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm opacity-50\",\n              children: \"Drag media to timeline layers\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 868,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 861,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 860,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.max(0, currentTime - 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              children: /*#__PURE__*/_jsxDEV(SkipBack, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 881,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 877,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handlePlayPause,\n              className: \"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\",\n              children: isPlaying ? /*#__PURE__*/_jsxDEV(Pause, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 887,\n                columnNumber: 30\n              }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 887,\n                columnNumber: 52\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 883,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => seekTo(Math.min(videoDuration, currentTime + 10)),\n              className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n              children: /*#__PURE__*/_jsxDEV(SkipForward, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 895,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 889,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setIsMuted(!isMuted),\n                className: \"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 902,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 902,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 898,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: \"0\",\n                max: \"1\",\n                step: \"0.1\",\n                value: volume,\n                onChange: e => setVolume(parseFloat(e.target.value)),\n                className: \"w-24 accent-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 904,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 897,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-white text-sm font-medium min-w-0\",\n              children: [formatTime(currentTime), \" / \", formatTime(videoDuration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 914,\n              columnNumber: 15\n            }, this), getCurrentTimelineContent().audio.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-1\",\n              children: [/*#__PURE__*/_jsxDEV(Music, {\n                size: 16,\n                className: \"text-green-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 919,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-400 text-xs font-medium\",\n                children: [getCurrentTimelineContent().audio.length, \" audio\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 920,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 918,\n              columnNumber: 17\n            }, this), getCurrentTimelineContent().allVisual.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-1\",\n              children: [/*#__PURE__*/_jsxDEV(Layers, {\n                size: 16,\n                className: \"text-blue-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 927,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-blue-400 text-xs font-medium\",\n                children: [getCurrentTimelineContent().allVisual.length, \" layers\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 928,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 926,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 876,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 875,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 817,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `h-96 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden ${isDragging || isTimelineDragging ? \"border-blue-400 bg-blue-50/20\" : \"border-gray-200\"}`,\n        onDragOver: handleDragOver,\n        onDrop: handleDrop,\n        onDragLeave: handleDragLeave,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 p-4 border-b border-gray-200\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-gray-800 font-semibold flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Layers, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 950,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Timeline Layers\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 951,\n                columnNumber: 17\n              }, this), (isDragging || isTimelineDragging) && dropPreview && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: dropPreview.isValid ? \"text-green-600\" : \"text-red-600\",\n                children: [\"- \", dropPreview.isValid ? \"Drop to place\" : \"Position blocked\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 953,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 949,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600 text-sm font-medium\",\n                  children: \"Zoom:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 960,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white rounded-xl p-2 border border-gray-200\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"range\",\n                    min: \"0.5\",\n                    max: \"3\",\n                    step: \"0.1\",\n                    value: timelineZoom,\n                    onChange: e => setTimelineZoom(parseFloat(e.target.value)),\n                    className: \"w-24 accent-blue-500\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 962,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 961,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 959,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => addLayer('video'),\n                  className: \"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200\",\n                  title: \"Add Video Layer\",\n                  children: /*#__PURE__*/_jsxDEV(Plus, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 979,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 974,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200\",\n                  children: /*#__PURE__*/_jsxDEV(Split, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 982,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 981,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200\",\n                  children: /*#__PURE__*/_jsxDEV(Copy, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 985,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 984,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 973,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 958,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 948,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 947,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 relative overflow-x-auto\",\n          ref: timelineRef,\n          onClick: handleTimelineClick,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-12 bg-gray-50 border-b border-gray-200 relative\",\n            children: [Array.from({\n              length: Math.ceil(videoDuration / 5) + 1\n            }, (_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 h-full border-l border-gray-300\",\n              style: {\n                left: `${i * 100 * timelineZoom}px`\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\",\n                children: formatTime(i * 5)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1005,\n                columnNumber: 19\n              }, this)\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1000,\n              columnNumber: 17\n            }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\",\n              style: {\n                left: `${currentTime / videoDuration * videoDuration * 20 * timelineZoom}px`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1010,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 998,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            style: {\n              height: `${(layers.video.length + layers.audio.length + layers.effects.length) * 24}px`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute left-0 top-0 w-48 bg-gray-50 border-r border-gray-200 z-10\",\n              children: [...layers.video, ...layers.audio, ...layers.effects].map((layer, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-6 flex items-center px-3 border-b border-gray-100 text-xs font-medium text-gray-700\",\n                style: {\n                  top: `${index * 24}px`\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => toggleLayerVisibility(layer.id),\n                  className: \"mr-2 hover:bg-gray-200 rounded p-1\",\n                  children: layer.visible ? /*#__PURE__*/_jsxDEV(Eye, {\n                    size: 12\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1032,\n                    columnNumber: 40\n                  }, this) : /*#__PURE__*/_jsxDEV(EyeOff, {\n                    size: 12\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1032,\n                    columnNumber: 60\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1028,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"truncate\",\n                  children: layer.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1034,\n                  columnNumber: 21\n                }, this)]\n              }, layer.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1023,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1021,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pl-48\",\n              children: [timelineItems.map(item => {\n                const layer = [...layers.video, ...layers.audio, ...layers.effects].find(l => l.id === item.layerId);\n                if (!(layer !== null && layer !== void 0 && layer.visible)) return null;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  draggable: \"true\",\n                  onDragStart: e => handleTimelineItemDragStart(e, item),\n                  onDragEnd: handleTimelineItemDragEnd,\n                  className: `absolute h-5 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md ${getLayerColor(item.layerId)} ${(selectedTimelineItem === null || selectedTimelineItem === void 0 ? void 0 : selectedTimelineItem.id) === item.id ? \"ring-2 ring-blue-300\" : \"\"} ${(draggedTimelineItem === null || draggedTimelineItem === void 0 ? void 0 : draggedTimelineItem.id) === item.id ? \"opacity-50 z-30\" : \"\"}`,\n                  style: getTimelineItemStyle(item),\n                  onClick: e => {\n                    e.stopPropagation();\n                    setSelectedTimelineItem(item);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"p-1 text-white text-xs truncate font-medium\",\n                    children: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1064,\n                    columnNumber: 23\n                  }, this)\n                }, item.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1046,\n                  columnNumber: 21\n                }, this);\n              }), dropPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `absolute h-5 rounded-lg border-2 border-dashed opacity-75 ${dropPreview.isValid ? `${getLayerColor(dropPreview.layerId).replace('border-', 'border-')} bg-opacity-50` : \"bg-red-300 border-red-500\"}`,\n                style: getDropPreviewStyle()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1073,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1040,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1019,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 992,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 937,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 7\n    }, this), selectedTimelineItem && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-80 bg-white border border-gray-200 rounded-2xl p-6 shadow-sm\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"font-semibold text-gray-800 text-lg\",\n            children: \"Properties\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1092,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSelectedTimelineItem(null),\n            className: \"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-xl transition-all duration-200\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1097,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1093,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1091,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1103,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: selectedTimelineItem.name,\n              className: \"w-full p-3 border border-gray-200 rounded-xl text-sm bg-gray-50 font-medium\",\n              readOnly: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1104,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1102,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Layer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1113,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: selectedTimelineItem.layerId,\n              onChange: e => {\n                const newLayerId = e.target.value;\n                const testItem = {\n                  ...selectedTimelineItem,\n                  layerId: newLayerId\n                };\n                if (!checkCollision(testItem, selectedTimelineItem.id)) {\n                  setTimelineItems(prev => prev.map(item => item.id === selectedTimelineItem.id ? {\n                    ...item,\n                    layerId: newLayerId\n                  } : item));\n                  setSelectedTimelineItem(prev => prev ? {\n                    ...prev,\n                    layerId: newLayerId\n                  } : null);\n                }\n              },\n              className: \"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\",\n              children: selectedTimelineItem.type === \"video\" || selectedTimelineItem.type === \"image\" ? layers.video.map(layer => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: layer.id,\n                children: layer.name\n              }, layer.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1137,\n                columnNumber: 25\n              }, this)) : selectedTimelineItem.type === \"audio\" ? layers.audio.map(layer => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: layer.id,\n                children: layer.name\n              }, layer.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1141,\n                columnNumber: 25\n              }, this)) : layers.effects.map(layer => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: layer.id,\n                children: layer.name\n              }, layer.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1144,\n                columnNumber: 25\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1114,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1112,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Start Time (seconds)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1151,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: selectedTimelineItem.startTime,\n              onChange: e => {\n                const newStartTime = parseFloat(e.target.value);\n                const testItem = {\n                  ...selectedTimelineItem,\n                  startTime: newStartTime\n                };\n                if (!checkCollision(testItem, selectedTimelineItem.id)) {\n                  setTimelineItems(prev => prev.map(item => item.id === selectedTimelineItem.id ? {\n                    ...item,\n                    startTime: newStartTime\n                  } : item));\n                  setSelectedTimelineItem(prev => prev ? {\n                    ...prev,\n                    startTime: newStartTime\n                  } : null);\n                }\n              },\n              className: \"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\",\n              step: \"0.1\",\n              min: \"0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1152,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1150,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Duration (seconds)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1179,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: selectedTimelineItem.duration,\n              onChange: e => {\n                const newDuration = parseFloat(e.target.value);\n                const testItem = {\n                  ...selectedTimelineItem,\n                  duration: newDuration\n                };\n                if (!checkCollision(testItem, selectedTimelineItem.id)) {\n                  setTimelineItems(prev => prev.map(item => item.id === selectedTimelineItem.id ? {\n                    ...item,\n                    duration: newDuration\n                  } : item));\n                  setSelectedTimelineItem(prev => prev ? {\n                    ...prev,\n                    duration: newDuration\n                  } : null);\n                }\n              },\n              className: \"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\",\n              step: \"0.1\",\n              min: \"0.1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1180,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1178,\n            columnNumber: 15\n          }, this), (selectedTimelineItem.type === \"image\" || selectedTimelineItem.type === \"video\") && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Opacity\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1208,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 rounded-xl p-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: \"0\",\n                max: \"1\",\n                step: \"0.1\",\n                value: selectedTimelineItem.opacity || 1,\n                onChange: e => {\n                  const newOpacity = parseFloat(e.target.value);\n                  setTimelineItems(prev => prev.map(item => item.id === selectedTimelineItem.id ? {\n                    ...item,\n                    opacity: newOpacity\n                  } : item));\n                  setSelectedTimelineItem(prev => prev ? {\n                    ...prev,\n                    opacity: newOpacity\n                  } : null);\n                },\n                className: \"w-full accent-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1210,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 mt-2 text-center font-medium\",\n                children: [Math.round((selectedTimelineItem.opacity || 1) * 100), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1231,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1209,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1207,\n            columnNumber: 17\n          }, this), selectedTimelineItem.type === \"audio\" && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-semibold text-gray-700 mb-2\",\n              children: \"Volume\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1240,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 rounded-xl p-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: \"0\",\n                max: \"2\",\n                step: \"0.1\",\n                value: selectedTimelineItem.volume,\n                onChange: e => {\n                  const newVolume = parseFloat(e.target.value);\n                  setTimelineItems(prev => prev.map(item => item.id === selectedTimelineItem.id ? {\n                    ...item,\n                    volume: newVolume\n                  } : item));\n                  setSelectedTimelineItem(prev => prev ? {\n                    ...prev,\n                    volume: newVolume\n                  } : null);\n                  const audioElement = audioElementsRef.current.get(selectedTimelineItem.id);\n                  if (audioElement) {\n                    audioElement.volume = newVolume * volume;\n                  }\n                },\n                className: \"w-full accent-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1242,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 mt-2 text-center font-medium\",\n                children: [Math.round(selectedTimelineItem.volume * 100), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1268,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1241,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1239,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeFromTimeline(selectedTimelineItem.id),\n            className: \"w-full p-3 bg-red-500 hover:bg-red-600 text-white rounded-xl text-sm font-semibold transition-all duration-200 hover:shadow-md\",\n            children: [/*#__PURE__*/_jsxDEV(Trash2, {\n              size: 16,\n              className: \"inline mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1279,\n              columnNumber: 17\n            }, this), \"Remove from Timeline\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1275,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1101,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1090,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1089,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 681,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoEditor, \"4XFBFyscfk1Go16iUEiZL1FBPDc=\");\n_c = VideoEditor;\nexport default VideoEditor;\nvar _c;\n$RefreshReg$(_c, \"VideoEditor\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","Upload","Play","Pause","Volume2","X","Video","Music","SkipBack","SkipForward","VolumeX","Copy","Trash2","Split","RotateCw","Crop","Filter","Type","Image","Film","Layers","Plus","Eye","EyeOff","jsxDEV","_jsxDEV","VideoEditor","_s","mediaLibrary","setMediaLibrary","videos","audios","images","timelineItems","setTimelineItems","currentTime","setCurrentTime","videoDuration","setVideoDuration","selectedTimelineItem","setSelectedTimelineItem","timelineZoom","setTimelineZoom","activeTab","setActiveTab","playbackSpeed","setPlaybackSpeed","volume","setVolume","isMuted","setIsMuted","isPlaying","setIsPlaying","currentVideoSource","setCurrentVideoSource","draggedItem","setDraggedItem","draggedTimelineItem","setDraggedTimelineItem","dropPreview","setDropPreview","isDragging","setIsDragging","isTimelineDragging","setIsTimelineDragging","dragOffset","setDragOffset","layers","setLayers","video","id","name","visible","track","audio","effects","videoRef","fileInputRef","audioInputRef","imageInputRef","timelineRef","intervalRef","audioElementsRef","Map","overlayCanvasRef","getCurrentTimelineContent","currentItems","filter","item","layer","find","l","layerId","startTime","duration","sortedItems","sort","a","b","aLayerIndex","getLayerIndex","bLayerIndex","type","allVisual","allLayers","findIndex","createAudioElement","audioItem","current","has","document","createElement","src","url","muted","preload","set","get","syncAudioTime","relativeTime","audioElement","timeDiff","Math","abs","max","checkCollision","newItem","excludeId","some","itemStart","itemEnd","newStart","newEnd","findNextAvailablePosition","preferredStart","layerItems","testItem","i","length","currentItem","nextItem","gapStart","gapEnd","gapSize","lastItem","renderOverlay","canvas","ctx","getContext","content","clearRect","width","height","forEach","index","img","onload","globalAlpha","opacity","drawImage","mainVideo","currentAudioIds","Set","map","paused","pause","play","catch","console","error","setInterval","prev","newTime","clearInterval","delete","handleVideoUpload","event","files","target","Array","from","file","URL","createObjectURL","newVideo","Date","now","random","handleAudioUpload","newAudio","handleImageUpload","newImage","addToTimeline","mediaItem","targetLayerId","finalStartTime","newTimelineItem","mediaId","newEndTime","toggleLayerVisibility","newLayers","Object","keys","trackType","addLayer","newLayerId","newLayer","charAt","toUpperCase","slice","handlePlayPause","seekTo","time","min","removeFromLibrary","itemId","removeFromTimeline","formatTime","seconds","mins","floor","secs","toString","padStart","handleTimelineClick","e","rect","getBoundingClientRect","clickX","clientX","left","timePerPixel","clickTime","handleDragStart","dataTransfer","effectAllowed","setData","handleDragEnd","handleTimelineItemDragStart","timelineItem","stopPropagation","itemRect","handleTimelineItemDragEnd","handleDragOver","preventDefault","dropEffect","dragX","dropTime","dragY","clientY","top","layerHeight","headerHeight","timeRulerHeight","relativeY","allLayersFlat","targetLayerIndex","targetLayer","isValid","handleDrop","handleDragLeave","_timelineRef$current","contains","relatedTarget","getTimelineItemStyle","layerIndex","getDropPreviewStyle","getLayerColor","startsWith","className","children","icon","tab","IconComponent","onClick","size","fileName","_jsxFileName","lineNumber","columnNumber","_fileInputRef$current","_audioInputRef$curren","_imageInputRef$curren","click","ref","accept","multiple","onChange","draggable","onDragStart","onDragEnd","alt","style","mixBlendMode","zIndex","step","value","parseFloat","onDragOver","onDrop","onDragLeave","title","ceil","_","replace","readOnly","newStartTime","newDuration","newOpacity","round","newVolume","_c","$RefreshReg$"],"sources":["C:/Scriptify/ai-content-studio/frontend/src/components/VideoEditor/VideoEditor.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Upload,\r\n  Play,\r\n  Pause,\r\n  Volume2,\r\n  X,\r\n  Video,\r\n  Music,\r\n  SkipBack,\r\n  SkipForward,\r\n  VolumeX,\r\n  Copy,\r\n  Trash2,\r\n  Split,\r\n  RotateCw,\r\n  Crop,\r\n  Filter,\r\n  Type,\r\n  Image,\r\n  Film,\r\n  Layers,\r\n  Plus,\r\n  Eye,\r\n  EyeOff\r\n} from \"lucide-react\";\r\n\r\nconst VideoEditor = () => {\r\n  const [mediaLibrary, setMediaLibrary] = useState({\r\n    videos: [],\r\n    audios: [],\r\n    images: [],\r\n  });\r\n  const [timelineItems, setTimelineItems] = useState([]);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [videoDuration, setVideoDuration] = useState(60);\r\n  const [selectedTimelineItem, setSelectedTimelineItem] = useState(null);\r\n  const [timelineZoom, setTimelineZoom] = useState(1);\r\n  const [activeTab, setActiveTab] = useState(\"videos\");\r\n  const [playbackSpeed, setPlaybackSpeed] = useState(1);\r\n  const [volume, setVolume] = useState(1);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [currentVideoSource, setCurrentVideoSource] = useState(null);\r\n  const [draggedItem, setDraggedItem] = useState(null);\r\n  const [draggedTimelineItem, setDraggedTimelineItem] = useState(null);\r\n  const [dropPreview, setDropPreview] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isTimelineDragging, setIsTimelineDragging] = useState(false);\r\n  const [dragOffset, setDragOffset] = useState(0);\r\n  \r\n  // Новые состояния для слоев\r\n  const [layers, setLayers] = useState({\r\n    video: [\r\n      { id: 'video-0', name: 'Video Layer 1', visible: true, track: 0 },\r\n      { id: 'video-1', name: 'Video Layer 2', visible: true, track: 0 },\r\n      { id: 'video-2', name: 'Video Layer 3', visible: true, track: 0 }\r\n    ],\r\n    audio: [\r\n      { id: 'audio-0', name: 'Audio Layer 1', visible: true, track: 1 },\r\n      { id: 'audio-1', name: 'Audio Layer 2', visible: true, track: 1 },\r\n      { id: 'audio-2', name: 'Audio Layer 3', visible: true, track: 1 }\r\n    ],\r\n    effects: [\r\n      { id: 'effects-0', name: 'Effects Layer 1', visible: true, track: 2 }\r\n    ]\r\n  });\r\n\r\n  const videoRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n  const audioInputRef = useRef(null);\r\n  const imageInputRef = useRef(null);\r\n  const timelineRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n  const audioElementsRef = useRef(new Map());\r\n  const overlayCanvasRef = useRef(null);\r\n\r\n  const getCurrentTimelineContent = useCallback(() => {\r\n    const currentItems = timelineItems.filter(\r\n      (item) => {\r\n        const layer = layers.video.find(l => l.id === item.layerId) || \r\n                     layers.audio.find(l => l.id === item.layerId) || \r\n                     layers.effects.find(l => l.id === item.layerId);\r\n        \r\n        return layer?.visible && \r\n               currentTime >= item.startTime &&\r\n               currentTime < item.startTime + item.duration;\r\n      }\r\n    );\r\n\r\n    // Сортируем по слоям (верхние слои имеют больший индекс)\r\n    const sortedItems = currentItems.sort((a, b) => {\r\n      const aLayerIndex = getLayerIndex(a.layerId);\r\n      const bLayerIndex = getLayerIndex(b.layerId);\r\n      return aLayerIndex - bLayerIndex;\r\n    });\r\n\r\n    return {\r\n      video: sortedItems.filter(item => item.type === \"video\" && item.track === 0),\r\n      audio: sortedItems.filter(item => item.type === \"audio\" && item.track === 1),\r\n      images: sortedItems.filter(item => item.type === \"image\"),\r\n      allVisual: sortedItems.filter(item => item.track === 0 || item.type === \"image\")\r\n    };\r\n  }, [currentTime, timelineItems, layers]);\r\n\r\n  const getLayerIndex = useCallback((layerId) => {\r\n    const allLayers = [...layers.video, ...layers.audio, ...layers.effects];\r\n    return allLayers.findIndex(layer => layer.id === layerId);\r\n  }, [layers]);\r\n\r\n  const createAudioElement = useCallback((audioItem) => {\r\n    if (!audioElementsRef.current.has(audioItem.id)) {\r\n      const audio = document.createElement('audio');\r\n      audio.src = audioItem.url;\r\n      audio.volume = (audioItem.volume || 1) * volume;\r\n      audio.muted = isMuted;\r\n      audio.preload = \"metadata\";\r\n      audioElementsRef.current.set(audioItem.id, audio);\r\n    }\r\n    return audioElementsRef.current.get(audioItem.id);\r\n  }, [volume, isMuted]);\r\n\r\n  const syncAudioTime = useCallback((audioItem, relativeTime) => {\r\n    const audioElement = audioElementsRef.current.get(audioItem.id);\r\n    if (audioElement) {\r\n      const timeDiff = Math.abs(audioElement.currentTime - relativeTime);\r\n      if (timeDiff > 0.2) {\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const checkCollision = useCallback((newItem, excludeId = null) => {\r\n    return timelineItems.some(item => {\r\n      if (item.id === excludeId) return false;\r\n      if (item.layerId !== newItem.layerId) return false;\r\n      \r\n      const itemStart = item.startTime;\r\n      const itemEnd = item.startTime + item.duration;\r\n      const newStart = newItem.startTime;\r\n      const newEnd = newItem.startTime + newItem.duration;\r\n      \r\n      return (newStart < itemEnd && newEnd > itemStart);\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  const findNextAvailablePosition = useCallback((layerId, duration, preferredStart = 0) => {\r\n    const layerItems = timelineItems\r\n      .filter(item => item.layerId === layerId)\r\n      .sort((a, b) => a.startTime - b.startTime);\r\n    \r\n    if (preferredStart >= 0) {\r\n      const testItem = { layerId, startTime: preferredStart, duration };\r\n      if (!checkCollision(testItem)) {\r\n        return preferredStart;\r\n      }\r\n    }\r\n    \r\n    for (let i = 0; i < layerItems.length; i++) {\r\n      const currentItem = layerItems[i];\r\n      const nextItem = layerItems[i + 1];\r\n      \r\n      if (i === 0 && currentItem.startTime >= duration) {\r\n        return 0;\r\n      }\r\n      \r\n      if (nextItem) {\r\n        const gapStart = currentItem.startTime + currentItem.duration;\r\n        const gapEnd = nextItem.startTime;\r\n        const gapSize = gapEnd - gapStart;\r\n        \r\n        if (gapSize >= duration) {\r\n          return gapStart;\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (layerItems.length === 0) return 0;\r\n    const lastItem = layerItems[layerItems.length - 1];\r\n    return lastItem.startTime + lastItem.duration;\r\n  }, [timelineItems, checkCollision]);\r\n\r\n  // Отрисовка наложения элементов\r\n  const renderOverlay = useCallback(() => {\r\n    if (!overlayCanvasRef.current) return;\r\n    \r\n    const canvas = overlayCanvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n    const content = getCurrentTimelineContent();\r\n    \r\n    // Очищаем canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    \r\n    // Отрисовываем элементы по порядку слоев (снизу вверх)\r\n    content.allVisual.forEach((item, index) => {\r\n      if (item.type === 'image') {\r\n        const img = new Image();\r\n        img.onload = () => {\r\n          // Здесь можно добавить эффекты позиционирования, масштабирования и т.д.\r\n          ctx.globalAlpha = item.opacity || 1;\r\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n          ctx.globalAlpha = 1;\r\n        };\r\n        img.src = item.url;\r\n      }\r\n    });\r\n  }, [getCurrentTimelineContent]);\r\n\r\n  // Основной effect для управления видео и аудио\r\n  useEffect(() => {\r\n    const content = getCurrentTimelineContent();\r\n\r\n    // Управление основным видео (нижний слой)\r\n    const mainVideo = content.video[0]; // Берем самый нижний видео слой\r\n    if (mainVideo && mainVideo.url !== currentVideoSource) {\r\n      setCurrentVideoSource(mainVideo.url);\r\n      if (videoRef.current) {\r\n        const relativeTime = currentTime - mainVideo.startTime;\r\n        videoRef.current.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    } else if (!mainVideo && content.images.length > 0) {\r\n      setCurrentVideoSource(content.images[0].url);\r\n    } else if (!mainVideo && !content.images.length) {\r\n      setCurrentVideoSource(null);\r\n    }\r\n\r\n    // Отрисовываем наложения\r\n    renderOverlay();\r\n\r\n    // Управление аудио\r\n    const currentAudioIds = new Set(content.audio.map(item => item.id));\r\n    \r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = createAudioElement(audioItem);\r\n      const relativeTime = currentTime - audioItem.startTime;\r\n      \r\n      audioElement.volume = (audioItem.volume || 1) * volume;\r\n      audioElement.muted = isMuted;\r\n      \r\n      if (isPlaying && relativeTime >= 0) {\r\n        syncAudioTime(audioItem, relativeTime);\r\n        if (audioElement.paused) {\r\n          audioElement.play().catch(console.error);\r\n        }\r\n      } else {\r\n        if (!audioElement.paused) {\r\n          audioElement.pause();\r\n        }\r\n      }\r\n    });\r\n\r\n  }, [currentTime, timelineItems, getCurrentTimelineContent, isPlaying, volume, isMuted, createAudioElement, syncAudioTime, currentVideoSource, renderOverlay]);\r\n\r\n  useEffect(() => {\r\n    if (isPlaying) {\r\n      intervalRef.current = setInterval(() => {\r\n        setCurrentTime((prev) => {\r\n          const newTime = prev + 0.1;\r\n          if (newTime >= videoDuration) {\r\n            setIsPlaying(false);\r\n            return videoDuration;\r\n          }\r\n          return newTime;\r\n        });\r\n      }, 100);\r\n    } else {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [isPlaying, videoDuration]);\r\n\r\n  useEffect(() => {\r\n    if (videoRef.current && currentVideoSource) {\r\n      const content = getCurrentTimelineContent();\r\n      const mainVideo = content.video[0];\r\n      if (mainVideo) {\r\n        const relativeTime = currentTime - mainVideo.startTime;\r\n        const timeDiff = Math.abs(videoRef.current.currentTime - relativeTime);\r\n\r\n        if (timeDiff > 0.5) {\r\n          videoRef.current.currentTime = Math.max(0, relativeTime);\r\n        }\r\n\r\n        if (isPlaying && videoRef.current.paused) {\r\n          videoRef.current.play().catch(console.error);\r\n        } else if (!isPlaying && !videoRef.current.paused) {\r\n          videoRef.current.pause();\r\n        }\r\n      }\r\n    }\r\n  }, [currentTime, currentVideoSource, getCurrentTimelineContent, isPlaying]);\r\n\r\n  useEffect(() => {\r\n    const currentAudioIds = new Set(\r\n      timelineItems\r\n        .filter(item => item.type === \"audio\")\r\n        .map(item => item.id)\r\n    );\r\n\r\n    audioElementsRef.current.forEach((audioElement, id) => {\r\n      if (!currentAudioIds.has(id)) {\r\n        audioElement.pause();\r\n        audioElement.src = '';\r\n        audioElementsRef.current.delete(id);\r\n      }\r\n    });\r\n  }, [timelineItems]);\r\n\r\n  const handleVideoUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newVideo = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        duration: 10,\r\n        type: \"video\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        videos: [...prev.videos, newVideo],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const handleAudioUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newAudio = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        duration: 10,\r\n        type: \"audio\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        audios: [...prev.audios, newAudio],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const handleImageUpload = (event) => {\r\n    const files = event.target.files ? Array.from(event.target.files) : [];\r\n    files.forEach((file) => {\r\n      const url = URL.createObjectURL(file);\r\n      const newImage = {\r\n        id: Date.now() + Math.random(),\r\n        name: file.name,\r\n        url: url,\r\n        file: file,\r\n        type: \"image\",\r\n      };\r\n\r\n      setMediaLibrary((prev) => ({\r\n        ...prev,\r\n        images: [...prev.images, newImage],\r\n      }));\r\n    });\r\n  };\r\n\r\n  const addToTimeline = (mediaItem, startTime = null, targetLayerId = null) => {\r\n    const track = mediaItem.type === \"video\" ? 0 : mediaItem.type === \"audio\" ? 1 : 2;\r\n    const duration = mediaItem.duration || (mediaItem.type === \"image\" ? 5 : 10);\r\n    \r\n    // Определяем слой\r\n    let layerId = targetLayerId;\r\n    if (!layerId) {\r\n      if (mediaItem.type === \"video\" || mediaItem.type === \"image\") {\r\n        layerId = layers.video[0].id; // Первый видео слой по умолчанию\r\n      } else if (mediaItem.type === \"audio\") {\r\n        layerId = layers.audio[0].id; // Первый аудио слой по умолчанию\r\n      } else {\r\n        layerId = layers.effects[0].id;\r\n      }\r\n    }\r\n    \r\n    const finalStartTime = startTime !== null ? startTime : \r\n      findNextAvailablePosition(layerId, duration);\r\n\r\n    const newTimelineItem = {\r\n      id: Date.now() + Math.random(),\r\n      mediaId: mediaItem.id,\r\n      type: mediaItem.type,\r\n      name: mediaItem.name,\r\n      url: mediaItem.url,\r\n      startTime: finalStartTime,\r\n      duration: duration,\r\n      track: track,\r\n      layerId: layerId,\r\n      volume: 1,\r\n      opacity: 1,\r\n      effects: [],\r\n    };\r\n\r\n    if (!checkCollision(newTimelineItem)) {\r\n      setTimelineItems((prev) => [...prev, newTimelineItem]);\r\n\r\n      const newEndTime = newTimelineItem.startTime + newTimelineItem.duration;\r\n      if (newEndTime > videoDuration) {\r\n        setVideoDuration(newEndTime);\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleLayerVisibility = (layerId) => {\r\n    setLayers(prev => {\r\n      const newLayers = { ...prev };\r\n      Object.keys(newLayers).forEach(trackType => {\r\n        newLayers[trackType] = newLayers[trackType].map(layer =>\r\n          layer.id === layerId ? { ...layer, visible: !layer.visible } : layer\r\n        );\r\n      });\r\n      return newLayers;\r\n    });\r\n  };\r\n\r\n  const addLayer = (trackType) => {\r\n    const track = trackType === 'video' ? 0 : trackType === 'audio' ? 1 : 2;\r\n    const newLayerId = `${trackType}-${Date.now()}`;\r\n    const newLayer = {\r\n      id: newLayerId,\r\n      name: `${trackType.charAt(0).toUpperCase() + trackType.slice(1)} Layer ${layers[trackType].length + 1}`,\r\n      visible: true,\r\n      track: track\r\n    };\r\n    \r\n    setLayers(prev => ({\r\n      ...prev,\r\n      [trackType]: [...prev[trackType], newLayer]\r\n    }));\r\n  };\r\n\r\n  const handlePlayPause = () => {\r\n    setIsPlaying(!isPlaying);\r\n  };\r\n\r\n  const seekTo = (time) => {\r\n    const newTime = Math.max(0, Math.min(videoDuration, time));\r\n    setCurrentTime(newTime);\r\n    \r\n    const content = getCurrentTimelineContent();\r\n    content.audio.forEach(audioItem => {\r\n      const audioElement = audioElementsRef.current.get(audioItem.id);\r\n      if (audioElement) {\r\n        const relativeTime = newTime - audioItem.startTime;\r\n        audioElement.currentTime = Math.max(0, relativeTime);\r\n      }\r\n    });\r\n  };\r\n\r\n  const removeFromLibrary = (itemId, type) => {\r\n    setMediaLibrary((prev) => ({\r\n      ...prev,\r\n      [type]: prev[type].filter((item) => item.id !== itemId),\r\n    }));\r\n  };\r\n\r\n  const removeFromTimeline = (itemId) => {\r\n    const audioElement = audioElementsRef.current.get(itemId);\r\n    if (audioElement) {\r\n      audioElement.pause();\r\n      audioElement.src = '';\r\n      audioElementsRef.current.delete(itemId);\r\n    }\r\n    \r\n    setTimelineItems((prev) => prev.filter((item) => item.id !== itemId));\r\n    setSelectedTimelineItem(null);\r\n  };\r\n\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  const handleTimelineClick = (e) => {\r\n    if (isDragging || isTimelineDragging) return;\r\n    \r\n    const rect = timelineRef.current.getBoundingClientRect();\r\n    const clickX = e.clientX - rect.left;\r\n    const timePerPixel = videoDuration / (rect.width * timelineZoom);\r\n    const clickTime = clickX * timePerPixel;\r\n    seekTo(clickTime);\r\n  };\r\n\r\n  const handleDragStart = (e, mediaItem) => {\r\n    setDraggedItem(mediaItem);\r\n    setIsDragging(true);\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    setDraggedItem(null);\r\n    setDropPreview(null);\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const handleTimelineItemDragStart = (e, timelineItem) => {\r\n    e.stopPropagation();\r\n    setDraggedTimelineItem(timelineItem);\r\n    setIsTimelineDragging(true);\r\n    \r\n    const rect = timelineRef.current.getBoundingClientRect();\r\n    const itemRect = e.target.getBoundingClientRect();\r\n    setDragOffset(e.clientX - itemRect.left);\r\n    \r\n    e.dataTransfer.effectAllowed = \"move\";\r\n    e.dataTransfer.setData(\"text/plain\", \"\");\r\n  };\r\n\r\n  const handleTimelineItemDragEnd = () => {\r\n    setDraggedTimelineItem(null);\r\n    setDropPreview(null);\r\n    setIsTimelineDragging(false);\r\n    setDragOffset(0);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    if (!draggedItem && !draggedTimelineItem) return;\r\n    \r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = draggedItem ? \"copy\" : \"move\";\r\n    \r\n    const rect = timelineRef.current.getBoundingClientRect();\r\n    const dragX = e.clientX - rect.left - (draggedTimelineItem ? dragOffset : 0);\r\n    const timePerPixel = videoDuration / (rect.width * timelineZoom);\r\n    const dropTime = Math.max(0, dragX * timePerPixel);\r\n    \r\n    // Определяем на какой слой перетаскиваем\r\n    const dragY = e.clientY - rect.top;\r\n    const layerHeight = 24; // Высота одного слоя\r\n    const headerHeight = 48; // Высота заголовка таймлайна\r\n    const timeRulerHeight = 48; // Высота временной линейки\r\n    \r\n    const relativeY = dragY - timeRulerHeight;\r\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\r\n    const targetLayerIndex = Math.floor(relativeY / layerHeight);\r\n    const targetLayer = allLayersFlat[targetLayerIndex];\r\n    \r\n    if (draggedItem && targetLayer) {\r\n      const track = targetLayer.track;\r\n      const duration = draggedItem.duration || (draggedItem.type === \"image\" ? 5 : 10);\r\n      const testItem = { layerId: targetLayer.id, startTime: dropTime, duration };\r\n      \r\n      setDropPreview({\r\n        time: dropTime,\r\n        duration: duration,\r\n        layerId: targetLayer.id,\r\n        track: track,\r\n        isValid: !checkCollision(testItem)\r\n      });\r\n    } else if (draggedTimelineItem && targetLayer) {\r\n      const testItem = { \r\n        ...draggedTimelineItem, \r\n        startTime: dropTime,\r\n        layerId: targetLayer.id\r\n      };\r\n      \r\n      setDropPreview({\r\n        time: dropTime,\r\n        duration: draggedTimelineItem.duration,\r\n        layerId: targetLayer.id,\r\n        track: targetLayer.track,\r\n        isValid: !checkCollision(testItem, draggedTimelineItem.id)\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    if ((!draggedItem && !draggedTimelineItem) || !dropPreview) return;\r\n    \r\n    e.preventDefault();\r\n    \r\n    if (dropPreview.isValid) {\r\n      if (draggedItem) {\r\n        addToTimeline(draggedItem, dropPreview.time, dropPreview.layerId);\r\n      } else if (draggedTimelineItem) {\r\n        setTimelineItems(prev => prev.map(item => \r\n          item.id === draggedTimelineItem.id \r\n            ? { ...item, startTime: dropPreview.time, layerId: dropPreview.layerId }\r\n            : item\r\n        ));\r\n        \r\n        if (selectedTimelineItem?.id === draggedTimelineItem.id) {\r\n          setSelectedTimelineItem(prev => ({ \r\n            ...prev, \r\n            startTime: dropPreview.time, \r\n            layerId: dropPreview.layerId \r\n          }));\r\n        }\r\n      }\r\n    }\r\n    \r\n    setDropPreview(null);\r\n    setDraggedItem(null);\r\n    setDraggedTimelineItem(null);\r\n    setIsDragging(false);\r\n    setIsTimelineDragging(false);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    if (!timelineRef.current?.contains(e.relatedTarget)) {\r\n      setDropPreview(null);\r\n    }\r\n  };\r\n\r\n  const getTimelineItemStyle = (item) => {\r\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\r\n    const layerIndex = allLayersFlat.findIndex(layer => layer.id === item.layerId);\r\n    \r\n    return {\r\n      left: `${\r\n        (item.startTime / videoDuration) *\r\n        videoDuration *\r\n        20 *\r\n        timelineZoom\r\n      }px`,\r\n      width: `${\r\n        (item.duration / videoDuration) *\r\n        videoDuration *\r\n        20 *\r\n        timelineZoom\r\n      }px`,\r\n      top: `${layerIndex * 24 + 4}px`,\r\n    };\r\n  };\r\n\r\n  const getDropPreviewStyle = () => {\r\n    if (!dropPreview) return {};\r\n    \r\n    const allLayersFlat = [...layers.video, ...layers.audio, ...layers.effects];\r\n    const layerIndex = allLayersFlat.findIndex(layer => layer.id === dropPreview.layerId);\r\n    \r\n    return {\r\n      left: `${\r\n        (dropPreview.time / videoDuration) *\r\n        videoDuration *\r\n        20 *\r\n        timelineZoom\r\n      }px`,\r\n      width: `${\r\n        (dropPreview.duration / videoDuration) *\r\n        videoDuration *\r\n        20 *\r\n        timelineZoom\r\n      }px`,\r\n      top: `${layerIndex * 24 + 4}px`,\r\n    };\r\n  };\r\n\r\n  const getLayerColor = (layerId) => {\r\n    if (layerId.startsWith('video')) return 'bg-blue-500 border-blue-400';\r\n    if (layerId.startsWith('audio')) return 'bg-green-500 border-green-400';\r\n    return 'bg-purple-500 border-purple-400';\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-1 h-screen gap-4 p-4 bg-gray-100\">\r\n      <div className=\"w-80 bg-white border border-gray-200 flex flex-col rounded-2xl shadow-sm overflow-hidden\">\r\n        <div className=\"p-4 pb-0\">\r\n          <div className=\"flex bg-gray-100 rounded-xl p-1\">\r\n            {[\r\n              { id: \"videos\", name: \"Videos\", icon: Video },\r\n              { id: \"audios\", name: \"Audio\", icon: Music },\r\n              { id: \"images\", name: \"Images\", icon: Image },\r\n            ].map((tab) => {\r\n              const IconComponent = tab.icon;\r\n              return (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id)}\r\n                  className={`flex-1 p-3 text-sm font-medium transition-all duration-200 rounded-lg ${\r\n                    activeTab === tab.id\r\n                      ? \"bg-white text-blue-600 shadow-sm\"\r\n                      : \"text-gray-600 hover:text-gray-800\"\r\n                  }`}\r\n                >\r\n                  <IconComponent size={16} className=\"mr-2 inline\" />\r\n                  {tab.name}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4\">\r\n          <button\r\n            onClick={() => {\r\n              if (activeTab === \"videos\") fileInputRef.current?.click();\r\n              else if (activeTab === \"audios\") audioInputRef.current?.click();\r\n              else imageInputRef.current?.click();\r\n            }}\r\n            className=\"w-full p-6 border-2 border-dashed border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-200 text-center group\"\r\n          >\r\n            <div className=\"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-100 transition-colors\">\r\n              <Upload\r\n                size={20}\r\n                className=\"text-gray-500 group-hover:text-blue-500\"\r\n              />\r\n            </div>\r\n            <span className=\"text-sm font-medium text-gray-700 group-hover:text-blue-600\">\r\n              Upload{\" \"}\r\n              {activeTab === \"videos\"\r\n                ? \"Video\"\r\n                : activeTab === \"audios\"\r\n                ? \"Audio\"\r\n                : \"Images\"}\r\n            </span>\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              {activeTab === \"videos\"\r\n                ? \"MP4, AVI, MOV up to 2GB\"\r\n                : activeTab === \"audios\"\r\n                ? \"MP3, WAV, M4A up to 100MB\"\r\n                : \"JPG, PNG, GIF up to 10MB\"}\r\n            </p>\r\n          </button>\r\n        </div>\r\n\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\"video/*\"\r\n          multiple\r\n          onChange={handleVideoUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={audioInputRef}\r\n          type=\"file\"\r\n          accept=\"audio/*\"\r\n          multiple\r\n          onChange={handleAudioUpload}\r\n          className=\"hidden\"\r\n        />\r\n        <input\r\n          ref={imageInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          multiple\r\n          onChange={handleImageUpload}\r\n          className=\"hidden\"\r\n        />\r\n\r\n        <div className=\"flex-1 overflow-y-auto px-4 pb-4\">\r\n          <div className=\"space-y-2\">\r\n            {mediaLibrary[activeTab].map((item) => (\r\n              <div\r\n                key={item.id}\r\n                draggable=\"true\"\r\n                onDragStart={(e) => handleDragStart(e, item)}\r\n                onDragEnd={handleDragEnd}\r\n                className={`flex items-center p-3 bg-gray-50 rounded-xl hover:bg-gray-100 hover:shadow-sm transition-all duration-200 cursor-grab active:cursor-grabbing group ${\r\n                  draggedItem?.id === item.id ? \"opacity-50\" : \"\"\r\n                }`}\r\n                onClick={() => addToTimeline(item)}\r\n              >\r\n                <div className=\"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-3 shadow-sm group-hover:shadow\">\r\n                  {activeTab === \"videos\" && (\r\n                    <Video size={20} className=\"text-blue-500\" />\r\n                  )}\r\n                  {activeTab === \"audios\" && (\r\n                    <Music size={20} className=\"text-green-500\" />\r\n                  )}\r\n                  {activeTab === \"images\" && (\r\n                    <Image size={20} className=\"text-purple-500\" />\r\n                  )}\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <p className=\"text-sm font-medium text-gray-900 truncate\">\r\n                    {item.name}\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    {activeTab === \"images\"\r\n                      ? \"Image\"\r\n                      : formatTime(item.duration || 0)}\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    removeFromLibrary(item.id, activeTab);\r\n                  }}\r\n                  className=\"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200\"\r\n                >\r\n                  <Trash2 size={14} />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 flex flex-col gap-4\">\r\n        <div className=\"flex-1 bg-black rounded-2xl relative overflow-hidden shadow-sm\">\r\n          {currentVideoSource ? (\r\n            <div className=\"relative w-full h-full\">\r\n              {getCurrentTimelineContent().video[0] ? (\r\n                <video\r\n                  ref={videoRef}\r\n                  src={currentVideoSource}\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                  muted={isMuted}\r\n                />\r\n              ) : (\r\n                <img\r\n                  src={currentVideoSource}\r\n                  alt=\"Timeline content\"\r\n                  className=\"w-full h-full object-contain rounded-2xl\"\r\n                />\r\n              )}\r\n              \r\n              {/* Canvas для наложений */}\r\n              <canvas\r\n                ref={overlayCanvasRef}\r\n                className=\"absolute top-0 left-0 w-full h-full pointer-events-none\"\r\n                width={1920}\r\n                height={1080}\r\n                style={{ mixBlendMode: 'normal' }}\r\n              />\r\n              \r\n              {/* Отображаем изображения как наложения */}\r\n              {getCurrentTimelineContent().images.map((item, index) => (\r\n                <img\r\n                  key={item.id}\r\n                  src={item.url}\r\n                  alt={item.name}\r\n                  className=\"absolute top-0 left-0 w-full h-full object-contain pointer-events-none\"\r\n                  style={{ \r\n                    zIndex: 10 + index,\r\n                    opacity: item.opacity || 1,\r\n                    mixBlendMode: 'normal'\r\n                  }}\r\n                />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"w-full h-full flex items-center justify-center text-white\">\r\n              <div className=\"text-center\">\r\n                <div className=\"w-20 h-20 bg-gray-800 rounded-2xl flex items-center justify-center mx-auto mb-4\">\r\n                  <Film size={40} className=\"opacity-50\" />\r\n                </div>\r\n                <p className=\"text-xl opacity-75 font-medium\">\r\n                  No content at current time\r\n                </p>\r\n                <p className=\"text-sm opacity-50\">\r\n                  Drag media to timeline layers\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-md rounded-2xl p-4\">\r\n            <div className=\"flex items-center space-x-6\">\r\n              <button\r\n                onClick={() => seekTo(Math.max(0, currentTime - 10))}\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n              >\r\n                <SkipBack size={20} />\r\n              </button>\r\n              <button\r\n                onClick={handlePlayPause}\r\n                className=\"w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center text-white transition-all hover:scale-105\"\r\n              >\r\n                {isPlaying ? <Pause size={24} /> : <Play size={24} />}\r\n              </button>\r\n              <button\r\n                onClick={() =>\r\n                  seekTo(Math.min(videoDuration, currentTime + 10))\r\n                }\r\n                className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n              >\r\n                <SkipForward size={20} />\r\n              </button>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <button\r\n                  onClick={() => setIsMuted(!isMuted)}\r\n                  className=\"text-white hover:text-blue-400 transition-colors p-1 rounded-lg hover:bg-white/10\"\r\n                >\r\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\r\n                </button>\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                  value={volume}\r\n                  onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                  className=\"w-24 accent-blue-500\"\r\n                />\r\n              </div>\r\n              <span className=\"text-white text-sm font-medium min-w-0\">\r\n                {formatTime(currentTime)} / {formatTime(videoDuration)}\r\n              </span>\r\n              {getCurrentTimelineContent().audio.length > 0 && (\r\n                <div className=\"flex items-center space-x-1\">\r\n                  <Music size={16} className=\"text-green-400\" />\r\n                  <span className=\"text-green-400 text-xs font-medium\">\r\n                    {getCurrentTimelineContent().audio.length} audio\r\n                  </span>\r\n                </div>\r\n              )}\r\n              {getCurrentTimelineContent().allVisual.length > 1 && (\r\n                <div className=\"flex items-center space-x-1\">\r\n                  <Layers size={16} className=\"text-blue-400\" />\r\n                  <span className=\"text-blue-400 text-xs font-medium\">\r\n                    {getCurrentTimelineContent().allVisual.length} layers\r\n                  </span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div \r\n          className={`h-96 bg-white rounded-2xl shadow-sm border-2 transition-all duration-200 overflow-hidden ${\r\n            isDragging || isTimelineDragging \r\n              ? \"border-blue-400 bg-blue-50/20\" \r\n              : \"border-gray-200\"\r\n          }`}\r\n          onDragOver={handleDragOver}\r\n          onDrop={handleDrop}\r\n          onDragLeave={handleDragLeave}\r\n        >\r\n          <div className=\"bg-gray-50 p-4 border-b border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"text-gray-800 font-semibold flex items-center space-x-2\">\r\n                <Layers size={18} />\r\n                <span>Timeline Layers</span>\r\n                {(isDragging || isTimelineDragging) && dropPreview && (\r\n                  <span className={dropPreview.isValid ? \"text-green-600\" : \"text-red-600\"}>\r\n                    - {dropPreview.isValid ? \"Drop to place\" : \"Position blocked\"}\r\n                  </span>\r\n                )}\r\n              </h4>\r\n              <div className=\"flex items-center space-x-6\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <span className=\"text-gray-600 text-sm font-medium\">Zoom:</span>\r\n                  <div className=\"bg-white rounded-xl p-2 border border-gray-200\">\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"0.5\"\r\n                      max=\"3\"\r\n                      step=\"0.1\"\r\n                      value={timelineZoom}\r\n                      onChange={(e) => setTimelineZoom(parseFloat(e.target.value))}\r\n                      className=\"w-24 accent-blue-500\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button\r\n                    onClick={() => addLayer('video')}\r\n                    className=\"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200\"\r\n                    title=\"Add Video Layer\"\r\n                  >\r\n                    <Plus size={16} />\r\n                  </button>\r\n                  <button className=\"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200\">\r\n                    <Split size={16} />\r\n                  </button>\r\n                  <button className=\"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200\">\r\n                    <Copy size={16} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            className=\"flex-1 relative overflow-x-auto\"\r\n            ref={timelineRef}\r\n            onClick={handleTimelineClick}\r\n          >\r\n            {/* Временная линейка */}\r\n            <div className=\"h-12 bg-gray-50 border-b border-gray-200 relative\">\r\n              {Array.from({ length: Math.ceil(videoDuration / 5) + 1 }, (_, i) => (\r\n                <div\r\n                  key={i}\r\n                  className=\"absolute top-0 h-full border-l border-gray-300\"\r\n                  style={{ left: `${i * 100 * timelineZoom}px` }}\r\n                >\r\n                  <span className=\"text-xs text-gray-600 ml-2 mt-2 inline-block font-medium\">\r\n                    {formatTime(i * 5)}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n              <div\r\n                className=\"absolute top-0 w-0.5 h-full bg-red-500 z-20 shadow-sm\"\r\n                style={{\r\n                  left: `${(currentTime / videoDuration) * videoDuration * 20 * timelineZoom}px`,\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            {/* Слои */}\r\n            <div className=\"relative\" style={{ height: `${(layers.video.length + layers.audio.length + layers.effects.length) * 24}px` }}>\r\n              {/* Заголовки слоев */}\r\n              <div className=\"absolute left-0 top-0 w-48 bg-gray-50 border-r border-gray-200 z-10\">\r\n                {[...layers.video, ...layers.audio, ...layers.effects].map((layer, index) => (\r\n                  <div\r\n                    key={layer.id}\r\n                    className=\"h-6 flex items-center px-3 border-b border-gray-100 text-xs font-medium text-gray-700\"\r\n                    style={{ top: `${index * 24}px` }}\r\n                  >\r\n                    <button\r\n                      onClick={() => toggleLayerVisibility(layer.id)}\r\n                      className=\"mr-2 hover:bg-gray-200 rounded p-1\"\r\n                    >\r\n                      {layer.visible ? <Eye size={12} /> : <EyeOff size={12} />}\r\n                    </button>\r\n                    <span className=\"truncate\">{layer.name}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Элементы таймлайна */}\r\n              <div className=\"pl-48\">\r\n                {timelineItems.map((item) => {\r\n                  const layer = [...layers.video, ...layers.audio, ...layers.effects].find(l => l.id === item.layerId);\r\n                  if (!layer?.visible) return null;\r\n                  \r\n                  return (\r\n                    <div\r\n                      key={item.id}\r\n                      draggable=\"true\"\r\n                      onDragStart={(e) => handleTimelineItemDragStart(e, item)}\r\n                      onDragEnd={handleTimelineItemDragEnd}\r\n                      className={`absolute h-5 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all shadow-sm hover:shadow-md ${\r\n                        getLayerColor(item.layerId)\r\n                      } ${\r\n                        selectedTimelineItem?.id === item.id ? \"ring-2 ring-blue-300\" : \"\"\r\n                      } ${\r\n                        draggedTimelineItem?.id === item.id ? \"opacity-50 z-30\" : \"\"\r\n                      }`}\r\n                      style={getTimelineItemStyle(item)}\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setSelectedTimelineItem(item);\r\n                      }}\r\n                    >\r\n                      <div className=\"p-1 text-white text-xs truncate font-medium\">\r\n                        {item.name}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n                \r\n                {/* Drop preview */}\r\n                {dropPreview && (\r\n                  <div\r\n                    className={`absolute h-5 rounded-lg border-2 border-dashed opacity-75 ${\r\n                      dropPreview.isValid \r\n                        ? `${getLayerColor(dropPreview.layerId).replace('border-', 'border-')} bg-opacity-50` \r\n                        : \"bg-red-300 border-red-500\"\r\n                    }`}\r\n                    style={getDropPreviewStyle()}\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {selectedTimelineItem && (\r\n        <div className=\"w-80 bg-white border border-gray-200 rounded-2xl p-6 shadow-sm\">\r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"font-semibold text-gray-800 text-lg\">Properties</h4>\r\n              <button\r\n                onClick={() => setSelectedTimelineItem(null)}\r\n                className=\"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-xl transition-all duration-200\"\r\n              >\r\n                <X size={16} />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={selectedTimelineItem.name}\r\n                  className=\"w-full p-3 border border-gray-200 rounded-xl text-sm bg-gray-50 font-medium\"\r\n                  readOnly\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Layer</label>\r\n                <select\r\n                  value={selectedTimelineItem.layerId}\r\n                  onChange={(e) => {\r\n                    const newLayerId = e.target.value;\r\n                    const testItem = { ...selectedTimelineItem, layerId: newLayerId };\r\n                    \r\n                    if (!checkCollision(testItem, selectedTimelineItem.id)) {\r\n                      setTimelineItems((prev) =>\r\n                        prev.map((item) =>\r\n                          item.id === selectedTimelineItem.id\r\n                            ? { ...item, layerId: newLayerId }\r\n                            : item\r\n                        )\r\n                      );\r\n                      setSelectedTimelineItem((prev) =>\r\n                        prev ? { ...prev, layerId: newLayerId } : null\r\n                      );\r\n                    }\r\n                  }}\r\n                  className=\"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\"\r\n                >\r\n                  {selectedTimelineItem.type === \"video\" || selectedTimelineItem.type === \"image\" \r\n                    ? layers.video.map(layer => (\r\n                        <option key={layer.id} value={layer.id}>{layer.name}</option>\r\n                      ))\r\n                    : selectedTimelineItem.type === \"audio\"\r\n                    ? layers.audio.map(layer => (\r\n                        <option key={layer.id} value={layer.id}>{layer.name}</option>\r\n                      ))\r\n                    : layers.effects.map(layer => (\r\n                        <option key={layer.id} value={layer.id}>{layer.name}</option>\r\n                      ))\r\n                  }\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Start Time (seconds)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={selectedTimelineItem.startTime}\r\n                  onChange={(e) => {\r\n                    const newStartTime = parseFloat(e.target.value);\r\n                    const testItem = { ...selectedTimelineItem, startTime: newStartTime };\r\n                    \r\n                    if (!checkCollision(testItem, selectedTimelineItem.id)) {\r\n                      setTimelineItems((prev) =>\r\n                        prev.map((item) =>\r\n                          item.id === selectedTimelineItem.id\r\n                            ? { ...item, startTime: newStartTime }\r\n                            : item\r\n                        )\r\n                      );\r\n                      setSelectedTimelineItem((prev) =>\r\n                        prev ? { ...prev, startTime: newStartTime } : null\r\n                      );\r\n                    }\r\n                  }}\r\n                  className=\"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\"\r\n                  step=\"0.1\"\r\n                  min=\"0\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Duration (seconds)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={selectedTimelineItem.duration}\r\n                  onChange={(e) => {\r\n                    const newDuration = parseFloat(e.target.value);\r\n                    const testItem = { ...selectedTimelineItem, duration: newDuration };\r\n                    \r\n                    if (!checkCollision(testItem, selectedTimelineItem.id)) {\r\n                      setTimelineItems((prev) =>\r\n                        prev.map((item) =>\r\n                          item.id === selectedTimelineItem.id\r\n                            ? { ...item, duration: newDuration }\r\n                            : item\r\n                        )\r\n                      );\r\n                      setSelectedTimelineItem((prev) =>\r\n                        prev ? { ...prev, duration: newDuration } : null\r\n                      );\r\n                    }\r\n                  }}\r\n                  className=\"w-full p-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all\"\r\n                  step=\"0.1\"\r\n                  min=\"0.1\"\r\n                />\r\n              </div>\r\n\r\n              {(selectedTimelineItem.type === \"image\" || selectedTimelineItem.type === \"video\") && (\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Opacity</label>\r\n                  <div className=\"bg-gray-50 rounded-xl p-4\">\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"0\"\r\n                      max=\"1\"\r\n                      step=\"0.1\"\r\n                      value={selectedTimelineItem.opacity || 1}\r\n                      onChange={(e) => {\r\n                        const newOpacity = parseFloat(e.target.value);\r\n                        setTimelineItems((prev) =>\r\n                          prev.map((item) =>\r\n                            item.id === selectedTimelineItem.id\r\n                              ? { ...item, opacity: newOpacity }\r\n                              : item\r\n                          )\r\n                        );\r\n                        setSelectedTimelineItem((prev) =>\r\n                          prev ? { ...prev, opacity: newOpacity } : null\r\n                        );\r\n                      }}\r\n                      className=\"w-full accent-blue-500\"\r\n                    />\r\n                    <div className=\"text-sm text-gray-600 mt-2 text-center font-medium\">\r\n                      {Math.round((selectedTimelineItem.opacity || 1) * 100)}%\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {selectedTimelineItem.type === \"audio\" && (\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Volume</label>\r\n                  <div className=\"bg-gray-50 rounded-xl p-4\">\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"0\"\r\n                      max=\"2\"\r\n                      step=\"0.1\"\r\n                      value={selectedTimelineItem.volume}\r\n                      onChange={(e) => {\r\n                        const newVolume = parseFloat(e.target.value);\r\n                        setTimelineItems((prev) =>\r\n                          prev.map((item) =>\r\n                            item.id === selectedTimelineItem.id\r\n                              ? { ...item, volume: newVolume }\r\n                              : item\r\n                          )\r\n                        );\r\n                        setSelectedTimelineItem((prev) =>\r\n                          prev ? { ...prev, volume: newVolume } : null\r\n                        );\r\n                        \r\n                        const audioElement = audioElementsRef.current.get(selectedTimelineItem.id);\r\n                        if (audioElement) {\r\n                          audioElement.volume = newVolume * volume;\r\n                        }\r\n                      }}\r\n                      className=\"w-full accent-blue-500\"\r\n                    />\r\n                    <div className=\"text-sm text-gray-600 mt-2 text-center font-medium\">\r\n                      {Math.round(selectedTimelineItem.volume * 100)}%\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              <button\r\n                onClick={() => removeFromTimeline(selectedTimelineItem.id)}\r\n                className=\"w-full p-3 bg-red-500 hover:bg-red-600 text-white rounded-xl text-sm font-semibold transition-all duration-200 hover:shadow-md\"\r\n              >\r\n                <Trash2 size={16} className=\"inline mr-2\" />\r\n                Remove from Timeline\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoEditor;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}